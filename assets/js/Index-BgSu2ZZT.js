import{_ as e}from"./AppLayout-poNpMhjN.js";import{ac as s,H as l,I as a,J as t,M as n,L as r,O as o,Q as d,S as i,U as c,F as u,x as g,aa as m,b as v,R as y,f as p,o as x,Z as h,_ as b}from"./vendor-DNM7Y6Xn.js";import{p as k}from"./app-BXm70mdJ.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";const f={class:"py-12"},w={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},C={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6 mb-6"},P={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},S=["onClick"],W={class:"flex items-center justify-between"},_={class:"font-medium text-gray-900"},j={class:"text-sm text-gray-600"},A={class:"text-xs text-gray-500"},Y={class:"text-right"},M={class:"text-sm font-medium text-gray-900"},E={class:"text-xs text-gray-500"},L={key:0,class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6 mb-6"},U={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Q=["value"],B={class:"flex items-end"},F={key:1,class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},G={class:"flex justify-between items-center mb-6"},I={class:"text-lg font-medium text-gray-900"},T={class:"text-sm text-gray-500"},V={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},H=["onClick"],R={class:"flex justify-between items-start mb-3"},z={class:"font-medium text-gray-900"},D={class:"space-y-2"},J={class:"text-sm text-gray-600"},N={class:"w-full bg-gray-200 rounded-full h-2"},O={class:"text-xs text-gray-500"},Z={key:2,class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-12 text-center"},$={key:3,class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-12 text-center"};const q=k({components:{AppLayout:e},setup(){const e=p(!1),s=p(!1),l=p([]),a=p([]),t=p([]),n=p(null),r=p(null),o=p(1);x(async()=>{await d()});const d=async()=>{e.value=!0;try{const e=await h.get("/api/academic-years");l.value=e.data;const s=await h.get("/api/classroom-subject-teachers/my-assignments");a.value=s.data,l.value.length>0&&(r.value=l.value[0].id)}catch(s){console.error("Error loading initial data:",s)}finally{e.value=!1}},i=async()=>{if(n.value&&r.value){e.value=!0;try{const e=await h.get("/api/weeklyplansystem/headers",{params:{cst_id:n.value.id,academic_year_id:r.value,semester_number:o.value}});t.value=e.data}catch(s){console.error("Error loading weekly plans:",s),t.value=[]}finally{e.value=!1}}},c=e=>{var s,l;const a=(null==(s=e.sessions)?void 0:s.length)||0;if(0===a)return"Empty";const t=(null==(l=e.sessions)?void 0:l.filter(e=>{var s;return"lesson"===e.type&&(null==(s=e.data)?void 0:s.completed)}).length)||0;return 0===t?"Planned":t===a?"Complete":"In Progress"};return{loading:e,generating:s,academicYears:l,classSubjectTeachers:a,weeklyPlans:t,selectedCst:n,selectedAcademicYear:r,selectedSemester:o,selectCst:e=>{n.value=e,i()},loadWeeklyPlans:i,generateSemesterPlans:async()=>{if(n.value&&r.value){s.value=!0;try{const e=await h.post("/api/weeklyplansystem/headers/generate-semester",{cst_id:n.value.id,academic_year_id:r.value,semester_number:o.value,total_weeks:18});t.value=e.data,console.log("Semester plans generated successfully")}catch(e){console.error("Error generating semester plans:",e)}finally{s.value=!1}}},openWeeklyPlan:e=>{b.visit(`/weekly-plans/${e.id}/edit`)},getCurrentAcademicYear:()=>l.value.find(e=>e.id===r.value),getWeeklyPlanStatus:e=>"Ready",getWeekStatus:c,getWeekStatusClass:e=>{switch(c(e)){case"Empty":default:return"bg-gray-100 text-gray-800";case"Planned":return"bg-blue-100 text-blue-800";case"In Progress":return"bg-yellow-100 text-yellow-800";case"Complete":return"bg-green-100 text-green-800"}},getWeekProgress:e=>{var s,l;const a=(null==(s=e.sessions)?void 0:s.length)||0;if(0===a)return 0;const t=(null==(l=e.sessions)?void 0:l.filter(e=>{var s;return null==(s=e.data)?void 0:s.completed}).length)||0;return Math.round(t/a*100)}}}},[["render",function(e,p,x,h,b,k){const q=s("AppLayout");return a(),l(q,{title:"Weekly Plans"},{header:t(()=>p[4]||(p[4]=[n("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Weekly Plans ",-1)])),default:t(()=>{var e,s,l;return[n("div",f,[n("div",w,[n("div",C,[p[5]||(p[5]=n("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"My Teaching Assignments",-1)),n("div",P,[(a(!0),r(u,null,d(h.classSubjectTeachers,e=>{var s,l,t,o;return a(),r("div",{key:e.id,class:i(["border rounded-lg p-4 cursor-pointer hover:bg-gray-50 transition-colors",{"border-blue-500 bg-blue-50":(null==(s=h.selectedCst)?void 0:s.id)===e.id}]),onClick:s=>h.selectCst(e)},[n("div",W,[n("div",null,[n("h4",_,c((null==(l=e.classroom)?void 0:l.name)||"Unknown Class"),1),n("p",j,c((null==(t=e.subject)?void 0:t.name)||"Unknown Subject"),1),n("p",A,c(e.classes_per_week)+" sessions/week",1)]),n("div",Y,[n("div",M,c(h.getWeeklyPlanStatus(e.id)),1),n("div",E,c(null==(o=h.getCurrentAcademicYear())?void 0:o.name),1)])])],10,S)}),128))])]),h.selectedCst?(a(),r("div",L,[n("div",U,[n("div",null,[p[6]||(p[6]=n("label",{class:"block text-sm font-medium text-gray-700"},"Academic Year",-1)),g(n("select",{"onUpdate:modelValue":p[0]||(p[0]=e=>h.selectedAcademicYear=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onChange:p[1]||(p[1]=(...e)=>h.loadWeeklyPlans&&h.loadWeeklyPlans(...e))},[(a(!0),r(u,null,d(h.academicYears,e=>(a(),r("option",{key:e.id,value:e.id},c(e.name),9,Q))),128))],544),[[m,h.selectedAcademicYear]])]),n("div",null,[p[8]||(p[8]=n("label",{class:"block text-sm font-medium text-gray-700"},"Semester",-1)),g(n("select",{"onUpdate:modelValue":p[2]||(p[2]=e=>h.selectedSemester=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onChange:p[3]||(p[3]=(...e)=>h.loadWeeklyPlans&&h.loadWeeklyPlans(...e))},p[7]||(p[7]=[n("option",{value:"1"},"First Semester",-1),n("option",{value:"2"},"Second Semester",-1)]),544),[[m,h.selectedSemester]])]),n("div",B,[v(QBtn,{color:"primary",icon:"auto_fix_high",label:"Generate Semester Plans",onClick:h.generateSemesterPlans,loading:h.generating,class:"w-full"},null,8,["onClick","loading"])])])])):o("",!0),h.selectedCst&&h.weeklyPlans.length>0?(a(),r("div",F,[n("div",G,[n("h3",I," Weekly Plans - "+c(null==(e=h.selectedCst.classroom)?void 0:e.name)+" - "+c(null==(s=h.selectedCst.subject)?void 0:s.name),1),n("div",T," Semester "+c(h.selectedSemester)+" - "+c(null==(l=h.getCurrentAcademicYear())?void 0:l.name),1)]),n("div",V,[(a(!0),r(u,null,d(h.weeklyPlans,e=>{var s;return a(),r("div",{key:e.id,class:"border rounded-lg p-4 cursor-pointer hover:shadow-md transition-shadow",onClick:s=>h.openWeeklyPlan(e)},[n("div",R,[n("h4",z,"Week "+c(e.week_number),1),n("span",{class:i(["px-2 py-1 text-xs rounded-full",h.getWeekStatusClass(e)])},c(h.getWeekStatus(e)),3)]),n("div",D,[n("div",J,c((null==(s=e.sessions)?void 0:s.length)||0)+" sessions planned ",1),n("div",N,[n("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:y({width:h.getWeekProgress(e)+"%"})},null,4)]),n("div",O,c(h.getWeekProgress(e))+"% complete ",1)])],8,H)}),128))])])):h.selectedCst&&!h.loading?(a(),r("div",Z,[p[9]||(p[9]=n("div",{class:"text-gray-400 mb-4"},[n("svg",{class:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})])],-1)),p[10]||(p[10]=n("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No Weekly Plans Found",-1)),p[11]||(p[11]=n("p",{class:"text-gray-600 mb-4"},"Generate your semester plans to get started with weekly planning.",-1)),v(QBtn,{color:"primary",icon:"auto_fix_high",label:"Generate Semester Plans",onClick:h.generateSemesterPlans,loading:h.generating},null,8,["onClick","loading"])])):o("",!0),h.loading?(a(),r("div",$,[v(QSpinnerDots,{size:"50px",color:"primary"}),p[12]||(p[12]=n("p",{class:"mt-4 text-gray-600"},"Loading weekly plans...",-1))])):o("",!0)])])]}),_:1})}]]);export{q as default};
