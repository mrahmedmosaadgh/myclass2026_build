import{r as e,u as l,f as a,b as t,Q as s,h as o,aR as n,i,l as d,j as r,k as u,c,t as m,s as v,d as p,e as f,aS as g}from"./app-DlLesFGi.js";import{Q as b}from"./QSelect-BTh0khse.js";import{Q as x}from"./QBadge-IdEcTs8C.js";import h from"./QuizNumpad-BoO7KE-q.js";import{f as w,a as y,o as k,e as _,I as C,J as z,K as V,b as M,R as S,W as A,V as U,y as j,a0 as I,N as T,Q,F as $,O as N,B as q,U as B,a2 as O}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";const D=new Audio("/audio/timer/ticking-clock_1-27477.mp3");D.loop=!0,D.preload="auto";const F=new Audio("/audio/timer/countdown-timer-pressure.mp3");F.preload="auto";const R={playTicking(){D.play().catch(e=>console.warn("Ticking play failed",e))},pauseTicking(){D.pause()},playAlarm(){F.currentTime=0,F.play().catch(e=>console.warn("Alarm play failed",e))},stopAll(){D.pause(),D.currentTime=0,F.pause(),F.currentTime=0}},J={class:"flex flex-wrap items-center justify-between gap-3 sm:gap-4"},K={class:"flex flex-wrap items-center gap-2 sm:gap-4 flex-grow"},P={class:"text-base sm:text-h6 font-bold flex items-center gap-2 whitespace-nowrap"},W={class:"flex items-center gap-2 sm:gap-3 bg-blue-800/30 p-1.5 sm:p-2 rounded-lg border border-blue-400/30 overflow-x-auto max-w-[calc(100vw-120px)] sm:max-w-none"},Z={class:"text-white font-bold text-xs truncate max-w-[100px] sm:max-w-[120px]"},E={class:"flex items-center gap-1 sm:gap-2"},L={class:"flex items-center gap-2 bg-gray-900/50 p-1.5 sm:p-2 rounded-lg border border-gray-700 ml-auto sm:ml-0"},G={class:"flex gap-1 border-l border-gray-600 pl-2"},H={class:"bg-primary text-white p-2 shadow-md z-10 fixed top-0 w-full md:hidden flex items-center justify-between gap-2"},X={class:"text-sm font-bold truncate flex-grow text-center"},Y={class:"flex items-center gap-1 bg-gray-900/50 px-1 py-0.5 rounded border border-gray-700"},ee={class:"bg-white w-full border-b border-gray-200 p-2 overflow-x-auto mt-12"},le={class:"flex gap-1 min-w-max px-2"},ae={class:"flex-grow flex flex-col md:flex-row overflow-hidden relative bg-white"},te={class:"flex-grow flex flex-col p-4 overflow-hidden"},se={class:"flex items-center justify-between mb-2"},oe={class:"text-lg font-bold text-gray-700 flex items-center gap-2"},ne={key:0,class:"ml-1 text-xs opacity-75"},ie={class:"text-xs text-gray-400 font-normal ml-2"},de={class:"flex-grow overflow-y-auto pr-2 custom-scrollbar relative"},re={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3"},ue=["onClick"],ce=["src"],me={class:"text-sm font-bold text-center text-gray-800 leading-tight h-8 overflow-hidden line-clamp-2 w-full"},ve={class:"mt-3 w-full relative"},pe={key:0,class:"absolute inset-0 flex flex-col items-center justify-center text-gray-400"},fe={class:"h-1/3 min-h-[150px] flex flex-col overflow-hidden bg-green-50 border-t border-green-100 p-4"},ge={class:"flex items-center justify-between mb-2"},be={class:"text-lg font-bold text-green-800 flex items-center gap-2"},xe={class:"flex-grow overflow-y-auto pr-2 custom-scrollbar"},he={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3"},we=["src"],ye={class:"flex-grow overflow-hidden"},ke={class:"text-xs font-bold truncate"},_e={class:"text-xs font-mono text-green-700 font-bold bg-green-50 px-1 rounded inline-block"},Ce={key:0,class:"fixed-bottom z-50 flex justify-center pointer-events-none"},ze={class:"w-full max-w-md pointer-events-auto bg-white rounded-t-xl shadow-2xl overflow-hidden"},Ve={class:"bg-blue-600 text-white p-2 flex items-center justify-between shadow-2 relative z-10"},Me={class:"flex items-center gap-2"},Se=["src"],Ae={class:"text-subtitle2 font-bold"},Ue="quiz_mode_state",je=e({__name:"QuizMode",props:{modelValue:Boolean,students:{type:Array,default:()=>[]},behaviors:{type:Array,default:()=>[]}},emits:["update:modelValue","update-points"],setup(e,{emit:D}){const F=e,je=D,Ie=l(),Te=w("Unit 1 Quiz"),Qe=w(10),$e=w(null),Ne=w({}),qe=w([]),Be=w(null),Oe=w(null),De=y(()=>F.students.find(e=>e.id===Oe.value)),Fe=y(()=>F.behaviors.map(e=>({label:e.name,value:e.id,icon:e.icon}))),Re=e=>{const l=F.behaviors.find(l=>l.id===e);return l?l.name:null},Je=()=>{const e={quizTitle:Te.value,finalMark:Qe.value,selectedBehaviorId:$e.value,studentMarks:Ne.value,completedStudentIds:qe.value};localStorage.setItem(Ue,JSON.stringify(e))};k(()=>{const e=localStorage.getItem(Ue);if(e)try{const l=JSON.parse(e);Te.value=l.quizTitle||"Unit 1 Quiz",Qe.value=l.finalMark||10,$e.value=l.selectedBehaviorId||null,Ne.value=l.studentMarks||{},qe.value=l.completedStudentIds||[],!$e.value&&F.behaviors.length>0&&($e.value=F.behaviors[0].id)}catch(l){console.error("Failed to restore quiz state",l)}else F.behaviors.length>0&&($e.value=F.behaviors[0].id)});const Ke=e=>{Oe.value&&(Ne.value[Oe.value]=e,Je())},Pe=()=>{Oe.value=null},We=y(()=>{const e=new Set;return F.students.forEach(l=>{const a=l.name.trim().charAt(0).toUpperCase();/[A-Z]/.test(a)?e.add(a):e.add("#")}),Array.from(e).sort()}),Ze=y(()=>Be.value?F.students.filter(e=>{const l=e.name.trim().charAt(0).toUpperCase();return"#"===Be.value?!/[A-Z]/.test(l):l===Be.value}):F.students),Ee=y(()=>Ze.value.filter(e=>!qe.value.includes(e.id))),Le=y(()=>qe.value.map(e=>{const l=F.students.find(l=>l.id===e);return l?{student:l,mark:Ne.value[e]}:null}).filter(Boolean).reverse()),Ge=w(0),He=w(!1),Xe=w(null),Ye=w(0),el=w(0),ll=()=>{if(He.value)clearInterval(Xe.value),He.value=!1,R.pauseTicking();else{if(Ge.value<=0)return;He.value=!0,Ge.value>10?R.playTicking():R.playAlarm(),Xe.value=setInterval(()=>{Ge.value>0?(Ge.value--,10===Ge.value&&(R.pauseTicking(),R.playAlarm())):(clearInterval(Xe.value),He.value=!1,R.pauseTicking())},1e3)}},al=()=>{clearInterval(Xe.value),He.value=!1,R.stopAll(),Ge.value=60*Ye.value+el.value},tl=()=>{R.stopAll(),Ge.value=60*Ye.value+el.value,al()},sl=e=>{R.stopAll(),Ye.value=e,el.value=0,Ge.value=60*e,al()},ol=e=>{const l=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},nl=()=>{const e=Ee.value;if(0===e.length)return;const l=e[Math.floor(Math.random()*e.length)];il(l.id)},il=e=>{Oe.value=e},dl=e=>{const l=Ne.value[e.id];null!=l&&""!==l&&(l<0||l>Qe.value?Ie.notify({message:`Invalid mark. Must be between 0 and ${Qe.value}`,color:"negative"}):(je("update-points",{studentId:e.id,points:Number(l),behaviorName:`${Te.value}: ${l}/${Qe.value}`,type:"quiz",behaviorId:$e.value}),ul(e.name,Number(l)),qe.value.push(e.id),Je(),Oe.value=null))},rl=()=>{qe.value=[],Ne.value={},Je()},ul=(e,l)=>{if(!("speechSynthesis"in window))return;const a=window.speechSynthesis,t=e.trim().split(/\s+/).slice(0,2).join(" "),s=new SpeechSynthesisUtterance(`Number of points... ${l}... for ${t}`);a.speak(s)},cl=e=>e?e.avatar?e.avatar.startsWith("/")?e.avatar:`/${e.avatar}`:"/images/avatars/default-avatar.svg":"";return _(()=>{clearInterval(Xe.value),R.stopAll()}),(l,w)=>(z(),C(f,{"model-value":e.modelValue,"onUpdate:modelValue":w[22]||(w[22]=e=>l.$emit("update:modelValue",e)),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:V(()=>[M(p,{class:"bg-gray-50 h-full"},{default:V(()=>[M(a,{class:"bg-primary text-white p-3 sm:p-4 shadow-md z-10 hidden md:block"},{default:V(()=>[S("div",J,[S("div",K,[M(t,{flat:"",round:"",dense:"",icon:"arrow_back",onClick:w[0]||(w[0]=e=>l.$emit("update:modelValue",!1))}),S("div",P,[M(s,{name:"quiz"}),w[23]||(w[23]=A()),w[24]||(w[24]=S("span",{class:"hidden sm:inline"},"Quiz Mode",-1))]),S("div",W,[M(o,{modelValue:Te.value,"onUpdate:modelValue":[w[1]||(w[1]=e=>Te.value=e),Je],dense:"",dark:"",borderless:"",placeholder:"Quiz Title",class:"font-bold min-w-[120px] sm:min-w-[200px]","input-class":"text-white placeholder-blue-200"},{prepend:V(()=>[M(s,{name:"edit",size:"xs",color:"blue-200"})]),_:1},8,["modelValue"]),w[26]||(w[26]=S("div",{class:"h-6 w-px bg-blue-400/30"},null,-1)),M(b,{modelValue:$e.value,"onUpdate:modelValue":[w[2]||(w[2]=e=>$e.value=e),Je],options:Fe.value,"emit-value":"","map-options":"",dense:"",dark:"",borderless:"","options-dense":"",class:"min-w-[120px] sm:min-w-[150px]",style:{"min-width":"120px"},"label-color":"blue-200","popup-content-class":"text-xs"},{selected:V(()=>[S("div",Z,U(Re($e.value)||"Select Category"),1)]),_:1},8,["modelValue","options"]),w[27]||(w[27]=S("div",{class:"h-6 w-px bg-blue-400/30"},null,-1)),S("div",E,[w[25]||(w[25]=S("span",{class:"text-blue-200 text-xs font-bold uppercase hidden sm:inline"},"Max:",-1)),M(o,{modelValue:Qe.value,"onUpdate:modelValue":[w[3]||(w[3]=e=>Qe.value=e),Je],modelModifiers:{number:!0},type:"number",dense:"",dark:"",borderless:"",placeholder:"10",class:"font-bold w-10 sm:w-12 text-center","input-class":"text-center text-white"},null,8,["modelValue"])])])]),S("div",L,[M(n,{flat:"",dense:"","content-class":"bg-white",label:ol(Ge.value),class:"text-lg sm:text-h5 font-mono font-bold text-white tracking-widest","no-caps":""},{default:V(()=>[M(i,{class:"min-w-[200px]"},{default:V(()=>[M(d,{header:""},{default:V(()=>w[28]||(w[28]=[A("Select Duration")])),_:1}),j((z(),C(r,{clickable:"",onClick:w[4]||(w[4]=e=>sl(5))},{default:V(()=>[M(u,{avatar:""},{default:V(()=>[M(s,{name:"timer",color:"grey-7"})]),_:1}),M(u,null,{default:V(()=>w[29]||(w[29]=[A("5 Minutes")])),_:1})]),_:1})),[[g]]),j((z(),C(r,{clickable:"",onClick:w[5]||(w[5]=e=>sl(10))},{default:V(()=>[M(u,{avatar:""},{default:V(()=>[M(s,{name:"timer",color:"grey-7"})]),_:1}),M(u,null,{default:V(()=>w[30]||(w[30]=[A("10 Minutes")])),_:1})]),_:1})),[[g]]),j((z(),C(r,{clickable:"",onClick:w[6]||(w[6]=e=>sl(15))},{default:V(()=>[M(u,{avatar:""},{default:V(()=>[M(s,{name:"timer",color:"grey-7"})]),_:1}),M(u,null,{default:V(()=>w[31]||(w[31]=[A("15 Minutes")])),_:1})]),_:1})),[[g]]),j((z(),C(r,{clickable:"",onClick:w[7]||(w[7]=e=>sl(30))},{default:V(()=>[M(u,{avatar:""},{default:V(()=>[M(s,{name:"timer",color:"grey-7"})]),_:1}),M(u,null,{default:V(()=>w[32]||(w[32]=[A("30 Minutes")])),_:1})]),_:1})),[[g]]),M(c),M(d,{header:""},{default:V(()=>w[33]||(w[33]=[A("Manual Input")])),_:1}),M(r,{class:"gap-2"},{default:V(()=>[M(o,{modelValue:Ye.value,"onUpdate:modelValue":w[8]||(w[8]=e=>Ye.value=e),modelModifiers:{number:!0},label:"Min",type:"number",outlined:"",dense:"",class:"col",onClick:w[9]||(w[9]=I(()=>{},["stop"]))},null,8,["modelValue"]),M(o,{modelValue:el.value,"onUpdate:modelValue":w[10]||(w[10]=e=>el.value=e),modelModifiers:{number:!0},label:"Sec",type:"number",outlined:"",dense:"",class:"col",onClick:w[11]||(w[11]=I(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),M(r,null,{default:V(()=>[j(M(t,{label:"Set Time",color:"primary",class:"full-width",size:"sm",onClick:tl},null,512),[[g]])]),_:1})]),_:1})]),_:1},8,["label"]),S("div",G,[M(t,{round:"",dense:"",icon:He.value?"pause":"play_arrow",color:He.value?"amber":"green",size:"sm",onClick:I(ll,["stop"])},null,8,["icon","color"]),M(t,{round:"",dense:"",icon:"refresh",flat:"",color:"grey-4",size:"sm",onClick:I(al,["stop"])})])])])]),_:1}),S("div",H,[M(t,{flat:"",round:"",dense:"",icon:"arrow_back",onClick:w[12]||(w[12]=e=>l.$emit("update:modelValue",!1)),size:"sm"}),S("div",X,U(Te.value),1),S("div",Y,[M(n,{flat:"",dense:"","content-class":"bg-white",label:ol(Ge.value),class:"text-xs font-mono font-bold text-white tracking-widest min-w-[50px]","no-caps":"",size:"sm"},{default:V(()=>[M(i,{class:"min-w-[200px]"},{default:V(()=>[M(d,{header:""},{default:V(()=>w[34]||(w[34]=[A("Select Duration")])),_:1}),j((z(),C(r,{clickable:"",onClick:w[13]||(w[13]=e=>sl(5))},{default:V(()=>[M(u,null,{default:V(()=>w[35]||(w[35]=[A("5 Minutes")])),_:1})]),_:1})),[[g]]),j((z(),C(r,{clickable:"",onClick:w[14]||(w[14]=e=>sl(10))},{default:V(()=>[M(u,null,{default:V(()=>w[36]||(w[36]=[A("10 Minutes")])),_:1})]),_:1})),[[g]]),j((z(),C(r,{clickable:"",onClick:w[15]||(w[15]=e=>sl(15))},{default:V(()=>[M(u,null,{default:V(()=>w[37]||(w[37]=[A("15 Minutes")])),_:1})]),_:1})),[[g]]),M(c),M(d,{header:""},{default:V(()=>w[38]||(w[38]=[A("Manual")])),_:1}),M(r,{class:"gap-2"},{default:V(()=>[M(o,{modelValue:Ye.value,"onUpdate:modelValue":w[16]||(w[16]=e=>Ye.value=e),modelModifiers:{number:!0},label:"Min",type:"number",outlined:"",dense:"",class:"col",onClick:w[17]||(w[17]=I(()=>{},["stop"]))},null,8,["modelValue"]),M(o,{modelValue:el.value,"onUpdate:modelValue":w[18]||(w[18]=e=>el.value=e),modelModifiers:{number:!0},label:"Sec",type:"number",outlined:"",dense:"",class:"col",onClick:w[19]||(w[19]=I(()=>{},["stop"]))},null,8,["modelValue"])]),_:1}),M(r,null,{default:V(()=>[j(M(t,{label:"Set",color:"primary",class:"full-width",size:"sm",onClick:tl},null,512),[[g]])]),_:1})]),_:1})]),_:1},8,["label"]),w[39]||(w[39]=S("div",{class:"h-4 w-px bg-gray-600"},null,-1)),M(t,{round:"",dense:"",icon:He.value?"pause":"play_arrow",color:He.value?"amber":"green",size:"xs",onClick:I(ll,["stop"])},null,8,["icon","color"])])]),S("div",ee,[S("div",le,[M(t,{icon:"filter_alt_off",color:Be.value?"negative":"grey-3","text-color":Be.value?"white":"grey-6",round:"",dense:"",unelevated:"",size:"sm",class:"font-bold shadow-sm mr-2",style:{width:"28px",height:"28px"},onClick:w[20]||(w[20]=e=>Be.value=null),disable:!Be.value},{default:V(()=>[M(m,null,{default:V(()=>w[40]||(w[40]=[A("Clear Filter")])),_:1})]),_:1},8,["color","text-color","disable"]),M(c,{vertical:"",class:"mr-2"}),(z(!0),T($,null,Q(We.value,e=>(z(),C(t,{key:e,label:e,onClick:l=>Be.value=Be.value===e?null:e,color:Be.value===e?"primary":"grey-2","text-color":Be.value===e?"white":"grey-8",round:"",dense:"",unelevated:"",size:"sm",class:"font-bold shadow-sm",style:{width:"28px",height:"28px"}},null,8,["label","onClick","color","text-color"]))),128))])]),w[46]||(w[46]=S("div",{class:"flex flex-col flex-grow overflow-hidden"},null,-1)),S("div",ae,[S("div",te,[S("div",se,[S("h3",oe,[M(s,{name:"pending",color:"orange"}),w[41]||(w[41]=A(" Pending ")),M(x,{color:"orange",rounded:"",class:"px-2"},{default:V(()=>[A(U(Ee.value.length)+" ",1),Be.value?(z(),T("span",ne," (of "+U(e.students.length-qe.value.length)+" total pending) ",1)):N("",!0)]),_:1}),S("span",ie," Total Progress: "+U(qe.value.length)+" / "+U(e.students.length),1)]),M(t,{dense:"",flat:"",icon:"shuffle",color:"primary",label:"Pick Random",onClick:nl,disable:0===Ee.value.length},null,8,["disable"])]),S("div",de,[S("div",re,[(z(!0),T($,null,Q(Ee.value,e=>(z(),T("div",{key:e.id,class:B(["bg-white rounded-xl shadow-sm border border-gray-100 p-3 hover:shadow-md transition-all flex flex-col items-center group relative overflow-hidden",{"ring-2 ring-primary ring-offset-1":Oe.value===e.id}]),onClick:l=>il(e.id)},[M(v,{size:"56px",class:"shadow-sm mb-2"},{default:V(()=>[S("img",{src:cl(e)},null,8,ce)]),_:2},1024),S("div",me,U(e.name),1),S("div",ve,[M(o,{modelValue:Ne.value[e.id],"onUpdate:modelValue":l=>Ne.value[e.id]=l,modelModifiers:{number:!0},type:"number",outlined:"",dense:"",placeholder:"Mark",class:"input-centered-text","bg-color":"blue-50",max:Qe.value,readonly:"",onClick:l=>il(e.id),onKeydown:O(l=>dl(e),["enter"])},{append:V(()=>[M(t,{round:"",dense:"",flat:"",icon:"send",size:"sm",color:"primary",onClick:I(l=>dl(e),["stop"]),disable:!Ne.value[e.id]&&0!==Ne.value[e.id]},{default:V(()=>[M(m,null,{default:V(()=>w[42]||(w[42]=[A("Submit")])),_:1})]),_:2},1032,["onClick","disable"])]),_:2},1032,["modelValue","onUpdate:modelValue","max","onClick","onKeydown"])])],10,ue))),128))]),0===Ee.value.length?(z(),T("div",pe,[M(s,{name:"done_all",size:"4em",class:"mb-2 opacity-50"}),w[43]||(w[43]=S("div",null,"No pending students found",-1))])):N("",!0)])]),S("div",fe,[S("div",ge,[S("h3",be,[M(s,{name:"check_circle",color:"green"}),w[44]||(w[44]=A(" Completed ")),M(x,{color:"green",rounded:""},{default:V(()=>[A(U(Le.value.length),1)]),_:1})]),M(t,{flat:"",dense:"",icon:"delete_sweep",color:"green",label:"Reset List",size:"sm",onClick:rl})]),S("div",xe,[S("div",he,[(z(!0),T($,null,Q(Le.value,e=>(z(),T("div",{key:e.student.id,class:"bg-white rounded-xl shadow-sm border border-green-100 p-2 flex items-center gap-3 opacity-90"},[M(v,{size:"32px"},{default:V(()=>[S("img",{src:cl(e.student)},null,8,we)]),_:2},1024),S("div",ye,[S("div",ke,U(e.student.name),1),S("div",_e,U(e.mark)+" / "+U(Qe.value),1)]),M(t,{round:"",flat:"",dense:"",icon:"undo",size:"xs",color:"grey-5",onClick:l=>(e=>{const l=qe.value.indexOf(e);l>-1&&(qe.value.splice(l,1),Je())})(e.student.id)},{default:V(()=>[M(m,null,{default:V(()=>w[45]||(w[45]=[A("Undo")])),_:1})]),_:2},1032,["onClick"])]))),128))])])])]),M(q,{"enter-active-class":"animated slideInUp","leave-active-class":"animated slideOutDown"},{default:V(()=>{var e;return[Oe.value?(z(),T("div",Ce,[S("div",ze,[S("div",Ve,[S("div",Me,[M(v,{size:"28px",class:"border border-white/50"},{default:V(()=>[S("img",{src:cl(De.value)},null,8,Se)]),_:1}),S("div",Ae,U(null==(e=De.value)?void 0:e.name),1)]),M(t,{flat:"",round:"",dense:"",icon:"close",size:"sm",onClick:Pe})]),M(h,{"model-value":Ne.value[Oe.value],max:Qe.value,"onUpdate:modelValue":Ke,onSubmit:w[21]||(w[21]=e=>dl(De.value))},null,8,["model-value","max"])])])):N("",!0)]}),_:1})]),_:1})]),_:1},8,["model-value"]))}},[["__scopeId","data-v-bc7af436"]]);export{je as default};
