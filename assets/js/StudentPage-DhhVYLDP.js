import{D as e,aG as a,aH as t,o as s,u as l,c as i,d as n,f as o,Q as u,m as r,s as c,z as d,bc as v,t as p,v as m}from"./app-B9g134Ig.js";import{h as g,f as x,a as h,e as b,N as y,J as w,b as _,O as f,z as q,a4 as k,Q as z,K as j,a2 as C,V as S,I as T,U as Q,F as I,R as O,_ as V}from"./vendor-nQjeLEvd.js";import{Q as M}from"./QSpinnerDots-aM7mOe_6.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";const U=e({name:"QSpinnerOrbit",props:a,setup(e){const{cSize:a,classes:s}=t(e);return()=>g("svg",{class:s.value,width:a.value,height:a.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg",innerHTML:'<circle cx="50" cy="50" r="44" fill="none" stroke-width="4" stroke-opacity=".5" stroke="currentColor"></circle><circle cx="8" cy="54" r="6" fill="currentColor" stroke-width="3" stroke="currentColor"><animateTransform attributeName="transform" type="rotate" from="0 50 48" to="360 50 52" dur="2s" repeatCount="indefinite"></animateTransform></circle>'})}}),$={class:"student-page"},L={key:0,class:"content-wrapper join-screen"},D={class:"icon-wrapper q-mb-md"},E={key:1,class:"content-wrapper waiting-screen"},F={class:"waiting-animation q-mb-lg"},H={class:"participant-badge"},N={key:2,class:"content-wrapper question-screen"},R={class:"row items-center justify-between q-mb-lg"},Y=["innerHTML"],A={class:"answer-section"},G={key:0,class:"options-grid"},B=["onClick"],J={class:"option-label"},K={key:1,class:"numeric-input-wrapper"},W={class:"feedback-content bounce-in"},P={class:"text-h3 text-white text-weight-bold q-my-none"},X={class:"text-h5 text-white q-mt-sm"},Z={class:"score-badge q-mt-md"},ee={key:2,class:"text-center q-mt-xl"},ae={key:3,class:"content-wrapper completed-screen"},te={class:"trophy-animation q-mb-lg"},se={class:"final-score-card q-mt-xl"},le={class:"score-value text-h2 text-weight-bold text-primary"},ie=s({__name:"StudentPage",setup(e){const a=l(),t=x(""),s=x(null),g=x(null),ie=x(null),ne=x(null),oe=x(!1),ue=x(!1),re=x(!1),ce=x(null),de=x(0),ve=x(0),pe=x(null);let me=null;const ge=h(()=>{var e;return(null==(e=ie.value)?void 0:e.options)?ie.value.options.map(e=>({label:e.option_text,value:e.id})):[]}),xe=async()=>{var e,l,i;if(t.value){re.value=!0;try{const l=await V.post("/api/quiz-sessions/join",{access_code:t.value.toUpperCase()});s.value=l.data.session,g.value=l.data.participant;const i=c(p,`quiz_sessions/${s.value.access_code}/participants/${g.value.id}`);await d(i,{student:g.value.student,score:null!=(e=g.value.score)?e:0,status:"joined",id:g.value.id,last_answered_question_id:null}),he(),a.notify({type:"positive",message:"You're in! ðŸš€",position:"top"})}catch(n){console.error("Failed to join session:",n),a.notify({type:"negative",message:(null==(i=null==(l=n.response)?void 0:l.data)?void 0:i.message)||"Oops! Check the code.",position:"top"})}finally{re.value=!1}}},he=()=>{const e=c(p,`quiz_sessions/${t.value.toUpperCase()}`);me=m(e,e=>{var a;const t=e.val();t&&(t.status&&(s.value.status=t.status),t.current_question&&(ie.value&&ie.value.id===t.current_question.id||(ie.value=t.current_question,ne.value=null,oe.value=!1,ce.value=null,(null==(a=s.value.settings)?void 0:a.timer)&&be(s.value.settings.timer))),t.participants&&(de.value=Object.keys(t.participants).length))})},be=e=>{ve.value=e,pe.value&&clearInterval(pe.value),pe.value=setInterval(()=>{var e;ve.value--,ve.value<=0&&(clearInterval(pe.value),(null==(e=s.value.settings)?void 0:e.auto_submit)&&!oe.value&&ye())},1e3)},ye=async()=>{if(ne.value&&!oe.value){ue.value=!0;try{const e=await V.post(`/api/quiz-sessions/${s.value.id}/answers`,{question_id:ie.value.id,answer:ne.value});oe.value=!0,ce.value=e.data,g.value&&(g.value.score=e.data.participant.score);const a=c(p,`quiz_sessions/${s.value.access_code}/participants/${g.value.id}`);await v(a,{score:e.data.participant.score,status:"active",last_answered_question_id:ie.value.id,answer_status:"submitted"})}catch(e){console.error("Failed to submit answer:",e),a.notify({type:"negative",message:"Could not send answer. Try again!",position:"top"})}finally{ue.value=!1}}};return b(()=>{me&&me(),pe.value&&clearInterval(pe.value)}),(e,a)=>(w(),y(I,null,[_(q(k),{title:"Join Live Quiz"}),f("div",$,[a[11]||(a[11]=f("div",{class:"shape shape-1"},null,-1)),a[12]||(a[12]=f("div",{class:"shape shape-2"},null,-1)),a[13]||(a[13]=f("div",{class:"shape shape-3"},null,-1)),s.value?"waiting"===s.value.status?(w(),y("div",E,[_(r,{class:"game-card bounce-in"},{default:j(()=>[_(i,{class:"text-center q-pa-lg"},{default:j(()=>[f("div",F,[_(U,{color:"orange",size:"100px"})]),a[4]||(a[4]=f("h2",{class:"text-h4 text-weight-bold text-primary"},"Get Ready!",-1)),a[5]||(a[5]=f("p",{class:"text-h6 text-grey-7 q-mb-md"},"Waiting for the teacher to start...",-1)),f("div",H,[_(n,{name:"group",size:"24px"}),f("span",null,S(de.value)+" friends joined",1)])]),_:1})]),_:1})])):"active"===s.value.status&&ie.value?(w(),y("div",N,[_(r,{class:"game-card slide-up"},{default:j(()=>[_(i,{class:"q-pa-md"},{default:j(()=>{var e,t;return[f("div",R,[a[6]||(a[6]=f("div",{class:"question-number text-h6 text-weight-bold text-grey-8"}," Question ",-1)),ve.value>0?(w(),y("div",{key:0,class:Q(["timer-badge",{"timer-warning":ve.value<=10}])},[_(n,{name:"timer",size:"24px"}),f("span",null,S(ve.value)+"s",1)],2)):z("",!0)]),f("div",{class:"question-text text-h5 text-weight-bold text-center q-mb-xl",innerHTML:ie.value.question_text},null,8,Y),f("div",A,["multiple_choice"===(null==(e=ie.value.question_type)?void 0:e.slug)?(w(),y("div",G,[(w(!0),y(I,null,O(ge.value,e=>(w(),y("button",{key:e.value,class:Q(["option-btn",{selected:ne.value===e.value,disabled:oe.value}]),onClick:a=>!oe.value&&(ne.value=e.value)},[f("span",J,S(e.label),1),ne.value===e.value?(w(),T(n,{key:0,name:"check_circle",size:"32px",color:"white"})):z("",!0)],10,B))),128))])):"numeric"===(null==(t=ie.value.question_type)?void 0:t.slug)?(w(),y("div",K,[_(o,{modelValue:ne.value,"onUpdate:modelValue":a[1]||(a[1]=e=>ne.value=e),type:"number",placeholder:"Type your answer...",outlined:"",class:"big-input","input-class":"text-center text-weight-bold",disable:oe.value},null,8,["modelValue","disable"])])):z("",!0)]),oe.value?z("",!0):(w(),T(u,{key:0,push:"",color:"positive",label:"SUBMIT ANSWER",onClick:ye,disable:!ne.value,loading:ue.value,size:"xl",class:"full-width q-mt-xl game-btn"},null,8,["disable","loading"])),oe.value&&ce.value?(w(),y("div",{key:1,class:Q(["feedback-overlay",ce.value.is_correct?"correct":"incorrect"])},[f("div",W,[_(n,{name:ce.value.is_correct?"emoji_events":"sentiment_dissatisfied",size:"100px",color:"white",class:"q-mb-md"},null,8,["name"]),f("h2",P,S(ce.value.is_correct?"Awesome!":"Oops!"),1),f("p",X,S(ce.value.is_correct?"You got it right! +10 pts":"Nice try!"),1),f("div",Z," Total Score: "+S(ce.value.participant.score),1)])],2)):oe.value&&!ce.value?(w(),y("div",ee,[_(M,{color:"primary",size:"40px"}),a[7]||(a[7]=f("p",{class:"text-h6 text-grey-7"},"Sending answer...",-1))])):z("",!0)]}),_:1})]),_:1})])):"completed"===s.value.status?(w(),y("div",ae,[_(r,{class:"game-card bounce-in"},{default:j(()=>[_(i,{class:"text-center q-pa-lg"},{default:j(()=>{var e;return[f("div",te,[_(n,{name:"emoji_events",size:"120px",color:"warning"})]),a[9]||(a[9]=f("h2",{class:"text-h3 text-weight-bold text-primary q-mb-md"},"Quiz Done!",-1)),a[10]||(a[10]=f("p",{class:"text-h5 text-grey-7"},"You did great!",-1)),f("div",se,[a[8]||(a[8]=f("div",{class:"text-uppercase text-caption text-weight-bold text-grey-6"},"Final Score",-1)),f("div",le,S((null==(e=g.value)?void 0:e.score)||0),1)])]}),_:1})]),_:1})])):z("",!0):(w(),y("div",L,[_(r,{class:"game-card bounce-in"},{default:j(()=>[_(i,{class:"text-center q-pa-lg"},{default:j(()=>[f("div",D,[_(n,{name:"school",size:"60px",color:"white"})]),a[2]||(a[2]=f("h1",{class:"text-h3 text-weight-bold text-primary q-mb-sm"},"Class Quiz!",-1)),a[3]||(a[3]=f("p",{class:"text-h6 text-grey-7"},"Enter the magic code from your teacher",-1)),_(o,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value=e),placeholder:"CODE",outlined:"",class:"code-input q-mt-lg","input-class":"text-center text-uppercase text-weight-bold",onKeyup:C(xe,["enter"]),disable:re.value},{prepend:j(()=>[_(n,{name:"vpn_key",color:"primary"})]),_:1},8,["modelValue","disable"]),_(u,{push:"",color:"primary",label:"LET'S GO!",onClick:xe,loading:re.value,disable:!t.value,size:"xl",class:"full-width q-mt-lg game-btn","icon-right":"rocket_launch"},null,8,["loading","disable"])]),_:1})]),_:1})]))])],64))}},[["__scopeId","data-v-6f392bd7"]]);export{ie as default};
