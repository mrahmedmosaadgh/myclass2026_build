import{p as e,u as s,q as t,Q as a,aq as o,e as l,d as n,A as i,C as r,m as d,n as c,a as u}from"./app-BXm70mdJ.js";import{Q as p}from"./QBadge-ZzhN1X9C.js";import{Q as m}from"./QSpace-Bu8V-QDa.js";import{f as g,o as y,L as v,I as f,M as x,O as h,b,H as w,J as _,V as q,U as k,y as z,P as C,F as j,Q as L,Z as S}from"./vendor-DNM7Y6Xn.js";import{u as F}from"./teacherStore-BpVC7zBP.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";const Q={class:"q-pa-md bg-grey-2"},N={class:"max-w-7xl mx-auto"},A={class:"row justify-between items-center q-mb-lg"},D={class:"row items-center gap-2"},O={class:"text-h4 text-weight-bold text-grey-9 q-my-none"},P={class:"text-subtitle2 text-grey-7 q-mt-xs"},$={key:0,class:"row justify-center q-py-xl"},I={key:1,class:"row q-col-gutter-md"},M={key:0,class:"col-12 text-center q-py-xl"},T={class:"text-h5 q-mt-md text-weight-bold text-grey-9"},V={class:"text-caption text-grey-6 q-mt-sm"},B={key:0},G={key:1},E={class:"text-primary text-weight-medium text-caption"},H={key:2},J={key:0,class:"text-center q-py-xl bg-white rounded-borders shadow-1"},U={class:"text-h6 text-weight-medium text-grey-9 q-my-none"},Z={class:"q-mt-md"},K={key:1,class:"row q-col-gutter-md"},R={class:"row items-center q-gutter-xs q-mb-sm"},W={class:"text-caption text-grey-5"},X=["title"],Y={class:"text-body2 text-grey-6 ellipsis-2-lines q-mt-xs"},ee={class:"column full-width q-gutter-xs"},se={class:"row justify-between items-center"},te={class:"row q-gutter-xs"},ae={class:"row q-gutter-xs"},oe=["href"],le=["href"],ne={class:"row q-gutter-xs full-width"},ie=e({__name:"LessonList",setup(e){const ie=s(),re=F(),de=g([]),ce=g(!1),ue=g(null),pe=g("grades"),me=async()=>{if(ue.value){ce.value=!0;try{const e={grade_id:ue.value.id},s=await S.get(route("lesson-presentation.list"),{params:e});de.value=s.data}catch(e){console.error("Failed to fetch lessons:",e),ie.notify({type:"negative",message:"Failed to fetch lessons."})}finally{ce.value=!1}}};return y(async()=>{await re.fetchTeacherData()}),(e,s)=>{var g,y;return f(),v("div",Q,[x("div",N,[x("div",A,[x("div",null,[x("div",D,["lessons"===pe.value?(f(),w(a,{key:0,flat:"",round:"",dense:"",icon:"arrow_back",color:"primary",onClick:s[0]||(s[0]=e=>{pe.value="grades",ue.value=null})},{default:_(()=>[b(t,null,{default:_(()=>s[1]||(s[1]=[q("Back to Grades")])),_:1})]),_:1})):h("",!0),x("h1",O,k("grades"===pe.value?"My Classes":`${null==(g=ue.value)?void 0:g.name} Lessons`),1)]),x("p",P,k("grades"===pe.value?"Select a grade to view lessons.":"Manage your interactive lessons for this grade."),1)]),b(z(C),{href:e.route("lesson-presentation.edit")},{default:_(()=>[b(a,{color:"primary",icon:"add",label:"Create New Lesson","no-caps":""})]),_:1},8,["href"])]),ce.value||z(re).loading?(f(),v("div",$,[b(o,{color:"primary",size:"3em"})])):"grades"===pe.value?(f(),v("div",I,[0===z(re).grades.length?(f(),v("div",M,[b(l,{name:"school",size:"4rem",color:"grey-4",class:"q-mb-md"}),s[2]||(s[2]=x("h3",{class:"text-h6 text-grey-7"},"No grades assigned.",-1))])):h("",!0),(f(!0),v(j,null,L(z(re).grades,e=>(f(),v("div",{key:e.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[b(c,{class:"cursor-pointer hover-shadow transition-generic full-height",onClick:s=>(e=>{ue.value=e,pe.value="lessons",me()})(e)},{default:_(()=>[b(n,{class:"text-center q-py-lg"},{default:_(()=>[b(i,{size:"80px","font-size":"40px",color:"blue-1","text-color":"primary",icon:"school"}),x("div",T,k(e.name),1),x("div",V,[e.subjects&&e.subjects.length?(f(),v("div",B,[(f(!0),v(j,null,L(e.subjects,e=>(f(),w(r,{key:e.id,dense:"",size:"sm",color:"blue-grey-1","text-color":"blue-grey-8"},{default:_(()=>[q(k(e.name),1)]),_:2},1024))),128))])):(f(),v("span",G,"No subjects assigned"))])]),_:2},1024),b(d,{align:"center",class:"bg-grey-1 q-py-sm"},{default:_(()=>[x("span",E,[s[3]||(s[3]=q("View Lessons ")),b(l,{name:"arrow_forward",size:"xs"})])]),_:1})]),_:2},1032,["onClick"])]))),128))])):"lessons"===pe.value?(f(),v("div",H,[0===de.value.length?(f(),v("div",J,[b(l,{name:"auto_stories",size:"4rem",color:"grey-4",class:"q-mb-md"}),x("h3",U,"No lessons found for "+k(null==(y=ue.value)?void 0:y.name),1),s[4]||(s[4]=x("p",{class:"text-body2 text-grey-6 q-mt-xs"},"Get started by creating your first interactive lesson.",-1)),x("div",Z,[b(z(C),{href:e.route("lesson-presentation.edit")},{default:_(()=>[b(a,{color:"primary",icon:"add",label:"Create Lesson","no-caps":""})]),_:1},8,["href"])])])):(f(),v("div",K,[(f(!0),v(j,null,L(de.value,o=>(f(),v("div",{key:o.id,class:"col-12 col-sm-6 col-lg-4"},[b(c,{class:"column full-height hover-shadow transition-generic"},{default:_(()=>[b(n,{class:"col q-pb-none"},{default:_(()=>[x("div",R,[b(p,{color:"blue-1","text-color":"primary"},{default:_(()=>[b(l,{name:"menu_book",size:"xs",class:"q-mr-xs"}),q(" "+k(o.slides_count||0),1)]),_:2},1024),b(p,{color:"purple-1","text-color":"purple"},{default:_(()=>[b(l,{name:"edit",size:"xs",class:"q-mr-xs"}),s[5]||(s[5]=q(" Practice "))]),_:1}),o.quiz_id?(f(),w(p,{key:0,color:"green-1","text-color":"green"},{default:_(()=>[b(l,{name:"quiz",size:"xs",class:"q-mr-xs"}),q(" Quiz: "+k(o.quiz_id),1)]),_:2},1024)):h("",!0),b(m),x("span",W,k(new Date(o.created_at).toLocaleDateString()),1)]),x("div",{class:"text-h6 text-grey-9 ellipsis",title:o.name},k(o.name),9,X),x("div",Y,k(o.description||"No description provided."),1)]),_:2},1024),b(d,{class:"bg-grey-1 border-top-grey-3 q-px-md q-py-sm"},{default:_(()=>[x("div",ee,[x("div",se,[x("div",te,[b(z(C),{href:e.route("lesson-presentation.edit",{id:o.id})},{default:_(()=>[b(a,{flat:"",dense:"",size:"sm",color:"grey-7",icon:"edit",label:"Edit","no-caps":"",class:"hover-text-primary"})]),_:2},1032,["href"]),b(a,{flat:"",dense:"",size:"sm",color:"grey-7",icon:"delete",label:"Delete","no-caps":"",class:"hover-text-negative",onClick:e=>(async e=>{ie.dialog({title:"Confirm Deletion",message:`Are you sure you want to delete "${e.name}"?`,cancel:!0,persistent:!0}).onOk(async()=>{try{await S.delete(route("lesson-presentation.destroy",{id:e.id})),de.value=de.value.filter(s=>s.id!==e.id),ie.notify({type:"positive",message:"Lesson deleted successfully."})}catch(s){console.error("Failed to delete lesson:",s),ie.notify({type:"negative",message:"Failed to delete lesson."})}})})(o)},null,8,["onClick"])]),x("div",ae,[x("a",{href:e.route("lesson-presentation.student.view",{id:o.id}),target:"_blank",class:"text-decoration-none"},[b(a,{flat:"",dense:"",size:"sm",color:"primary",icon:"play_arrow",label:"Preview","no-caps":""})],8,oe),b(a,{flat:"",round:"",dense:"",size:"sm",color:"grey-6",icon:"link",onClick:e=>(e=>{const s=route("lesson-presentation.student.view",{id:e});navigator.clipboard.writeText(s).then(()=>{ie.notify({type:"positive",message:"Student link copied to clipboard!",position:"top"})})})(o.id)},{default:_(()=>[b(t,null,{default:_(()=>s[6]||(s[6]=[q("Copy Student Link")])),_:1})]),_:2},1032,["onClick"]),x("a",{href:e.route("lesson-presentation.print",{id:o.id}),target:"_blank",class:"text-decoration-none"},[b(a,{flat:"",round:"",dense:"",size:"sm",color:"grey-6",icon:"print"},{default:_(()=>[b(t,null,{default:_(()=>s[7]||(s[7]=[q("Print Lesson")])),_:1})]),_:1})],8,le)])]),b(u),x("div",ne,[b(a,{unelevated:"",dense:"",size:"sm",color:"positive",icon:"lock_open",label:"Open to All Students","no-caps":"",class:"col",onClick:e=>(async e=>{var s;ie.dialog({title:"Open Lesson to All Students",message:`This will unlock "${e.name}" for all students in ${null==(s=ue.value)?void 0:s.name}. Continue?`,cancel:!0,persistent:!0}).onOk(async()=>{var s,t;try{const s=(await S.get(route("lesson-presentation.students.by-grade",{gradeId:ue.value.id}))).data.map(e=>e.id);if(0===s.length)return void ie.notify({type:"warning",message:"No students found in this grade.",position:"top"});await S.post(route("lesson-presentation.progress.open"),{lesson_id:e.id,student_ids:s}),ie.notify({type:"positive",message:`Lesson opened for ${s.length} student(s)!`,position:"top"})}catch(a){console.error("Failed to open lesson:",a),ie.notify({type:"negative",message:(null==(t=null==(s=a.response)?void 0:s.data)?void 0:t.message)||"Failed to open lesson for students.",position:"top"})}})})(o)},null,8,["onClick"]),b(z(C),{href:e.route("lesson-presentation.teacher.progress",{lessonId:o.id})},{default:_(()=>[b(a,{unelevated:"",dense:"",size:"sm",color:"primary",icon:"assessment",label:"View Progress","no-caps":""})]),_:2},1032,["href"])])])]),_:2},1024)]),_:2},1024)]))),128))]))])):h("",!0)])])}}},[["__scopeId","data-v-2495142c"]]);export{ie as default};
