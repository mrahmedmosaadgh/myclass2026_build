import{u as e,f as a,Q as l,b as t,g as o,h as r,i as s,j as u,k as n,l as i,m as d,o as m,d as c,e as p}from"./app-DlLesFGi.js";import{Q as v}from"./QSpace-BK_PGLKv.js";import{Q as y}from"./QStepperNavigation-DjG6vbQc.js";import{Q as f,a as g}from"./QStepper-DsaP_4Mi.js";import{c as b}from"./copy-to-clipboard-Dc8Jrd75.js";import{f as _,I as h,J as k,K as w,b as x,R as C,O as I,V,N as j,Q as q,W as A,F as N,U as S,_ as J}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./use-panel-BqxRbB7W.js";import"./use-render-cache-CmTcazfP.js";const O={class:"text-caption",style:{"white-space":"pre-wrap","max-height":"200px","overflow-y":"auto"}},P={class:"q-mt-md"},Q={class:"text-body2"},B={key:0,class:"q-mt-sm"},E={class:"q-mb-none"},R={key:0,class:"text-caption"},U={__name:"BulkImportDialog",props:{modelValue:Boolean},emits:["update:modelValue","imported"],setup(U,{emit:M}){const D=M,F=e(),G=_(1),$=_(!1),T=_(!1),z=_(!1),H=_(""),K=_(""),L=_(""),W=_([]),X=_(!0),Y=_(null),Z=async()=>{var e,a;try{$.value=!0,await J.get("/sanctum/csrf-cookie");const e=await J.get("/api/admin/menus/helpers/ai-prompt");H.value=e.data.prompt,await b(H.value),F.notify({type:"positive",message:"AI prompt copied to clipboard!"})}catch(l){console.error("Error generating AI prompt:",l),F.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to generate AI prompt"})}finally{$.value=!1}},ee=()=>{try{T.value=!0,L.value="";const e=JSON.parse(K.value);if(!Array.isArray(e))return void(L.value="JSON must be an array of menu objects");W.value=e,G.value=3}catch(e){L.value=`Invalid JSON: ${e.message}`}finally{T.value=!1}},ae=async()=>{var e,a;try{z.value=!0,await J.get("/sanctum/csrf-cookie");const e=await J.post("/api/admin/menus/bulk-import",{menus:W.value,dry_run:X.value});Y.value=e.data,F.notify({type:e.data.error_count>0?"warning":"positive",message:e.data.message}),X.value||0!==e.data.error_count||(D("imported"),setTimeout(()=>le(),2e3))}catch(l){console.error("Error importing menus:",l),F.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to import menus"})}finally{z.value=!1}},le=()=>{G.value=1,K.value="",L.value="",W.value=[],Y.value=null,D("update:modelValue",!1)};return(e,b)=>(k(),h(p,{"model-value":U.modelValue,"onUpdate:modelValue":b[6]||(b[6]=a=>e.$emit("update:modelValue",a)),persistent:""},{default:w(()=>[x(c,{style:{"min-width":"700px","max-width":"900px"}},{default:w(()=>[x(a,{class:"row items-center q-pb-none"},{default:w(()=>[x(l,{name:"upload_file",color:"secondary",size:"md",class:"q-mr-sm"}),b[7]||(b[7]=C("div",{class:"text-h6"},"Bulk Import Menus",-1)),x(v),x(t,{icon:"close",flat:"",round:"",dense:"",onClick:le})]),_:1}),x(a,null,{default:w(()=>[x(f,{modelValue:G.value,"onUpdate:modelValue":b[5]||(b[5]=e=>G.value=e),vertical:"",color:"primary",animated:""},{default:w(()=>[x(g,{name:1,title:"Generate AI Prompt",icon:"smart_toy",done:G.value>1},{default:w(()=>[b[9]||(b[9]=C("div",{class:"text-body2 q-mb-md"}," Click the button below to generate a prompt that you can copy and paste to an AI assistant (ChatGPT, Claude, etc.) to generate menu JSON. ",-1)),x(t,{color:"purple",icon:"content_copy",label:"Generate & Copy AI Prompt",onClick:Z,loading:$.value},null,8,["loading"]),H.value?(k(),h(o,{key:0,class:"bg-grey-2 q-mt-md",rounded:""},{avatar:w(()=>[x(l,{name:"info",color:"primary"})]),default:w(()=>[b[8]||(b[8]=C("div",{class:"text-subtitle2 q-mb-sm"},"AI Prompt (Copied to Clipboard)",-1)),C("pre",O,V(H.value),1)]),_:1})):I("",!0),x(y,null,{default:w(()=>[x(t,{color:"primary",label:"Next",onClick:b[0]||(b[0]=e=>G.value=2)})]),_:1})]),_:1},8,["done"]),x(g,{name:2,title:"Paste JSON",icon:"code",done:G.value>2},{default:w(()=>[b[10]||(b[10]=C("div",{class:"text-body2 q-mb-md"}," Paste the JSON generated by the AI assistant below: ",-1)),x(r,{modelValue:K.value,"onUpdate:modelValue":b[1]||(b[1]=e=>K.value=e),type:"textarea",outlined:"",rows:"15",placeholder:'[{"label": "Menu Label", "route": "route.name", ...}]',error:!!L.value,"error-message":L.value},null,8,["modelValue","error","error-message"]),x(y,null,{default:w(()=>[x(t,{flat:"",color:"grey-7",label:"Back",onClick:b[2]||(b[2]=e=>G.value=1),class:"q-mr-sm"}),x(t,{color:"primary",label:"Validate",onClick:ee,loading:T.value},null,8,["loading"])]),_:1})]),_:1},8,["done"]),x(g,{name:3,title:"Preview & Import",icon:"preview"},{default:w(()=>[b[11]||(b[11]=C("div",{class:"text-body2 q-mb-md"}," Preview the menus that will be created: ",-1)),x(s,{bordered:"",separator:""},{default:w(()=>[(k(!0),j(N,null,q(W.value,(e,a)=>(k(),h(u,{key:a},{default:w(()=>[x(n,{avatar:""},{default:w(()=>[x(l,{name:e.icon||"folder"},null,8,["name"])]),_:2},1024),x(n,null,{default:w(()=>[x(i,null,{default:w(()=>[A(V(e.label),1)]),_:2},1024),x(i,{caption:""},{default:w(()=>[A(" Module: "+V(e.module)+" | Route: "+V(e.route||"None"),1)]),_:2},1024),e.children&&e.children.length>0?(k(),h(i,{key:0,caption:""},{default:w(()=>[A(" Children: "+V(e.children.length),1)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),C("div",P,[x(d,{modelValue:X.value,"onUpdate:modelValue":b[3]||(b[3]=e=>X.value=e),label:"Dry run (preview only, don't save)"},null,8,["modelValue"])]),x(y,null,{default:w(()=>[x(t,{flat:"",color:"grey-7",label:"Back",onClick:b[4]||(b[4]=e=>G.value=2),class:"q-mr-sm"}),x(t,{color:"primary",label:X.value?"Run Dry Run":"Import Menus",onClick:ae,loading:z.value},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Y.value?(k(),h(o,{key:0,class:S([Y.value.error_count>0?"bg-warning":"bg-positive","text-white q-mt-md"]),rounded:""},{avatar:w(()=>[x(l,{name:Y.value.error_count>0?"warning":"check_circle"},null,8,["name"])]),default:w(()=>[b[13]||(b[13]=C("div",{class:"text-subtitle2"},"Import Results",-1)),C("div",Q," Success: "+V(Y.value.success_count)+" | Errors: "+V(Y.value.error_count),1),Y.value.results.errors.length>0?(k(),j("div",B,[b[12]||(b[12]=C("div",{class:"text-subtitle2"},"Errors:",-1)),C("ul",E,[(k(!0),j(N,null,q(Y.value.results.errors.slice(0,5),(e,a)=>{var l;return k(),j("li",{key:a},V((null==(l=e.data)?void 0:l.label)||`Item ${e.index}`)+": "+V(Object.values(e.errors).flat().join(", ")),1)}),128))]),Y.value.results.errors.length>5?(k(),j("div",R," ... and "+V(Y.value.results.errors.length-5)+" more errors ",1)):I("",!0)])):I("",!0)]),_:1},8,["class"])):I("",!0)]),_:1}),x(m,{align:"right"},{default:w(()=>[x(t,{flat:"",label:"Close",color:"grey-7",onClick:le})]),_:1})]),_:1})]),_:1},8,["model-value"]))}};export{U as default};
