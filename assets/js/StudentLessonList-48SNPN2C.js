import{Q as e}from"./QLinearProgress--xrLPDag.js";import{r as s,Q as t,f as a,b as r,d as l}from"./app-CCwy2VVq.js";import{Q as o}from"./QBadge-BmqcVL7P.js";import{f as c,a as i,o as n,af as d,N as u,J as p,b as g,R as v,O as m,V as _,F as y,Q as k,K as b,U as q,a0 as f,W as x,_ as h,$ as z}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const w={class:"student-lesson-list q-pa-md"},L={class:"row items-center q-mb-lg"},j={class:"col"},Q={class:"text-grey-7 q-mb-none"},I={class:"col-auto"},C={class:"progress-card"},P={class:"text-h6"},N={class:"row q-col-gutter-md"},R={key:0,class:"lock-overlay"},S={class:"row items-center q-mb-sm"},W={class:"col"},B={class:"text-overline text-grey-7"},F={class:"col-auto"},M={class:"text-h6 q-mb-sm"},T={class:"text-caption text-grey-7 line-clamp-2"},O={class:"progress-indicators q-mt-md"},V={class:"row q-gutter-xs"},A={class:"col"},E={class:"col"},G={class:"col"},H={class:"q-mt-md"},J={key:0,class:"q-mt-sm"},K={key:0,class:"text-caption text-grey-7"},U={key:1,class:"text-caption text-grey-7"},Y={key:0},$={key:0,class:"text-center q-pa-xl"},D=s({__name:"StudentLessonList",props:{studentId:{type:Number,required:!0},gradeId:{type:Number,required:!0},subjectId:{type:Number,required:!0}},setup(s){const D=s,X=c([]),Z=c(null),ee=c(null),se=c(!1),te=i(()=>{const e=X.value.filter(e=>{var s;return null==(s=e.progress)?void 0:s.opened_at});if(0===e.length)return 0;const s=e.filter(e=>{var s,t;return"completed"===(null==(s=e.progress)?void 0:s.status)||(null==(t=e.progress)?void 0:t.force_passed)});return Math.round(s.length/e.length*100)}),ae={gray:"card-gray",light_blue:"card-light-blue",blue:"card-blue",purple:"card-purple",green:"card-green",yellow:"card-yellow",dark_yellow:"card-dark-yellow",orange:"card-orange",red:"card-red"},re=e=>{var s;return ae[null==(s=e.progress)?void 0:s.color_status]||"card-gray"},le=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return t&&"locked"!==t?"opened"===t?"Ready":"learning"===t?"In Progress":"practice_pending"===t?"Practice":"practice_submitted"===t?"Waiting":"quiz_unlocked"===t?"Quiz Ready":"completed"===t?"Completed":"failed"===t?"Failed":t:"Locked"},oe=e=>{var s;const t=null==(s=e.progress)?void 0:s.color_status;return"green"===t?"positive":"yellow"===t||"dark_yellow"===t?"warning":"red"===t?"negative":"purple"===t?"purple":"blue"===t||"light_blue"===t?"info":"grey"},ce=(e,s)=>{const t=e.progress;return t?"learn"===s?t.learn_completed_at?"stage-completed":"learning"===t.status||"opened"===t.status?"stage-active":"stage-locked":"practice"===s?null!==t.practice_score?"stage-completed":"practice_pending"===t.status||"practice_submitted"===t.status?"stage-active":t.learn_completed_at?"stage-available":"stage-locked":"quiz"===s?t.quiz_passed?"stage-completed":"quiz_unlocked"===t.status?"stage-active":t.practice_score>=6?"stage-available":"stage-locked":"stage-locked":"stage-locked"},ie=e=>{var s;return"locked"!==(null==(s=e.progress)?void 0:s.status)},ne=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return t&&"locked"!==t?"opened"===t?"Start Learning":"learning"===t?"Continue Learning":"practice_pending"===t?"Submit Practice":"practice_submitted"===t?"Waiting for Teacher":"quiz_unlocked"===t?"Take Quiz":"completed"===t?"Review":"failed"===t?"Contact Teacher":"Open":"Locked"},de=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return"completed"===t?"positive":"failed"===t?"negative":"practice_submitted"===t?"grey":"primary"},ue=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return t&&"locked"!==t?"opened"===t||"learning"===t?"play_arrow":"practice_pending"===t?"edit_note":"practice_submitted"===t?"hourglass_empty":"quiz_unlocked"===t?"quiz":"completed"===t?"check_circle":"failed"===t?"error":"arrow_forward":"lock"},pe=e=>{ie(e)&&z.visit(route("lesson-presentation.student.view",{id:e.id}))};return n(()=>{(async()=>{se.value=!0;try{const e=await h.get(route("lesson-presentation.progress.student",{studentId:D.studentId})),s={};e.data.forEach(e=>{s[e.lesson_presentation_id]=e});const t=await h.get(route("lesson-presentation.list"),{params:{grade_id:D.gradeId,subject_id:D.subjectId}});X.value=t.data.map(e=>({...e,progress:s[e.id]||{status:"locked",color_status:"gray"}})).sort((e,s)=>(e.order||0)-(s.order||0))}catch(e){console.error("Failed to fetch lessons:",e)}finally{se.value=!1}})()}),(s,c)=>{var i,n;const h=d("Head");return p(),u(y,null,[g(h,{title:"My Lessons"}),v("div",w,[v("div",L,[v("div",j,[c[0]||(c[0]=v("h4",{class:"text-h4 q-my-none"},"My Lessons",-1)),v("p",Q,_(null==(i=Z.value)?void 0:i.name)+" - Grade "+_(null==(n=ee.value)?void 0:n.name),1)]),v("div",I,[v("div",C,[v("div",P,_(te.value)+"%",1),c[1]||(c[1]=v("div",{class:"text-caption text-grey-7"},"Progress",-1)),g(e,{value:te.value/100,color:"primary",class:"q-mt-sm"},null,8,["value"])])])]),v("div",N,[(p(!0),u(y,null,k(X.value,(e,s)=>(p(),u("div",{key:e.id,class:"col-12 col-sm-6 col-md-4"},[g(l,{class:q([re(e),"lesson-card cursor-pointer"]),onClick:s=>(e=>{ie(e)&&pe(e)})(e)},{default:b(()=>{var l;return["locked"===(null==(l=e.progress)?void 0:l.status)?(p(),u("div",R,[g(t,{name:"lock",size:"48px",color:"grey-5"}),c[2]||(c[2]=v("div",{class:"text-caption text-grey-6 q-mt-sm"},"Waiting for teacher",-1))])):m("",!0),g(a,null,{default:b(()=>[v("div",S,[v("div",W,[v("div",B,"Lesson "+_(e.order||s+1),1)]),v("div",F,[g(o,{color:oe(e),label:le(e)},null,8,["color","label"])])]),v("div",M,_(e.name),1),v("div",T,_(e.description),1),v("div",O,[v("div",V,[v("div",A,[v("div",{class:q(["stage-indicator",ce(e,"learn")])},[g(t,{name:"school",size:"sm"}),c[3]||(c[3]=v("div",{class:"text-caption"},"Learn",-1))],2)]),v("div",E,[v("div",{class:q(["stage-indicator",ce(e,"practice")])},[g(t,{name:"edit_note",size:"sm"}),c[4]||(c[4]=v("div",{class:"text-caption"},"Practice",-1))],2)]),v("div",G,[v("div",{class:q(["stage-indicator",ce(e,"quiz")])},[g(t,{name:"quiz",size:"sm"}),c[5]||(c[5]=v("div",{class:"text-caption"},"Quiz",-1))],2)])])]),v("div",H,[g(r,{label:ne(e),color:de(e),icon:ue(e),disable:!ie(e),unelevated:"","no-caps":"",class:"full-width",onClick:f(s=>pe(e),["stop"])},null,8,["label","color","icon","disable","onClick"])]),e.progress?(p(),u("div",J,[null!==e.progress.practice_score?(p(),u("div",K," Practice Score: "+_(e.progress.practice_score)+"/10 ",1)):m("",!0),e.progress.quiz_attempts>0?(p(),u("div",U,[x(" Quiz Attempts: "+_(e.progress.quiz_attempts)+" ",1),null!==e.progress.quiz_best_score?(p(),u("span",Y," (Best: "+_(e.progress.quiz_best_score)+"%) ",1)):m("",!0)])):m("",!0)])):m("",!0)]),_:2},1024)]}),_:2},1032,["class","onClick"])]))),128))]),0===X.value.length?(p(),u("div",$,[g(t,{name:"school",size:"64px",color:"grey-5"}),c[6]||(c[6]=v("div",{class:"text-h6 text-grey-7 q-mt-md"},"No lessons available yet",-1)),c[7]||(c[7]=v("div",{class:"text-caption text-grey-6"},"Your teacher will open lessons for you soon",-1))])):m("",!0)])],64)}}},[["__scopeId","data-v-9ae30d52"]]);export{D as default};
