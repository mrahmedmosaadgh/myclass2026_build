import{r as e,u as a,aI as t,t as s,b as i,d as o,Q as r,aS as n,f as l,e as p}from"./app-Dtv5Fi9L.js";import{Q as m}from"./QSpace-D-IrDQfo.js";import{Q as d}from"./QBar-Btr9r56g.js";import{M as u,f as c,a as j,o as v,af as y,N as f,J as g,b,I as Q,O as w,K as _,W as S,S as h,y as x,Y as P,ak as k,F as C,_ as z}from"./vendor-BWKGNkNB.js";import I from"./LessonPlayer-CyQbwu_-.js";import T from"./reward_sys-Dfp2V1Hc.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./QSpinnerDots-DmqPi45h.js";import"./QBadge-B7PIhVlN.js";import"./QPage-BrT4SiPb.js";import"./QPageContainer-Cr4qnoAV.js";import"./QLayout-BrBc8rSQ.js";import"./QuestionSlide-DMYW7qR3.js";import"./EnhancedQuestionEditor-BA1OBnsW.js";import"./QuestionEditor-DSxiKt56.js";import"./RichTextEditor-CSzw5j8S.js";import"./QColor-B2TdKj-z.js";import"./QSlider-DGBUMv46.js";import"./QTabs-Djj_zpNj.js";import"./rtl-Cr6c3OOr.js";import"./QTab-C3dKeHww.js";import"./QTabPanels-DIsvTADE.js";import"./use-panel-CKffL4LQ.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanel-DJnQc_xc.js";import"./purify.es-C2Ba6vpb.js";import"./MathEditor-CvZ-JriR.js";import"./katex-BXKQVcz-.js";import"./MathPastePreview-Dm9kNOd_.js";import"./QSelect-BslHFD89.js";import"./StepByStepEditor-C5Cjhvsk.js";import"./QuestionTypeSelector-D-EnBePT.js";import"./QuizEngine-BLzHZEti.js";import"./useQuizI18n-COVRmzJR.js";import"./PlayerSidebar-BjeSnrT8.js";import"./QDrawer-DdqpavDU.js";import"./SectionCard-XsKjmsbR.js";import"./SectionBanner-D_5YVSe3.js";import"./QLinearProgress-D6iXPeG1.js";import"./SlideRenderer-sZBeUFHR.js";import"./FingerDrawingSlide-DxmLKe_H.js";import"./QPopupProxy-pHT4w2do.js";import"./NavigationFooter-Dz303Thm.js";import"./DrawingOverlay-CSlNZgrw.js";import"./DrawingCanvas-C-f7So6M.js";import"./DrawingToolbar-CmZk_-1o.js";import"./QBtnToggle-BoICfhrK.js";import"./SlideAnnotationOverlay-lqeQIPXL.js";import"./PointsDisplaySettings-BtXJq6Vl.js";import"./StudentCard-rsVUyQIV.js";import"./AvatarManager-D64r3XLO.js";import"./CameraCapture-_bgxMbKa.js";import"./noise-CzERC21p.js";const D={key:1,class:"h-screen flex items-center justify-center bg-gray-50"},L={key:2,class:"fixed-bottom-right q-ma-md",style:{"z-index":"2000"}},M={key:0,class:"text-h6 q-ml-sm"},B={key:1,class:"text-subtitle2 q-ml-sm"},E=e({__name:"StudentLessonView",props:{presentationId:{type:[String,Number],required:!0},studentId:{type:[String,Number],required:!0},sections:{type:Array,default:()=>[]}},setup(e){const E=a(),F=u(),q=e,N=c({}),A=c([]),R=c(null),V=c(!0),K=c(!1),O=c(!1),W=j(()=>{var e,a;const t=null==(a=null==(e=F.props.auth)?void 0:e.user)?void 0:a.role;return"teacher"===t||"admin"===t}),H=async()=>{try{V.value=!0;const e=await z.get(route("lesson-presentation.show",{id:q.presentationId}));N.value=e.data,A.value=(e.data.slides||[]).map(e=>({...e,section:e.section||"learn"}));const a=(await z.get(route("lesson-presentation.progress.student",{studentId:q.studentId}))).data.find(e=>e.lesson_presentation_id==q.presentationId);R.value=a}catch(e){console.error("Failed to load data:",e),E.notify({type:"negative",message:"Failed to load lesson data"})}finally{V.value=!1}},U=async()=>{try{await z.put(route("lesson-presentation.progress.complete-learn",{id:R.value.id})),await H(),E.notify({type:"positive",message:"Learn section completed! Practice unlocked."})}catch(e){console.error("Failed to complete learn:",e)}},Y=async()=>{await H(),E.notify({type:"positive",message:"Practice submitted! Waiting for teacher review."})};return v(()=>{H()}),(a,u)=>{const c=y("Head");return g(),f(C,null,[b(c,{title:N.value.name?`Lesson: ${N.value.name}`:"Lesson View"},null,8,["title"]),V.value?(g(),f("div",D,[b(t,{color:"primary",size:"3em"})])):(g(),Q(I,{key:0,presentation:N.value,sections:e.sections,slides:A.value,progress:R.value,loading:V.value,onCompleteLearn:U,onSubmitPractice:Y},null,8,["presentation","sections","slides","progress","loading"])),W.value?(g(),f("div",L,[b(i,{fab:"",icon:"emoji_events",color:"warning",onClick:u[0]||(u[0]=e=>{K.value=!0,O.value=!1})},{default:_(()=>[b(s,null,{default:_(()=>u[4]||(u[4]=[S("Reward System")])),_:1})]),_:1})])):w("",!0),b(p,{modelValue:K.value,"onUpdate:modelValue":u[3]||(u[3]=e=>K.value=e),maximized:!O.value,seamless:O.value,position:O.value?"bottom":"standard","transition-show":"slide-up","transition-hide":"slide-down"},{default:_(()=>[b(o,{style:h(O.value?"width: 300px":"")},{default:_(()=>[b(d,{class:"bg-primary text-white"},{default:_(()=>[b(r,{name:"emoji_events"}),O.value?(g(),f("div",B,"Rewards")):(g(),f("div",M,"Reward System")),b(m),O.value?(g(),Q(i,{key:2,dense:"",flat:"","no-caps":"",label:"Maximize",icon:"open_in_full",onClick:u[1]||(u[1]=e=>O.value=!1)},{default:_(()=>[b(s,null,{default:_(()=>u[5]||(u[5]=[S("Maximize")])),_:1})]),_:1})):(g(),Q(i,{key:3,dense:"",flat:"",icon:"minimize",onClick:u[2]||(u[2]=e=>O.value=!0)},{default:_(()=>[b(s,null,{default:_(()=>u[6]||(u[6]=[S("Minimize")])),_:1})]),_:1})),x((g(),Q(i,{dense:"",flat:"",icon:"close"},{default:_(()=>[b(s,null,{default:_(()=>u[7]||(u[7]=[S("Close")])),_:1})]),_:1})),[[n]])]),_:1}),x(b(l,{class:"q-pa-none",style:{height:"calc(100vh - 32px)"}},{default:_(()=>[(g(),Q(k,null,[b(T,{isDialog:!0})],1024))]),_:1},512),[[P,!O.value]])]),_:1},8,["style"])]),_:1},8,["modelValue","maximized","seamless","position"])],64)}}},[["__scopeId","data-v-8d7bb35e"]]);export{E as default};
