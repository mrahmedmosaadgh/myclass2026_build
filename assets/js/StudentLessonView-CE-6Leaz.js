import{o as e,u as t,aE as a,p as s,Q as i,m as o,d as r,aP as n,c as l,b as p}from"./app-tFXAu5dG.js";import{Q as m}from"./QSpace-PFtRKs6J.js";import{Q as d}from"./QBar-j5mWzEQI.js";import{M as u,f as c,a as j,o as v,af as y,N as f,J as g,b,I as Q,Q as _,K as w,W as S,S as h,y as P,Y as x,ak as k,F as C,_ as I}from"./vendor-nQjeLEvd.js";import z from"./LessonPlayer-U6cs-EaG.js";import T from"./reward_sys-vPP5sGB8.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";import"./QSpinnerDots-C_dcRmiY.js";import"./QBadge-qhepP9EB.js";import"./QPage-BOs9Ora7.js";import"./QPageContainer-BzOeoStV.js";import"./QLayout-BonoIlLg.js";import"./QuestionSlide-DXsF34Wd.js";import"./EnhancedQuestionEditor-D5jlCFjO.js";import"./QuestionEditor-DxSwM-bX.js";import"./RichTextEditor-N74O22b8.js";import"./QColor-K7Jvc-Lm.js";import"./QSlider-DKMYX9-R.js";import"./QTabs-MK3vUK-C.js";import"./rtl-Cr6c3OOr.js";import"./QTab-BKLAeiU7.js";import"./QTabPanels-DrOpUhST.js";import"./use-panel-C-DNV6UK.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanel-DaHi4t9n.js";import"./purify.es-C2Ba6vpb.js";import"./MathEditor-CfjeXhnT.js";import"./katex-BXKQVcz-.js";import"./MathPastePreview-B4ZtibSz.js";import"./QSelect-CmlFFsWs.js";import"./StepByStepEditor-Ba6vyEdn.js";import"./QuestionTypeSelector-5qRj8NAZ.js";import"./QuizEngine-DKjJM2yz.js";import"./useQuizI18n-D42PDdQD.js";import"./PlayerSidebar-DOBJenbn.js";import"./QDrawer-tL5XFF38.js";import"./SectionCard-B8LNiz3l.js";import"./SectionBanner-CzQjImpR.js";import"./QLinearProgress-D4JaekYN.js";import"./SlideRenderer-CzDznmtR.js";import"./FingerDrawingSlide-C0lwHs9S.js";import"./QPopupProxy-B2hJ8Meq.js";import"./NavigationFooter-C65tq1tD.js";import"./DrawingOverlay-Xyxnu-Y9.js";import"./DrawingCanvas-CNGfzbYR.js";import"./DrawingToolbar-Dug7T2Lr.js";import"./QBtnToggle-BggOqwtJ.js";import"./SlideAnnotationOverlay-DaENHhGH.js";import"./QToolbar-B3iq7pXK.js";import"./reward_sys_point_action-oLy4sW63.js";import"./PeriodSelectionRefactored-B09ne4Ce.js";import"./ClassroomSelection-BxCe4NhC.js";import"./TopLeaderboard-BnC_WZ6u.js";import"./html2canvas.esm-Cq3pa7K9.js";import"./CertificateGenerator-CPR-ZWoI.js";import"./jspdf.es.min-BTDh8jQZ.js";import"./StudentCard-BwtL4Uw2.js";import"./AvatarManager-D3ZrWUBe.js";import"./CameraCapture-Dh16e_ym.js";import"./StudentGrouping-CkL84c9v.js";import"./vuedraggable.umd-C4qRof-w.js";import"./index-DTdDyFNb.js";import"./BehaviorIncidents-DjW_UZV1.js";import"./IncidentPrintReport-g-fgqinb.js";const L={key:1,class:"h-screen flex items-center justify-center bg-gray-50"},R={key:2,class:"fixed-bottom-right q-ma-md",style:{"z-index":"2000"}},E={key:0,class:"text-h6 q-ml-sm"},M={key:1,class:"text-subtitle2 q-ml-sm"},q=e({__name:"StudentLessonView",props:{presentationId:{type:[String,Number],required:!0},studentId:{type:[String,Number],required:!0},sections:{type:Array,default:()=>[]}},setup(e){const q=t(),B=u(),D=e,F=c({}),V=c([]),A=c(null),N=c(!0),O=c(!1),G=c(!1),H=j(()=>{var e,t;const a=null==(t=null==(e=B.props.auth)?void 0:e.user)?void 0:t.role;return"teacher"===a||"admin"===a}),J=async()=>{try{N.value=!0;const e=await I.get(route("lesson-presentation.show",{id:D.presentationId}));F.value=e.data,V.value=(e.data.slides||[]).map(e=>({...e,section:e.section||"learn"}));const t=(await I.get(route("lesson-presentation.progress.student",{studentId:D.studentId}))).data.find(e=>e.lesson_presentation_id==D.presentationId);A.value=t}catch(e){console.error("Failed to load data:",e),q.notify({type:"negative",message:"Failed to load lesson data"})}finally{N.value=!1}},K=async()=>{try{await I.put(route("lesson-presentation.progress.complete-learn",{id:A.value.id})),await J(),q.notify({type:"positive",message:"Learn section completed! Practice unlocked."})}catch(e){console.error("Failed to complete learn:",e)}},W=async()=>{await J(),q.notify({type:"positive",message:"Practice submitted! Waiting for teacher review."})};return v(()=>{J()}),(t,u)=>{const c=y("Head");return g(),f(C,null,[b(c,{title:F.value.name?`Lesson: ${F.value.name}`:"Lesson View"},null,8,["title"]),N.value?(g(),f("div",L,[b(a,{color:"primary",size:"3em"})])):(g(),Q(z,{key:0,presentation:F.value,sections:e.sections,slides:V.value,progress:A.value,loading:N.value,onCompleteLearn:K,onSubmitPractice:W},null,8,["presentation","sections","slides","progress","loading"])),H.value?(g(),f("div",R,[b(i,{fab:"",icon:"emoji_events",color:"warning",onClick:u[0]||(u[0]=e=>{O.value=!0,G.value=!1})},{default:w(()=>[b(s,null,{default:w(()=>u[4]||(u[4]=[S("Reward System")])),_:1})]),_:1})])):_("",!0),b(p,{modelValue:O.value,"onUpdate:modelValue":u[3]||(u[3]=e=>O.value=e),maximized:!G.value,seamless:G.value,position:G.value?"bottom":"standard","transition-show":"slide-up","transition-hide":"slide-down"},{default:w(()=>[b(o,{style:h(G.value?"width: 300px":"")},{default:w(()=>[b(d,{class:"bg-primary text-white"},{default:w(()=>[b(r,{name:"emoji_events"}),G.value?(g(),f("div",M,"Rewards")):(g(),f("div",E,"Reward System")),b(m),G.value?(g(),Q(i,{key:2,dense:"",flat:"","no-caps":"",label:"Maximize",icon:"open_in_full",onClick:u[1]||(u[1]=e=>G.value=!1)},{default:w(()=>[b(s,null,{default:w(()=>u[5]||(u[5]=[S("Maximize")])),_:1})]),_:1})):(g(),Q(i,{key:3,dense:"",flat:"",icon:"minimize",onClick:u[2]||(u[2]=e=>G.value=!0)},{default:w(()=>[b(s,null,{default:w(()=>u[6]||(u[6]=[S("Minimize")])),_:1})]),_:1})),P((g(),Q(i,{dense:"",flat:"",icon:"close"},{default:w(()=>[b(s,null,{default:w(()=>u[7]||(u[7]=[S("Close")])),_:1})]),_:1})),[[n]])]),_:1}),P(b(l,{class:"q-pa-none",style:{height:"calc(100vh - 32px)"}},{default:w(()=>[(g(),Q(k,null,[b(T,{isDialog:!0})],1024))]),_:1},512),[[x,!G.value]])]),_:1},8,["style"])]),_:1},8,["modelValue","maximized","seamless","position"])],64)}}},[["__scopeId","data-v-8d7bb35e"]]);export{q as default};
