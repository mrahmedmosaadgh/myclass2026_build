import{o as e,u as a,d as s,p as t,Q as i,c as o,m as n,l,b as r}from"./app-DOc39CFu.js";import{Q as c}from"./QTab-Dldfuhzv.js";import{Q as u}from"./QTabs-CQbEg8iR.js";import{Q as d}from"./QTabPanel-C5l4w7rK.js";import{Q as v}from"./QTabPanels-D4WV1jNy.js";import{f as p,a as m,M as g,J as b,N as f,b as h,Q as y,V as T,K as w,W as _,U as k,F as j,R as V,I as S,_ as C}from"./vendor-DuKqz2x4.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-Ddka6S_L.js";import"./use-render-cache-CmTcazfP.js";const $={class:"behavior-manager"},A={class:"student-header"},N={class:"student-avatar"},z={class:"student-info"},Q={class:"student-name"},x={class:"encouragement-text"},L={class:"tab-content"},G={class:"tab-content"},M={class:"panel-header"},P={class:"behavior-grid"},Y={class:"behavior-icon positive-icon"},I={class:"behavior-name"},J={class:"behavior-points positive-points"},O={class:"behavior-grid"},U={class:"behavior-icon negative-icon"},q={class:"behavior-name"},K={class:"behavior-points negative-points"},W={class:"score-display"},B={class:"score-card positive-score"},R={class:"score-number"},F={class:"score-card total-score"},D={class:"score-number"},E={class:"score-card negative-score"},H={class:"score-number"},X={class:"confirm-icon"},Z={class:"confirm-title"},ee={class:"confirm-message"},ae={class:"student-name-large"},se={class:"behavior-description"},te={class:"behavior-name-large"},ie={class:"points-info"},oe={key:0,class:"success-animation"},ne={class:"success-content"},le={class:"success-text"},re=e({__name:"BehaviorManager",props:{studentId:Number,read:Boolean,studentName:{type:String,default:"Student"},periodCode:String,date:{type:String,default:()=>(new Date).toISOString().slice(0,10)},behaviors:{type:Array,default:()=>[]},summary:{type:Object,default:()=>({positive:0,negative:0,total:0})}},emits:["recorded","close"],setup(e,{emit:re}){const ce=e,ue=re,de=a(),ve=p("positive"),pe=p(!1),me=p(null),ge=p(!1),be=p(""),fe=p(null),he=p(null),ye=m(()=>ce.summary||{positive:0,negative:0,total:0}),Te=m(()=>(ce.behaviors||[]).filter(e=>"positive"===e.type)),we=m(()=>(ce.behaviors||[]).filter(e=>"negative"===e.type)),_e=["You're doing great!","Keep up the good work!","You're awesome!","Learning every day!","You're a star!","Great effort!","You're amazing!"],ke=m(()=>{const e=Math.floor(Math.random()*_e.length);return _e[e]}),je=(e,a=1,s=1.2)=>{if(ce.read&&"speechSynthesis"in window){speechSynthesis.cancel();const t=new SpeechSynthesisUtterance(e);t.rate=a,t.pitch=s,t.volume=.8;const i=speechSynthesis.getVoices().find(e=>e.name.includes("child")||e.name.includes("kid")||e.name.includes("young")||"female"===e.gender&&e.lang.startsWith("en"));i&&(t.voice=i),speechSynthesis.speak(t)}},Ve=()=>{je(`  ${ce.studentName} `,.9,1.3)},Se=e=>{try{const a=new(window.AudioContext||window.webkitAudioContext),s=a.createOscillator(),t=a.createGain();s.connect(t),t.connect(a.destination),"positive"===e?(s.frequency.setValueAtTime(523.25,a.currentTime),s.frequency.setValueAtTime(659.25,a.currentTime+.1),s.frequency.setValueAtTime(783.99,a.currentTime+.2),s.type="sine",t.gain.setValueAtTime(.3,a.currentTime),t.gain.exponentialRampToValueAtTime(.01,a.currentTime+.5),s.start(a.currentTime),s.stop(a.currentTime+.5)):(s.frequency.setValueAtTime(440,a.currentTime),s.type="sine",t.gain.setValueAtTime(.2,a.currentTime),t.gain.exponentialRampToValueAtTime(.01,a.currentTime+.3),s.start(a.currentTime),s.stop(a.currentTime+.3))}catch(a){console.log("Web Audio not available")}},Ce=(e,a)=>{const s={positive:{listening:"ðŸ‘‚",helping:"ðŸ¤",sharing:"ðŸ¤²","following directions":"âœ…","being kind":"ðŸ’","working hard":"ðŸ’ª","raising hand":"ðŸ™‹","good effort":"â­",teamwork:"ðŸ‘¥",respect:"ðŸ™",default:"ðŸŒŸ"},negative:{"talking out":"ðŸ—£ï¸","not listening":"ðŸ‘‚","not following directions":"ðŸ“‹",disrupting:"âš ï¸","not sharing":"ðŸ¤²","not helping":"ðŸ¤","off task":"ðŸ“š",default:"ðŸ“–"}},t=s[a]||s.positive,i=e.toLowerCase();for(const o in t)if(i.includes(o))return t[o];return t.default},$e=e=>{me.value=e,pe.value=!0;const a="positive"===e.type?`Great job   ${e.name}!`:`  ${e.name}`;je(a,.9,1.2)},Ae=()=>{pe.value=!1,me.value=null},Ne=async()=>{var e,a,s,t,i;if(!me.value)return;const o=me.value;try{await C.post("/api/student-behaviors",{student_id:ce.studentId,behavior_id:o.id,points:o.points,period_code:ce.periodCode,date:ce.date}),"positive"===o.type?((()=>{try{fe.value?(fe.value.currentTime=0,fe.value.play().catch(()=>{Se("positive")})):Se("positive")}catch(e){console.log("Sound not available")}})(),be.value=`ðŸŽ‰ Great job, ${ce.studentName}! You earned ${o.points} points for ${o.name}!`,je(`Fantastic ${ce.studentName}! You earned ${o.points} points for ${o.name}! Keep up the great work!`,.9,1.3)):((()=>{try{he.value?(he.value.currentTime=0,he.value.play().catch(()=>{Se("negative")})):Se("negative")}catch(e){console.log("Sound not available")}})(),be.value=`  ${ce.studentName}  ${o.name} do better next time!`,je(` ${ce.studentName}.   ${o.name}.  you lost ${Math.abs(o.points)||0} points  `,.9,1.1)),ge.value=!0,pe.value=!1,me.value=null,ue("recorded"),setTimeout(()=>{ge.value=!1,setTimeout(()=>{ue("close")},500)},3e3)}catch(n){let o="Oops! Something went wrong.";if(409===(null==(e=n.response)?void 0:e.status))o="This was already recorded today!";else if(null==(s=null==(a=n.response)?void 0:a.data)?void 0:s.errors){o=Object.values(n.response.data.errors).flat().join(". ")}else(null==(i=null==(t=n.response)?void 0:t.data)?void 0:i.message)&&(o=n.response.data.message);de.notify({message:o,color:"negative",position:"top",timeout:3e3,actions:[{icon:"close",color:"white"}]}),je(o,.9,1)}};return(a,p)=>(b(),g("div",$,[f("div",A,[f("div",N,[h(s,{name:"face",size:"3rem",color:"primary"})]),f("div",z,[f("h2",Q,T(e.studentName),1),f("p",x,T(ke.value),1)]),h(i,{round:"",color:"primary",icon:"volume_up",onClick:Ve,class:"speak-btn",size:"lg"},{default:w(()=>[h(t,null,{default:w(()=>p[3]||(p[3]=[_("Say student name")])),_:1})]),_:1})]),h(u,{modelValue:ve.value,"onUpdate:modelValue":p[0]||(p[0]=e=>ve.value=e),class:"fun-tabs","indicator-color":"transparent","active-color":"white",align:"justify"},{default:w(()=>[h(c,{name:"positive",class:k(["positive-tab",{"active-positive":"positive"===ve.value}])},{default:w(()=>[f("div",L,[h(s,{name:"star",size:"2rem"}),p[4]||(p[4]=f("div",{class:"tab-label"},"Great Job!",-1)),p[5]||(p[5]=f("div",{class:"tab-emoji"},"â­",-1))])]),_:1},8,["class"]),h(c,{name:"negative",class:k(["negative-tab",{"active-negative":"negative"===ve.value}])},{default:w(()=>[f("div",G,[h(s,{name:"school",size:"2rem"}),p[6]||(p[6]=f("div",{class:"tab-label"},"Let's Practice",-1)),p[7]||(p[7]=f("div",{class:"tab-emoji"},"ðŸ“š",-1))])]),_:1},8,["class"])]),_:1},8,["modelValue"]),h(v,{modelValue:ve.value,"onUpdate:modelValue":p[1]||(p[1]=e=>ve.value=e),animated:"",class:"behavior-panels"},{default:w(()=>[h(d,{name:"positive",class:"positive-panel"},{default:w(()=>[f("div",M,[p[8]||(p[8]=f("h3",null,"ðŸŒŸ Awesome Behaviors! ðŸŒŸ",-1)),f("p",null,"Click on what "+T(e.studentName)+" did great!",1)]),f("div",P,[(b(!0),g(j,null,V(Te.value,e=>(b(),S(n,{key:e.id,class:"behavior-card positive-card",onClick:a=>$e(e)},{default:w(()=>[h(o,{class:"card-content"},{default:w(()=>[f("div",Y,T(Ce(e.name,"positive")),1),f("div",I,T(e.name),1),f("div",J," +"+T(e.points)+" points ",1),p[9]||(p[9]=f("div",{class:"sparkles"},"âœ¨",-1))]),_:2},1024)]),_:2},1032,["onClick"]))),128))])]),_:1}),h(d,{name:"negative",class:"negative-panel"},{default:w(()=>[p[11]||(p[11]=f("div",{class:"panel-header"},[f("h3",null,"ðŸ“š Let's Learn Together! ðŸ“š"),f("p",null,"We can practice and get better at these!")],-1)),f("div",O,[(b(!0),g(j,null,V(we.value,e=>(b(),S(n,{key:e.id,class:"behavior-card negative-card",onClick:a=>$e(e)},{default:w(()=>[h(o,{class:"card-content"},{default:w(()=>[f("div",U,T(Ce(e.name,"negative")),1),f("div",q,T(e.name),1),f("div",K,T(e.points)+" points ",1),p[10]||(p[10]=f("div",{class:"practice-text"},"Let's practice!",-1))]),_:2},1024)]),_:2},1032,["onClick"]))),128))])]),_:1})]),_:1},8,["modelValue"]),f("div",W,[f("div",B,[h(s,{name:"star",size:"2rem",color:"positive"}),f("div",R,"+"+T(ye.value.positive),1),p[12]||(p[12]=f("div",{class:"score-label"},"Great Jobs!",-1))]),f("div",F,[h(s,{name:"emoji_events",size:"2rem",color:"primary"}),f("div",D,T(ye.value.total),1),p[13]||(p[13]=f("div",{class:"score-label"},"Total Points",-1))]),f("div",E,[h(s,{name:"school",size:"2rem",color:"orange"}),f("div",H,T(Math.abs(ye.value.negative)),1),p[14]||(p[14]=f("div",{class:"score-label"},"Practice More",-1))])]),h(r,{modelValue:pe.value,"onUpdate:modelValue":p[2]||(p[2]=e=>pe.value=e),persistent:""},{default:w(()=>[h(n,{class:"confirm-dialog"},{default:w(()=>[h(o,{class:"dialog-header"},{default:w(()=>{var e,a;return[f("div",X,T("positive"===(null==(e=me.value)?void 0:e.type)?"ðŸŒŸ":"ðŸ“š"),1),f("h3",Z,T("positive"===(null==(a=me.value)?void 0:a.type)?"Great Job!":"Let's Practice!"),1)]}),_:1}),h(o,{class:"dialog-content"},{default:w(()=>{var a,s,t,i;return[f("div",ee,[f("p",ae,T(e.studentName),1),f("p",se,T("positive"===(null==(a=me.value)?void 0:a.type)?"did a great job with:":"needs to practice:"),1),f("p",te,T(null==(s=me.value)?void 0:s.name),1),f("p",ie,[_(" This will "+T("positive"===(null==(t=me.value)?void 0:t.type)?"add":"subtract")+" ",1),f("strong",null,T(Math.abs((null==(i=me.value)?void 0:i.points)||0))+" points",1)])])]}),_:1}),h(l,{class:"dialog-actions"},{default:w(()=>{var e,a;return[h(i,{flat:"",label:"Cancel",color:"grey",onClick:Ae,class:"cancel-btn",size:"lg"}),h(i,{color:"positive"===(null==(e=me.value)?void 0:e.type)?"positive":"orange",label:"positive"===(null==(a=me.value)?void 0:a.type)?"Yes, Great Job!":"Yes, Let's Practice!",onClick:Ne,class:"confirm-btn",size:"lg"},null,8,["color","label"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]),ge.value?(b(),g("div",oe,[f("div",ne,[p[15]||(p[15]=f("div",{class:"success-icon"},"ðŸŽ‰",-1)),f("div",le,T(be.value),1)])])):y("",!0),f("audio",{ref_key:"positiveSound",ref:fe,preload:"auto"},p[16]||(p[16]=[f("source",{src:"/sounds/positive-chime.mp3",type:"audio/mpeg"},null,-1),f("source",{src:"/sounds/positive-chime.wav",type:"audio/wav"},null,-1)]),512),f("audio",{ref_key:"negativeSound",ref:he,preload:"auto"},p[17]||(p[17]=[f("source",{src:"/sounds/gentle-reminder.mp3",type:"audio/mpeg"},null,-1),f("source",{src:"/sounds/gentle-reminder.wav",type:"audio/wav"},null,-1)]),512)]))}},[["__scopeId","data-v-9b952bdc"]]);export{re as default};
