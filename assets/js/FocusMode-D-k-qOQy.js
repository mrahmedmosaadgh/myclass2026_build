import{o as e,bk as o,Q as t,N as s}from"./app-C-NJhdpe.js";import{Q as l}from"./QCircularProgress-ChYGQanO.js";import{f as a,a as i,o as n,z as r,k as c,L as u,I as d,M as m,b as v,J as p,U as h,R as x,O as k,H as f}from"./vendor-CUZ9QTQV.js";import"./offline-BzIlwqNM.js";import"./i18n-CP46N9fu.js";import"./ui-LrZmvB2D.js";const w={class:"focus-mode-overlay"},b={class:"focus-mode-content"},g={class:"focus-header"},S={class:"focus-timer"},y={class:"timer-content"},C={class:"text-h1 text-white"},F={class:"countdown-animation"},_={class:"session-type text-caption text-white q-mt-xs"},E={class:"focus-task"},M={class:"text-h4 text-white text-center"},j={key:0,class:"text-subtitle1 text-white text-center"},q={key:1,class:"text-caption text-white-8 q-mt-md"},I={class:"focus-controls"},$={class:"focus-ambient"},D={class:"row q-col-gutter-md"},T={class:"col-4"},A={class:"col-4"},O={class:"col-4"},P=e({__name:"FocusMode",props:{task:Object,pomodoroSession:Object},emits:["exit"],setup(e,{emit:P}){const Q=e,R=P,z=o(),B=a(0),N=a(!1),H=a(!1),J=a(null),L=a(null),U=a(null),W=a(!0),G=i(()=>{let e;return e=Q.pomodoroSession?60*Q.pomodoroSession.duration:1500,(e-B.value)/e*100}),K=()=>{if(Q.pomodoroSession)try{const e=new Date(Q.pomodoroSession.started_at),o=new Date,t=Math.floor((o-e)/1e3),s=60*Q.pomodoroSession.duration;B.value=Math.max(0,s-t),console.log("Focus Mode Timer started with",B.value,"seconds remaining")}catch(e){console.error("Error calculating time remaining:",e),B.value=1500}console.log("Starting timer with",B.value,"seconds remaining"),clearInterval(J.value),J.value=setInterval(()=>{N.value||(B.value--,B.value<=0&&(clearInterval(J.value),ee()))},1e3)},V=()=>{N.value=!0},X=()=>{N.value=!1},Y=()=>{Q.task&&z.fetchData({endpoint:`/developer/tasks/${Q.task.id}/toggle-complete`,method:"post",onSuccess:()=>{R("exit")}})},Z=e=>{const o=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`},ee=()=>{new Audio("/sounds/notification.mp3").play().catch(e=>console.error("Error playing sound:",e))},oe=e=>{if(L.value&&(L.value.pause(),L.value=null),U.value===e)return void(U.value=null);U.value=e;const o=document.getElementById(`audio-${e}`);o?(o.volume=.5,o.loop=!0,o.play().catch(e=>{console.error("Error playing ambient sound:",e),s.create({message:"Could not play ambient sound. Please check your browser settings.",color:"warning"})}),L.value=o):console.error(`Audio element for ${e} not found`)};return n(()=>{K();const e=document.documentElement;e.requestFullscreen&&e.requestFullscreen().catch(e=>console.error("Error attempting to enable fullscreen:",e))}),r(()=>{clearInterval(J.value),L.value&&(L.value.pause(),L.value=null),document.fullscreenElement&&document.exitFullscreen().catch(e=>console.error("Error attempting to exit fullscreen:",e))}),c(()=>Q.pomodoroSession,e=>{console.log("FocusMode: pomodoroSession changed",e),e||(B.value=1500),K()},{immediate:!0}),(o,s)=>{var a,i,n;return d(),u("div",w,[s[8]||(s[8]=m("audio",{id:"audio-rain",src:"/sounds/rain.mp3",preload:"auto"},null,-1)),s[9]||(s[9]=m("audio",{id:"audio-white-noise",src:"/sounds/white-noise.mp3",preload:"auto"},null,-1)),s[10]||(s[10]=m("audio",{id:"audio-forest",src:"/sounds/forest.mp3",preload:"auto"},null,-1)),m("div",b,[m("div",g,[v(t,{flat:"",round:"",color:"white",icon:"close",onClick:s[0]||(s[0]=e=>o.$emit("exit"))}),s[5]||(s[5]=m("div",{class:"text-h6 text-white"},"Focus Mode",-1))]),m("div",S,[v(l,{value:G.value,size:"300px",thickness:.2,color:"white","track-color":"rgba(255, 255, 255, 0.3)",class:"q-ma-md"},{default:p(()=>[m("div",y,[m("div",C,h(Z(B.value)),1),s[6]||(s[6]=m("div",{class:"text-subtitle1 text-white q-mt-sm"},"remaining",-1)),m("div",F,[m("div",{class:"countdown-dot",style:x({transform:`rotate(${3.6*G.value}deg)`})},null,4)]),m("div",_,h(H.value?"Break Time":"Focus Time"),1)])]),_:1},8,["value"])]),m("div",E,[m("div",M,h(e.task?e.task.title:"Focus Session"),1),e.task&&e.task.description?(d(),u("div",j,h(e.task.description),1)):k("",!0),W.value?(d(),u("div",q,[m("div",null,"Session ID: "+h(null==(a=e.pomodoroSession)?void 0:a.id),1),m("div",null,"Duration: "+h(null==(i=e.pomodoroSession)?void 0:i.duration)+" minutes",1),m("div",null,"Started at: "+h(null==(n=e.pomodoroSession)?void 0:n.started_at),1),m("div",null,"Time remaining: "+h(B.value)+" seconds",1)])):k("",!0)]),m("div",I,[N.value?(d(),f(t,{key:1,color:"white","text-color":"black",label:"Resume",icon:"play_arrow",onClick:X})):(d(),f(t,{key:0,color:"white","text-color":"black",label:"Pause",icon:"pause",onClick:V})),v(t,{color:"white","text-color":"black",label:"Complete",icon:"check",onClick:Y}),v(t,{color:"white","text-color":"black",label:"Exit Focus Mode",icon:"fullscreen_exit",onClick:s[1]||(s[1]=e=>o.$emit("exit"))})]),m("div",$,[s[7]||(s[7]=m("div",{class:"text-subtitle1 text-white q-mb-sm"},"Ambient Sounds",-1)),m("div",D,[m("div",T,[v(t,{color:"white","text-color":"black",label:"Rain",icon:"water_drop",onClick:s[2]||(s[2]=e=>oe("rain"))})]),m("div",A,[v(t,{color:"white","text-color":"black",label:"White Noise",icon:"waves",onClick:s[3]||(s[3]=e=>oe("white-noise"))})]),m("div",O,[v(t,{color:"white","text-color":"black",label:"Forest",icon:"forest",onClick:s[4]||(s[4]=e=>oe("forest"))})])])])])])}}},[["__scopeId","data-v-572b88d6"]]);export{P as default};
