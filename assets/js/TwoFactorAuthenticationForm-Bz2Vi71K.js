import{f as e,r as a,N as o,J as t,R as s,b as r,L as l,K as n,W as i,U as u,V as c,a2 as d,n as m,M as p,a7 as f,a as v,k as y,I as h,O as g,z as w,F as b,Q as x,$ as k}from"./vendor-BWKGNkNB.js";import{_}from"./ActionSection-BVBei21x.js";import{_ as C}from"./DialogModal-Csn-6t1F.js";import{_ as S}from"./InputError-DEGVtjzl.js";import{_ as j}from"./PrimaryButton-DVJXOzHH.js";import{_ as T}from"./SecondaryButton-WaufSYeJ.js";import{_ as F}from"./TextInput-QkZjzCho.js";import{D as M}from"./DangerButton-9Wp16n7S.js";import{_ as V}from"./InputLabel-Ch3YeqCE.js";import"./SectionTitle-DuU1aIml.js";import"./app-CmR0nRZC.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./Modal-CN4QIdw_.js";const A={class:"mt-4"},L={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(p,{emit:f}){const v=f,y=e(!1),h=a({password:"",error:"",processing:!1}),g=e(null),w=()=>{axios.get(route("password.confirmation")).then(e=>{e.data.confirmed?v("confirmed"):(y.value=!0,setTimeout(()=>g.value.focus(),250))})},b=()=>{h.processing=!0,axios.post(route("password.confirm"),{password:h.password}).then(()=>{h.processing=!1,x(),m().then(()=>v("confirmed"))}).catch(e=>{h.processing=!1,h.error=e.response.data.errors.password[0],g.value.focus()})},x=()=>{y.value=!1,h.password="",h.error=""};return(e,a)=>(t(),o("span",null,[s("span",{onClick:w},[l(e.$slots,"default")]),r(C,{show:y.value,onClose:x},{title:n(()=>[i(c(p.title),1)]),content:n(()=>[i(c(p.content)+" ",1),s("div",A,[r(F,{ref_key:"passwordInput",ref:g,modelValue:h.password,"onUpdate:modelValue":a[0]||(a[0]=e=>h.password=e),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:d(b,["enter"])},null,8,["modelValue"]),r(S,{message:h.error,class:"mt-2"},null,8,["message"])])]),footer:n(()=>[r(T,{onClick:x},{default:n(()=>a[1]||(a[1]=[i(" Cancel ")])),_:1}),r(j,{class:u(["ms-3",{"opacity-25":h.processing}]),disabled:h.processing,onClick:b},{default:n(()=>[i(c(p.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},P={key:0,class:"text-lg font-medium text-gray-900"},R={key:1,class:"text-lg font-medium text-gray-900"},B={key:2,class:"text-lg font-medium text-gray-900"},I={key:3},K={key:0},q={class:"mt-4 max-w-xl text-sm text-gray-600"},D={key:0,class:"font-semibold"},H={key:1},E=["innerHTML"],Q={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},U={class:"font-semibold"},Y=["innerHTML"],O={key:1,class:"mt-4"},W={key:1},$={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},z={class:"mt-5"},G={key:0},J={key:1},N={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(a){const l=a,m=p(),C=e(!1),A=e(!1),N=e(!1),X=e(null),Z=e(null),ee=e([]),ae=f({code:""}),oe=v(()=>{var e;return!C.value&&(null==(e=m.props.auth.user)?void 0:e.two_factor_enabled)});y(oe,()=>{oe.value||(ae.reset(),ae.clearErrors())});const te=()=>{C.value=!0,k.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([se(),re(),le()]),onFinish:()=>{C.value=!1,A.value=l.requiresConfirmation}})},se=()=>axios.get(route("two-factor.qr-code")).then(e=>{X.value=e.data.svg}),re=()=>axios.get(route("two-factor.secret-key")).then(e=>{Z.value=e.data.secretKey}),le=()=>axios.get(route("two-factor.recovery-codes")).then(e=>{ee.value=e.data}),ne=()=>{ae.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{A.value=!1,X.value=null,Z.value=null}})},ie=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>le())},ue=()=>{N.value=!0,k.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{N.value=!1,A.value=!1}})};return(e,a)=>(t(),h(_,null,{title:n(()=>a[1]||(a[1]=[i(" Two Factor Authentication ")])),description:n(()=>a[2]||(a[2]=[i(" Add additional security to your account using two factor authentication. ")])),content:n(()=>[oe.value&&!A.value?(t(),o("h3",P," You have enabled two factor authentication. ")):oe.value&&A.value?(t(),o("h3",R," Finish enabling two factor authentication. ")):(t(),o("h3",B," You have not enabled two factor authentication. ")),a[11]||(a[11]=s("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[s("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1)),oe.value?(t(),o("div",I,[X.value?(t(),o("div",K,[s("div",q,[A.value?(t(),o("p",D," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(t(),o("p",H," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),s("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:X.value},null,8,E),Z.value?(t(),o("div",Q,[s("p",U,[a[3]||(a[3]=i(" Setup Key: ")),s("span",{innerHTML:Z.value},null,8,Y)])])):g("",!0),A.value?(t(),o("div",O,[r(V,{for:"code",value:"Code"}),r(F,{id:"code",modelValue:w(ae).code,"onUpdate:modelValue":a[0]||(a[0]=e=>w(ae).code=e),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:d(ne,["enter"])},null,8,["modelValue"]),r(S,{message:w(ae).errors.code,class:"mt-2"},null,8,["message"])])):g("",!0)])):g("",!0),ee.value.length>0&&!A.value?(t(),o("div",W,[a[4]||(a[4]=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1)),s("div",$,[(t(!0),o(b,null,x(ee.value,e=>(t(),o("div",{key:e},c(e),1))),128))])])):g("",!0)])):g("",!0),s("div",z,[oe.value?(t(),o("div",J,[r(L,{onConfirmed:ne},{default:n(()=>[A.value?(t(),h(j,{key:0,type:"button",class:u(["me-3",{"opacity-25":C.value}]),disabled:C.value},{default:n(()=>a[6]||(a[6]=[i(" Confirm ")])),_:1},8,["class","disabled"])):g("",!0)]),_:1}),r(L,{onConfirmed:ie},{default:n(()=>[ee.value.length>0&&!A.value?(t(),h(T,{key:0,class:"me-3"},{default:n(()=>a[7]||(a[7]=[i(" Regenerate Recovery Codes ")])),_:1})):g("",!0)]),_:1}),r(L,{onConfirmed:le},{default:n(()=>[0!==ee.value.length||A.value?g("",!0):(t(),h(T,{key:0,class:"me-3"},{default:n(()=>a[8]||(a[8]=[i(" Show Recovery Codes ")])),_:1}))]),_:1}),r(L,{onConfirmed:ue},{default:n(()=>[A.value?(t(),h(T,{key:0,class:u({"opacity-25":N.value}),disabled:N.value},{default:n(()=>a[9]||(a[9]=[i(" Cancel ")])),_:1},8,["class","disabled"])):g("",!0)]),_:1}),r(L,{onConfirmed:ue},{default:n(()=>[A.value?g("",!0):(t(),h(M,{key:0,class:u({"opacity-25":N.value}),disabled:N.value},{default:n(()=>a[10]||(a[10]=[i(" Disable ")])),_:1},8,["class","disabled"]))]),_:1})])):(t(),o("div",G,[r(L,{onConfirmed:te},{default:n(()=>[r(j,{type:"button",class:u({"opacity-25":C.value}),disabled:C.value},{default:n(()=>a[5]||(a[5]=[i(" Enable ")])),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{N as default};
