import{Q as e}from"./QTab-Dldfuhzv.js";import{Q as l}from"./QTabs-CQbEg8iR.js";import{o as a,u as i,c as o,a as t,d as s,f as r,Q as d,m as n,p as u}from"./app-DOc39CFu.js";import{Q as p}from"./QTabPanel-C5l4w7rK.js";import{Q as m}from"./QTabPanels-D4WV1jNy.js";import{f as c,a as f,k as v,M as g,J as y,b as D,N as b,K as P,V as F,W as U}from"./vendor-DuKqz2x4.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./use-panel-Ddka6S_L.js";import"./use-render-cache-CmTcazfP.js";const h={class:"pdf-slide-container"},_={key:0,class:"upload-area"},x={class:"column items-center"},V={class:"column items-center"},w={key:1,class:"pdf-viewer"},k={class:"col"},q={class:"text-weight-medium"},z={class:"text-caption text-grey-6"},j=["src"],L=a({__name:"PDFSlide",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(a,{emit:L}){var R,S,M,G,Q,B;const C=a,A=L,T=i(),I=c(null),K=c("url"),O=c(""),J=c({type:(null==(R=C.modelValue)?void 0:R.type)||null,pdfData:(null==(S=C.modelValue)?void 0:S.pdfData)||null,embedUrl:(null==(M=C.modelValue)?void 0:M.embedUrl)||null,originalUrl:(null==(G=C.modelValue)?void 0:G.originalUrl)||null,filename:(null==(Q=C.modelValue)?void 0:Q.filename)||"",fileSize:(null==(B=C.modelValue)?void 0:B.fileSize)||0}),N=f(()=>!!J.value.pdfData||!!J.value.embedUrl);v(()=>C.modelValue,e=>{e&&(J.value={type:e.type||null,pdfData:e.pdfData||null,embedUrl:e.embedUrl||null,originalUrl:e.originalUrl||null,filename:e.filename||"",fileSize:e.fileSize||0})},{deep:!0});const $=e=>{try{return new URL(e),!0}catch(l){return!1}},E=()=>{if(!O.value||!$(O.value))return;const e=O.value.trim(),l=(e=>{const l=e.match(/\/file\/d\/([^\/]+)/);return l?l[1]:null})(e);return l?(J.value={type:"gdrive",embedUrl:`https://drive.google.com/file/d/${l}/preview`,pdfData:null,originalUrl:e,filename:"Google Drive PDF",fileSize:0},A("update:modelValue",J.value),O.value="",void T.notify({type:"positive",message:"Google Drive PDF added successfully",icon:"check_circle",position:"top"})):e.match(/\.pdf$/i)||e.includes("pdf")?(J.value={type:"direct",pdfData:e,embedUrl:null,originalUrl:e,filename:e.split("/").pop()||"Direct PDF",fileSize:0},A("update:modelValue",J.value),O.value="",void T.notify({type:"positive",message:"PDF URL added successfully",icon:"check_circle",position:"top"})):void T.notify({type:"warning",message:"URL format not recognized. Please use Google Drive or direct PDF links.",icon:"warning",position:"top",timeout:3e3})},W=()=>{var e;null==(e=I.value)||e.click()},H=async e=>{const l=e.target.files[0];if(!l)return;if("application/pdf"!==l.type)return void T.notify({type:"negative",message:"Please select a PDF file",icon:"error",position:"top"});if(l.size>3145728)T.notify({type:"negative",message:"File size exceeds 3MB limit. Please use Google Drive for larger files.",icon:"error",position:"top",timeout:3e3});else{try{T.loading.show({message:"Loading PDF..."});const e=await X(l);J.value={type:"upload",pdfData:e,embedUrl:null,originalUrl:null,filename:l.name,fileSize:l.size},A("update:modelValue",J.value),T.loading.hide(),T.notify({type:"positive",message:"PDF uploaded successfully",icon:"check_circle",position:"top"})}catch(a){T.loading.hide(),console.error("PDF upload error:",a),T.notify({type:"negative",message:"Failed to upload PDF",icon:"error",position:"top"})}e.target.value=""}},X=e=>new Promise((l,a)=>{const i=new FileReader;i.onload=()=>l(i.result),i.onerror=a,i.readAsDataURL(e)}),Y=()=>{T.dialog({title:"Remove PDF",message:"Are you sure you want to remove this PDF?",cancel:!0,persistent:!0}).onOk(()=>{J.value={type:null,pdfData:null,embedUrl:null,originalUrl:null,filename:"",fileSize:0},A("update:modelValue",J.value),T.notify({type:"info",message:"PDF removed",icon:"info",position:"top"})})},Z=e=>{if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,l)*100)/100+" "+["Bytes","KB","MB"][l]};return(a,i)=>(y(),g("div",h,[N.value?(y(),g("div",w,[D(n,{flat:"",bordered:"",class:"info-bar q-mb-sm"},{default:P(()=>[D(o,{class:"row items-center q-pa-sm"},{default:P(()=>[D(s,{name:"picture_as_pdf",color:"red-6",size:"24px",class:"q-mr-sm"}),b("div",k,[b("div",q,F("gdrive"===J.value.type?"Google Drive PDF":J.value.filename||"PDF Document"),1),b("div",z,F("gdrive"===J.value.type?"Embedded from Google Drive":"direct"===J.value.type?"Direct URL":"upload"===J.value.type?Z(J.value.fileSize):"PDF"),1)]),D(d,{flat:"",round:"",dense:"",icon:"close",color:"negative",onClick:Y},{default:P(()=>[D(u,null,{default:P(()=>i[9]||(i[9]=[U("Remove PDF")])),_:1})]),_:1})]),_:1})]),_:1}),D(n,{flat:"",bordered:"",class:"pdf-preview"},{default:P(()=>[b("iframe",{src:J.value.pdfData||J.value.embedUrl,class:"pdf-iframe",frameborder:"0"},null,8,j)]),_:1})])):(y(),g("div",_,[D(n,{flat:"",bordered:"",class:"upload-card"},{default:P(()=>[D(o,{class:"q-pa-lg"},{default:P(()=>[D(l,{modelValue:K.value,"onUpdate:modelValue":i[0]||(i[0]=e=>K.value=e),dense:"",class:"text-grey-7 q-mb-md","active-color":"primary","indicator-color":"primary",align:"justify"},{default:P(()=>[D(e,{name:"url",icon:"link",label:"Google Drive Link"}),D(e,{name:"upload",icon:"upload_file",label:"Upload File"})]),_:1},8,["modelValue"]),D(t,{class:"q-mb-lg"}),D(m,{modelValue:K.value,"onUpdate:modelValue":i[2]||(i[2]=e=>K.value=e),animated:""},{default:P(()=>[D(p,{name:"url",class:"q-pa-none"},{default:P(()=>[b("div",x,[D(s,{name:"cloud",size:"60px",color:"primary",class:"q-mb-md"}),i[3]||(i[3]=b("div",{class:"text-h6 text-grey-8 q-mb-sm"},"Add PDF Link",-1)),i[4]||(i[4]=b("div",{class:"text-caption text-grey-6 q-mb-lg text-center"}," Paste a Google Drive PDF link or direct PDF URL ",-1)),D(r,{modelValue:O.value,"onUpdate:modelValue":i[1]||(i[1]=e=>O.value=e),outlined:"",dense:"",placeholder:"https://drive.google.com/file/d/.../view",class:"full-width q-mb-md",rules:[e=>!e||$(e)||"Please enter a valid URL"]},{prepend:P(()=>[D(s,{name:"link"})]),_:1},8,["modelValue","rules"]),D(d,{unelevated:"",color:"primary",icon:"add",label:"Add PDF",onClick:E,disable:!O.value||!$(O.value),class:"full-width"},null,8,["disable"]),i[5]||(i[5]=b("div",{class:"q-mt-md text-caption text-grey-6"},[b("div",{class:"q-mb-xs"},[b("strong",null,"Supported:")]),b("div",null,"• Google Drive: drive.google.com/file/d/.../view"),b("div",null,"• Direct PDF URLs: ending with .pdf")],-1))])]),_:1}),D(p,{name:"upload",class:"q-pa-none"},{default:P(()=>[b("div",V,[D(s,{name:"picture_as_pdf",size:"60px",color:"grey-5",class:"q-mb-md"}),i[6]||(i[6]=b("div",{class:"text-h6 text-grey-7 q-mb-sm"},"Upload PDF File",-1)),i[7]||(i[7]=b("div",{class:"text-caption text-grey-6 q-mb-lg"},"Maximum file size: 3MB",-1)),D(d,{unelevated:"",color:"primary",icon:"upload_file",label:"Choose PDF File",onClick:W,class:"full-width"}),i[8]||(i[8]=b("div",{class:"text-caption text-grey-5 q-mt-sm"},"or drag and drop here",-1))])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),b("input",{ref_key:"fileInput",ref:I,type:"file",accept:".pdf,application/pdf",onChange:H,style:{display:"none"}},null,544)]))]))}},[["__scopeId","data-v-86b4d597"]]);export{L as default};
