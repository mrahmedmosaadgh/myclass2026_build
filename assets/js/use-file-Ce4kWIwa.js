import{an as e,P as t,a2 as i}from"./app-4gpSDtVV.js";import{f as a,a as l,p as n,h as r}from"./vendor-BWKGNkNB.js";function s(e,t,i,a){const l=[];return e.forEach(e=>{!0===a(e)?l.push(e):t.push({failedPropValidation:i,file:e})}),l}function o(e){(null==e?void 0:e.dataTransfer)&&(e.dataTransfer.dropEffect="copy"),t(e)}const u={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},c=["rejected"];function f({editable:u,dnd:c,getFileInput:f,addFilesToQueue:d}){const{props:p,emit:m,proxy:g}=n(),v=a(null),h=l(()=>void 0!==p.accept?p.accept.split(",").map(e=>"*"===(e=e.trim())?"*/":(e.endsWith("/*")&&(e=e.slice(0,e.length-1)),e.toUpperCase())):null),x=l(()=>parseInt(p.maxFiles,10)),F=l(()=>parseInt(p.maxTotalSize,10));function z(t){var i;if(u.value)if(t!==Object(t)&&(t={target:null}),!0===(null==(i=t.target)?void 0:i.matches('input[type="file"]')))0===t.clientX&&0===t.clientY&&e(t);else{const e=f();e!==t.target&&(null==e||e.click(t))}}function S(e){u.value&&e&&d(null,e)}function b(e){t(e);!0===(null!==e.relatedTarget||!0!==i.is.safari?e.relatedTarget!==v.value:!1===document.elementsFromPoint(e.clientX,e.clientY).includes(v.value))&&(c.value=!1)}function T(e){o(e);const t=e.dataTransfer.files;0!==t.length&&d(null,t),c.value=!1}return Object.assign(g,{pickFiles:z,addFiles:S}),{pickFiles:z,addFiles:S,onDragover:function(e){o(e),!0!==c.value&&(c.value=!0)},onDragleave:b,processFiles:function(e,t,i,a){let l=Array.from(t||e.target.files);const n=[],r=()=>{0!==n.length&&m("rejected",n)};if(void 0!==p.accept&&-1===h.value.indexOf("*/")&&(l=s(l,n,"accept",e=>h.value.some(t=>e.type.toUpperCase().startsWith(t)||e.name.toUpperCase().endsWith(t))),0===l.length))return r();if(void 0!==p.maxFileSize){const e=parseInt(p.maxFileSize,10);if(l=s(l,n,"max-file-size",t=>t.size<=e),0===l.length)return r()}if(!0!==p.multiple&&0!==l.length&&(l=[l[0]]),l.forEach(e=>{e.__key=e.webkitRelativePath+e.lastModified+e.name+e.size}),!0===a){const e=i.map(e=>e.__key);l=s(l,n,"duplicate",t=>!1===e.includes(t.__key))}if(0===l.length)return r();if(void 0!==p.maxTotalSize){let e=!0===a?i.reduce((e,t)=>e+t.size,0):0;if(l=s(l,n,"max-total-size",t=>(e+=t.size,e<=F.value)),0===l.length)return r()}if("function"==typeof p.filter){const e=p.filter(l);l=s(l,n,"filter",t=>e.includes(t))}if(void 0!==p.maxFiles){let e=!0===a?i.length:0;if(l=s(l,n,"max-files",()=>(e++,e<=x.value)),0===l.length)return r()}return r(),0!==l.length?l:void 0},getDndNode:function(e){if(!0===c.value)return r("div",{ref:v,class:`q-${e}__dnd absolute-full`,onDragenter:o,onDragover:o,onDragleave:b,onDrop:T})},maxFilesNumber:x,maxTotalSizeNumber:F}}export{u as a,f as b,c as u};
