import{Q as e}from"./QSelect-BImwntZk.js";import{o as l,u as t,c as a,Q as o,p as s,m as r,A as n}from"./app-BB4Fw2oM.js";import i from"./html2canvas.esm-Cq3pa7K9.js";import{f as d,o as c,k as u,a as p,M as f,Q as m,J as v,b as g,K as b,N as h,I as x,V as y,F as w,R as k,W as S,n as _,U as j}from"./vendor-DuKqz2x4.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";const C={key:0,class:"mb-6"},z={class:"mt-6 flex flex-col md:flex-row items-center justify-center gap-4 px-4"},N={class:"text-sm text-yellow-200 mt-3 font-bold tracking-widest uppercase opacity-80"},T={key:0,class:"text-center py-16"},A={key:1,class:"flex flex-col md:flex-row justify-center items-end gap-6 md:gap-10 min-h-[580px]"},V={class:"text-center mb-6"},I={key:0,class:"text-9xl animate-bounce-slow drop-shadow-2xl"},L={key:1,class:"text-8xl drop-shadow-2xl"},U={class:"text-center pt-8 pb-4 relative z-10"},W={class:"text-4xl font-black italic tracking-wider text-white drop-shadow-2xl"},F={class:"px-4 pb-4 relative z-10"},O={class:"space-y-4"},Q=["src"],R={class:"flex-1 min-w-0"},B={class:"font-black"},J={class:"shiny-name text-3xl md:text-4xl leading-tight block truncate"},E={class:"shiny-name-small block text-lg mt-1 opacity-95 truncate"},M={class:"text-yellow-300 font-bold text-lg mt-1"},P={class:"bg-gradient-to-b from-gray-800 to-gray-900 rounded-2xl p-6 border-2 border-gray-700"},$={class:"flex items-center justify-between mb-6"},D={class:"space-y-3"},H={class:"flex items-center gap-5"},K={class:"flex-shrink-0 w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center border-4 border-yellow-300 shadow-lg"},q={class:"text-white font-black text-2xl"},G={class:"flex-1 flex flex-wrap gap-4"},X=["src"],Y={class:"font-bold text-lg"},Z={class:"shiny-name"},ee={class:"shiny-name-small text-sm ml-1"},le={class:"text-yellow-300 text-sm font-semibold"},te=l({__name:"TopLeaderboard copy 5",props:{students:{type:Array,default:()=>[]},studentBehaviors:{type:Object,default:()=>({})},periodCode:{type:String,default:""},date:{type:String,default:""}},setup(l){const te=t(),ae=l,oe=d({label:"Current Session",value:"session"}),se=d(5),re=[{label:"Current Session",value:"session"},{label:"Today",value:"today"},{label:"This Week",value:"week"},{label:"All Time",value:"all"}];c(()=>{const e=localStorage.getItem("leaderboard_preferences");if(e)try{const l=JSON.parse(e),t=re.find(e=>e.value===l.scope);t&&(oe.value=t),l.topCount&&(se.value=l.topCount)}catch(l){console.error(l)}}),u([oe,se],()=>{localStorage.setItem("leaderboard_preferences",JSON.stringify({scope:oe.value.value,topCount:se.value}))},{deep:!0});const ne=p(()=>{if(!ae.students.length)return[];const e=ae.students.map(e=>{const l=ae.studentBehaviors[e.id]||{},t=(l.points_plus||0)-(l.points_minus||0);return{...e,total:t}}).filter(e=>e.total>0).sort((e,l)=>l.total-e.total);if(!e.length)return[];const l=[];let t={rank:1,total:e[0].total,students:[e[0]]};for(let a=1;a<e.length;a++)e[a].total===t.total?t.students.push(e[a]):(l.push(t),t={rank:l.length+1,total:e[a].total,students:[e[a]]});return l.push(t),l.slice(0,se.value)}),ie=p(()=>ne.value.slice(0,3)),de=p(()=>ne.value),ce=p(()=>{const e=ie.value,l=e.find(e=>1===e.rank);return[e.find(e=>2===e.rank),l,e.find(e=>3===e.rank)].filter(Boolean)});function ue(){console.log("Filters applied")}function pe(){oe.value=re[0],se.value=5}function fe(e){const l=["th","st","nd","rd"],t=e%100;return e+(l[(t-20)%10]||l[t]||l[0])}function me(e){return 1===e?"bg-gradient-to-b from-yellow-400 via-yellow-500 to-yellow-700 border-yellow-300 shadow-yellow-500/70 ring-8 ring-yellow-400/40":2===e?"bg-gradient-to-b from-gray-300 via-gray-400 to-gray-600 border-gray-200 shadow-gray-500/50":3===e?"bg-gradient-to-b from-orange-400 via-orange-500 to-orange-700 border-orange-300 shadow-orange-500/50":""}const ve=d(null),ge=d(!1);function be(){ge.value=!0,_(()=>{const e=ve.value;return e?document.contains(e)?void i(e).then(e=>{const l=e.toDataURL("image/png");navigator.canShare&&navigator.canShare({files:[]})?fetch(l).then(e=>e.blob()).then(e=>{const l=new File([e],"leaderboard.png",{type:"image/png"});return navigator.share({files:[l],title:"Leaderboard"})}).then(()=>{te.notify({message:"Shared successfully!",color:"positive"})}).catch(()=>{he(l)}):he(l)}).catch(e=>{console.error(e),te.notify({message:"Screenshot failed",color:"negative"})}).finally(()=>{ge.value=!1}):(te.notify({message:"Element not available for screenshot",color:"negative"}),void(ge.value=!1)):(te.notify({message:"Leaderboard element not found",color:"negative"}),void(ge.value=!1))})}function he(e){const l=document.createElement("a");l.href=e,l.download="leaderboard.png",l.click(),te.notify({message:"Screenshot downloaded â€“ share on WhatsApp!",color:"positive",icon:"download"})}function xe(e="S"){const l=e.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase();return`data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140"><rect width="140" height="140" fill="#1e293b"/><text x="70" y="70" dy="12" text-anchor="middle" font-size="60" font-family="Arial" font-weight="bold" fill="#cbd5e1">${l}</text></svg>`)}`}return(t,i)=>l.students.length?(v(),f("div",C,[g(r,{class:"shadow-2xl rounded-3xl overflow-hidden bg-gray-900 border-4 border-yellow-500 relative"},{default:b(()=>[i[8]||(i[8]=h("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[h("div",{class:"stars"}),h("div",{class:"twinkling"})],-1)),g(a,{class:"relative z-10 text-center py-6 bg-gradient-to-b from-transparent to-black/50"},{default:b(()=>[i[2]||(i[2]=h("h1",{class:"text-4xl md:text-6xl font-black tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-500 drop-shadow-lg animate-shine"}," ðŸ† CHAMPIONS ðŸ† ",-1)),h("div",z,[g(e,{modelValue:oe.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>oe.value=e),ue],options:re,outlined:"",dense:"",dark:"",label:"Filter Scope",class:"w-full md:w-48 bg-black/30"},null,8,["modelValue"]),g(e,{modelValue:se.value,"onUpdate:modelValue":[i[1]||(i[1]=e=>se.value=e),ue],options:[{label:"Top 5",value:5},{label:"Top 10",value:10}],outlined:"",dense:"",dark:"",label:"Show Places",class:"w-full md:w-32 bg-black/30","emit-value":"","map-options":""},null,8,["modelValue"]),g(o,{color:"yellow-7",icon:"refresh",label:"Reset",onClick:pe,size:"md",class:"w-full md:w-auto"})]),h("p",N,y(oe.value.label)+" â€¢ Top "+y(se.value),1)]),_:1}),g(a,{class:"p-4 md:p-8 relative z-10"},{default:b(()=>[0===ie.value.length?(v(),f("div",T,i[3]||(i[3]=[h("p",{class:"text-3xl text-yellow-400 font-bold animate-pulse"},"The arena is empty... Who will rise? âš”ï¸",-1)]))):(v(),f("div",A,[(v(!0),f(w,null,k(ce.value,(e,l)=>{return v(),f(w,{key:(null==e?void 0:e.rank)||l},[e?(v(),f("div",{key:0,class:j(["w-full md:w-1/3 flex flex-col transition-all duration-700 podium-card",[1===e.rank?"order-2 md:mb-32 z-30":2===e.rank?"order-1 md:mb-12 z-20":"order-3 z-20"]])},[h("div",V,[1===e.rank?(v(),f("div",I,"ðŸ‘‘")):(v(),f("div",L,y((t=e.rank,1===t?"ðŸ¥‡":2===t?"ðŸ¥ˆ":3===t?"ðŸ¥‰":"")),1))]),h("div",{class:j(["relative rounded-3xl overflow-hidden border-4 shadow-2xl backdrop-blur-xl flex flex-col mx-4 pb-6",me(e.rank)])},[i[5]||(i[5]=h("div",{class:"absolute inset-0 bg-gradient-to-tr from-white/0 via-white/30 to-white/0 w-[200%] h-full animate-shine-move pointer-events-none"},null,-1)),h("div",U,[h("h2",W,y(fe(e.rank)),1),i[4]||(i[4]=h("div",{class:"h-1 w-32 mx-auto bg-white/40 rounded-full mt-3"},null,-1))]),h("div",F,[h("div",O,[(v(!0),f(w,null,k(e.students,e=>(v(),f("div",{key:e.id,class:"bg-black/70 rounded-2xl p-4 backdrop-blur-md border border-white/20 shadow-xl hover:border-yellow-400/50 transition-all flex items-center gap-4"},[g(n,{size:"80px",class:"ring-4 ring-yellow-400/60 shadow-xl border-2 flex-shrink-0"},{default:b(()=>[h("img",{src:e.avatar||xe(e.name),class:"object-cover"},null,8,Q)]),_:2},1024),h("div",R,[h("div",B,[h("span",J,y(e.firstName),1),h("span",E,y(e.lastName),1)]),h("div",M,y(e.total)+" pts",1)])]))),128))])])],2)],2)):m("",!0)],64);var t}),128))]))]),_:1}),de.value.length>0?(v(),x(a,{key:0,ref_key:"leaderboardList",ref:ve,class:"p-4 md:p-8 pt-0 relative z-10"},{default:b(()=>[h("div",P,[h("div",$,[i[7]||(i[7]=h("h3",{class:"text-2xl font-bold text-yellow-400 text-center flex-1"},"ðŸ† Complete Leaderboard ðŸ†",-1)),g(o,{color:"green",icon:"screenshot",label:"Share",onClick:be,loading:ge.value,class:"shadow-lg"},{default:b(()=>[g(s,null,{default:b(()=>i[6]||(i[6]=[S("Capture & Share on WhatsApp")])),_:1})]),_:1},8,["loading"])]),h("div",D,[(v(!0),f(w,null,k(de.value,e=>(v(),f("div",{key:e.rank,class:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-xl p-5 border border-gray-600 hover:border-yellow-500 hover:shadow-yellow-500/30 transition-all duration-300"},[h("div",H,[h("div",K,[h("span",q,y(e.rank),1)]),h("div",G,[(v(!0),f(w,null,k(e.students,e=>(v(),f("div",{key:e.id,class:"flex items-center gap-3 bg-black/50 rounded-lg px-4 py-3 backdrop-blur-sm"},[g(n,{size:"48px",class:"border-2 border-yellow-500/40"},{default:b(()=>[h("img",{src:e.avatar||xe(e.name)},null,8,X)]),_:2},1024),h("div",null,[h("div",Y,[h("span",Z,y(e.firstName),1),h("span",ee,y(e.lastName),1)]),h("div",le,y(e.total)+" pts",1)])]))),128))])])]))),128))])])]),_:1},512)):m("",!0)]),_:1})])):m("",!0)}},[["__scopeId","data-v-399c2f04"]]);export{te as default};
