import{o as e,Q as l,m as a,c as t,l as s,aP as i,b as r}from"./app-tFXAu5dG.js";import{f as u,a as o,o as d,N as c,J as n,O as y,b as v,I as h,K as x,W as f,V as p,y as g,F as m,R as b,Q as k,U as z}from"./vendor-nQjeLEvd.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";const S={class:"puzzle-container relative"},w={class:"controls absolute top-4 right-4 space-x-2"},_={class:"text-body1 mt-2"},M={class:"text-body2 mt-2"},C=["width","height"],V=["x1","x2","y2"],P=["cx","cy","fill","opacity","onClick","onDblclick"],I=["x1","y1","x2","y2","stroke"],N=["x1","y1","x2","y2"],j=["cx","cy","fill"],U=["cx","cy"],D=e({__name:"UserPuzzle",props:{imageUrl:{type:String,required:!1},width:{type:Number,default:800},height:{type:Number,default:800},solution:{type:Array,required:!1},gridSize:{type:Number,default:50}},setup(e){const D=e,J=u([]),O=u(!1),R=u(!0),q=u(null),A=u(!1),Q=u(0),E=u(0),F=e=>{const l=D.width/2;return l-(e-l)},K=o(()=>{const e=[];for(let l=D.gridSize;l<=D.width/2;l+=D.gridSize)for(let a=D.gridSize;a<D.height;a+=D.gridSize)e.push({x:l,y:a,side:"left",isInteractive:!0});for(let l=D.width/2+D.gridSize;l<D.width;l+=D.gridSize)for(let a=D.gridSize;a<D.height;a+=D.gridSize)e.push({x:l,y:a,side:"right",isInteractive:!1});return e}),W=o(()=>{const e=[];for(let l=0;l<J.value.length-1;l++)e.push({start:J.value[l],end:J.value[l+1],isValid:O.value&&B(J.value[l],J.value[l+1])});return e}),B=(e,l)=>D.solution.some((a,t)=>{if(t===D.solution.length-1)return!1;const s=D.solution[t+1];return Math.abs(a.x-e.x)<5&&Math.abs(a.y-e.y)<5&&Math.abs(s.x-l.x)<5&&Math.abs(s.y-l.y)<5||Math.abs(a.x-l.x)<5&&Math.abs(a.y-l.y)<5&&Math.abs(s.x-e.x)<5&&Math.abs(s.y-e.y)<5}),G=()=>{J.value=[],O.value=!1,A.value=!1},H=()=>{R.value=!R.value,G()},L=()=>{q.value={dots:[...J.value],lines:[...W.value]},localStorage.setItem("savedPuzzle",JSON.stringify(q.value)),R.value=!1,G()},T=e=>R.value?"right"===e.side?"#d1d5db":"#94a3b8":"#ef4444",X=e=>R.value?"right"===e.side?"0.3":"0.5":"0.7",Y=()=>{q.value&&(Q.value=J.value.filter(e=>q.value.dots.some(l=>Math.abs(l.x-e.x)<5&&Math.abs(l.y-e.y)<5)).length,E.value=q.value.dots.length,A.value=!0)};return d(()=>{(()=>{const e=localStorage.getItem("savedPuzzle");e&&(q.value=JSON.parse(e))})()}),(u,o)=>(n(),c("div",S,[y("div",w,[v(l,{color:R.value?"primary":"secondary",onClick:H},{default:x(()=>[f(p(R.value?"Create Puzzle":"Solve Puzzle"),1)]),_:1},8,["color"]),R.value?(n(),h(l,{key:0,color:"positive",onClick:L},{default:x(()=>o[1]||(o[1]=[f(" Save Puzzle ")])),_:1})):(n(),h(l,{key:1,color:"primary",onClick:Y},{default:x(()=>o[2]||(o[2]=[f(" Submit Answer ")])),_:1})),v(l,{color:"grey",onClick:G},{default:x(()=>o[3]||(o[3]=[f(" Reset ")])),_:1})]),v(r,{modelValue:A.value,"onUpdate:modelValue":o[0]||(o[0]=e=>A.value=e)},{default:x(()=>[v(a,{class:"p-4"},{default:x(()=>[v(t,null,{default:x(()=>[o[4]||(o[4]=y("div",{class:"text-h6"},"Results",-1)),y("div",_," Correct Dots: "+p(Q.value)+" / "+p(E.value),1),y("div",M," Score: "+p(Math.round(Q.value/E.value*100))+"% ",1)]),_:1}),v(s,{align:"right"},{default:x(()=>[g(v(l,{flat:"",label:"Close",color:"primary"},null,512),[[i]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(n(),c("svg",{class:"dots-overlay",width:e.width,height:e.height},[y("line",{x1:e.width/2,y1:0,x2:e.width/2,y2:e.height,stroke:"#2563eb","stroke-width":"2","stroke-dasharray":"4"},null,8,V),(n(!0),c(m,null,b(K.value,e=>(n(),c(m,{key:"grid-"+e.x+"-"+e.y},[R.value||"left"===e.side?(n(),c("circle",{key:0,cx:e.x,cy:e.y,r:"5",fill:T(e),opacity:X(e),class:z(["grid-point",{interactive:R.value||"left"===e.side}]),onClick:l=>(e=>{J.value.push({x:e.x,y:e.y,isValid:!1}),O.value=!1})(e),onDblclick:l=>(e=>{J.value.reduce((l,a,t)=>(a.x===e.x&&a.y===e.y&&l.push(t),l),[]).reverse().forEach(e=>{J.value.splice(e,1)}),O.value=!1})(e)},null,42,P)):k("",!0)],64))),128)),(n(!0),c(m,null,b(W.value,(e,l)=>(n(),c(m,{key:"line-"+l},[y("line",{x1:e.start.x,y1:e.start.y,x2:e.end.x,y2:e.end.y,stroke:e.isValid?"#22c55e":"#ef4444","stroke-width":"2"},null,8,I),y("line",{x1:F(e.start.x),y1:e.start.y,x2:F(e.end.x),y2:e.end.y,stroke:"#666","stroke-width":"2","stroke-dasharray":"4"},null,8,N)],64))),128)),(n(!0),c(m,null,b(J.value,(e,l)=>(n(),c(m,{key:"dot-"+l},[y("circle",{cx:e.x,cy:e.y,r:"6",fill:e.isValid?"#22c55e":"#ef4444",class:"user-dot"},null,8,j),y("circle",{cx:F(e.x),cy:e.y,r:"6",fill:"#666",class:"mirrored-dot",opacity:"0.6"},null,8,U)],64))),128))],8,C))]))}},[["__scopeId","data-v-ae20c152"]]);export{D as default};
