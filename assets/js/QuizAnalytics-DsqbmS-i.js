import{r as a,u as e,b as s,f as i,d as t,s as l,Q as n,t as c}from"./app-4gpSDtVV.js";import{Q as r}from"./QSpinnerDots-BRGXnI5e.js";import{Q as u}from"./QBtnToggle-Bt3oZt1M.js";import{Q as o}from"./QCircularProgress-BfppuIom.js";import{Q as d}from"./QBadge-6oS4ziQU.js";import{f as _,a as m,o as v,N as f,J as p,R as y,b as z,z as q,$ as g,V as h,K as b,F as x,Q as w,U as k,W as T,_ as Q,n as S}from"./vendor-BWKGNkNB.js";import{Q as j}from"./QuizStats-ZI-W14la.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const A={class:"quiz-analytics"},C={class:"quiz-analytics__header"},R={class:"quiz-analytics__header-content"},M={class:"quiz-analytics__title"},$={class:"quiz-analytics__header-actions"},H={key:0,class:"quiz-analytics__loading"},P={key:1,class:"quiz-analytics__content"},E={class:"quiz-analytics__overview"},I={class:"quiz-analytics__charts"},V={class:"quiz-analytics__chart"},D={class:"quiz-analytics__chart"},F={class:"quiz-analytics__questions-header"},L={class:"quiz-analytics__questions-list"},N={class:"quiz-analytics__question-info"},O={class:"quiz-analytics__question-number"},U=["innerHTML"],B={class:"quiz-analytics__question-stats"},K={class:"quiz-analytics__stat-item"},W={class:"text-caption"},J={class:"quiz-analytics__stat-item"},Y={class:"quiz-analytics__stat-value"},G={class:"quiz-analytics__stat-item"},X={class:"quiz-analytics__performers"},Z={class:"quiz-analytics__performers-list"},aa={class:"quiz-analytics__performer-rank"},ea={class:"quiz-analytics__performer-info"},sa={class:"quiz-analytics__performer-name"},ia={class:"quiz-analytics__performer-score"},ta={class:"quiz-analytics__performers-list"},la={class:"quiz-analytics__performer-info"},na={class:"quiz-analytics__performer-name"},ca={class:"quiz-analytics__performer-score"},ra=a({__name:"QuizAnalytics",props:{quizId:Number},setup(a){const ra=e(),ua=a,oa=_(!1),da=_({name:""}),_a=_({totalAttempts:0,avgScore:0,avgTime:0,completionRate:0,scoreTrend:0,completionTrend:0}),ma=_([]),va=_([]),fa=_([]),pa=_("difficulty"),ya=_(null),za=_(null),qa=m(()=>{const a=[...ma.value];switch(pa.value){case"success":return a.sort((a,e)=>a.success_rate-e.success_rate);case"time":return a.sort((a,e)=>e.avg_time-a.avg_time);default:const e={Easy:1,Medium:2,Hard:3};return a.sort((a,s)=>(e[s.difficulty]||2)-(e[a.difficulty]||2))}}),ga=()=>{console.log("Charts would be initialized here with Chart.js")},ha=a=>`${Math.floor(a/60)}:${String(a%60).padStart(2,"0")}`,ba=(a,e)=>{const s=a.replace(/<[^>]*>/g,"");return s.length>e?s.substring(0,e)+"...":s},xa=a=>a.split(" ").map(a=>a[0]).join("").toUpperCase().substring(0,2),wa=a=>["warning","grey-6","orange-8"][a]||"grey",ka=()=>{g.visit(`/quizzes/${ua.quizId}/preview`)},Ta=()=>{ra.notify({type:"info",message:"Exporting report...",icon:"download"})};return v(()=>{(async()=>{oa.value=!0;try{const a=await Q.get(`/api/quizzes/${ua.quizId}/analytics`);da.value=a.data.quiz,_a.value=a.data.analytics,ma.value=a.data.questions,va.value=a.data.topPerformers,fa.value=a.data.strugglingStudents,await S(),ga()}catch(a){console.error("Failed to load analytics:",a),da.value={name:"Sample Quiz"},_a.value={totalAttempts:156,avgScore:78,avgTime:1245,completionRate:92,scoreTrend:5,completionTrend:3},ma.value=[{id:1,question_text:"What is 2+2?",success_rate:95,avg_time:12,difficulty:"Easy"},{id:2,question_text:"Solve for x: 2x + 5 = 15",success_rate:72,avg_time:45,difficulty:"Medium"},{id:3,question_text:"Calculate the derivative of x²",success_rate:58,avg_time:67,difficulty:"Hard"}],va.value=[{id:1,name:"Ahmed Ali",score:98,time:890},{id:2,name:"Sara Mohamed",score:95,time:920},{id:3,name:"Omar Hassan",score:92,time:1050}],fa.value=[{id:4,name:"Fatima Ibrahim",score:45,attempts:3},{id:5,name:"Youssef Khaled",score:52,attempts:2}],await S(),ga()}finally{oa.value=!1}})()}),(a,e)=>(p(),f("div",A,[y("div",C,[z(s,{flat:"",round:"",icon:"arrow_back",onClick:e[0]||(e[0]=a=>q(g).visit("/quizzes"))}),y("div",R,[y("h1",M,h(da.value.name)+" - Analytics",1),e[2]||(e[2]=y("p",{class:"quiz-analytics__subtitle"},"Performance insights and statistics",-1))]),y("div",$,[z(s,{flat:"",label:"Export Report",icon:"download",onClick:Ta}),z(s,{unelevated:"",color:"primary",label:"View Quiz",icon:"visibility",onClick:ka})])]),oa.value?(p(),f("div",H,[z(r,{color:"primary",size:"50px"}),e[3]||(e[3]=y("p",null,"Loading analytics...",-1))])):(p(),f("div",P,[y("div",E,[z(j,{icon:"people",label:"Total Attempts",value:_a.value.totalAttempts,variant:"primary"},null,8,["value"]),z(j,{icon:"check_circle",label:"Avg. Score",value:`${_a.value.avgScore}%`,variant:"success",trend:_a.value.scoreTrend},null,8,["value","trend"]),z(j,{icon:"schedule",label:"Avg. Time",value:ha(_a.value.avgTime),variant:"info"},null,8,["value"]),z(j,{icon:"trending_up",label:"Completion Rate",value:`${_a.value.completionRate}%`,variant:"warning",trend:_a.value.completionTrend},null,8,["value","trend"])]),y("div",I,[z(t,{class:"quiz-analytics__chart-card"},{default:b(()=>[z(i,null,{default:b(()=>[e[4]||(e[4]=y("h3",null,"Score Distribution",-1)),y("div",V,[y("canvas",{ref_key:"scoreChartRef",ref:ya},null,512)])]),_:1})]),_:1}),z(t,{class:"quiz-analytics__chart-card"},{default:b(()=>[z(i,null,{default:b(()=>[e[5]||(e[5]=y("h3",null,"Performance Over Time",-1)),y("div",D,[y("canvas",{ref_key:"timeChartRef",ref:za},null,512)])]),_:1})]),_:1})]),z(t,{class:"quiz-analytics__questions-card"},{default:b(()=>[z(i,null,{default:b(()=>[y("div",F,[e[6]||(e[6]=y("h3",null,"Question Analysis",-1)),z(u,{modelValue:pa.value,"onUpdate:modelValue":e[1]||(e[1]=a=>pa.value=a),options:[{label:"Difficulty",value:"difficulty"},{label:"Success Rate",value:"success"},{label:"Time",value:"time"}],unelevated:"",dense:""},null,8,["modelValue"])]),y("div",L,[(p(!0),f(x,null,w(qa.value,(a,s)=>{return p(),f("div",{key:a.id,class:"quiz-analytics__question-item"},[y("div",N,[y("div",O,"Q"+h(s+1),1),y("div",{class:"quiz-analytics__question-text",innerHTML:ba(a.question_text,80)},null,8,U)]),y("div",B,[y("div",K,[z(o,{value:a.success_rate,size:"60px",thickness:.15,color:(t=a.success_rate,t>=80?"positive":t>=60?"warning":"negative"),"track-color":"grey-3","show-value":""},{default:b(()=>[y("div",W,h(a.success_rate)+"%",1)]),_:2},1032,["value","color"]),e[7]||(e[7]=y("span",{class:"text-caption"},"Success Rate",-1))]),y("div",J,[y("div",Y,h(a.avg_time)+"s",1),e[8]||(e[8]=y("span",{class:"text-caption"},"Avg. Time",-1))]),y("div",G,[z(d,{color:(i=a.difficulty,{Easy:"positive",Medium:"warning",Hard:"negative"}[i]||"info"),label:a.difficulty||"Medium"},null,8,["color","label"]),e[9]||(e[9]=y("span",{class:"text-caption"},"Difficulty",-1))])])]);var i,t}),128))])]),_:1})]),_:1}),y("div",X,[z(t,{class:"quiz-analytics__performers-card"},{default:b(()=>[z(i,null,{default:b(()=>[e[10]||(e[10]=y("h3",null,"Top Performers",-1)),y("div",Z,[(p(!0),f(x,null,w(va.value,(a,e)=>(p(),f("div",{key:a.id,class:"quiz-analytics__performer-item"},[y("div",aa,[y("div",{class:k(["quiz-analytics__rank-badge",`quiz-analytics__rank-badge--${e+1}`])},h(e+1),3)]),z(l,{size:"40px",color:"primary","text-color":"white"},{default:b(()=>[T(h(xa(a.name)),1)]),_:2},1024),y("div",ea,[y("div",sa,h(a.name),1),y("div",ia,h(a.score)+"% • "+h(ha(a.time)),1)]),z(n,{name:"emoji_events",color:wa(e),size:"24px"},null,8,["color"])]))),128))])]),_:1})]),_:1}),z(t,{class:"quiz-analytics__performers-card"},{default:b(()=>[z(i,null,{default:b(()=>[e[12]||(e[12]=y("h3",null,"Needs Attention",-1)),y("div",ta,[(p(!0),f(x,null,w(fa.value,a=>(p(),f("div",{key:a.id,class:"quiz-analytics__performer-item"},[z(l,{size:"40px",color:"warning","text-color":"white"},{default:b(()=>[T(h(xa(a.name)),1)]),_:2},1024),y("div",la,[y("div",na,h(a.name),1),y("div",ca,h(a.score)+"% • "+h(a.attempts)+" attempts",1)]),z(s,{flat:"",dense:"",round:"",icon:"message",size:"sm",onClick:e=>(a=>{ra.notify({type:"info",message:`Opening message to ${a.name}`,icon:"message"})})(a)},{default:b(()=>[z(c,null,{default:b(()=>e[11]||(e[11]=[T("Send Message")])),_:1})]),_:2},1032,["onClick"])]))),128))])]),_:1})]),_:1})])]))]))}},[["__scopeId","data-v-581e16a5"]]);export{ra as default};
