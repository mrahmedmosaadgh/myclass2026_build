import{Q as e}from"./QSelect-DIrzf0A1.js";import{o as l,u as t,c as a,Q as o,p as s,m as r,A as n}from"./app-CqJgtQaN.js";import i from"./html2canvas.esm-Cq3pa7K9.js";import d from"./CertificateGenerator-DbhSd2TB.js";import{f as c,o as u,k as p,a as f,M as m,Q as v,J as b,b as g,K as h,N as x,I as w,V as y,F as k,R as _,W as S,n as j,U as C}from"./vendor-DuKqz2x4.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./QSpace-1qvgFvrB.js";import"./QBar-dUcuj-Ci.js";import"./jspdf.es.min-BZKw8HNe.js";const z={key:0,class:"mb-6"},V={class:"mt-6 flex flex-col md:flex-row items-center justify-center gap-4 px-4"},T={class:"text-sm text-yellow-200 mt-3 font-bold tracking-widest uppercase opacity-80"},N={key:0,class:"text-center py-16"},A={key:1,class:"flex flex-col md:flex-row justify-center items-end gap-6 md:gap-10 min-h-[580px]"},U={class:"text-center mb-6"},I={key:0,class:"text-9xl animate-bounce-slow drop-shadow-2xl"},L={key:1,class:"text-8xl drop-shadow-2xl"},Q={class:"text-center pt-8 pb-4 relative z-10"},O={class:"text-4xl font-black italic tracking-wider text-white drop-shadow-2xl"},R={class:"px-4 pb-4 relative z-10"},W={class:"space-y-4"},B=["src"],F={class:"flex-1 min-w-0"},P={class:"font-black"},J={class:"shiny-name text-3xl md:text-4xl leading-tight block truncate"},E={class:"shiny-name-small block text-lg mt-1 opacity-95 truncate"},M={class:"text-yellow-300 font-bold text-lg mt-1"},$={class:"bg-gradient-to-b from-gray-800 to-gray-900 rounded-2xl p-6 border-2 border-gray-700"},D={class:"flex items-center justify-between mb-6"},G={class:"space-y-3"},H={class:"flex items-center gap-5"},K={class:"flex-shrink-0 w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center border-4 border-yellow-300 shadow-lg"},q={class:"text-white font-black text-2xl"},X={class:"flex-1 flex flex-wrap gap-4"},Y=["src"],Z={class:"font-bold text-lg"},ee={class:"shiny-name"},le={class:"shiny-name-small text-sm ml-1"},te={class:"text-yellow-300 text-sm font-semibold"},ae=l({__name:"TopLeaderboard",props:{students:{type:Array,default:()=>[]},studentBehaviors:{type:Object,default:()=>({})},periodCode:{type:String,default:""},date:{type:String,default:""}},setup(l){const ae=t(),oe=l,se=c({label:"Current Session",value:"session"}),re=c(5),ne=[{label:"Current Session",value:"session"},{label:"Today",value:"today"},{label:"This Week",value:"week"},{label:"All Time",value:"all"}];u(()=>{const e=localStorage.getItem("leaderboard_preferences");if(e)try{const l=JSON.parse(e),t=ne.find(e=>e.value===l.scope);t&&(se.value=t),l.topCount&&(re.value=l.topCount)}catch(l){console.error(l)}}),p([se,re],()=>{localStorage.setItem("leaderboard_preferences",JSON.stringify({scope:se.value.value,topCount:re.value}))},{deep:!0});const ie=f(()=>{if(!oe.students.length)return[];const e=oe.students.map(e=>{const l=oe.studentBehaviors[e.id]||{},t=(l.points_plus||0)-(l.points_minus||0);return{...e,total:t}}).filter(e=>e.total>0).sort((e,l)=>l.total-e.total);if(!e.length)return[];const l=[];let t={rank:1,total:e[0].total,students:[e[0]]};for(let a=1;a<e.length;a++)e[a].total===t.total?t.students.push(e[a]):(l.push(t),t={rank:l.length+1,total:e[a].total,students:[e[a]]});return l.push(t),l.slice(0,re.value)}),de=f(()=>ie.value.slice(0,3)),ce=f(()=>ie.value),ue=f(()=>{const e=de.value,l=e.find(e=>1===e.rank);return[e.find(e=>2===e.rank),l,e.find(e=>3===e.rank)].filter(Boolean)});function pe(){console.log("Filters applied")}function fe(){se.value=ne[0],re.value=5}function me(e){const l=["th","st","nd","rd"],t=e%100;return e+(l[(t-20)%10]||l[t]||l[0])}function ve(e){return 1===e?"bg-gradient-to-b from-yellow-400 via-yellow-500 to-yellow-700 border-yellow-300 shadow-yellow-500/70 ring-8 ring-yellow-400/40":2===e?"bg-gradient-to-b from-gray-300 via-gray-400 to-gray-600 border-gray-200 shadow-gray-500/50":3===e?"bg-gradient-to-b from-orange-400 via-orange-500 to-orange-700 border-orange-300 shadow-orange-500/50":""}const be=c(null),ge=c(!1);function he(){ge.value=!0,j(()=>{const e=be.value;return e?document.contains(e)?void i(e).then(e=>{const l=e.toDataURL("image/png");navigator.canShare&&navigator.canShare({files:[]})?fetch(l).then(e=>e.blob()).then(e=>{const l=new File([e],"leaderboard.png",{type:"image/png"});return navigator.share({files:[l],title:"Leaderboard"})}).then(()=>{ae.notify({message:"Shared successfully!",color:"positive"})}).catch(()=>{xe(l)}):xe(l)}).catch(e=>{console.error(e),ae.notify({message:"Screenshot failed",color:"negative"})}).finally(()=>{ge.value=!1}):(ae.notify({message:"Element not available for screenshot",color:"negative"}),void(ge.value=!1)):(ae.notify({message:"Leaderboard element not found",color:"negative"}),void(ge.value=!1))})}function xe(e){const l=document.createElement("a");l.href=e,l.download="leaderboard.png",l.click(),ae.notify({message:"Screenshot downloaded â€“ share on WhatsApp!",color:"positive",icon:"download"})}function we(e="S"){const l=e.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase();return`data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140"><rect width="140" height="140" fill="#1e293b"/><text x="70" y="70" dy="12" text-anchor="middle" font-size="60" font-family="Arial" font-weight="bold" fill="#cbd5e1">${l}</text></svg>`)}`}const ye=c(!1),ke=c(null);function _e(e){ke.value=e,ye.value=!0}return(t,i)=>l.students.length?(b(),m("div",z,[g(r,{class:"shadow-2xl rounded-3xl overflow-hidden bg-gray-900 border-4 border-yellow-500 relative"},{default:h(()=>[i[11]||(i[11]=x("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[x("div",{class:"stars"}),x("div",{class:"twinkling"})],-1)),g(a,{class:"relative z-10 text-center py-6 bg-gradient-to-b from-transparent to-black/50"},{default:h(()=>[i[3]||(i[3]=x("h1",{class:"text-4xl md:text-6xl font-black tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-500 drop-shadow-lg animate-shine"}," ðŸ† CHAMPIONS ðŸ† ",-1)),x("div",V,[g(e,{modelValue:se.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>se.value=e),pe],options:ne,outlined:"",dense:"",dark:"",label:"Filter Scope",class:"w-full md:w-48 bg-black/30"},null,8,["modelValue"]),g(e,{modelValue:re.value,"onUpdate:modelValue":[i[1]||(i[1]=e=>re.value=e),pe],options:[{label:"Top 5",value:5},{label:"Top 10",value:10}],outlined:"",dense:"",dark:"",label:"Show Places",class:"w-full md:w-32 bg-black/30","emit-value":"","map-options":""},null,8,["modelValue"]),g(o,{color:"yellow-7",icon:"refresh",label:"Reset",onClick:fe,size:"md",class:"w-full md:w-auto"})]),x("p",T,y(se.value.label)+" â€¢ Top "+y(re.value),1)]),_:1}),g(a,{class:"p-4 md:p-8 relative z-10"},{default:h(()=>[0===de.value.length?(b(),m("div",N,i[4]||(i[4]=[x("p",{class:"text-3xl text-yellow-400 font-bold animate-pulse"},"The arena is empty... Who will rise? âš”ï¸",-1)]))):(b(),m("div",A,[(b(!0),m(k,null,_(ue.value,(e,l)=>{return b(),m(k,{key:(null==e?void 0:e.rank)||l},[e?(b(),m("div",{key:0,class:C(["w-full md:w-1/3 flex flex-col transition-all duration-700 podium-card",[1===e.rank?"order-2 md:mb-32 z-30":2===e.rank?"order-1 md:mb-12 z-20":"order-3 z-20"]])},[x("div",U,[1===e.rank?(b(),m("div",I,"ðŸ‘‘")):(b(),m("div",L,y((t=e.rank,1===t?"ðŸ¥‡":2===t?"ðŸ¥ˆ":3===t?"ðŸ¥‰":"")),1))]),x("div",{class:C(["relative rounded-3xl overflow-hidden border-4 shadow-2xl backdrop-blur-xl flex flex-col mx-4 pb-6",ve(e.rank)])},[i[7]||(i[7]=x("div",{class:"absolute inset-0 bg-gradient-to-tr from-white/0 via-white/30 to-white/0 w-[200%] h-full animate-shine-move pointer-events-none"},null,-1)),x("div",Q,[x("h2",O,y(me(e.rank)),1),i[5]||(i[5]=x("div",{class:"h-1 w-32 mx-auto bg-white/40 rounded-full mt-3"},null,-1))]),x("div",R,[x("div",W,[(b(!0),m(k,null,_(e.students,e=>(b(),m("div",{key:e.id,class:"bg-black/70 rounded-2xl p-4 backdrop-blur-md border border-white/20 shadow-xl hover:border-yellow-400/50 transition-all flex items-center gap-4"},[g(n,{size:"80px",class:"ring-4 ring-yellow-400/60 shadow-xl border-2 flex-shrink-0"},{default:h(()=>[x("img",{src:e.avatar||we(e.name),class:"object-cover"},null,8,B)]),_:2},1024),x("div",F,[x("div",P,[x("span",J,y(e.firstName),1),x("span",E,y(e.lastName),1)]),x("div",M,y(e.total)+" pts",1)]),g(o,{flat:"",round:"",color:"white",icon:"card_membership",onClick:l=>_e(e)},{default:h(()=>[g(s,null,{default:h(()=>i[6]||(i[6]=[S("Print Certificate")])),_:1})]),_:2},1032,["onClick"])]))),128))])])],2)],2)):v("",!0)],64);var t}),128))]))]),_:1}),ce.value.length>0?(b(),w(a,{key:0,ref_key:"leaderboardList",ref:be,class:"p-4 md:p-8 pt-0 relative z-10"},{default:h(()=>[x("div",$,[x("div",D,[i[9]||(i[9]=x("h3",{class:"text-2xl font-bold text-yellow-400 text-center flex-1"},"ðŸ† Complete Leaderboard ðŸ†",-1)),g(o,{color:"green",icon:"screenshot",label:"Share",onClick:he,loading:ge.value,class:"shadow-lg"},{default:h(()=>[g(s,null,{default:h(()=>i[8]||(i[8]=[S("Capture & Share on WhatsApp")])),_:1})]),_:1},8,["loading"])]),x("div",G,[(b(!0),m(k,null,_(ce.value,e=>(b(),m("div",{key:e.rank,class:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-xl p-5 border border-gray-600 hover:border-yellow-500 hover:shadow-yellow-500/30 transition-all duration-300"},[x("div",H,[x("div",K,[x("span",q,y(e.rank),1)]),x("div",X,[(b(!0),m(k,null,_(e.students,e=>(b(),m("div",{key:e.id,class:"flex items-center gap-3 bg-black/50 rounded-lg px-4 py-3 backdrop-blur-sm"},[g(n,{size:"48px",class:"border-2 border-yellow-500/40"},{default:h(()=>[x("img",{src:e.avatar||we(e.name)},null,8,Y)]),_:2},1024),x("div",null,[x("div",Z,[x("span",ee,y(e.firstName),1),x("span",le,y(e.lastName),1)]),x("div",te,y(e.total)+" pts",1)]),g(o,{flat:"",round:"",dense:"",color:"yellow-500",icon:"card_membership",onClick:l=>_e(e)},{default:h(()=>[g(s,null,{default:h(()=>i[10]||(i[10]=[S("Print Certificate")])),_:1})]),_:2},1032,["onClick"])]))),128))])])]))),128))])])]),_:1},512)):v("",!0),g(d,{modelValue:ye.value,"onUpdate:modelValue":i[2]||(i[2]=e=>ye.value=e),student:ke.value,"default-date":l.date},null,8,["modelValue","student","default-date"])]),_:1})])):v("",!0)}},[["__scopeId","data-v-90d3b7e9"]]);export{ae as default};
