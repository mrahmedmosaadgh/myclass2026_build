import{D as e,a7 as a,ac as l,ap as t,aa as i,ad as n,aq as u,ae as s,ar as o,as as r,a9 as d,ag as c,C as p}from"./app-BwCflFkV.js";import{u as v,a as f,b as m}from"./use-file-DlZDX63w.js";import{f as b,a as g,h as y,p as C}from"./vendor-CUZ9QTQV.js";const h=e({name:"QFile",inheritAttrs:!1,props:{...t,...l,...f,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...a,...v],setup(e,{slots:a,emit:l,attrs:t}){const{proxy:v}=C(),f=i(),h=b(null),x=b(!1),V=n(e),{pickFiles:F,onDragover:j,onDragleave:S,processFiles:q,getDndNode:O}=m({editable:f.editable,dnd:x,getFileInput:I,addFilesToQueue:K}),A=u(e),D=g(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),_=g(()=>s(D.value)),k=g(()=>D.value.map(e=>e.name).join(", ")),L=g(()=>o(D.value.reduce((e,a)=>e+a.size,0))),N=g(()=>({totalSize:L.value,filesNumber:D.value.length,maxFiles:e.maxFiles})),$=g(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:V.value,...t,id:f.targetUid.value,disabled:!0!==f.editable.value})),Q=g(()=>"q-file q-field--auto-height"+(!0===x.value?" q-file--dnd":"")),R=g(()=>!0===e.multiple&&!0===e.append);function w(e){const a=D.value.slice();a.splice(e,1),z(a)}function z(a){l("update:modelValue",!0===e.multiple?a:a[0])}function B(e){13===e.keyCode&&c(e)}function E(e){13!==e.keyCode&&32!==e.keyCode||F(e)}function I(){return h.value}function K(a,l){const t=q(a,l,D.value,R.value),i=I();null!=i&&(i.value=""),void 0!==t&&((!0===e.multiple?e.modelValue&&t.every(e=>D.value.includes(e)):e.modelValue===t[0])||z(!0===R.value?D.value.concat(t):t))}function T(){return[y("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function U(){const a={ref:h,...$.value,...A.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:K};return!0===e.multiple&&(a.multiple=!0),y("input",a)}return Object.assign(f,{fieldClass:Q,emitValue:z,hasValue:_,inputRef:h,innerValue:D,floatingLabel:g(()=>!0===_.value||s(e.displayValue)),computedCounter:g(()=>{if(void 0!==e.counterLabel)return e.counterLabel(N.value);const a=e.maxFiles;return`${D.value.length}${void 0!==a?" / "+a:""} (${L.value})`}),getControlChild:()=>O("file"),getControl:()=>{const l={ref:f.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return!0===f.editable.value&&Object.assign(l,{onDragover:j,onDragleave:S,onKeydown:B,onKeyup:E}),y("div",l,[U()].concat(function(){if(void 0!==a.file)return 0===D.value.length?T():D.value.map((e,l)=>a.file({index:l,file:e,ref:this}));if(void 0!==a.selected)return 0===D.value.length?T():a.selected({files:D.value,ref:this});if(!0===e.useChips)return 0===D.value.length?T():D.value.map((a,l)=>y(p,{key:"file-"+l,removable:f.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{w(l)}},()=>y("span",{class:"ellipsis",textContent:a.name})));const l=void 0!==e.displayValue?e.displayValue:k.value;return 0!==l.length?[y("div",{class:e.inputClass,style:e.inputStyle,textContent:l})]:T()}()))}}),Object.assign(v,{removeAtIndex:w,removeFile:function(e){const a=D.value.indexOf(e);-1!==a&&w(a)},getNativeElement:()=>h.value}),r(v,"nativeEl",()=>h.value),d(f)}});export{h as Q};
