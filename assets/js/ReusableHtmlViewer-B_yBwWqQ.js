import e from"./purify.es-C2Ba6vpb.js";import t from"./EditorToolbar-BDTi8Xgw.js";import a from"./EditorContent-DBjw4Ld8.js";import n from"./PrintLayout-qNVTJQoM.js";import{p as i}from"./app-BXm70mdJ.js";import{f as l,a as o,k as r,L as m,I as s,b as u}from"./vendor-DNM7Y6Xn.js";import"./TitleInput-d_dt1zKz.js";import"./TextFormatControls-BfjTZEdz.js";import"./underline-BaO36zfI.js";import"./createLucideIcon-DNsKNLPq.js";import"./LineSpacingControl-Cg7MRML_.js";import"./AlignmentControls-Bl46Lv0m.js";import"./align-right-BV65b6MB.js";import"./ImageControls-BnoLYhaJ.js";import"./image-D9BEVhOC.js";import"./PrintButton-BEovC59w.js";import"./printer-DEjU2fo9.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";const d={class:"relative bg-white"},p=i({__name:"ReusableHtmlViewer",props:{modelValue:{type:String,required:!0},title:{type:String,default:"Document"}},emits:["update:modelValue"],setup(i,{emit:p}){const g=i,c=p,v=l(g.title),f=l(null),b=l(null),h=l(1.5),y=l("left"),j=l("inline-block"),w=l(100),C=l([]),I=[5,10,15,20,25,33,50,75,100,110,120,150,200,300],T=o(()=>e.sanitize(g.modelValue)),V=o(()=>["bold","italic","underline"].filter(e=>document.queryCommandState(e))),_=e=>{document.execCommand(e,!1,null)},L=e=>{"IMG"===e.target.tagName&&(C.value=[e.target])},$=()=>{C.value.length&&C.value.forEach(e=>{e.style.width=`${w.value}%`})},k=()=>{const e=window.open("","_blank"),t=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <title>${v.value}</title>\n            <style>\n                @page {\n                    margin: 1cm;\n                    size: A4;\n                }\n                body {\n                    font-family: system-ui, -apple-system, sans-serif;\n                    line-height: ${h.value};\n                    margin: 0;\n                    padding: 1cm;\n                    text-align: ${y.value};\n                }\n                .prose {\n                    max-width: none;\n                }\n                .prose img {\n                    max-width: 100%;\n                    height: auto;\n                    page-break-inside: avoid;\n                }\n                @media print {\n                    html, body {\n                        width: 210mm;\n                        height: 297mm;\n                    }\n                }\n            </style>\n        </head>\n        <body>\n            ${T.value}\n        </body>\n        </html>\n    `;e.document.write(t),e.document.close(),e.onload=()=>{e.print(),e.onafterprint=()=>{e.close()}}},U=async()=>{if(!b.value)return;const t=b.value.$el||b.value,a=t.getElementsByTagName("img"),n=Array.from(a).map(async e=>{if(!e.src.startsWith("data:"))try{const t=await fetch(e.src),a=await t.blob(),n=await(e=>new Promise((t,a)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=a,n.readAsDataURL(e)}))(a);e.src=n}catch(t){console.error("Failed to convert image to base64:",t)}});await Promise.all(n),(t=>{const a=t.target.innerHTML,n=e.sanitize(a);c("update:modelValue",n)})({target:t})};return r(()=>g.modelValue,t=>{b.value&&b.value.innerHTML!==t&&(b.value.innerHTML=e.sanitize(t))}),(e,l)=>(s(),m("div",d,[u(t,{title:v.value,"onUpdate:title":l[0]||(l[0]=e=>v.value=e),"line-spacing":h.value,"onUpdate:lineSpacing":l[1]||(l[1]=e=>h.value=e),alignment:y.value,"onUpdate:alignment":l[2]||(l[2]=e=>y.value=e),"image-display-mode":j.value,"onUpdate:imageDisplayMode":l[3]||(l[3]=e=>j.value=e),"image-width":w.value,"onUpdate:imageWidth":l[4]||(l[4]=e=>w.value=e),"active-formats":V.value,"image-sizes":I,onFormat:_,onConvertImagesToBase64:U,onResizeImages:$,onPrint:k},null,8,["title","line-spacing","alignment","image-display-mode","image-width","active-formats"]),u(a,{"model-value":i.modelValue,"line-spacing":h.value,alignment:y.value,"onUpdate:modelValue":l[5]||(l[5]=e=>c("update:modelValue",e)),onImageClick:L,ref_key:"editableContent",ref:b},null,8,["model-value","line-spacing","alignment"]),u(n,{ref_key:"printContainer",ref:f,content:T.value,"line-spacing":h.value,alignment:y.value},null,8,["content","line-spacing","alignment"])]))}},[["__scopeId","data-v-98ba914f"]]);export{p as default};
