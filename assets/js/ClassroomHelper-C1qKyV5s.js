import{Q as e}from"./QBtnToggle-iboNob1y.js";import{u as t,f as a,b as l,t as s,G as o,s as r,Q as i,i as n,m as d,d as c,c as u,h as m,o as p,e as v,k as g,l as f,j as b,aS as h,R as _}from"./app-DlLesFGi.js";import{Q as y}from"./QTd-BU_S4ffH.js";import{a as k,Q as x}from"./QTable-BIAJAIui.js";import{Q as w}from"./QBadge-IdEcTs8C.js";import{Q as V}from"./QSelect-BTh0khse.js";import{f as C,r as S,k as T,a as U,o as j,N as A,J as O,R as B,b as L,K as D,O as z,I,F as q,Q as P,V as Q,W as N,U as M,y as R,a2 as E,_ as $}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./QMarkupTable-CzIo4GGA.js";import"./QLinearProgress-CX6G9yBK.js";import"./use-fullscreen-BQHoXYBI.js";import"./rtl-Cr6c3OOr.js";const W={class:"q-pa-md"},F={class:"row q-mb-md flex-center"},J={class:"col-12 col-md-6 flex justify-center"},H={key:0,class:"flex justify-between items-center q-pa-sm bg-blue-50 border-b border-blue-100"},K={class:"flex items-center gap-3"},G=["src"],X={class:"font-bold"},Y={class:"row justify-center q-gutter-xs"},Z={class:"flex gap-2 justify-center"},ee={class:"row justify-center q-gutter-xs"},te={class:"flex gap-2 justify-center"},ae={class:"flex items-center gap-3"},le=["src"],se={class:"font-bold"},oe={class:"flex gap-1 flex-wrap"},re={class:"flex gap-1 flex-wrap"},ie={class:"flex justify-end gap-2 items-center"},ne={key:0,class:"flex gap-1 mr-2 opacity-50"},de={key:3},ce={class:"row q-col-gutter-md q-mb-md"},ue={class:"col-12 col-md-8"},me={class:"bg-orange-50 p-4 rounded-xl border border-orange-200 flex items-center justify-between"},pe={class:"flex items-center gap-4"},ve={class:"text-h6 text-orange-900"},ge={class:"flex gap-2"},fe=["src"],be={class:"flex items-center gap-2"},he={key:0,class:"mb-6"},_e={class:"text-h6 text-blue-900 mb-2 flex items-center gap-2"},ye=["src"],ke={class:"flex gap-2"},xe={key:1,class:"text-center p-8 text-grey-5 border-2 border-dashed border-gray-200 rounded-xl mb-8"},we={key:2,class:"flex justify-center mb-8"},Ve={key:3,class:"mt-8"},Ce={class:"text-h6 text-grey-8 mb-2 flex items-center gap-2"},Se={class:"flex items-center gap-3"},Te=["src"],Ue={class:"font-medium"},je={class:"text-xs"},Ae={key:4},Oe={class:"row q-col-gutter-md"},Be={class:"col-12 col-md-8"},Le={class:"flex items-center gap-3"},De=["src"],ze={class:"font-bold"},Ie={class:"col-12 col-md-4"},qe={class:"text-h6 flex items-center gap-2"},Pe={class:"text-subtitle2 mt-1"},Qe={key:0,class:"flex flex-col gap-2"},Ne=["src"],Me={class:"font-medium"},Re={key:1,class:"text-center text-green-700 py-4 italic"},Ee={class:"text-subtitle2 text-grey"},$e={class:"flex justify-center mb-4"},We={class:"row items-center no-wrap"},Fe={class:"row items-center no-wrap"},Je={class:"mt-3"},He={class:"flex gap-1 flex-wrap"},Ke={class:"text-subtitle2 text-grey"},Ge={key:0,class:"bg-red-50 text-red-700 p-2 rounded mt-2 text-sm border border-red-200"},Xe={class:"d-flex flex-col gap-2"},Ye={key:1},Ze=["src"],et={class:"row q-col-gutter-md"},tt={class:"col-12 col-md-6"},at={class:"col-12 col-md-6"},lt={__name:"ClassroomHelper",props:{students:Array,studentBehaviors:Object,studentAttendance:Object,periodInfo:Object},setup(lt){const st=lt,ot=t(),rt=C("academic"),it=[{name:"student",label:"Student",align:"left",field:"name"},{name:"attendance",label:"Attendance",align:"center"},{name:"materials",label:"Materials Readiness",align:"center"},{name:"tasks",label:"Tasks Readiness",align:"center"}],nt=[{name:"student",label:"Student",align:"left",field:"name",sortable:!0},{name:"pos",label:"Pos (+)",align:"center",field:e=>Pt(e.id).pos,sortable:!0},{name:"pos_detail",label:"Positive List",align:"left",field:e=>Pt(e.id).posList,headerStyle:"width: 200px"},{name:"neg",label:"Neg (-)",align:"center",field:e=>Pt(e.id).neg,sortable:!0},{name:"neg_detail",label:"Negative List",align:"left",field:e=>Pt(e.id).negList,headerStyle:"width: 200px"},{name:"total",label:"Total",align:"center",field:e=>Pt(e.id).total,sortable:!0},{name:"action",label:"Action",align:"right"}],dt=[{name:"leave_order",label:"Order",align:"center",field:e=>Dt(e.id),sortable:!0},{name:"student",label:"Student",align:"left",field:"name",sortable:!0},{name:"times_left",label:"Total Sorties",align:"center",field:e=>Bt(e.id),sortable:!0},{name:"last_out",label:"Last Time Out",align:"left",field:e=>zt(e.id),sort:(e,t,a,l)=>Lt(a.id)-Lt(l.id),sortable:!0},{name:"duration",label:"Time Stayed",align:"center",field:e=>qt(e.id),format:(e,t)=>It(t.id),sortable:!0},{name:"action",label:"Action",align:"center"}],ct=[{name:"student",label:"Student",align:"left",field:"name"},{name:"mark",label:"Attendance",align:"center"}],ut=e=>e?e.avatar?e.avatar.startsWith("/")?e.avatar:`/${e.avatar}`:"/images/avatars/default-avatar.svg":"",mt=e=>!st.studentAttendance||st.studentAttendance[e],pt=S({});T(()=>st.studentAttendance,e=>{e&&st.students.forEach(t=>{pt[t.id]=!1!==e[t.id]})},{immediate:!0,deep:!0});const vt=U(()=>st.students.filter(e=>!pt[e.id])),gt=U(()=>vt.value.length),ft=C(!1),bt=C(""),ht=C(""),_t=S({materials:["Pen","Book","Notebook"],tasks:["Homework","Classwork"]}),yt=e=>{const t="materials"===e?bt.value:ht.value;t.trim()&&("materials"===e?(_t.materials.includes(t)||_t.materials.push(t),bt.value=""):(_t.tasks.includes(t)||_t.tasks.push(t),ht.value=""),xt())},kt=(e,t)=>{"materials"===e?_t.materials.splice(t,1):_t.tasks.splice(t,1),xt()},xt=()=>{localStorage.setItem("academicConfig",JSON.stringify(_t))},wt=e=>{const t=st.studentBehaviors[e];return t&&t.academic_tracker?(t.academic_tracker.materials||(t.academic_tracker.materials={}),t.academic_tracker.tasks||(t.academic_tracker.tasks={}),t.academic_tracker):(t&&!t.academic_tracker&&(t.academic_tracker={materials:{},tasks:{}}),t?t.academic_tracker:{materials:{},tasks:{}})},Vt=e=>{const t=st.studentBehaviors[e];return t&&!t.behavior_tracker&&(t.behavior_tracker=[]),t?t.behavior_tracker:[]},Ct=C(1),St=C(5),Tt=C(Date.now()),Ut=C(!1),jt=C(""),At=U(()=>{if(!jt.value)return st.students;const e=jt.value.toLowerCase();return st.students.filter(t=>t.name.toLowerCase().includes(e))});j(()=>{setInterval(()=>{Tt.value=Date.now()},1e3)});const Ot=e=>{const t=st.studentBehaviors[e];if(t&&!t.logistics_tracker)t.logistics_tracker={status:"in",current:null,history:[]};else if(t&&t.logistics_tracker&&!t.logistics_tracker.history){const e=t.logistics_tracker;t.logistics_tracker={status:e.status||"in",current:"out"===e.status?{reason:e.reason,timestamp:e.timestamp}:null,history:[]}}return t?t.logistics_tracker:{status:"in",current:null,history:[]}},Bt=e=>{const t=Ot(e);return t.history?t.history.length:0},Lt=e=>{const t=Ot(e);if(!t.history||0===t.history.length)return 0;const a=t.history[0],l=a.out_time||a.timestamp;return new Date(l).getTime()},Dt=e=>{const t=Qt.value.map(e=>({id:e.id,ts:Lt(e.id)}));t.sort((e,t)=>e.ts-t.ts);return t.findIndex(t=>t.id===e)+1},zt=e=>{const t=Ot(e);if(!t.history||0===t.history.length)return"-";const a=t.history[0];if(!a.timestamp&&!a.out_time)return"-";const l=a.out_time||a.timestamp;return new Date(l).toLocaleString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},It=e=>{const t=Ot(e);if(!t.history||0===t.history.length)return"-";const a=t.history[0],l=a.out_time||a.timestamp,s=a.in_time;if(!l||!s)return"-";const o=Math.floor((new Date(s).getTime()-new Date(l).getTime())/1e3);if(o<0)return"-";return`${Math.floor(o/60).toString().padStart(2,"0")}:${(o%60).toString().padStart(2,"0")}`},qt=e=>{const t=Ot(e);if(!t.history||0===t.history.length)return 0;const a=t.history[0],l=a.out_time||a.timestamp,s=a.in_time;return l&&s?Math.floor((new Date(s).getTime()-new Date(l).getTime())/1e3):0},Pt=e=>{const t=Vt(e);let a=0,l=0;const s=[],o=[];return t.forEach(e=>{"positive"===e.type?(a++,s.push(e.note)):(l++,o.push(e.note))}),{pos:a,neg:l,total:a-l,posList:s,negList:o}},Qt=U(()=>st.students?st.students.filter(e=>{const t=Ot(e.id);return t.history&&t.history.length>0&&"in"===t.status}):[]),Nt=U(()=>st.students?st.students.filter(e=>{const t=Ot(e.id);return t&&"out"===t.status}):[]),Mt=U(()=>st.students?st.students.filter(e=>{const t=Ot(e.id);return t&&"waiting"===t.status}).sort((e,t)=>{var a,l;const s=null==(a=Ot(e.id).current)?void 0:a.timestamp,o=null==(l=Ot(t.id).current)?void 0:l.timestamp;return s?o?new Date(s)-new Date(o):-1:1}):[]),Rt=U(()=>Nt.value.length>=Ct.value),Et=U(()=>Mt.value.length>=St.value),$t=e=>{var t;const a=Ot(e),l=(null==(t=a.current)?void 0:t.timestamp)||a.timestamp;if(!a||"out"!==a.status||!l)return"00:00";const s=new Date(l).getTime(),o=Math.floor((Tt.value-s)/1e3);if(o<0)return"00:00";return`${Math.floor(o/60).toString().padStart(2,"0")}:${(o%60).toString().padStart(2,"0")}`},Wt=async(e,t)=>{const a=st.studentBehaviors[t];if(!a)return;let l=null;"academic_tracker"===e&&(l=a.academic_tracker),"behavior_tracker"===e&&(l=a.behavior_tracker),"logistics_tracker"===e&&(l=a.logistics_tracker);try{await $.post("/api/student-behaviors/update-tracker",{student_id:t,tracker_type:e,data:l,date:st.periodInfo.date,period_code:st.periodInfo.periodCode,classroom_id:st.periodInfo.classroomId}),console.log(`Saved ${e} for student ${t}`)}catch(s){console.error("Failed to save tracker:",s),ot.notify({message:"Failed to save change",color:"negative",icon:"error"})}},Ft=async(e,t)=>{const a="materials"===e?_t.materials:_t.tasks,l=[];if(st.students.forEach(s=>{if(!mt(s.id))return;const o=wt(s.id),r="materials"===e?o.materials:o.tasks;let i=!1;a.forEach(e=>{r[e]!==t&&(r[e]=t,i=!0)}),i&&l.push(Wt("academic_tracker",s.id))}),l.length>0){ot.loading.show({message:`Updating ${l.length} students...`});try{await Promise.all(l),ot.notify({type:"positive",message:"Bulk update completed"})}catch(s){console.error(s),ot.notify({type:"negative",message:"Some updates failed"})}finally{ot.loading.hide()}}else ot.notify({type:"info",message:"No changes needed"})},Jt=C(!1),Ht=C(null),Kt=C(""),Gt=C("negative"),Xt=C([]),Yt=["Disruptive","No Homework","Talking","Late","Sleeping","Disrespectful"],Zt=U(()=>[...new Set([...Yt,...Xt.value])]),ea=()=>{if(!Ht.value||!Kt.value)return;const e=Ht.value.id,t=st.studentBehaviors[e];t.behavior_tracker||(t.behavior_tracker=[]);const a={note:Kt.value,type:Gt.value,timestamp:(new Date).toISOString()};t.behavior_tracker.unshift(a),Wt("behavior_tracker",e);const l=Kt.value.split(",").map(e=>e.trim()).filter(e=>e.length>0);let s=!1;l.forEach(e=>{e.length<20&&!Yt.includes(e)&&!Xt.value.includes(e)&&(Xt.value.push(e),s=!0)}),s&&localStorage.setItem("customBehaviorTags",JSON.stringify(Xt.value)),Jt.value=!1,ot.notify({type:"positive",message:"Behavior logged"})};j(()=>{const e=localStorage.getItem("customBehaviorTags");if(e)try{Xt.value=JSON.parse(e)}catch(a){console.error("Failed to parse behavior tags",a)}const t=localStorage.getItem("academicConfig");if(t)try{const e=JSON.parse(t);_t.materials=e.materials||[],_t.tasks=e.tasks||[]}catch(a){console.error("Failed to parse academic config",a)}});const ta=C(!1),aa=()=>{ot.dialog({title:"Reset Session",message:"Are you sure you want to clear all logistics history? This cannot be undone.",cancel:!0,persistent:!0}).onOk(()=>{st.students.forEach(e=>{const t=st.studentBehaviors[e.id];t&&t.logistics_tracker&&("out"===t.logistics_tracker.status||t.logistics_tracker.history&&t.logistics_tracker.history.length>0)&&(t.logistics_tracker={status:"in",current:null,history:[]},Wt("logistics_tracker",e.id))}),ot.notify({type:"positive",message:"Session Reset"})})},la=e=>{if(!Ht.value)return;const t=Ht.value.id;if("Urgent Override"!==e)return Et.value?(ot.notify({message:"Waitlist is full!",color:"negative",icon:"hourglass_disabled"}),void(ta.value=!1)):void sa(t,e);const a=st.studentBehaviors[t];let l=Ot(t);a.logistics_tracker={status:"out",current:{reason:e,timestamp:(new Date).toISOString()},history:l.history||[]},Wt("logistics_tracker",t),ta.value=!1},sa=(e,t)=>{const a=st.studentBehaviors[e];let l=Ot(e);a.logistics_tracker={status:"waiting",current:{reason:t,timestamp:(new Date).toISOString()},history:l.history||[]},Wt("logistics_tracker",e),ta.value=!1,ot.notify({message:"Added to Waiting List",color:"orange",icon:"hourglass_empty"})};return(t,C)=>(O(),A("div",W,[B("div",F,[B("div",J,[L(e,{modelValue:rt.value,"onUpdate:modelValue":C[0]||(C[0]=e=>rt.value=e),push:"",glossy:"","toggle-color":"primary",options:[{label:"Academic Tracker",value:"academic",icon:"school"},{label:"Behavior Tracker",value:"behavior",icon:"psychology"},{label:"Logistics Tracker",value:"logistics",icon:"swap_horiz"},{label:"Attendance Helper",value:"attendance",icon:"assignment_ind"}]},null,8,["modelValue"])])]),L(c,{class:"shadow-sm border border-gray-200"},{default:D(()=>[L(a,{class:"q-pa-none"},{default:D(()=>{var e;return["academic"===rt.value?(O(),A("div",H,[C[24]||(C[24]=B("div",{class:"text-subtitle1 text-blue-900 font-bold ml-2"},"Academic Goals",-1)),L(l,{flat:"",icon:"settings",label:"Configure Columns",color:"primary",size:"sm",onClick:C[1]||(C[1]=e=>ft.value=!0)})])):z("",!0),"academic"===rt.value?(O(),I(x,{key:1,rows:lt.students,columns:it,"row-key":"id",flat:"",bordered:"",pagination:{rowsPerPage:0},"hide-bottom":""},{"body-cell-student":D(e=>[L(y,{props:e},{default:D(()=>[B("div",K,[L(r,{size:"md"},{default:D(()=>[B("img",{src:ut(e.row)},null,8,G)]),_:2},1024),B("div",X,Q(e.row.name),1)])]),_:2},1032,["props"])]),"body-cell-attendance":D(e=>[L(y,{props:e,class:"text-center"},{default:D(()=>[L(o,{color:mt(e.row.id)?"green-1":"red-1","text-color":mt(e.row.id)?"green-9":"red-9",dense:"",square:""},{default:D(()=>[N(Q(mt(e.row.id)?"Present":"Absent"),1)]),_:2},1032,["color","text-color"])]),_:2},1032,["props"])]),"header-cell-materials":D(e=>[L(k,{props:e},{default:D(()=>[B("div",null,Q(e.col.label),1),B("div",Y,[L(l,{flat:"",round:"",dense:"",icon:"done_all",color:"positive",size:"sm",onClick:C[2]||(C[2]=e=>Ft("materials",!0))},{default:D(()=>[L(s,null,{default:D(()=>C[25]||(C[25]=[N("Check All Materials")])),_:1})]),_:1}),L(l,{flat:"",round:"",dense:"",icon:"remove_done",color:"negative",size:"sm",onClick:C[3]||(C[3]=e=>Ft("materials",!1))},{default:D(()=>[L(s,null,{default:D(()=>C[26]||(C[26]=[N("Uncheck All Materials")])),_:1})]),_:1})])]),_:2},1032,["props"])]),"body-cell-materials":D(e=>[L(y,{props:e},{default:D(()=>[B("div",Z,[(O(!0),A(q,null,P(_t.materials,t=>(O(),I(d,{key:t,modelValue:wt(e.row.id).materials[t],"onUpdate:modelValue":[a=>wt(e.row.id).materials[t]=a,t=>Wt("academic_tracker",e.row.id)],dense:"",color:"blue",label:t,disable:!mt(e.row.id)},null,8,["modelValue","onUpdate:modelValue","label","disable"]))),128))])]),_:2},1032,["props"])]),"header-cell-tasks":D(e=>[L(k,{props:e},{default:D(()=>[B("div",null,Q(e.col.label),1),B("div",ee,[L(l,{flat:"",round:"",dense:"",icon:"done_all",color:"positive",size:"sm",onClick:C[4]||(C[4]=e=>Ft("tasks",!0))},{default:D(()=>[L(s,null,{default:D(()=>C[27]||(C[27]=[N("Check All Tasks")])),_:1})]),_:1}),L(l,{flat:"",round:"",dense:"",icon:"remove_done",color:"negative",size:"sm",onClick:C[5]||(C[5]=e=>Ft("tasks",!1))},{default:D(()=>[L(s,null,{default:D(()=>C[28]||(C[28]=[N("Uncheck All Tasks")])),_:1})]),_:1})])]),_:2},1032,["props"])]),"body-cell-tasks":D(e=>[L(y,{props:e},{default:D(()=>[B("div",te,[(O(!0),A(q,null,P(_t.tasks,t=>(O(),I(d,{key:t,modelValue:wt(e.row.id).tasks[t],"onUpdate:modelValue":[a=>wt(e.row.id).tasks[t]=a,t=>Wt("academic_tracker",e.row.id)],dense:"",color:"blue",label:t,disable:!mt(e.row.id)},null,8,["modelValue","onUpdate:modelValue","label","disable"]))),128))])]),_:2},1032,["props"])]),_:1},8,["rows"])):z("",!0),"behavior"===rt.value?(O(),I(x,{key:2,rows:lt.students,columns:nt,"row-key":"id",flat:"",bordered:"",pagination:{rowsPerPage:0},"hide-bottom":""},{"body-cell-student":D(e=>[L(y,{props:e},{default:D(()=>[B("div",ae,[L(r,{size:"md"},{default:D(()=>[B("img",{src:ut(e.row)},null,8,le)]),_:2},1024),B("div",se,Q(e.row.name),1)])]),_:2},1032,["props"])]),"body-cell-pos":D(e=>[L(y,{props:e,class:"text-center font-bold text-green-700"},{default:D(()=>[N(Q(e.value>0?"+"+e.value:"-"),1)]),_:2},1032,["props"])]),"body-cell-pos_detail":D(e=>[L(y,{props:e},{default:D(()=>[B("div",oe,[(O(!0),A(q,null,P(e.value,(e,t)=>(O(),I(w,{key:t,color:"green-1","text-color":"green-9"},{default:D(()=>[N(Q(e),1)]),_:2},1024))),128))])]),_:2},1032,["props"])]),"body-cell-neg":D(e=>[L(y,{props:e,class:"text-center font-bold text-red-700"},{default:D(()=>[N(Q(e.value>0?"-"+e.value:"-"),1)]),_:2},1032,["props"])]),"body-cell-neg_detail":D(e=>[L(y,{props:e},{default:D(()=>[B("div",re,[(O(!0),A(q,null,P(e.value,(e,t)=>(O(),I(w,{key:t,color:"red-1","text-color":"red-9"},{default:D(()=>[N(Q(e),1)]),_:2},1024))),128))])]),_:2},1032,["props"])]),"body-cell-total":D(e=>[L(y,{props:e,class:M(["text-center font-bold",e.value>0?"text-green-700":e.value<0?"text-red-700":"text-grey-7"])},{default:D(()=>[N(Q(e.value>0?"+"+e.value:e.value),1)]),_:2},1032,["props","class"])]),"body-cell-action":D(e=>[L(y,{props:e,class:"text-right"},{default:D(()=>[B("div",ie,[Vt(e.row.id).length>0?(O(),A("div",ne,[(O(!0),A(q,null,P(Vt(e.row.id).slice(0,3),(e,t)=>(O(),A("div",{key:t,class:M(["w-2 h-2 rounded-full","positive"===e.type?"bg-green-500":"bg-red-500"])},null,2))),128))])):z("",!0),L(l,{icon:"add_comment",label:"Log",color:"primary",size:"sm",onClick:t=>{return a=e.row,Ht.value=a,Kt.value="",Gt.value="negative",void(Jt.value=!0);var a},disable:!mt(e.row.id)},null,8,["onClick","disable"])])]),_:2},1032,["props"])]),_:1},8,["rows"])):z("",!0),"logistics"===rt.value?(O(),A("div",de,[B("div",ce,[B("div",ue,[B("div",me,[B("div",pe,[B("div",ve,[L(i,{name:"timelapse"}),N(" Outside: "+Q((null==(e=Nt.value)?void 0:e.length)||0)+" / "+Q(Ct.value),1)]),B("div",ge,[(O(!0),A(q,null,P(Nt.value,e=>(O(),I(o,{key:e.id,removable:"",onRemove:t=>(e=>{const t=st.studentBehaviors[e];let a=Ot(e),l=[...a.history||[]];"out"===a.status&&a.current&&l.unshift({...a.current,out_time:a.current.timestamp,in_time:(new Date).toISOString()}),"out"===a.status&&!a.current&&a.timestamp&&l.unshift({reason:a.reason,out_time:a.timestamp,in_time:(new Date).toISOString()}),t.logistics_tracker={status:"in",current:null,history:l},Wt("logistics_tracker",e)})(e.id),color:"white","text-color":"orange-9",class:"border border-orange-300"},{default:D(()=>[L(r,null,{default:D(()=>[B("img",{src:ut(e)},null,8,fe)]),_:2},1024),N(" "+Q(e.name)+" ",1),L(w,{color:"orange",floating:"",transparent:"",class:"text-xs font-mono"},{default:D(()=>[N(Q($t(e.id)),1)]),_:2},1024)]),_:2},1032,["onRemove"]))),128))])]),B("div",be,[C[30]||(C[30]=B("span",{class:"text-orange-900 text-sm font-bold"},"Max Out:",-1)),L(V,{modelValue:Ct.value,"onUpdate:modelValue":C[6]||(C[6]=e=>Ct.value=e),options:[1,2,3,4,5],dense:"",outlined:"","options-dense":"","bg-color":"white",class:"w-20"},null,8,["modelValue"]),C[31]||(C[31]=B("span",{class:"text-blue-900 text-sm font-bold ml-2"},"Max Wait:",-1)),L(V,{modelValue:St.value,"onUpdate:modelValue":C[7]||(C[7]=e=>St.value=e),options:[1,2,3,4,5,6,7,8,9,10],dense:"",outlined:"","options-dense":"","bg-color":"white",class:"w-20"},null,8,["modelValue"]),L(l,{icon:"restart_alt",color:"negative",flat:"",round:"",dense:"",onClick:aa},{default:D(()=>[L(s,null,{default:D(()=>C[29]||(C[29]=[N("Reset Logistics Session")])),_:1})]),_:1})])])])]),Mt.value.length>0?(O(),A("div",he,[B("div",_e,[L(i,{name:"hourglass_empty"}),N(" Waiting Queue ("+Q(Mt.value.length)+" / "+Q(St.value)+") ",1)]),L(n,{bordered:"",separator:"",class:"rounded-borders bg-blue-50 border-blue-200"},{default:D(()=>[(O(!0),A(q,null,P(Mt.value,(e,t)=>(O(),I(b,{key:e.id},{default:D(()=>[L(g,{avatar:""},{default:D(()=>[L(r,null,{default:D(()=>[B("img",{src:ut(e)},null,8,ye)]),_:2},1024)]),_:2},1024),L(g,null,{default:D(()=>[L(f,{class:"font-bold"},{default:D(()=>[N(Q(t+1)+". "+Q(e.name),1)]),_:2},1024),L(f,{caption:""},{default:D(()=>{var t;return[N(" Waiting since "+Q(new Date(null==(t=Ot(e.id).current)?void 0:t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),1)]}),_:2},1024)]),_:2},1024),L(g,{side:""},{default:D(()=>[B("div",ke,[L(l,{icon:"arrow_forward",label:"Let Out",color:"primary",size:"sm",onClick:t=>(e=>{var t;if(Rt.value)return void ot.notify({message:"Classroom limit reached. Cannot let out.",color:"negative"});const a=e.id,l=st.studentBehaviors[a];let s=Ot(a);l.logistics_tracker={status:"out",current:{reason:(null==(t=s.current)?void 0:t.reason)||"From Queue",timestamp:(new Date).toISOString()},history:s.history||[]},Wt("logistics_tracker",a),ot.notify({message:`${e.name} is now out.`,color:"positive",icon:"logout"})})(e),disable:Rt.value},{default:D(()=>[Rt.value?(O(),I(s,{key:0},{default:D(()=>C[32]||(C[32]=[N("Class Limit Reached")])),_:1})):z("",!0)]),_:2},1032,["onClick","disable"]),L(l,{icon:"close",flat:"",round:"",color:"grey",size:"sm",onClick:t=>(e=>{const t=st.studentBehaviors[e];let a=Ot(e);t.logistics_tracker={status:"in",current:null,history:a.history||[]},Wt("logistics_tracker",e)})(e.id)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):z("",!0),0===Nt.value.length&&0===Mt.value.length?(O(),A("div",xe,[L(i,{name:"timelapse",size:"4em",class:"mb-2"}),C[33]||(C[33]=B("div",{class:"text-lg"},"Classroom is full. No one is currently waiting or outside.",-1)),L(l,{label:"Request Exit",color:"primary",icon:"add",class:"mt-4",onClick:C[8]||(C[8]=e=>Ut.value=!0)})])):(O(),A("div",we,[L(l,{label:"Request Another Exit",color:"primary",icon:"add",size:"md",onClick:C[9]||(C[9]=e=>Ut.value=!0)})])),Qt.value.length>0?(O(),A("div",Ve,[B("div",Ce,[L(i,{name:"history"}),C[34]||(C[34]=N(" Previously Left "))]),L(x,{rows:Qt.value,columns:dt,"row-key":"id",flat:"","hide-bottom":"",class:"bg-grey-50"},{"body-cell-leave_order":D(e=>[L(y,{props:e,class:"text-center text-grey-7 font-bold"},{default:D(()=>[N(" #"+Q(e.value),1)]),_:2},1032,["props"])]),"body-cell-student":D(e=>[L(y,{props:e},{default:D(()=>[B("div",Se,[L(r,{size:"sm"},{default:D(()=>[B("img",{src:ut(e.row)},null,8,Te)]),_:2},1024),B("div",Ue,Q(e.row.name),1)])]),_:2},1032,["props"])]),"body-cell-times_left":D(e=>[L(y,{props:e,class:"text-center font-bold"},{default:D(()=>[N(Q(Bt(e.row.id)),1)]),_:2},1032,["props"])]),"body-cell-last_out":D(e=>[L(y,{props:e},{default:D(()=>[B("div",je,Q(zt(e.row.id)),1)]),_:2},1032,["props"])]),"body-cell-duration":D(e=>[L(y,{props:e,class:"text-center font-mono text-xs"},{default:D(()=>[N(Q(It(e.row.id)),1)]),_:2},1032,["props"])]),"body-cell-action":D(e=>[L(y,{props:e,class:"text-center"},{default:D(()=>[L(l,{label:"Urgent Exit",color:"negative",outline:"",size:"xs",icon:"priority_high",onClick:t=>{return a=e.row,Ht.value=a,void(ta.value=!0);var a}},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"])])):z("",!0)])):z("",!0),"attendance"===rt.value?(O(),A("div",Ae,[B("div",Oe,[B("div",Be,[L(x,{rows:lt.students,columns:ct,"row-key":"id",flat:"",bordered:"",pagination:{rowsPerPage:0},"hide-bottom":""},{"body-cell-student":D(e=>[L(y,{props:e},{default:D(()=>[B("div",Le,[L(r,{size:"md"},{default:D(()=>[B("img",{src:ut(e.row)},null,8,De)]),_:2},1024),B("div",ze,Q(e.row.name),1)])]),_:2},1032,["props"])]),"body-cell-mark":D(e=>[L(y,{props:e,class:"text-center"},{default:D(()=>[L(d,{modelValue:pt[e.row.id],"onUpdate:modelValue":t=>pt[e.row.id]=t,color:pt[e.row.id]?"positive":"negative","checked-icon":"check_circle","unchecked-icon":"cancel",size:"lg","keep-color":"",disable:!1},{default:D(()=>[L(s,null,{default:D(()=>C[35]||(C[35]=[N("Toggle Attendance")])),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","color"])]),_:2},1032,["props"])]),_:1},8,["rows"])]),B("div",Ie,[L(c,{class:"bg-red-50 text-red-900 sticky-top",flat:"",bordered:""},{default:D(()=>[L(a,null,{default:D(()=>[B("div",qe,[L(i,{name:"warning",color:"negative"}),C[36]||(C[36]=N(" Absentees List "))]),B("div",Pe," Total: "+Q(gt.value)+" / "+Q(lt.students.length),1)]),_:1}),L(u,{color:"red-200"}),L(a,{class:"q-pa-sm"},{default:D(()=>[gt.value>0?(O(),A("div",Qe,[(O(!0),A(q,null,P(vt.value,e=>(O(),A("div",{key:e.id,class:"flex items-center gap-2 bg-white p-2 rounded shadow-sm border border-red-100"},[L(r,{size:"sm"},{default:D(()=>[B("img",{src:ut(e)},null,8,Ne)]),_:2},1024),B("span",Me,Q(e.name),1)]))),128))])):(O(),A("div",Re,[L(i,{name:"thumb_up"}),C[37]||(C[37]=N(" All Present "))]))]),_:1})]),_:1})])])])):z("",!0)]}),_:1})]),_:1}),L(v,{modelValue:Jt.value,"onUpdate:modelValue":C[12]||(C[12]=e=>Jt.value=e)},{default:D(()=>[L(c,{style:{"min-width":"350px"}},{default:D(()=>[L(a,null,{default:D(()=>{var e;return[C[38]||(C[38]=B("div",{class:"text-h6"},"Log Behavior Note",-1)),B("div",Ee,Q(null==(e=Ht.value)?void 0:e.name),1)]}),_:1}),L(a,null,{default:D(()=>[B("div",$e,[L(e,{modelValue:Gt.value,"onUpdate:modelValue":C[10]||(C[10]=e=>Gt.value=e),spread:"","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Negative Behavior",value:"negative",slot:"neg"},{label:"Positive Behavior",value:"positive",slot:"pos"}]},{neg:D(()=>[B("div",We,[L(i,{name:"remove_circle",color:"negative",class:"mr-2"}),C[39]||(C[39]=B("div",{class:"text-center"},"Negative",-1))])]),pos:D(()=>[B("div",Fe,[L(i,{name:"add_circle",color:"positive",class:"mr-2"}),C[40]||(C[40]=B("div",{class:"text-center"},"Positive",-1))])]),_:1},8,["modelValue"])]),L(m,{modelValue:Kt.value,"onUpdate:modelValue":C[11]||(C[11]=e=>Kt.value=e),label:"Note",outlined:"",autofocus:"",autogrow:"",color:"positive"===Gt.value?"green":"red"},null,8,["modelValue","color"]),B("div",Je,[C[41]||(C[41]=B("div",{class:"text-xs text-grey-6 mb-1"},"Quick Tags:",-1)),B("div",He,[(O(!0),A(q,null,P(Zt.value,e=>(O(),I(o,{key:e,clickable:"",color:"grey-2","text-color":"grey-9",size:"sm",onClick:t=>(e=>{Kt.value?Kt.value+=`, ${e}`:Kt.value=e})(e)},{default:D(()=>[N(Q(e),1)]),_:2},1032,["onClick"]))),128))])])]),_:1}),L(p,{align:"right"},{default:D(()=>[R(L(l,{flat:"",label:"Cancel",color:"primary"},null,512),[[h]]),L(l,{flat:"",label:"Save",color:"primary",onClick:ea})]),_:1})]),_:1})]),_:1},8,["modelValue"]),L(v,{modelValue:ta.value,"onUpdate:modelValue":C[14]||(C[14]=e=>ta.value=e)},{default:D(()=>[L(c,{style:{"min-width":"300px"}},{default:D(()=>[L(a,null,{default:D(()=>{var e;return[C[42]||(C[42]=B("div",{class:"text-h6"},"Check Out Student",-1)),B("div",Ke,Q(null==(e=Ht.value)?void 0:e.name),1),Rt.value?(O(),A("div",Ge,[L(i,{name:"warning"}),N(" Limit Reached ("+Q(Ct.value)+" students already out). ",1)])):z("",!0)]}),_:1}),L(a,null,{default:D(()=>[B("div",Xe,[Rt.value?(O(),A("div",Ye,[L(l,{label:"Force Check Out (Urgent)",color:"negative",icon:"priority_high",class:"full-width q-mb-sm",onClick:C[13]||(C[13]=e=>la("Urgent Override"))}),R(L(l,{flat:"",label:"Cancel",class:"full-width"},null,512),[[h]])])):(O(),A(q,{key:0},P(["Bathroom","Office","Cafeteria","Doctor"],e=>L(l,{key:e,label:e,color:"primary",outline:"",class:"full-width q-mb-sm",onClick:t=>la(e)},null,8,["label","onClick"])),64))])]),_:1})]),_:1})]),_:1},8,["modelValue"]),L(v,{modelValue:Ut.value,"onUpdate:modelValue":C[16]||(C[16]=e=>Ut.value=e)},{default:D(()=>[L(c,{style:{"min-width":"400px","max-height":"80vh"}},{default:D(()=>[L(a,null,{default:D(()=>[C[43]||(C[43]=B("div",{class:"text-h6"},"Request Exit",-1)),L(m,{modelValue:jt.value,"onUpdate:modelValue":C[15]||(C[15]=e=>jt.value=e),placeholder:"Search student...",dense:"",outlined:"",class:"mt-2",autofocus:""},{prepend:D(()=>[L(i,{name:"search"})]),_:1},8,["modelValue"])]),_:1}),L(u),L(a,{class:"scroll",style:{"max-height":"60vh"}},{default:D(()=>[L(n,{separator:""},{default:D(()=>[(O(!0),A(q,null,P(At.value,e=>R((O(),I(b,{key:e.id,clickable:"",disable:!mt(e.id)||"in"!==Ot(e.id).status,onClick:t=>(e=>{mt(e.id)&&(Ht.value=e,ta.value=!0,Ut.value=!1)})(e)},{default:D(()=>[L(g,{avatar:""},{default:D(()=>[L(r,{size:"md"},{default:D(()=>[B("img",{src:ut(e)},null,8,Ze)]),_:2},1024)]),_:2},1024),L(g,null,{default:D(()=>[L(f,null,{default:D(()=>[N(Q(e.name),1)]),_:2},1024),mt(e.id)?"out"===Ot(e.id).status?(O(),I(f,{key:1,caption:"",class:"text-blue-700"},{default:D(()=>C[45]||(C[45]=[N("Currently Out")])),_:1})):"waiting"===Ot(e.id).status?(O(),I(f,{key:2,caption:"",class:"text-blue-700"},{default:D(()=>C[46]||(C[46]=[N("Already Waiting")])),_:1})):z("",!0):(O(),I(f,{key:0,caption:"",class:"text-amber-700"},{default:D(()=>C[44]||(C[44]=[N("Absent from Class")])),_:1}))]),_:2},1024),mt(e.id)&&"in"===Ot(e.id).status?(O(),I(g,{key:0,side:""},{default:D(()=>[L(l,{icon:"navigate_next",color:"primary",flat:"",round:""})]),_:1})):z("",!0)]),_:2},1032,["disable","onClick"])),[[_]])),128))]),_:1})]),_:1}),L(p,{align:"right"},{default:D(()=>[R(L(l,{flat:"",label:"Close",color:"primary"},null,512),[[h]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),L(v,{modelValue:ft.value,"onUpdate:modelValue":C[23]||(C[23]=e=>ft.value=e)},{default:D(()=>[L(c,{style:{"min-width":"400px"}},{default:D(()=>[L(a,null,{default:D(()=>C[47]||(C[47]=[B("div",{class:"text-h6"},"Configure Academic Tracker",-1),B("div",{class:"text-caption text-grey"},"Manage checklist items for Materials and Tasks.",-1)])),_:1}),L(a,{class:"q-pt-none"},{default:D(()=>[B("div",et,[B("div",tt,[C[48]||(C[48]=B("div",{class:"font-bold mb-2 text-primary"},"Materials Items",-1)),L(m,{modelValue:bt.value,"onUpdate:modelValue":C[18]||(C[18]=e=>bt.value=e),dense:"",outlined:"",placeholder:"Add item (e.g. Laptop)",onKeyup:C[19]||(C[19]=E(e=>yt("materials"),["enter"]))},{append:D(()=>[L(l,{round:"",dense:"",flat:"",icon:"add",color:"primary",onClick:C[17]||(C[17]=e=>yt("materials"))})]),_:1},8,["modelValue"]),L(n,{dense:"",separator:"",class:"mt-2 text-sm border rounded"},{default:D(()=>[(O(!0),A(q,null,P(_t.materials,(e,t)=>(O(),I(b,{key:t},{default:D(()=>[L(g,null,{default:D(()=>[L(m,{modelValue:_t.materials[t],"onUpdate:modelValue":e=>_t.materials[t]=e,dense:"",borderless:"",onChange:xt},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),L(g,{side:""},{default:D(()=>[L(l,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"xs",onClick:e=>kt("materials",t)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),B("div",at,[C[49]||(C[49]=B("div",{class:"font-bold mb-2 text-primary"},"Tasks Items",-1)),L(m,{modelValue:ht.value,"onUpdate:modelValue":C[21]||(C[21]=e=>ht.value=e),dense:"",outlined:"",placeholder:"Add item (e.g. Project)",onKeyup:C[22]||(C[22]=E(e=>yt("tasks"),["enter"]))},{append:D(()=>[L(l,{round:"",dense:"",flat:"",icon:"add",color:"primary",onClick:C[20]||(C[20]=e=>yt("tasks"))})]),_:1},8,["modelValue"]),L(n,{dense:"",separator:"",class:"mt-2 text-sm border rounded"},{default:D(()=>[(O(!0),A(q,null,P(_t.tasks,(e,t)=>(O(),I(b,{key:t},{default:D(()=>[L(g,null,{default:D(()=>[L(m,{modelValue:_t.tasks[t],"onUpdate:modelValue":e=>_t.tasks[t]=e,dense:"",borderless:"",onChange:xt},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),L(g,{side:""},{default:D(()=>[L(l,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"xs",onClick:e=>kt("tasks",t)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])])]),_:1}),L(p,{align:"right"},{default:D(()=>[R(L(l,{flat:"",label:"Done",color:"primary"},null,512),[[h]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{lt as default};
