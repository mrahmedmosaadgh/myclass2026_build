import{o as e,u as s,m as a,c as l,Q as t,a as r,f as o,d as i,C as c,A as n}from"./app-B77gjd5a.js";import{Q as u}from"./QTd-Cd1TbwhN.js";import{Q as d}from"./QTable-Dzgz30xz.js";import{f as m,a as v,M as p,J as g,b as h,z as f,a4 as b,K as y,N as _,I as w,Q as j,F as x,R as q,U as C,V as A,W as k,$ as T}from"./vendor-DuKqz2x4.js";import{_ as S}from"./AppLayout-OZsHDu4T.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./QMarkupTable-xKG6mM4A.js";import"./QSelect-DB_tK-Lk.js";import"./rtl-Cr6c3OOr.js";import"./QLinearProgress-B9hMkhRG.js";import"./use-fullscreen-Cf3Zl1YN.js";const V={class:"q-pa-md"},Q={class:"row items-center justify-between"},L={class:"q-gutter-sm"},U={class:"row q-col-gutter-md"},N={class:"col-12 col-md-6"},P={class:"row q-col-gutter-md q-mt-md"},z={class:"text-h6 text-primary"},F={class:"text-caption text-grey-7 q-mt-xs"},R={class:"q-mt-sm"},$={class:"text-h6 q-mb-md"},M={key:0,class:"q-mb-md"},B={class:"row q-col-gutter-sm"},E={class:"row q-col-gutter-md q-mb-md"},I={class:"col-12 col-md-6"},O={class:"row items-center q-gutter-sm"},J={class:"text-subtitle2"},K={class:"text-caption text-grey-7"},W={class:"q-mt-md"},D={class:"row justify-end q-gutter-sm q-mt-md"},G=e({__name:"AssignByCourse",props:{courses:{type:Array,required:!0},teachers:{type:Array,required:!0}},setup(e){const G=e,H=s(),X=m(""),Y=m(""),Z=m(null),ee=m([]),se=m(""),ae=m(!1),le=[{name:"name",label:"Teacher",field:"name",align:"left",sortable:!0},{name:"phone",label:"Phone",field:"phone",align:"left",sortable:!0},{name:"subject",label:"Subject",field:"subject",align:"left",sortable:!0}],te=v(()=>{if(!X.value)return G.courses;const e=X.value.toLowerCase();return G.courses.filter(s=>{var a;return s.name.toLowerCase().includes(e)||(null==(a=s.description)?void 0:a.toLowerCase().includes(e))})}),re=v(()=>Z.value&&Z.value.teachers||[]),oe=v(()=>{if(!Z.value)return G.teachers;const e=re.value.map(e=>e.id);return G.teachers.filter(s=>!e.includes(s.id))}),ie=()=>{ee.value=[],se.value=""},ce=()=>{if(0===ee.value.length)return void H.notify({type:"warning",message:"Please select at least one teacher.",icon:"warning"});ae.value=!0;const e={course_id:Z.value.id,teacher_ids:ee.value.map(e=>e.id),notes:se.value};T.post(route("course-management.teachers.assign-teachers-to-course"),e,{onSuccess:()=>{H.notify({type:"positive",message:`${ee.value.length} teacher(s) assigned to course successfully!`,icon:"check_circle"}),ee.value=[],se.value="",T.reload()},onError:e=>{H.notify({type:"negative",message:"Failed to assign teachers to course.",caption:Object.values(e).join(" "),icon:"error"})},onFinish:()=>{ae.value=!1}})};return(e,s)=>(g(),p(x,null,[h(f(b),{title:"Assign Teachers to Course"}),h(S,{title:"Assign Teachers to Course"},{default:y(()=>[_("div",V,[h(a,{flat:"",bordered:""},{default:y(()=>[h(l,null,{default:y(()=>[_("div",Q,[s[6]||(s[6]=_("div",null,[_("div",{class:"text-h6"},"Assign Teachers to Course"),_("div",{class:"text-subtitle2"},"Select a course and assign multiple teachers to it")],-1)),_("div",L,[h(t,{flat:"",color:"grey-7",icon:"arrow_back",label:"Back to Assignments",onClick:s[0]||(s[0]=s=>e.$inertia.visit(e.route("course-management.teachers.index")))}),h(t,{flat:"",color:"orange",icon:"person_add",label:"Assign by Teacher",onClick:s[1]||(s[1]=s=>e.$inertia.visit(e.route("course-management.teachers.assign-by-teacher")))})])])]),_:1}),h(r),h(l,null,{default:y(()=>[s[7]||(s[7]=_("div",{class:"text-h6 q-mb-md"},"Step 1: Select Course",-1)),_("div",U,[_("div",N,[h(o,{modelValue:X.value,"onUpdate:modelValue":s[2]||(s[2]=e=>X.value=e),outlined:"",dense:"",placeholder:"Search courses...",clearable:""},{prepend:y(()=>[h(i,{name:"search"})]),_:1},8,["modelValue"])])]),_("div",P,[(g(!0),p(x,null,q(te.value,e=>{var s;return g(),p("div",{key:e.id,class:"col-12 col-sm-6 col-md-4"},[h(a,{flat:"",bordered:"",class:C(["cursor-pointer course-card",{"bg-blue-1 border-primary":(null==(s=Z.value)?void 0:s.id)===e.id}]),onClick:s=>(e=>{Z.value=e,ee.value=[],se.value=""})(e)},{default:y(()=>[h(l,null,{default:y(()=>[_("div",z,A(e.name),1),_("div",F,A(e.description||"No description"),1),_("div",R,[h(c,{size:"sm",color:"blue-1","text-color":"blue-8",icon:"layers"},{default:y(()=>{var s;return[k(A((null==(s=e.levels)?void 0:s.length)||0)+" Levels ",1)]}),_:2},1024),h(c,{size:"sm",color:"green-1","text-color":"green-8",icon:"person",class:"q-ml-xs"},{default:y(()=>{var s;return[k(A((null==(s=e.teachers)?void 0:s.length)||0)+" Teachers ",1)]}),_:2},1024)])]),_:2},1024)]),_:2},1032,["class","onClick"])])}),128))])]),_:1}),Z.value?(g(),w(l,{key:0},{default:y(()=>[_("div",$,'Step 2: Select Teachers for "'+A(Z.value.name)+'"',1),re.value.length>0?(g(),p("div",M,[s[8]||(s[8]=_("div",{class:"text-subtitle1 q-mb-sm"},"Currently Assigned Teachers:",-1)),_("div",B,[(g(!0),p(x,null,q(re.value,e=>(g(),p("div",{key:e.id,class:"col-auto"},[h(c,{color:"green","text-color":"white",icon:"person",removable:"",onRemove:s=>(e=>{T.post(route("course-management.teachers.remove-assignment-by-ids"),{_method:"delete",teacher_id:e.id,course_id:Z.value.id},{onSuccess:()=>{H.notify({type:"positive",message:"Teacher removed from course successfully.",icon:"check_circle"}),T.reload()},onError:()=>{H.notify({type:"negative",message:"Failed to remove teacher from course.",icon:"error"})}})})(e)},{default:y(()=>{var s;return[k(A((null==(s=e.user)?void 0:s.name)||e.name),1)]}),_:2},1032,["onRemove"])]))),128))])])):j("",!0),_("div",E,[_("div",I,[h(o,{modelValue:Y.value,"onUpdate:modelValue":s[3]||(s[3]=e=>Y.value=e),outlined:"",dense:"",placeholder:"Search teachers...",clearable:""},{prepend:y(()=>[h(i,{name:"search"})]),_:1},8,["modelValue"])])]),h(d,{rows:oe.value,columns:le,"row-key":"id",selection:"multiple",selected:ee.value,"onUpdate:selected":s[4]||(s[4]=e=>ee.value=e),flat:"",bordered:"",pagination:{rowsPerPage:10},filter:Y.value},{"body-cell-name":y(e=>[h(u,{props:e},{default:y(()=>[_("div",O,[h(n,{size:"32px",color:"primary","text-color":"white"},{default:y(()=>{return[k(A((s=e.row.name,s?s.split(" ").map(e=>e.charAt(0)).join("").toUpperCase():"?")),1)];var s}),_:2},1024),_("div",null,[_("div",J,A(e.row.name),1),_("div",K,A(e.row.email),1)])])]),_:2},1032,["props"])]),"body-cell-phone":y(e=>[h(u,{props:e},{default:y(()=>[k(A(e.row.phone||"N/A"),1)]),_:2},1032,["props"])]),"body-cell-subject":y(e=>[h(u,{props:e},{default:y(()=>[k(A(e.row.subject||"N/A"),1)]),_:2},1032,["props"])]),_:1},8,["rows","selected","filter"]),_("div",W,[h(o,{modelValue:se.value,"onUpdate:modelValue":s[5]||(s[5]=e=>se.value=e),outlined:"",type:"textarea",rows:"3",label:"Assignment Notes (Optional)",placeholder:"Add any notes about this assignment..."},null,8,["modelValue"])]),_("div",D,[h(t,{flat:"",label:"Clear Selection",color:"grey-7",onClick:ie}),h(t,{color:"primary",icon:"person_add",label:"Assign Teachers",disable:0===ee.value.length,loading:ae.value,onClick:ce},null,8,["disable","loading"])])]),_:1})):j("",!0)]),_:1})])]),_:1})],64))}},[["__scopeId","data-v-f865bbe3"]]);export{G as default};
