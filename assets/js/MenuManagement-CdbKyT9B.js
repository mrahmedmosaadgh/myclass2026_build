import{u as e,a,Q as s,b as l,c as o,d as t,e as n}from"./app-DlLesFGi.js";import{Q as u}from"./QTab-CYxYFXBq.js";import{Q as m}from"./QTabs-BClcf-CB.js";import{Q as r}from"./QTabPanel-DXa1fEFB.js";import{Q as i}from"./QTabPanels-CTgZWG49.js";import{M as d,f as p,k as c,I as v,J as y,K as f,R as g,b as j,N as b,Q,W as V,V as w,F as M,_ as x,$ as _}from"./vendor-BWKGNkNB.js";import{A as q}from"./AdminLayout-CuTvndvK.js";import C from"./MenuList-D6CrjwBb.js";import h from"./MenuForm-CGyOWmAT.js";import F from"./MenuDeleteDialog-DOMf6kN8.js";import k from"./BulkImportDialog-Cl55SaBu.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-BqxRbB7W.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-IdEcTs8C.js";import"./QSpace-BK_PGLKv.js";import"./QSelect-BTh0khse.js";import"./QForm-CDvMxBSt.js";import"./QStepperNavigation-DjG6vbQc.js";import"./QStepper-DsaP_4Mi.js";import"./copy-to-clipboard-Dc8Jrd75.js";const A={class:"q-pa-md"},U={class:"row q-mb-lg items-center justify-between"},D={class:"col"},I={class:"row items-center q-gutter-x-sm text-grey-8 q-mb-xs"},S={class:"col-auto row q-gutter-sm"},z={class:"row items-center no-wrap"},T={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(T){const B=e();d();const $=a(),E=T,J=p(E.modules[0]||"academics"),L=p(!1),N=p(!1),P=p(!1),R=p(!1),G=p(null),H=p(null),K=e=>E.menus.filter(a=>a.module===e),W=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");c(N,e=>{e&&(G.value=null,L.value=!0,N.value=!1)});const O=e=>{G.value=e,L.value=!0},X=e=>{H.value=e,P.value=!0},Y=async e=>{var a,s;try{G.value?(await x.put(`/api/admin/menus/${G.value.id}`,e),B.notify({type:"positive",message:"Menu updated successfully"})):(await x.post("/api/admin/menus",e),B.notify({type:"positive",message:"Menu created successfully"})),se(),_.reload({only:["menus"]})}catch(l){B.notify({type:"negative",message:(null==(s=null==(a=l.response)?void 0:a.data)?void 0:s.message)||"Failed to save menu"})}},Z=async()=>{var e,a;try{await x.delete(`/api/admin/menus/${H.value.id}`),B.notify({type:"positive",message:"Menu deleted successfully"}),P.value=!1,_.reload({only:["menus"]})}catch(s){B.notify({type:"negative",message:(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},ee=async e=>{var a,s;try{await x.post("/api/admin/menus/reorder",{items:e}),B.notify({type:"positive",message:"Menu order updated successfully"}),_.reload({only:["menus"]})}catch(l){B.notify({type:"negative",message:(null==(s=null==(a=l.response)?void 0:a.data)?void 0:s.message)||"Failed to reorder menus"})}},ae=async()=>{$.menus.clear(),_.reload({only:["menus"]})},se=()=>{L.value=!1,G.value=null};return(e,a)=>(y(),v(q,null,{default:f(()=>[g("div",A,[g("div",U,[g("div",D,[g("div",I,[j(s,{name:"settings",size:"sm"}),a[8]||(a[8]=g("div",{class:"text-h5 text-weight-bold"},"Menu Management",-1))]),a[9]||(a[9]=g("div",{class:"text-subtitle2 text-grey-7"},"Configure and organize application navigation menus",-1))]),g("div",S,[j(l,{color:"secondary",icon:"upload",label:"Import",outline:"",onClick:a[0]||(a[0]=e=>R.value=!0)}),j(l,{color:"primary",icon:"add",label:"Create Menu",unelevated:"",onClick:a[1]||(a[1]=e=>N.value=!0)})])]),j(t,{flat:"",bordered:"",class:"bg-white rounded-borders"},{default:f(()=>[j(m,{modelValue:J.value,"onUpdate:modelValue":a[2]||(a[2]=e=>J.value=e),dense:"",class:"text-grey-7 bg-grey-1","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:f(()=>[(y(!0),b(M,null,Q(T.modules,e=>(y(),v(u,{key:e,name:e,class:"q-px-lg q-py-md"},{default:f(()=>[g("div",z,[j(s,{name:"widgets",class:"q-mr-sm",size:"xs"}),V(" "+w(W(e)),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),j(o),j(i,{modelValue:J.value,"onUpdate:modelValue":a[3]||(a[3]=e=>J.value=e),animated:"",class:"bg-transparent"},{default:f(()=>[(y(!0),b(M,null,Q(T.modules,e=>(y(),v(r,{key:e,name:e,class:"q-pa-none"},{default:f(()=>[j(C,{menus:K(e),module:e,onEdit:O,onDelete:X,onReorder:ee},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1}),j(n,{modelValue:L.value,"onUpdate:modelValue":a[4]||(a[4]=e=>L.value=e),persistent:""},{default:f(()=>[j(h,{menu:G.value,modules:T.modules,onSave:Y,onCancel:se},null,8,["menu","modules"])]),_:1},8,["modelValue"]),j(F,{modelValue:P.value,"onUpdate:modelValue":a[5]||(a[5]=e=>P.value=e),menu:H.value,onConfirm:Z,onCancel:a[6]||(a[6]=e=>P.value=!1)},null,8,["modelValue","menu"]),j(k,{modelValue:R.value,"onUpdate:modelValue":a[7]||(a[7]=e=>R.value=e),onImported:ae},null,8,["modelValue"])])]),_:1}))}};export{T as default};
