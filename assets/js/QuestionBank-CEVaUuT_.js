import{r as e,Q as l,ao as a,i as t,aS as s,j as o,k as i,l as u,t as n,b as d,f as r,d as c,u as p,h as v,aI as m,o as g,e as y}from"./app-Dtv5Fi9L.js";import{Q as f}from"./QPagination-DzFw2F_8.js";import{Q as _}from"./QBtnToggle-BoICfhrK.js";import{f as b,a as q,I as x,J as h,K as w,b as k,R as V,S as j,N as C,O as Q,V as U,Q as z,y as F,W as E,F as A,k as T,o as $,_ as S,z as D,a4 as I,$ as O}from"./vendor-BWKGNkNB.js";import{Q as B}from"./QBadge-B7PIhVlN.js";import{Q as L}from"./QSelect-BslHFD89.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";const R={class:"row items-start q-gutter-md"},H={class:"col"},M={class:"row items-center justify-between q-mb-sm"},N={class:"row items-center q-gutter-sm"},G={class:"text-caption text-grey-7"},P={class:"row q-gutter-xs"},J=["innerHTML"],K={class:"row items-center q-gutter-md text-caption text-grey-7"},W={key:0},X={key:1},Y={key:2},Z={key:3},ee={key:0,class:"row items-center q-gutter-md q-mt-sm text-caption"},le={key:0,class:"text-grey-7"},ae={key:1,class:"text-positive"},te={key:2,class:"text-info"},se=e({__name:"QuestionCard",props:{question:{type:Object,required:!0},showAnalytics:{type:Boolean,default:!1}},emits:["edit","duplicate","delete","statusChange"],setup(e,{emit:p}){const v=e,m=p,g=b(!1),y=[{label:"Draft",value:"draft"},{label:"Active",value:"active"},{label:"Archived",value:"archived"},{label:"Review",value:"review"}],f=q(()=>{var e,l;return(null==(e=v.question.question_type)?void 0:e.name)||(null==(l=v.question.questionType)?void 0:l.name)||"Unknown"}),_=q(()=>{var e,l;return{multiple_choice:"radio_button_checked",multi_select:"check_box",true_false:"check_circle",fill_blank:"edit",short_answer:"short_text",essay:"description",matching:"compare_arrows"}[(null==(e=v.question.question_type)?void 0:e.slug)||(null==(l=v.question.questionType)?void 0:l.slug)||""]||"help_outline"}),T=q(()=>{var e,l;return{multiple_choice:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",multi_select:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",true_false:"linear-gradient(135deg, #11998e 0%, #38ef7d 100%)",fill_blank:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",short_answer:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",essay:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",matching:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)"}[(null==(e=v.question.question_type)?void 0:e.slug)||(null==(l=v.question.questionType)?void 0:l.slug)||""]||"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}),$=q(()=>{const e=v.question.status||"draft";return e.charAt(0).toUpperCase()+e.slice(1)}),S=q(()=>({draft:"grey",active:"positive",archived:"warning",review:"info"}[v.question.status]||"grey")),D=q(()=>{const e=v.question.difficulty_level;if(!e)return null;return{1:"Very Easy",2:"Easy",3:"Medium",4:"Hard",5:"Very Hard"}[e]||`Level ${e}`}),I=q(()=>{const e=v.question.difficulty_level;return e<=2?"positive":3===e?"warning":"negative"}),O=q(()=>{var e;return null==(e=v.question.subject)?void 0:e.name}),L=q(()=>{var e;return null==(e=v.question.grade)?void 0:e.name}),se=q(()=>{var e;return null==(e=v.question.topic)?void 0:e.name}),oe=q(()=>v.question.bloom_level),ie=q(()=>{const e=v.question.question_text||"",l=e.replace(/<[^>]*>/g,"");if(l.length<=200)return e;return l.substring(0,200)+"..."}),ue=q(()=>v.question.usage_count),ne=q(()=>{const e=v.question.avg_success_rate;return null!=e?Number(e).toFixed(1):null}),de=q(()=>{const e=v.question.discrimination_index;return null!=e?Number(e).toFixed(2):null});return(p,b)=>(h(),x(c,{class:"question-card",flat:"",bordered:""},{default:w(()=>[k(r,{class:"q-pa-md"},{default:w(()=>[V("div",R,[V("div",{class:"question-type-icon",style:j({background:T.value})},[k(l,{name:_.value,size:"28px",color:"white"},null,8,["name"])],4),V("div",H,[V("div",M,[V("div",N,[V("span",G,U(f.value),1),k(B,{color:S.value,label:$.value,clickable:"",onClick:b[1]||(b[1]=e=>g.value=!0)},{default:w(()=>[k(a,{modelValue:g.value,"onUpdate:modelValue":b[0]||(b[0]=e=>g.value=e)},{default:w(()=>[k(t,{style:{"min-width":"150px"}},{default:w(()=>[(h(),C(A,null,z(y,a=>F(k(o,{key:a.value,clickable:"",onClick:e=>{var l;(l=a.value)!==v.question.status&&m("statusChange",v.question,l)},active:e.question.status===a.value},{default:w(()=>[k(i,null,{default:w(()=>[k(u,null,{default:w(()=>[E(U(a.label),1)]),_:2},1024)]),_:2},1024),k(i,{side:""},{default:w(()=>[e.question.status===a.value?(h(),x(l,{key:0,name:"check",color:"primary"})):Q("",!0)]),_:2},1024)]),_:2},1032,["onClick","active"]),[[s]])),64))]),_:1})]),_:1},8,["modelValue"]),k(n,null,{default:w(()=>b[5]||(b[5]=[E("Click to change status")])),_:1})]),_:1},8,["color","label"]),D.value?(h(),x(B,{key:0,color:I.value,label:D.value,outline:""},null,8,["color","label"])):Q("",!0)]),V("div",P,[k(d,{flat:"",round:"",dense:"",icon:"edit",size:"sm",color:"primary",onClick:b[2]||(b[2]=l=>p.$emit("edit",e.question))},{default:w(()=>[k(n,null,{default:w(()=>b[6]||(b[6]=[E("Edit Question")])),_:1})]),_:1}),k(d,{flat:"",round:"",dense:"",icon:"content_copy",size:"sm",color:"secondary",onClick:b[3]||(b[3]=l=>p.$emit("duplicate",e.question))},{default:w(()=>[k(n,null,{default:w(()=>b[7]||(b[7]=[E("Duplicate Question")])),_:1})]),_:1}),k(d,{flat:"",round:"",dense:"",icon:"delete",size:"sm",color:"negative",onClick:b[4]||(b[4]=l=>p.$emit("delete",e.question))},{default:w(()=>[k(n,null,{default:w(()=>b[8]||(b[8]=[E("Delete Question")])),_:1})]),_:1})])]),V("div",{class:"question-text text-body1 q-mb-sm",innerHTML:ie.value},null,8,J),V("div",K,[O.value?(h(),C("span",W,[k(l,{name:"subject",size:"14px",class:"q-mr-xs"}),E(" "+U(O.value),1)])):Q("",!0),L.value?(h(),C("span",X,[k(l,{name:"school",size:"14px",class:"q-mr-xs"}),E(" "+U(L.value),1)])):Q("",!0),se.value?(h(),C("span",Y,[k(l,{name:"label",size:"14px",class:"q-mr-xs"}),E(" "+U(se.value),1)])):Q("",!0),oe.value?(h(),C("span",Z,[k(l,{name:"psychology",size:"14px",class:"q-mr-xs"}),E(" Bloom: "+U(oe.value),1)])):Q("",!0)]),e.showAnalytics?(h(),C("div",ee,[null!==ue.value?(h(),C("span",le,[k(l,{name:"quiz",size:"14px",class:"q-mr-xs"}),E(" Used: "+U(ue.value)+" times ",1)])):Q("",!0),null!==ne.value?(h(),C("span",ae,[k(l,{name:"check_circle",size:"14px",class:"q-mr-xs"}),E(" Success: "+U(ne.value)+"% ",1)])):Q("",!0),null!==de.value?(h(),C("span",te,[k(l,{name:"analytics",size:"14px",class:"q-mr-xs"}),E(" DI: "+U(de.value),1)])):Q("",!0)])):Q("",!0)])])]),_:1})]),_:1}))}},[["__scopeId","data-v-4320c538"]]),oe={class:"row items-center justify-between q-mb-md"},ie={class:"q-mb-md"},ue={class:"q-mb-md"},ne={class:"q-mb-md"},de={class:"q-mb-md"},re={class:"q-mb-md"},ce={class:"q-mb-md"},pe=e({__name:"QuestionFilters",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,t=l,s=b({question_type_id:null,difficulty:null,grade_id:null,subject_id:null,topic_id:null,status:null}),o=b([]),i=b([]),u=b([]),n=b([]),p=["Easy","Medium","Hard"],v=["draft","active","archived","review"],m=q(()=>Object.values(s.value).some(e=>null!=e&&""!==e)),g=q(()=>s.value.grade_id?u.value.filter(e=>e.grade_id===s.value.grade_id):u.value),y=q(()=>s.value.subject_id?n.value.filter(e=>e.subject_id===s.value.subject_id):n.value),f=()=>{s.value.subject_id=null,s.value.topic_id=null},_=()=>{s.value.topic_id=null},j=()=>{s.value={question_type_id:null,difficulty:null,grade_id:null,subject_id:null,topic_id:null,status:null}};return T(s,e=>{t("update:modelValue",{...e})},{deep:!0}),T(()=>a.modelValue,e=>{s.value={...e}},{deep:!0,immediate:!0}),$(()=>{(async()=>{try{const e=await S.get("/api/question-types");e.data.success&&(o.value=e.data.data)}catch(e){console.error("Failed to load question types:",e)}})(),(async()=>{try{const e=await S.get("/api/grades");e.data.success&&(i.value=e.data.data)}catch(e){console.error("Failed to load grades:",e)}})(),(async()=>{try{const e=await S.get("/api/subjects");e.data.success&&(u.value=e.data.data)}catch(e){console.error("Failed to load subjects:",e)}})(),(async()=>{try{const e=await S.get("/api/topics");e.data.success&&(n.value=e.data.data)}catch(e){console.error("Failed to load topics:",e)}})()}),(e,l)=>(h(),x(c,{flat:"",bordered:""},{default:w(()=>[k(r,null,{default:w(()=>[V("div",oe,[l[6]||(l[6]=V("div",{class:"text-h6"},"Filters",-1)),m.value?(h(),x(d,{key:0,flat:"",dense:"",size:"sm",label:"Clear",color:"primary",onClick:j})):Q("",!0)]),V("div",ie,[l[7]||(l[7]=V("div",{class:"text-subtitle2 q-mb-sm"},"Question Type",-1)),k(L,{modelValue:s.value.question_type_id,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.question_type_id=e),options:o.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",dense:"",clearable:"",placeholder:"All types"},null,8,["modelValue","options"])]),V("div",ue,[l[8]||(l[8]=V("div",{class:"text-subtitle2 q-mb-sm"},"Difficulty",-1)),k(L,{modelValue:s.value.difficulty,"onUpdate:modelValue":l[1]||(l[1]=e=>s.value.difficulty=e),options:p,outlined:"",dense:"",clearable:"",placeholder:"All difficulties"},null,8,["modelValue"])]),V("div",ne,[l[9]||(l[9]=V("div",{class:"text-subtitle2 q-mb-sm"},"Grade",-1)),k(L,{modelValue:s.value.grade_id,"onUpdate:modelValue":[l[2]||(l[2]=e=>s.value.grade_id=e),f],options:i.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",dense:"",clearable:"",placeholder:"All grades"},null,8,["modelValue","options"])]),V("div",de,[l[10]||(l[10]=V("div",{class:"text-subtitle2 q-mb-sm"},"Subject",-1)),k(L,{modelValue:s.value.subject_id,"onUpdate:modelValue":[l[3]||(l[3]=e=>s.value.subject_id=e),_],options:g.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",dense:"",clearable:"",placeholder:"All subjects",disable:!s.value.grade_id},null,8,["modelValue","options","disable"])]),V("div",re,[l[11]||(l[11]=V("div",{class:"text-subtitle2 q-mb-sm"},"Topic",-1)),k(L,{modelValue:s.value.topic_id,"onUpdate:modelValue":l[4]||(l[4]=e=>s.value.topic_id=e),options:y.value,"option-value":"id","option-label":"name","emit-value":"","map-options":"",outlined:"",dense:"",clearable:"",placeholder:"All topics",disable:!s.value.subject_id},null,8,["modelValue","options","disable"])]),V("div",ce,[l[12]||(l[12]=V("div",{class:"text-subtitle2 q-mb-sm"},"Status",-1)),k(L,{modelValue:s.value.status,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value.status=e),options:v,outlined:"",dense:"",clearable:"",placeholder:"All statuses"},null,8,["modelValue"])])]),_:1})]),_:1}))}},[["__scopeId","data-v-52475e44"]]),ve={class:"question-bank-page"},me={class:"q-pa-md"},ge={class:"row items-center justify-between q-mb-lg"},ye={class:"row q-gutter-sm"},fe={class:"row q-col-gutter-md"},_e={class:"col-12 col-md-3"},be={class:"col-12 col-md-9"},qe={key:0,class:"text-center q-py-xl"},xe={class:"text-grey-7"},he={key:2,class:"questions-grid"},we={key:3,class:"row justify-center q-mt-lg"},ke={class:"text-grey-7 q-mb-md"},Ve={class:"q-mb-md"},je={class:"text-caption text-grey-7"},Ce=e({__name:"QuestionBank",setup(e){const a=p(),t=b([]),o=b(!1),i=b(""),u=b({}),n=b({current_page:1,last_page:1,per_page:20,total:0}),j=b(!1),B=b(null),L=b(!1),R=b(!1),H=b(!1),M=b("xlsx"),N=b(!1),G=q(()=>Object.values(u.value).some(e=>null!=e&&""!==e));let P=null;const J=()=>{clearTimeout(P),P=setTimeout(()=>{n.value.current_page=1,K()},300)},K=async()=>{var e,l,s;o.value=!0;try{const e={page:n.value.current_page,per_page:n.value.per_page,search:i.value||void 0,...u.value};Object.keys(e).forEach(l=>{null!==e[l]&&void 0!==e[l]||delete e[l]});const l=await S.get("/api/questions",{params:e});if(l.data.success){const e=l.data.data;t.value=e.data||[],n.value={current_page:e.current_page,last_page:e.last_page,per_page:e.per_page,total:e.total}}}catch(d){console.error("Failed to load questions:",d),a.notify({type:"negative",message:"Failed to load questions",caption:(null==(s=null==(l=null==(e=d.response)?void 0:e.data)?void 0:l.error)?void 0:s.message)||d.message})}finally{o.value=!1}},W=()=>{O.visit("/questions/create")},X=e=>{O.visit(`/questions/${e.id}/edit`)},Y=async e=>{var l,t,s;try{const l=await S.post(`/api/questions/${e.id}/duplicate`);l.data.success&&(a.notify({type:"positive",message:"Question duplicated successfully",caption:"Opening editor..."}),O.visit(`/questions/${l.data.data.id}/edit`))}catch(o){console.error("Failed to duplicate question:",o),a.notify({type:"negative",message:"Failed to duplicate question",caption:(null==(s=null==(t=null==(l=o.response)?void 0:l.data)?void 0:t.error)?void 0:s.message)||o.message})}},Z=e=>{B.value=e,j.value=!0},ee=async()=>{var e,l,t;if(B.value){L.value=!0;try{(await S.delete(`/api/questions/${B.value.id}`)).data.success&&(a.notify({type:"positive",message:"Question deleted successfully"}),j.value=!1,B.value=null,K())}catch(s){console.error("Failed to delete question:",s),a.notify({type:"negative",message:"Failed to delete question",caption:(null==(t=null==(l=null==(e=s.response)?void 0:e.data)?void 0:l.error)?void 0:t.message)||s.message})}finally{L.value=!1}}},le=()=>{R.value=!1,O.visit("/questions/import")},ae=async(e,l)=>{var s,o,i;try{if((await S.put(`/api/questions/${e.id}`,{...e,status:l})).data.success){a.notify({type:"positive",message:"Status updated successfully",caption:`Question is now ${l}`});const s=t.value.findIndex(l=>l.id===e.id);-1!==s&&(t.value[s].status=l)}}catch(u){console.error("Failed to update status:",u),a.notify({type:"negative",message:"Failed to update status",caption:(null==(i=null==(o=null==(s=u.response)?void 0:s.data)?void 0:o.error)?void 0:i.message)||u.message})}},te=async()=>{var e,l,t;N.value=!0;try{const e={format:M.value,search:i.value||void 0,...u.value};Object.keys(e).forEach(l=>{null!==e[l]&&void 0!==e[l]||delete e[l]});const l=await S.get("/api/questions/export",{params:e,responseType:"blob"}),t=window.URL.createObjectURL(new Blob([l.data])),s=document.createElement("a");s.href=t,s.setAttribute("download",`questions_export.${M.value}`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(t),a.notify({type:"positive",message:"Export completed successfully",caption:`Downloaded questions_export.${M.value}`}),H.value=!1}catch(s){console.error("Failed to export questions:",s),a.notify({type:"negative",message:"Failed to export questions",caption:(null==(t=null==(l=null==(e=s.response)?void 0:e.data)?void 0:l.error)?void 0:t.message)||s.message})}finally{N.value=!1}};return T(u,()=>{n.value.current_page=1,K()},{deep:!0}),$(()=>{K()}),(e,a)=>(h(),C(A,null,[k(D(I),{title:"Question Bank"}),V("div",ve,[V("div",me,[V("div",ge,[a[9]||(a[9]=V("div",null,[V("h4",{class:"q-ma-none"},"Question Bank"),V("p",{class:"text-grey-7 q-mb-none"},"Manage your question library")],-1)),V("div",ye,[k(d,{color:"grey-7",icon:"download",label:"Export",onClick:a[0]||(a[0]=e=>H.value=!0)}),k(d,{color:"secondary",icon:"upload",label:"Import",onClick:a[1]||(a[1]=e=>R.value=!0)}),k(d,{color:"primary",icon:"add",label:"New Question",onClick:W})])]),V("div",fe,[V("div",_e,[k(pe,{modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=e=>u.value=e)},null,8,["modelValue"])]),V("div",be,[k(c,{flat:"",bordered:"",class:"q-mb-md"},{default:w(()=>[k(r,{class:"q-pa-md"},{default:w(()=>[k(v,{modelValue:i.value,"onUpdate:modelValue":[a[3]||(a[3]=e=>i.value=e),J],placeholder:"Search questions...",outlined:"",dense:"",clearable:""},{prepend:w(()=>[k(l,{name:"search"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o.value?(h(),C("div",qe,[k(m,{color:"primary",size:"50px"}),a[10]||(a[10]=V("p",{class:"text-grey-7 q-mt-md"},"Loading questions...",-1))])):0===t.value.length?(h(),x(c,{key:1,flat:"",bordered:"",class:"text-center q-py-xl"},{default:w(()=>[k(l,{name:"quiz",size:"64px",color:"grey-5"}),a[11]||(a[11]=V("p",{class:"text-h6 q-mt-md"},"No questions found",-1)),V("p",xe,U(G.value?"Try adjusting your filters":"Create your first question to get started"),1),G.value?Q("",!0):(h(),x(d,{key:0,color:"primary",label:"Create Question",icon:"add",onClick:W,class:"q-mt-md"}))]),_:1})):(h(),C("div",he,[(h(!0),C(A,null,z(t.value,e=>(h(),x(se,{key:e.id,question:e,"show-analytics":!0,onEdit:X,onDuplicate:Y,onDelete:Z,onStatusChange:ae,class:"q-mb-md"},null,8,["question"]))),128))])),n.value.last_page>1?(h(),C("div",we,[k(f,{modelValue:n.value.current_page,"onUpdate:modelValue":[a[4]||(a[4]=e=>n.value.current_page=e),K],max:n.value.last_page,"max-pages":7,"direction-links":"","boundary-links":""},null,8,["modelValue","max"])])):Q("",!0)])])]),k(y,{modelValue:j.value,"onUpdate:modelValue":a[5]||(a[5]=e=>j.value=e),persistent:""},{default:w(()=>[k(c,{style:{"min-width":"400px"}},{default:w(()=>[k(r,{class:"row items-center"},{default:w(()=>[k(l,{name:"warning",color:"warning",size:"32px",class:"q-mr-md"}),a[12]||(a[12]=V("span",{class:"text-h6"},"Delete Question?",-1))]),_:1}),k(r,null,{default:w(()=>a[13]||(a[13]=[V("p",null,"Are you sure you want to delete this question?",-1),V("p",{class:"text-grey-7 text-caption"},"This action cannot be undone.",-1)])),_:1}),k(g,{align:"right"},{default:w(()=>[F(k(d,{flat:"",label:"Cancel",color:"grey-7"},null,512),[[s]]),k(d,{flat:"",label:"Delete",color:"negative",onClick:ee,loading:L.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),k(y,{modelValue:R.value,"onUpdate:modelValue":a[6]||(a[6]=e=>R.value=e)},{default:w(()=>[k(c,{style:{"min-width":"500px"}},{default:w(()=>[k(r,null,{default:w(()=>a[14]||(a[14]=[V("div",{class:"text-h6"},"Import Questions",-1)])),_:1}),k(r,null,{default:w(()=>[a[15]||(a[15]=V("p",{class:"text-grey-7"},"Upload a CSV or Excel file to import multiple questions at once.",-1)),k(d,{color:"primary",label:"Go to Import Page",icon:"upload",onClick:le})]),_:1}),k(g,{align:"right"},{default:w(()=>[F(k(d,{flat:"",label:"Close",color:"grey-7"},null,512),[[s]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),k(y,{modelValue:H.value,"onUpdate:modelValue":a[8]||(a[8]=e=>H.value=e)},{default:w(()=>[k(c,{style:{"min-width":"500px"}},{default:w(()=>[k(r,null,{default:w(()=>a[16]||(a[16]=[V("div",{class:"text-h6"},"Export Questions",-1)])),_:1}),k(r,null,{default:w(()=>[V("p",ke," Export "+U(G.value?"filtered":"all")+" questions to Excel or CSV format. ",1),V("div",Ve,[a[17]||(a[17]=V("div",{class:"text-subtitle2 q-mb-sm"},"Export Format",-1)),k(_,{modelValue:M.value,"onUpdate:modelValue":a[7]||(a[7]=e=>M.value=e),"toggle-color":"primary",options:[{label:"Excel (.xlsx)",value:"xlsx"},{label:"CSV",value:"csv"}]},null,8,["modelValue"])]),V("div",je,[k(l,{name:"info",size:"sm",class:"q-mr-xs"}),E(" "+U(n.value.total)+" questions will be exported "+U(G.value?" (filtered)":""),1)])]),_:1}),k(g,{align:"right"},{default:w(()=>[F(k(d,{flat:"",label:"Cancel",color:"grey-7"},null,512),[[s]]),k(d,{label:"Export",color:"primary",icon:"download",loading:N.value,onClick:te},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],64))}},[["__scopeId","data-v-4cf72f6a"]]);export{Ce as default};
