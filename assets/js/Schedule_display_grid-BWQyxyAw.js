import{Q as e}from"./QTab-CnAf4tCv.js";import{Q as l}from"./QTabs-D_ZwIIJm.js";import{Q as a}from"./QSelect-DB_tK-Lk.js";import{Q as r}from"./QTd-Cd1TbwhN.js";import{Q as d}from"./QTable-Dzgz30xz.js";import{c as o,g as s,i,j as u,d as t,h as n,m as c}from"./app-B77gjd5a.js";import{f as m,a as p,k as v,M as y,Q as h,J as b,N as f,b as g,K as _,I as j,W as Q,V as S,F as k,R as I,_ as w}from"./vendor-DuKqz2x4.js";import C from"./DragDropScheduleTable-CKsgs0rS.js";import"./rtl-Cr6c3OOr.js";import"./QMarkupTable-xKG6mM4A.js";import"./QLinearProgress-B9hMkhRG.js";import"./use-fullscreen-Cf3Zl1YN.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./QSpace-Bk4F2b8L.js";import"./QBar-bEv3i1Ab.js";import"./ScheduleGrid-Cngd6zX_.js";import"./QSlider-DfH-qdFu.js";import"./ScheduleGridControls-BqqJDyA8.js";const T={key:0,class:"mt-4"},q={key:0,class:"p-4"},P={class:"row q-col-gutter-md"},V={class:"text-h6"},x={class:"text-subtitle2"},D={key:0},M={key:1,class:"text-grey q-pa-sm"},F={key:1,class:"p-4"},N={__name:"Schedule_display_grid",props:{schoolId:{type:Number,required:!0},scheduleCopyId:{type:Number,required:!0},schedule_data:{type:Array,required:!1}},setup(N){const G=m("drag"),W=N,$=m(W.schoolId),R=m(W.schedule_data),U=m(!1),A=m(null),B=(e,l)=>R.value.filter(a=>a.day===e&&a.period_number===l),E=[{name:"period_number",label:"Period",field:"period_number",align:"left"},{name:"day",label:"Day",field:"day",align:"left"},{name:"subject",label:"Subject",field:e=>{var l,a;return null==(a=null==(l=e.cst)?void 0:l.subject)?void 0:a.name},align:"left"},{name:"classroom",label:"Classroom",field:e=>{var l,a;return null==(a=null==(l=e.cst)?void 0:l.classroom)?void 0:a.name},align:"left"}],H=p(()=>A.value?R.value.filter(e=>{var l,a;return(null==(a=null==(l=e.cst)?void 0:l.teacher)?void 0:a.id)===A.value.id}):[]),J=p(()=>{if(!R.value.length)return[];return R.value.map(e=>{var l;return null==(l=e.cst)?void 0:l.teacher}).filter(e=>e).reduce((e,l)=>(e.some(e=>e.id===l.id)||e.push(l),e),[]).sort((e,l)=>e.name.localeCompare(l.name))}),K=e=>{console.log("Schedule updated:",e)};return v(()=>W.scheduleCopyId,async()=>{try{U.value=!0;const e=await w.get(`/admin/schedules/${W.schoolId}/${W.scheduleCopyId}`);R.value=e.data}catch(e){console.error("Error fetching schedule data:",e)}finally{U.value=!1}},{immediate:!0}),(m,p)=>$.value&&N.scheduleCopyId?(b(),y("div",T,[p[2]||(p[2]=f("div",{class:"text-h6 q-mb-md"},"Schedule Grid",-1)),g(l,{modelValue:G.value,"onUpdate:modelValue":p[0]||(p[0]=e=>G.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:_(()=>[g(e,{name:"grid",label:"grid"}),g(e,{name:"drag",label:"drag"})]),_:1},8,["modelValue"]),"grid"==G.value?(b(),y("div",q,[g(a,{modelValue:A.value,"onUpdate:modelValue":p[1]||(p[1]=e=>A.value=e),options:J.value,"option-label":"name","option-value":"id",label:"Filter by Teacher",outlined:"",dense:"",clearable:"",class:"q-mb-md"},null,8,["modelValue","options"]),A.value?(b(),j(d,{key:0,rows:H.value,columns:E,"row-key":"id",flat:"",bordered:"",loading:U.value,pagination:{rowsPerPage:0},"hide-pagination":""},{"body-cell-period_number":_(e=>[g(r,{props:e},{default:_(()=>[Q(" Period "+S(e.row.period_number),1)]),_:2},1032,["props"])]),"body-cell-day":_(e=>[g(r,{props:e},{default:_(()=>{return[Q(S((l=e.row.day,["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][l-1]||`Day ${l}`)),1)];var l}),_:2},1032,["props"])]),"body-cell-subject":_(e=>[g(r,{props:e},{default:_(()=>{var l,a;return[Q(S((null==(a=null==(l=e.row.cst)?void 0:l.subject)?void 0:a.name)||"-"),1)]}),_:2},1032,["props"])]),"body-cell-classroom":_(e=>[g(r,{props:e},{default:_(()=>{var l,a;return[Q(S((null==(a=null==(l=e.row.cst)?void 0:l.classroom)?void 0:a.name)||"-"),1)]}),_:2},1032,["props"])]),_:1},8,["rows","loading"])):h("",!0),f("div",P,[(b(),y(k,null,I(7,e=>f("div",{key:e,class:"col-12 col-md-4"},[g(c,{class:"q-pa-md"},{default:_(()=>[g(o,null,{default:_(()=>[f("div",V,"Day "+S(e),1),(b(),y(k,null,I(8,l=>f("div",{key:l,class:"q-mt-sm"},[f("div",x,"Period "+S(l),1),B(e,l).length?(b(),y("div",D,[g(s,{bordered:""},{default:_(()=>[(b(!0),y(k,null,I(B(e,l),e=>(b(),j(n,{key:e.id},{default:_(()=>[g(i,null,{default:_(()=>[g(u,null,{default:_(()=>{var l,a;return[Q(S(null==(a=null==(l=e.cst)?void 0:l.subject)?void 0:a.name),1)]}),_:2},1024),g(u,{caption:""},{default:_(()=>{var l,a,r,d;return[Q(S(null==(a=null==(l=e.cst)?void 0:l.teacher)?void 0:a.name)+" - "+S(null==(d=null==(r=e.cst)?void 0:r.classroom)?void 0:d.name),1)]}),_:2},1024)]),_:2},1024),g(i,{side:""},{default:_(()=>[g(t,{name:e.active?"check_circle":"cancel",color:e.active?"positive":"negative"},null,8,["name","color"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):(b(),y("div",M," No schedule "))])),64))]),_:2},1024)]),_:2},1024)])),64))])])):h("",!0),"drag"==G.value?(b(),y("div",F,[N.schoolId?(b(),j(C,{key:0,"school-id":N.schoolId,scheduleCopyId:N.scheduleCopyId,teachers:J.value,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"],periods:8,initialSchedule:R.value,onScheduleChange:K},null,8,["school-id","scheduleCopyId","teachers","initialSchedule"])):h("",!0)])):h("",!0)])):h("",!0)}};export{N as default};
