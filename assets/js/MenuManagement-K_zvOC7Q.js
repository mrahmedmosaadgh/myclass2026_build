import{u as e,Q as a,a as l,b as s}from"./app-Buylb2AA.js";import{Q as o}from"./QTab-DYNjFyV-.js";import{Q as t}from"./QTabs-DdUHRwMQ.js";import{Q as u}from"./QTabPanel-CY2oJrqN.js";import{Q as n}from"./QTabPanels-BcXMjpO5.js";import{N as m,f as i,k as r,H as d,I as p,J as c,M as v,b as y,L as f,Q as b,F as j,Z as g,_ as Q}from"./vendor-CUZ9QTQV.js";import{u as V,A as M}from"./AdminLayout-DmYvzQOF.js";import C from"./MenuList-BujvCvhj.js";import _ from"./MenuForm-BghwwHdv.js";import h from"./MenuDeleteDialog-DUWLd_uJ.js";import k from"./BulkImportDialog-D6ORVS5Q.js";import"./offline-BzIlwqNM.js";import"./i18n-CP46N9fu.js";import"./ui-LrZmvB2D.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-B1dc8KLj.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-Dt5ch-CZ.js";import"./QSpace-1_yTqfel.js";import"./QSelect-CcTxzM62.js";import"./QForm-Bm_VWO8S.js";import"./QStepperNavigation-BkK4sUGi.js";import"./QStepper-nNlmrtss.js";import"./copy-to-clipboard-B88gbF2I.js";const U={class:"q-pa-md"},w={class:"row q-mb-md items-center"},F={class:"col-auto"},S={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(S){const x=e();m();const A=S,T=i(A.modules[0]||"academics"),D=i(!1),I=i(!1),L=i(!1),q=i(!1),B=i(null),N=i(null),P=e=>A.menus.filter(a=>a.module===e),J=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");r(I,e=>{e&&(B.value=null,D.value=!0,I.value=!1)});const R=e=>{B.value=e,D.value=!0},$=e=>{N.value=e,L.value=!0},E=async e=>{var a,l;try{B.value?(await g.put(`/api/admin/menus/${B.value.id}`,e),x.notify({type:"positive",message:"Menu updated successfully"})):(await g.post("/api/admin/menus",e),x.notify({type:"positive",message:"Menu created successfully"})),X(),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to save menu"})}},H=async()=>{var e,a;try{await g.delete(`/api/admin/menus/${N.value.id}`),x.notify({type:"positive",message:"Menu deleted successfully"}),L.value=!1,Q.reload({only:["menus"]})}catch(l){x.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},K=async e=>{var a,l;try{await g.post("/api/admin/menus/reorder",{items:e}),x.notify({type:"positive",message:"Menu order updated successfully"}),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to reorder menus"})}},O=V(),W=async()=>{await O.invalidateCache(),Q.reload({only:["menus"]})},X=()=>{D.value=!1,B.value=null};return(e,m)=>(p(),d(M,null,{default:c(()=>[v("div",U,[v("div",w,[m[8]||(m[8]=v("div",{class:"col"},[v("div",{class:"text-h4"},"Menu Management"),v("div",{class:"text-subtitle2 text-grey-7"},"Manage navigation menus for your application")],-1)),v("div",F,[y(a,{color:"primary",icon:"add",label:"Create Menu",onClick:m[0]||(m[0]=e=>I.value=!0)}),y(a,{color:"secondary",icon:"upload",label:"Bulk Import",class:"q-ml-sm",onClick:m[1]||(m[1]=e=>q.value=!0)})])]),y(t,{modelValue:T.value,"onUpdate:modelValue":m[2]||(m[2]=e=>T.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left"},{default:c(()=>[(p(!0),f(j,null,b(S.modules,e=>(p(),d(o,{key:e,name:e,label:J(e)},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),y(l),y(n,{modelValue:T.value,"onUpdate:modelValue":m[3]||(m[3]=e=>T.value=e),animated:""},{default:c(()=>[(p(!0),f(j,null,b(S.modules,e=>(p(),d(u,{key:e,name:e},{default:c(()=>[y(C,{menus:P(e),module:e,onEdit:R,onDelete:$,onReorder:K},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),y(s,{modelValue:D.value,"onUpdate:modelValue":m[4]||(m[4]=e=>D.value=e),persistent:""},{default:c(()=>[y(_,{menu:B.value,modules:S.modules,onSave:E,onCancel:X},null,8,["menu","modules"])]),_:1},8,["modelValue"]),y(h,{modelValue:L.value,"onUpdate:modelValue":m[5]||(m[5]=e=>L.value=e),menu:N.value,onConfirm:H,onCancel:m[6]||(m[6]=e=>L.value=!1)},null,8,["modelValue","menu"]),y(k,{modelValue:q.value,"onUpdate:modelValue":m[7]||(m[7]=e=>q.value=e),onImported:W},null,8,["modelValue"])])]),_:1}))}};export{S as default};
