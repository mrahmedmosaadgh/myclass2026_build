import{D as e,ac as l,T as a,U as t,aC as u,bg as n,at as o,S as s,aw as i,ak as r,a2 as d,Q as c,i as v,j as m,h as p,g as f,m as h,c as _,f as k,d as y,aP as b,l as q,b as g,N as w}from"./app-CqJgtQaN.js";import{u as x,a as C,b as V,g as M}from"./use-datetime-C49MdXhF.js";import{_ as S,f as O}from"./date-Caiy_slx.js";import{p as j,f as D,a as H,k as U,n as B,h as A,B as K,y as P,a7 as $,M as F,J as Q,N as Y,b as z,K as I,F as N,R,I as T,W as G,V as J,z as L}from"./vendor-DuKqz2x4.js";import{Q as W}from"./QPopupProxy-Blg_zONg.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";function X(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}const E=e({name:"QTime",props:{...a,...l,...C,modelValue:{required:!0,validator:e=>"string"==typeof e||null===e},mask:{...C.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:x,setup(e,{slots:l,emit:a}){const v=j(),{$q:m}=v.proxy,p=t(e,m),{tabindex:f,headerClass:h,getLocale:_,getCurrentDate:k}=V(e,m),y=u(e),b=i(y);let q,g;const w=D(null),x=H(()=>"persian"!==e.calendar&&null!==e.mask?e.mask:"HH:mm"+(!0===e.withSeconds?":ss":"")),C=H(()=>_()),$=H(()=>function(){if("string"!=typeof e.defaultDate){const e=k(!0);return e.dateHash=M(e),e}return S(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}()),F=S(e.modelValue,x.value,C.value,e.calendar,$.value),Q=D(function(e){return null!==e.hour&&null===e.minute?"minute":"hour"}(F)),Y=D(F),z=D(null===F.hour||F.hour<12),I=H(()=>"q-time q-time--"+(!0===e.landscape?"landscape":"portrait")+(!0===p.value?" q-time--dark q-dark":"")+(!0===e.disable?" disabled":!0===e.readonly?" q-time--readonly":"")+(!0===e.bordered?" q-time--bordered":"")+(!0===e.square?" q-time--square no-border-radius":"")+(!0===e.flat?" q-time--flat no-shadow":"")),N=H(()=>{const e=Y.value;return{hour:null===e.hour?"--":!0===R.value?n(e.hour):String(!0===z.value?0===e.hour?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:null===e.minute?"--":n(e.minute),second:null===e.second?"--":n(e.second)}}),R=H(()=>null!==e.format24h?e.format24h:m.lang.date.format24h),T=H(()=>{const e="hour"===Q.value,l=!0===e?12:60,a=Y.value[Q.value];let t=`rotate(${Math.round(a*(360/l))-180}deg) translateX(-50%)`;return!0===e&&!0===R.value&&Y.value.hour>=12&&(t+=" scale(.7)"),{transform:t}}),G=H(()=>null!==Y.value.hour),J=H(()=>!0===G.value&&null!==Y.value.minute),L=H(()=>void 0!==e.hourOptions?l=>e.hourOptions.includes(l):void 0!==e.options?l=>e.options(l,null,null):null),W=H(()=>void 0!==e.minuteOptions?l=>e.minuteOptions.includes(l):void 0!==e.options?l=>e.options(Y.value.hour,l,null):null),E=H(()=>void 0!==e.secondOptions?l=>e.secondOptions.includes(l):void 0!==e.options?l=>e.options(Y.value.hour,Y.value.minute,l):null),Z=H(()=>{if(null===L.value)return null;const e=oe(0,11,L.value),l=oe(12,11,L.value);return{am:e,pm:l,values:e.values.concat(l.values)}}),ee=H(()=>null!==W.value?oe(0,59,W.value):null),le=H(()=>null!==E.value?oe(0,59,E.value):null),ae=H(()=>{switch(Q.value){case"hour":return Z.value;case"minute":return ee.value;case"second":return le.value}}),te=H(()=>{let e,l,a=0,t=1;const u=null!==ae.value?ae.value.values:void 0;"hour"===Q.value?!0===R.value?(e=0,l=23):(e=0,l=11,!1===z.value&&(a=12)):(e=0,l=55,t=5);const n=[];for(let o=e,s=e;o<=l;o+=t,s++){const e=o+a,l=!1===(null==u?void 0:u.includes(e)),t="hour"===Q.value&&0===o?!0===R.value?"00":"12":o;n.push({val:e,index:s,disable:l,label:t})}return n}),ue=H(()=>[[o,ce,void 0,{stop:!0,prevent:!0,mouse:!0}]]);function ne(){const e={...k(),...X()};je(e),Object.assign(Y.value,e),Q.value="hour"}function oe(e,l,a){const t=Array.apply(null,{length:l+1}).map((l,t)=>{const u=t+e;return{index:u,val:!0===a(u)}}).filter(e=>!0===e.val).map(e=>e.index);return{min:t[0],max:t[t.length-1],values:t,threshold:l+1}}function se(e,l,a){const t=Math.abs(e-l);return Math.min(t,a-t)}function ie(e,{min:l,max:a,values:t,threshold:u}){if(e===l)return l;if(e<l||e>a)return se(e,l,u)<=se(e,a,u)?l:a;const n=t.findIndex(l=>e<=l),o=t[n-1],s=t[n];return e-o<=s-e?o:s}function re(){return!0===r(v)||null!==ae.value&&(0===ae.value.values.length||"hour"===Q.value&&!0!==R.value&&0===Z.value[!0===z.value?"am":"pm"].values.length)}function de(){const e=w.value,{top:l,left:a,width:t}=e.getBoundingClientRect(),u=t/2;return{top:l+u,left:a+u,dist:.7*u}}function ce(e){if(!0!==re()){if(!0===e.isFirst)return q=de(),void(g=me(e.evt,q));g=me(e.evt,q,g),!0===e.isFinal&&(q=!1,g=null,ve())}}function ve(){"hour"===Q.value?Q.value="minute":e.withSeconds&&"minute"===Q.value&&(Q.value="second")}function me(e,l,a){const t=d(e),u=Math.abs(t.top-l.top),n=Math.sqrt(Math.pow(Math.abs(t.top-l.top),2)+Math.pow(Math.abs(t.left-l.left),2));let o,s=Math.asin(u/n)*(180/Math.PI);if(s=t.top<l.top?l.left<t.left?90-s:270+s:l.left<t.left?s+90:270-s,"hour"===Q.value){if(o=s/30,null!==Z.value){const e=!0!==R.value?!0===z.value:0!==Z.value.am.values.length&&0!==Z.value.pm.values.length?n>=l.dist:0!==Z.value.am.values.length;o=ie(o+(!0===e?0:12),Z.value[!0===e?"am":"pm"])}else o=Math.round(o),!0===R.value?n<l.dist?o<12&&(o+=12):12===o&&(o=0):!0===z.value&&12===o?o=0:!1===z.value&&12!==o&&(o+=12);!0===R.value&&(z.value=o<12)}else o=Math.round(s/6)%60,"minute"===Q.value&&null!==ee.value?o=ie(o,ee.value):"second"===Q.value&&null!==le.value&&(o=ie(o,le.value));return a!==o&&Ce[Q.value](o),o}U(()=>e.modelValue,l=>{const a=S(l,x.value,C.value,e.calendar,$.value);a.dateHash===Y.value.dateHash&&a.timeHash===Y.value.timeHash||(Y.value=a,null===a.hour?Q.value="hour":z.value=a.hour<12)}),U([x,C],()=>{B(()=>{je()})});const pe={hour(){Q.value="hour"},minute(){Q.value="minute"},second(){Q.value="second"}};function fe(e){13===e.keyCode&&Ve()}function he(e){13===e.keyCode&&Me()}function _e(e){!0!==re()&&(!0!==m.platform.is.desktop&&me(e,de()),ve())}function ke(e){!0!==re()&&me(e,de())}function ye(e){if(13===e.keyCode)Q.value="hour";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==Z.value){const e=!0===R.value?Z.value.values:Z.value[!0===z.value?"am":"pm"].values;if(0===e.length)return;if(null===Y.value.hour)ge(e[0]);else{const a=(e.length+e.indexOf(Y.value.hour)+l)%e.length;ge(e[a])}}else{const e=!0===R.value?24:12;ge((!0!==R.value&&!1===z.value?12:0)+(24+(null===Y.value.hour?-l:Y.value.hour)+l)%e)}}}function be(e){if(13===e.keyCode)Q.value="minute";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==ee.value){const e=ee.value.values;if(0===e.length)return;if(null===Y.value.minute)we(e[0]);else{const a=(e.length+e.indexOf(Y.value.minute)+l)%e.length;we(e[a])}}else{we((60+(null===Y.value.minute?-l:Y.value.minute)+l)%60)}}}function qe(e){if(13===e.keyCode)Q.value="second";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==le.value){const e=le.value.values;if(0===e.length)return;if(null===Y.value.seconds)xe(e[0]);else{const a=(e.length+e.indexOf(Y.value.second)+l)%e.length;xe(e[a])}}else{xe((60+(null===Y.value.second?-l:Y.value.second)+l)%60)}}}function ge(e){Y.value.hour!==e&&(Y.value.hour=e,Oe())}function we(e){Y.value.minute!==e&&(Y.value.minute=e,Oe())}function xe(e){Y.value.second!==e&&(Y.value.second=e,Oe())}const Ce={hour:ge,minute:we,second:xe};function Ve(){!1===z.value&&(z.value=!0,null!==Y.value.hour&&(Y.value.hour-=12,Oe()))}function Me(){!0===z.value&&(z.value=!1,null!==Y.value.hour&&(Y.value.hour+=12,Oe()))}function Se(l){const a=e.modelValue;Q.value!==l&&null!=a&&""!==a&&"string"!=typeof a&&(Q.value=l)}function Oe(){return null!==L.value&&!0!==L.value(Y.value.hour)?(Y.value=S(),void Se("hour")):null!==W.value&&!0!==W.value(Y.value.minute)?(Y.value.minute=null,Y.value.second=null,void Se("minute")):!0===e.withSeconds&&null!==E.value&&!0!==E.value(Y.value.second)?(Y.value.second=null,void Se("second")):void(null===Y.value.hour||null===Y.value.minute||!0===e.withSeconds&&null===Y.value.second||je())}function je(l){const t=Object.assign({...Y.value},l),u="persian"===e.calendar?n(t.hour)+":"+n(t.minute)+(!0===e.withSeconds?":"+n(t.second):""):O(new Date(t.year,null===t.month?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),x.value,C.value,t.year,t.timezoneOffset);t.changed=u!==e.modelValue,a("update:modelValue",u,t)}function De(){const l=[A("div",{class:"q-time__link "+("hour"===Q.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:pe.hour,onKeyup:ye},N.value.hour),A("div",":"),A("div",!0===G.value?{class:"q-time__link "+("minute"===Q.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:be,onClick:pe.minute}:{class:"q-time__link"},N.value.minute)];!0===e.withSeconds&&l.push(A("div",":"),A("div",!0===J.value?{class:"q-time__link "+("second"===Q.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:qe,onClick:pe.second}:{class:"q-time__link"},N.value.second));const a=[A("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},l)];return!1===R.value&&a.push(A("div",{class:"q-time__header-ampm column items-between no-wrap"},[A("div",{class:"q-time__link "+(!0===z.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Ve,onKeyup:fe},"AM"),A("div",{class:"q-time__link "+(!0!==z.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Me,onKeyup:he},"PM")])),A("div",{class:"q-time__header flex flex-center no-wrap "+h.value},a)}function He(){const l=Y.value[Q.value];return A("div",{class:"q-time__content col relative-position"},[A(K,{name:"q-transition--scale"},()=>A("div",{key:"clock"+Q.value,class:"q-time__container-parent absolute-full"},[A("div",{ref:w,class:"q-time__container-child fit overflow-hidden"},[P(A("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:_e,onMousedown:ke},[A("div",{class:"q-time__clock-circle fit"},[A("div",{class:"q-time__clock-pointer"+(null===Y.value[Q.value]?" hidden":void 0!==e.color?` text-${e.color}`:""),style:T.value}),te.value.map(e=>A("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${e.index}`+(e.val===l?" q-time__clock-position--active "+h.value:!0===e.disable?" q-time__clock-position--disable":"")},[A("span",e.label)]))])]),ue.value)])])),!0===e.nowBtn?A(c,{class:"q-time__now-button absolute",icon:m.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:f.value,onClick:ne}):null])}return v.proxy.setNow=ne,()=>{const a=[He()],t=s(l.default);return void 0!==t&&a.push(A("div",{class:"q-time__actions"},t)),void 0!==e.name&&!0!==e.disable&&b(a,"push"),A("div",{class:I.value,tabindex:-1},[De(),A("div",{class:"q-time__main col overflow-auto"},a)])}}}),Z={class:"q-pa-md"},ee={class:"row items-center justify-between q-mb-md"},le={class:"row q-gutter-sm"},ae={class:"text-h6"},te={class:"row q-col-gutter-sm q-mt-sm"},ue={class:"col-6"},ne={class:"row items-center justify-end"},oe={class:"col-6"},se={class:"row items-center justify-end"},ie={__name:"dp_MasterSchedule",props:{tasks:Array},setup(e){const l=D(!1),a=D(!1),t=D(null),u=$({title:"",start_time:"",end_time:"",description:"",type:"general"}),n=()=>{a.value?u.put(route("dp.master.update",t.value),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸÜÿ¨ÿßÿ≠"})}}):u.post(route("dp.master.store"),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠"})}})},o=()=>{a.value=!1,t.value=null,u.reset()};return(o,s)=>(Q(),F("div",Z,[Y("div",ee,[s[8]||(s[8]=Y("div",{class:"text-h5"},"ÿßŸÑÿ¨ÿØŸàŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä üìÖ",-1)),z(c,{label:"ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸáŸÖÿ©",color:"primary",icon:"add",onClick:s[0]||(s[0]=e=>l.value=!0)})]),z(f,{bordered:"",separator:"",class:"bg-white rounded-borders"},{default:I(()=>[(Q(!0),F(N,null,R(e.tasks,e=>(Q(),T(p,{key:e.id},{default:I(()=>[z(v,null,{default:I(()=>[z(m,null,{default:I(()=>[G(J(e.title),1)]),_:2},1024),z(m,{caption:""},{default:I(()=>[G(J(e.start_time)+" - "+J(e.end_time),1)]),_:2},1024)]),_:2},1024),z(v,{side:""},{default:I(()=>[Y("div",le,[z(c,{flat:"",round:"",color:"primary",icon:"edit",onClick:n=>(e=>{a.value=!0,t.value=e.id,u.title=e.title,u.start_time=e.start_time?e.start_time.substr(0,5):"",u.end_time=e.end_time?e.end_time.substr(0,5):"",u.description=e.description,l.value=!0})(e)},null,8,["onClick"]),z(c,{flat:"",round:"",color:"negative",icon:"delete",onClick:l=>{return a=e.id,void(confirm("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ∞ŸÅÿü")&&u.delete(route("dp.master.destroy",a),{onSuccess:()=>w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ≠ÿ∞ŸÅ"})}));var a}},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),z(g,{modelValue:l.value,"onUpdate:modelValue":s[7]||(s[7]=e=>l.value=e)},{default:I(()=>[z(h,{style:{"min-width":"350px"}},{default:I(()=>[z(_,null,{default:I(()=>[Y("div",ae,J(a.value?"ÿ™ÿπÿØŸäŸÑ ŸÖŸáŸÖÿ©":"ŸÖŸáŸÖÿ© ÿ¨ÿØŸäÿØÿ©"),1)]),_:1}),z(_,{class:"q-pt-none"},{default:I(()=>[z(k,{modelValue:L(u).title,"onUpdate:modelValue":s[1]||(s[1]=e=>L(u).title=e),label:"ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖŸáŸÖÿ©",autofocus:""},null,8,["modelValue"]),Y("div",te,[Y("div",ue,[z(k,{modelValue:L(u).start_time,"onUpdate:modelValue":s[3]||(s[3]=e=>L(u).start_time=e),label:"ŸÖŸÜ",mask:"time",rules:["time"]},{append:I(()=>[z(y,{name:"access_time",class:"cursor-pointer"},{default:I(()=>[z(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:I(()=>[z(E,{modelValue:L(u).start_time,"onUpdate:modelValue":s[2]||(s[2]=e=>L(u).start_time=e),format24h:""},{default:I(()=>[Y("div",ne,[P(z(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),Y("div",oe,[z(k,{modelValue:L(u).end_time,"onUpdate:modelValue":s[5]||(s[5]=e=>L(u).end_time=e),label:"ÿ•ŸÑŸâ",mask:"time",rules:["time"]},{append:I(()=>[z(y,{name:"access_time",class:"cursor-pointer"},{default:I(()=>[z(W,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:I(()=>[z(E,{modelValue:L(u).end_time,"onUpdate:modelValue":s[4]||(s[4]=e=>L(u).end_time=e),format24h:""},{default:I(()=>[Y("div",se,[P(z(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),z(k,{modelValue:L(u).description,"onUpdate:modelValue":s[6]||(s[6]=e=>L(u).description=e),label:"ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ™ÿ≠ŸÅŸäÿ≤Ÿäÿ©",type:"textarea",rows:"2"},null,8,["modelValue"])]),_:1}),z(q,{align:"right",class:"text-primary"},{default:I(()=>[P(z(c,{flat:"",label:"ÿ•ŸÑÿ∫ÿßÿ°"},null,512),[[b]]),z(c,{flat:"",label:"ÿ≠ŸÅÿ∏",onClick:n})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ie as default};
