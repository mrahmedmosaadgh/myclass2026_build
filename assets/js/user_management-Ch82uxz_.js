import{f as e,a as s,a7 as o,af as r,N as a,J as l,b as t,R as n,O as i,z as m,V as d,W as u,I as c,F as p,Q as v,U as f,K as b,y as x,ac as g,ae as y,ab as w,$ as h}from"./vendor-BWKGNkNB.js";import k from"./DialogModal_7-ByEwkwVP.js";import{_}from"./PrimaryButton-DVJXOzHH.js";import{_ as j}from"./SecondaryButton-WaufSYeJ.js";import C from"./UsersManagement-1NrHiL_v.js";import U from"./RolesManagement-BFhDXMUE.js";import S from"./PermissionsManagement-tIdWaxi4.js";import $ from"./UsersRoles-euavKGxO.js";import{u as I}from"./i18n-B0T1C7j3.js";import"./app-DlLesFGi.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./QSelect-BTh0khse.js";import"./rtl-Cr6c3OOr.js";import"./QTab-CYxYFXBq.js";import"./QTabs-BClcf-CB.js";import"./QTabPanel-DXa1fEFB.js";import"./use-panel-BqxRbB7W.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-CTgZWG49.js";import"./UsersList-DiyqBvAs.js";import"./QSpinnerDots-B_GSDqC3.js";import"./QSpace-BK_PGLKv.js";import"./UserDetailsDialog-CcasVMiX.js";const V={class:"flex justify-between items-center"},E={class:"font-semibold text-xl text-gray-800 leading-tight"},R={key:0,class:"py-12"},D={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Q={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},P={class:"border-b border-gray-200 mb-5"},A={class:"-mb-px flex space-x-8"},L=["onClick"],M={class:"mb-4"},T={for:"role-name",class:"block text-sm font-medium text-gray-700"},B={key:0,class:"text-red-500 text-sm mt-1"},O={class:"mb-4"},F={class:"block text-sm font-medium text-gray-700 mb-2"},W={class:"max-h-60 overflow-y-auto p-2 border rounded-md"},z={class:"flex items-center h-5"},H=["id","value"],J={class:"ml-3 text-sm"},K=["for"],N={key:0,class:"text-red-500 text-sm mt-1"},X={class:"mb-4"},Y={for:"permission-name",class:"block text-sm font-medium text-gray-700"},q={key:0,class:"text-red-500 text-sm mt-1"},G={class:"mb-4"},Z={class:"max-h-60 overflow-y-auto p-2 border rounded-md"},ee={class:"flex items-center h-5"},se=["id","value"],oe={class:"ml-3 text-sm"},re=["for"],ae={class:"space-y-4"},le={class:"block text-sm font-medium text-gray-700"},te={key:0,class:"text-red-500 text-sm mt-1"},ne={class:"block text-sm font-medium text-gray-700"},ie={key:0,class:"text-red-500 text-sm mt-1"},me={key:0},de={class:"block text-sm font-medium text-gray-700"},ue={key:0,class:"text-red-500 text-sm mt-1"},ce={key:1},pe={class:"block text-sm font-medium text-gray-700"},ve={class:"block text-sm font-medium text-gray-700"},fe=["value"],be={key:0,class:"text-red-500 text-sm mt-1"},xe={__name:"user_management",props:{roles:Array,permissions:Array,users:Array,enhancedUserData:{type:Object,default:()=>({})}},setup(xe){const{t:ge}=I(),ye=xe,we=e("users-management"),he=e(""),ke=e("all"),_e=e(!1),je=e(!1),Ce=e(null),Ue=e(null),Se=s(()=>[{id:"users-management",name:ge("tabs.users_management")},{id:"roles",name:ge("tabs.roles")},{id:"permissions",name:ge("tabs.permissions")},{id:"users",name:ge("tabs.users_roles")}]),$e=o({name:"",email:"",password:"",password_confirmation:"",roles:[]}),Ie=e(!1),Ve=e(null),Ee=o({name:"",permissionIds:[]}),Re=e(!1),De=e(null),Qe=o({name:""}),Pe=e(!1),Ae=e(null),Le=o({userId:"",roleIds:[]});function Me(e=null){Ve.value=e,e?(Ee.name=e.name,Ee.permissionIds=e.permissions.map(e=>e.id)):Ee.reset(),Ie.value=!0}function Te(e=null){e?(De.value=e,Qe.name=e.name):(De.value=null,Qe.reset()),Re.value=!0}function Be(e){Ae.value=e,Le.userId=e.id,Le.roleIds=e.roles.map(e=>e.id),Pe.value=!0}function Oe(){Ve.value?Ee.put(`/admin/roles/${Ve.value.id}`,{preserveScroll:!0,onSuccess:()=>{Ie.value=!1,Ee.reset()},onError:e=>{console.error(e)}}):Ee.post("/admin/roles",{preserveScroll:!0,onSuccess:()=>{Ie.value=!1,Ee.reset()},onError:e=>{console.error(e)}})}function Fe(e){confirm(ge("role.confirm_delete",{name:e.name}))&&h.delete(`/admin/roles/${e.id}`,{preserveScroll:!0})}function We(){De.value?Qe.put(`/admin/permissions/${De.value.id}`,{preserveScroll:!0,onSuccess:()=>{Re.value=!1,Qe.reset()},onError:e=>{console.error(e)}}):Qe.post("/admin/permissions",{preserveScroll:!0,onSuccess:()=>{Re.value=!1,Qe.reset()},onError:e=>{console.error(e)}})}function ze(e){confirm(ge("permission.confirm_delete",{name:e.name}))&&h.delete(`/admin/permissions/${e.id}`,{preserveScroll:!0})}function He(){h.put(`/admin/users/${Ae.value.id}/roles`,Le,{preserveScroll:!0,onSuccess:()=>{Pe.value=!1,Le.reset()}})}s(()=>{let e=[...ye.users];if(he.value){const s=he.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s))}return"active"===ke.value?e=e.filter(e=>!e.deleted_at):"deleted"===ke.value&&(e=e.filter(e=>e.deleted_at)),e});const Je=(e=null)=>{Ce.value=e,e?($e.name=e.name,$e.email=e.email,$e.password="",$e.password_confirmation="",$e.roles=e.roles.map(e=>e.id)):$e.reset(),_e.value=!0},Ke=()=>{_e.value=!1,Ce.value=null,$e.reset()},Ne=()=>{Ce.value?($e.password||(delete $e.password,delete $e.password_confirmation),$e.put(route("admin.users.update",Ce.value.id),{preserveScroll:!0,onSuccess:()=>{Ke()},onError:e=>{console.error(e)}})):$e.post(route("admin.users.store"),{preserveScroll:!0,onSuccess:()=>{Ke()},onError:e=>{console.error(e)}})},Xe=e=>{Ue.value=e,je.value=!0},Ye=()=>{je.value=!1,Ue.value=null},qe=()=>{Ue.value&&o({}).delete(route("admin.users.destroy",Ue.value.id),{onSuccess:()=>Ye()})},Ge=e=>{o({}).put(route("admin.users.restore",e.id))},Ze=()=>{const e=ye.users.map(e=>({name:e.name,email:e.email,password:"12345678",roles:e.roles.map(e=>e.name).join(";")})),s=[["name","email","password","roles"].join(","),...e.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.password}"`,`"${e.roles}"`].join(","))].join("\n"),o=new Blob([s],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),a=URL.createObjectURL(o);r.setAttribute("href",a),r.setAttribute("download","users_export.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)};return(e,s)=>{const o=r("Head");return l(),a(p,null,[t(o,{title:m(ge)("permissions.dashboard")},null,8,["title"]),n("div",null,[n("div",V,[n("h2",E,d(m(ge)("user.management_dashboard")),1),n("button",{onClick:Ze,class:"px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 flex items-center gap-2"},[s[17]||(s[17]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),u(" "+d(m(ge)("user.export_users")),1)])])]),xe.users?(l(),a("div",R,[n("div",D,[n("div",Q,[n("div",P,[n("nav",A,[(l(!0),a(p,null,v(Se.value,e=>(l(),a("button",{key:e.id,onClick:s=>we.value=e.id,class:f([we.value===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},d(e.name),11,L))),128))])]),"users-management"===we.value?(l(),c(C,{key:0,users:xe.users,onEditUser:Je,onDeleteUser:Xe,onRestoreUser:Ge},null,8,["users"])):i("",!0),"roles"===we.value?(l(),c(U,{key:1,roles:xe.roles,onCreateRole:s[0]||(s[0]=e=>Me()),onEditRole:Me,onDeleteRole:Fe},null,8,["roles"])):i("",!0),"permissions"===we.value?(l(),c(S,{key:2,permissions:xe.permissions,onCreatePermission:s[1]||(s[1]=e=>Te()),onEditPermission:Te,onDeletePermission:ze},null,8,["permissions"])):i("",!0),"users"===we.value?(l(),c($,{key:3,users:xe.users,"enhanced-user-data":xe.enhancedUserData,onManageUserRoles:Be},null,8,["users","enhanced-user-data"])):i("",!0)])])])):i("",!0),t(k,{show:Ie.value,onClose:s[5]||(s[5]=e=>Ie.value=!1)},{title:b(()=>[u(d(Ve.value?m(ge)("role.edit"):m(ge)("role.create")),1)]),content:b(()=>[n("div",null,[n("div",M,[n("label",T,d(m(ge)("role.name")),1),x(n("input",{type:"text",id:"role-name","onUpdate:modelValue":s[2]||(s[2]=e=>m(Ee).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ee).name]]),m(Ee).errors.name?(l(),a("div",B,d(m(Ee).errors.name),1)):i("",!0)]),n("div",O,[n("label",F,d(m(ge)("permissions.label")),1),n("div",W,[(l(!0),a(p,null,v(xe.permissions,e=>(l(),a("div",{key:e.id,class:"flex items-start mb-2"},[n("div",z,[x(n("input",{id:`permission-${e.id}`,type:"checkbox",value:e.id,"onUpdate:modelValue":s[3]||(s[3]=e=>m(Ee).permissionIds=e),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,H),[[y,m(Ee).permissionIds]])]),n("div",J,[n("label",{for:`permission-${e.id}`,class:"font-medium text-gray-700"},d(e.name),9,K)])]))),128))]),m(Ee).errors.permissionIds?(l(),a("div",N,d(m(Ee).errors.permissionIds),1)):i("",!0)])])]),footer:b(()=>[t(j,{onClick:s[4]||(s[4]=e=>Ie.value=!1)},{default:b(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:Oe,disabled:m(Ee).processing},{default:b(()=>[u(d(Ve.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["disabled"])]),_:1},8,["show"]),t(k,{show:Re.value,onClose:s[8]||(s[8]=e=>Re.value=!1)},{title:b(()=>[u(d(De.value?m(ge)("permission.edit"):m(ge)("permission.create")),1)]),content:b(()=>[n("div",null,[n("div",X,[n("label",Y,d(m(ge)("permission.name")),1),x(n("input",{type:"text",name:"permission-name",id:"permission-name","onUpdate:modelValue":s[6]||(s[6]=e=>m(Qe).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Qe).name]]),m(Qe).errors.name?(l(),a("div",q,d(m(Qe).errors.name),1)):i("",!0)])])]),footer:b(()=>[t(j,{onClick:s[7]||(s[7]=e=>Re.value=!1)},{default:b(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:We,disabled:m(Qe).processing},{default:b(()=>[u(d(De.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["disabled"])]),_:1},8,["show"]),t(k,{show:Pe.value,onClose:s[11]||(s[11]=e=>Pe.value=!1)},{title:b(()=>[u(d(m(ge)("user.manage_roles_for",{name:Ae.value?Ae.value.name:""})),1)]),content:b(()=>[n("div",null,[n("div",G,[n("div",Z,[(l(!0),a(p,null,v(xe.roles,e=>(l(),a("div",{key:e.id,class:"flex items-start mb-2"},[n("div",ee,[x(n("input",{id:`user-role-${e.id}`,type:"checkbox",value:e.id,"onUpdate:modelValue":s[9]||(s[9]=e=>m(Le).roleIds=e),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,se),[[y,m(Le).roleIds]])]),n("div",oe,[n("label",{for:`user-role-${e.id}`,class:"font-medium text-gray-700"},d(e.name),9,re)])]))),128))])])])]),footer:b(()=>[t(j,{onClick:s[10]||(s[10]=e=>Pe.value=!1)},{default:b(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:He},{default:b(()=>[u(d(m(ge)("user.save_roles")),1)]),_:1})]),_:1},8,["show"]),t(k,{show:_e.value,onClose:Ke},{title:b(()=>[u(d(Ce.value?m(ge)("user.edit"):m(ge)("user.create")),1)]),content:b(()=>[n("div",ae,[n("div",null,[n("label",le,d(m(ge)("user.name")),1),x(n("input",{type:"text","onUpdate:modelValue":s[12]||(s[12]=e=>m($e).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m($e).name]]),m($e).errors.name?(l(),a("div",te,d(m($e).errors.name),1)):i("",!0)]),n("div",null,[n("label",ne,d(m(ge)("user.email")),1),x(n("input",{type:"email","onUpdate:modelValue":s[13]||(s[13]=e=>m($e).email=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m($e).email]]),m($e).errors.email?(l(),a("div",ie,d(m($e).errors.email),1)):i("",!0)]),Ce.value?i("",!0):(l(),a("div",me,[n("label",de,d(m(ge)("user.password")),1),x(n("input",{type:"password","onUpdate:modelValue":s[14]||(s[14]=e=>m($e).password=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m($e).password]]),m($e).errors.password?(l(),a("div",ue,d(m($e).errors.password),1)):i("",!0)])),!Ce.value||m($e).password?(l(),a("div",ce,[n("label",pe,d(m(ge)("user.confirm_password")),1),x(n("input",{type:"password","onUpdate:modelValue":s[15]||(s[15]=e=>m($e).password_confirmation=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m($e).password_confirmation]])])):i("",!0),n("div",null,[n("label",ve,d(m(ge)("user.roles")),1),x(n("select",{multiple:"","onUpdate:modelValue":s[16]||(s[16]=e=>m($e).roles=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[(l(!0),a(p,null,v(xe.roles,e=>(l(),a("option",{key:e.id,value:e.id},d(e.name),9,fe))),128))],512),[[w,m($e).roles]]),m($e).errors.roles?(l(),a("div",be,d(m($e).errors.roles),1)):i("",!0)])])]),footer:b(()=>[n("button",{onClick:Ke,class:"mr-3 px-4 py-2 text-gray-700 hover:text-gray-900"},d(m(ge)("common.cancel")),1),n("button",{onClick:Ne,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},d(Ce.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["show"]),t(k,{show:je.value,onClose:Ye},{title:b(()=>[u(d(m(ge)("user.delete")),1)]),content:b(()=>[u(d(m(ge)("user.confirm_delete")),1)]),footer:b(()=>[n("button",{onClick:Ye,class:"mr-3 px-4 py-2 text-gray-700 hover:text-gray-900"},d(m(ge)("common.cancel")),1),n("button",{onClick:qe,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"},d(m(ge)("user.delete")),1)]),_:1},8,["show"])],64)}}};export{xe as default};
