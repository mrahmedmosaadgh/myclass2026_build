import{p as e,u as s,q as a,Q as t,aq as l,e as o,n as r,d as i,A as n,a as d,m as c}from"./app-BzjXrVp9.js";import{Q as u}from"./QTab-Cx9aTRVb.js";import{Q as m}from"./QTabs-BwLFzVWR.js";import{Q as g}from"./QBadge-D2ciqrkO.js";import{Q as v}from"./QSpace-qzKo_-If.js";import{f as p,a as y,k as f,o as b,L as h,I as x,M as w,O as q,H as _,J as k,b as j,V as z,U as Q,y as C,F as D,Q as L,S as M,$ as V,P as S,Z as E}from"./vendor-EI0FRBVb.js";import{u as F}from"./teacherStore-BELNLpdq.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./rtl-Cr6c3OOr.js";const I={class:"q-pa-md bg-grey-2"},P={class:"max-w-7xl mx-auto"},$={class:"row justify-between items-center q-mb-lg"},N={class:"row items-center gap-2"},T={class:"text-h4 text-weight-bold text-grey-9 q-my-none"},A={class:"text-subtitle2 text-grey-7 q-mt-xs"},B={key:0,class:"row justify-center q-py-xl"},H={key:1},O={key:0,class:"col-12 text-center q-py-xl"},U={key:1},G={key:0,class:"q-mb-lg"},J={class:"q-mt-md row q-col-gutter-lg"},Z={class:"text-h6 text-weight-bold"},K={class:"text-subtitle1 text-grey-9 text-weight-bold q-mt-md"},R={key:2},W={key:0,class:"text-center q-py-xl bg-white rounded-borders shadow-1"},X={class:"text-body2 text-grey-6 q-mt-xs"},Y={class:"q-mt-md"},ee={key:1,class:"row q-col-gutter-md"},se={class:"row items-center q-gutter-xs q-mb-sm"},ae={class:"text-caption text-grey-5"},te=["title"],le={class:"text-body2 text-grey-6 ellipsis-2-lines q-mt-xs"},oe={class:"column full-width q-gutter-xs"},re={class:"row justify-between items-center"},ie={class:"row q-gutter-xs"},ne={class:"row q-gutter-xs"},de=["href"],ce={class:"row q-gutter-xs full-width"},ue=e({__name:"LessonList",setup(e){const ue=s(),me=F(),ge=p([]),ve=p(!1),pe=p("dashboard"),ye=p(null),fe=p(null),be=y(()=>{const e=new Map;return me.grades?(me.grades.forEach(s=>{s.classrooms&&s.classrooms.forEach(a=>{a.subjects&&a.subjects.forEach(t=>{e.has(t.id)||e.set(t.id,{id:t.id,name:t.name,classrooms:[]}),e.get(t.id).classrooms.push({id:a.id,name:a.name,grade_id:s.id,grade_name:s.name})})})}),Array.from(e.values())):[]});f(be,e=>{e.length>0&&!ye.value&&(ye.value=e[0].id)},{immediate:!0});const he=y(()=>{const e=be.value.find(e=>e.id===ye.value);return e?e.classrooms:[]}),xe=y(()=>be.value.find(e=>e.id===ye.value)),we=e=>{fe.value=e,pe.value="lessons",qe()},qe=async()=>{if(fe.value&&ye.value){ve.value=!0;try{const e={grade_id:fe.value.grade_id,subject_id:ye.value},s=await E.get(route("lesson-presentation.list"),{params:e});ge.value=s.data}catch(e){console.error("Failed to fetch lessons:",e),ue.notify({type:"negative",message:"Failed to fetch lessons."})}finally{ve.value=!1}}};return b(async()=>{await me.fetchTeacherData()}),(e,s)=>{var p,y,f,b;return x(),h("div",I,[w("div",P,[w("div",$,[w("div",null,[w("div",N,["lessons"===pe.value?(x(),_(t,{key:0,flat:"",round:"",dense:"",icon:"arrow_back",color:"primary",onClick:s[0]||(s[0]=e=>pe.value="dashboard")},{default:k(()=>[j(a,null,{default:k(()=>s[2]||(s[2]=[z("Back to Dashboard")])),_:1})]),_:1})):q("",!0),w("h1",T,Q("dashboard"===pe.value?"My Classes":`${null==(p=fe.value)?void 0:p.name} - ${null==(y=xe.value)?void 0:y.name} Lessons`),1)]),w("p",A,Q("dashboard"===pe.value?"Select a class to manage lessons.":"Manage your interactive lessons for this class."),1)])]),ve.value||C(me).loading?(x(),h("div",B,[j(l,{color:"primary",size:"3em"})])):"dashboard"===pe.value?(x(),h("div",H,[0===be.value.length?(x(),h("div",O,[j(o,{name:"school",size:"4rem",color:"grey-4",class:"q-mb-md"}),s[3]||(s[3]=w("h3",{class:"text-h6 text-grey-7"},"No classes assigned.",-1))])):(x(),h("div",U,[be.value.length>1?(x(),h("div",G,[j(r,{flat:"",bordered:"",class:"rounded-borders"},{default:k(()=>[j(m,{modelValue:ye.value,"onUpdate:modelValue":s[1]||(s[1]=e=>ye.value=e),dense:"",class:"text-grey-7 bg-grey-1","active-color":"white","active-bg-color":"primary","indicator-color":"transparent",align:"left","narrow-indicator":"","content-class":"q-pa-sm"},{default:k(()=>[(x(!0),h(D,null,L(be.value,e=>(x(),_(u,{key:e.id,name:e.id,label:e.name,class:"rounded-borders q-mr-sm"},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1})])):q("",!0),w("div",J,[(x(!0),h(D,null,L(he.value,(a,l)=>(x(),h("div",{key:a.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[j(r,{class:"cursor-pointer hover-shadow transition-generic full-height column no-wrap overflow-hidden rounded-borders-lg",onClick:e=>we(a)},{default:k(()=>[w("div",{class:M(["q-pa-md text-white row items-center justify-between",["bg-blue-6","bg-purple-6","bg-teal-6","bg-indigo-6","bg-deep-orange-6"][l%5]])},[w("div",Z,Q(a.name),1),j(o,{name:"class",size:"24px",class:"opacity-80"})],2),j(i,{class:"col flex flex-center column q-py-lg bg-white relative-position"},{default:k(()=>[j(n,{size:"60px","font-size":"30px",class:M(["text-blue-6","text-purple-6","text-teal-6","text-indigo-6","text-deep-orange-6"][l%5]),color:"grey-2",icon:"school"},null,8,["class"]),w("div",K,Q(a.grade_name),1),s[4]||(s[4]=w("div",{class:"text-caption text-grey-6 q-mt-xs text-center"}," Manage lessons & student progress ",-1))]),_:2},1024),j(d),j(c,{align:"center",class:"bg-grey-1 q-pa-md row q-gutter-md"},{default:k(()=>[j(t,{flat:"",dense:"",color:"grey-8",icon:"visibility",label:"View",class:"col",onClick:V(e=>we(a),["stop"])},null,8,["onClick"]),j(C(S),{href:e.route("lesson-presentation.edit",{grade_id:a.grade_id,subject_id:ye.value}),class:"col"},{default:k(()=>[j(t,{unelevated:"",dense:"",color:["blue-6","purple-6","teal-6","indigo-6","deep-orange-6"][l%5],icon:"add",label:"Create",class:"full-width"},null,8,["color"])]),_:2},1032,["href"])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])]))])):"lessons"===pe.value?(x(),h("div",R,[0===ge.value.length?(x(),h("div",W,[j(o,{name:"auto_stories",size:"4rem",color:"grey-4",class:"q-mb-md"}),s[5]||(s[5]=w("h3",{class:"text-h6 text-weight-medium text-grey-9 q-my-none"},"No lessons found",-1)),w("p",X,"Get started by creating your first interactive lesson for "+Q(null==(f=fe.value)?void 0:f.name)+".",1),w("div",Y,[j(C(S),{href:e.route("lesson-presentation.edit",{grade_id:null==(b=fe.value)?void 0:b.grade_id,subject_id:ye.value})},{default:k(()=>[j(t,{color:"primary",icon:"add",label:"Create Lesson","no-caps":""})]),_:1},8,["href"])])])):(x(),h("div",ee,[(x(!0),h(D,null,L(ge.value,a=>(x(),h("div",{key:a.id,class:"col-12 col-sm-6 col-lg-4"},[j(r,{class:"column full-height hover-shadow transition-generic"},{default:k(()=>[j(i,{class:"col q-pb-none"},{default:k(()=>[w("div",se,[j(g,{color:"blue-1","text-color":"primary"},{default:k(()=>[j(o,{name:"menu_book",size:"xs",class:"q-mr-xs"}),z(" "+Q(a.slides_count||0),1)]),_:2},1024),a.quiz_id?(x(),_(g,{key:0,color:"green-1","text-color":"green"},{default:k(()=>[j(o,{name:"quiz",size:"xs",class:"q-mr-xs"}),s[6]||(s[6]=z(" Quiz "))]),_:1})):q("",!0),j(v),w("span",ae,Q(new Date(a.created_at).toLocaleDateString()),1)]),w("div",{class:"text-h6 text-grey-9 ellipsis",title:a.name},Q(a.name),9,te),w("div",le,Q(a.description||"No description provided."),1)]),_:2},1024),j(c,{class:"bg-grey-1 border-top-grey-3 q-px-md q-py-sm"},{default:k(()=>[w("div",oe,[w("div",re,[w("div",ie,[j(C(S),{href:e.route("lesson-presentation.edit",{id:a.id})},{default:k(()=>[j(t,{flat:"",dense:"",size:"sm",color:"grey-7",icon:"edit",label:"Edit","no-caps":""})]),_:2},1032,["href"]),j(t,{flat:"",dense:"",size:"sm",color:"grey-7",icon:"delete",label:"Delete","no-caps":"",onClick:e=>(async e=>{ue.dialog({title:"Confirm Deletion",message:`Delete "${e.name}"?`,cancel:!0,persistent:!0}).onOk(async()=>{try{await E.delete(route("lesson-presentation.destroy",{id:e.id})),ge.value=ge.value.filter(s=>s.id!==e.id),ue.notify({type:"positive",message:"Lesson deleted."})}catch(s){ue.notify({type:"negative",message:"Failed to delete lesson."})}})})(a)},null,8,["onClick"])]),w("div",ne,[w("a",{href:e.route("lesson-presentation.student.view",{id:a.id}),target:"_blank"},[j(t,{flat:"",dense:"",size:"sm",color:"primary",icon:"play_arrow",label:"Preview","no-caps":""})],8,de)])]),j(d),w("div",ce,[j(C(S),{href:e.route("lesson-presentation.teacher.progress",{lessonId:a.id})},{default:k(()=>[j(t,{unelevated:"",dense:"",size:"sm",color:"primary",icon:"assessment",label:"View Progress","no-caps":""})]),_:2},1032,["href"])])])]),_:2},1024)]),_:2},1024)]))),128))]))])):q("",!0)])])}}},[["__scopeId","data-v-51c986a5"]]);export{ue as default};
