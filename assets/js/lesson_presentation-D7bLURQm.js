import{D as e,as as t,K as n,aj as l,Q as a,o as s,u as o,A as i,d as r,f as d,m as c,c as u,b as p,p as m,l as v,aP as f,C as g,B as b,k as y,a as h,aF as x}from"./app-ggGwxJON.js";import{f as _,a as w,n as S,p as k,h as j,I as C,J as q,K as I,b as T,O as P,N as L,R as E,z as U,F as V,V as O,W as A,y as Q,Q as $,S as z,U as N,k as R,o as D,A as M,af as G,a2 as F,B,am as H,Y as J,ak as W,_ as K}from"./vendor-nQjeLEvd.js";import{Q as Y}from"./QBadge-DVUbh_5M.js";import{Q as X,a as Z}from"./QToolbar-DMbCF1rG.js";import{Q as ee}from"./QHeader-QSVvjn9L.js";import{Q as te}from"./QDrawer-DFCooEAP.js";import{Q as ne}from"./QSelect-DOo83gJW.js";import{Q as le}from"./QPage-B1Nl3adk.js";import{Q as ae}from"./QPageContainer-CznOqmtM.js";import{Q as se}from"./QLayout-D3qfTWrb.js";import{Q as oe}from"./QSpace-DKhB4IlP.js";import{Q as ie}from"./QBar-CrRFYR5C.js";import re from"./TextSlide-CaYXYxMS.js";import de from"./MediaSlide-DXY100o7.js";import{Q as ce}from"./QuestionSlide-CU5tqDZx.js";import ue from"./PDFSlide-Bt7FU2qD.js";import pe from"./VideoSlide-D5LzHSNC.js";import me from"./LessonSidebar-B1Wxxf4h.js";import ve from"./LessonPlayer-BloJUrQM.js";import fe from"./FingerDrawingSlide-iYc-GhH5.js";import{Q as ge,a as be}from"./QStepper-CL1d_Zwg.js";import{u as ye}from"./teacherStore-CoiTiwGN.js";import he from"./reward_sys-utii91bI.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";import"./rtl-Cr6c3OOr.js";import"./RichTextEditor-BiojowB3.js";import"./QColor-Gten_QEt.js";import"./QSlider-rHpK1y__.js";import"./QTabs-DMYUh0Ok.js";import"./QTab-Dz6RnWyq.js";import"./QTabPanels-BH2gx17B.js";import"./use-panel-BQ7QSG7B.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanel-DWPrbrYB.js";import"./purify.es-C2Ba6vpb.js";import"./MathEditor-BaYsC1Mk.js";import"./katex-BXKQVcz-.js";import"./MathPastePreview-Beckx_uo.js";import"./EnhancedQuestionEditor-DzTqQgQr.js";import"./QuestionEditor-DAFbQDAu.js";import"./StepByStepEditor-WT-qNlOk.js";import"./QuestionTypeSelector-CzZfUg3W.js";import"./QuizEngine-DW37yIyH.js";import"./useQuizI18n-D42PDdQD.js";import"./QLinearProgress-DJHuJoTJ.js";import"./QSpinnerDots-xIVaxwwk.js";import"./PlayerSidebar-DSiSWTO0.js";import"./SectionCard-usptGh1g.js";import"./SectionBanner-nmb_7N5U.js";import"./SlideRenderer-DP5TZv_f.js";import"./QPopupProxy-B_TgS9uL.js";import"./NavigationFooter-CTjx-5Fn.js";import"./DrawingOverlay-RBoppW9i.js";import"./DrawingCanvas-LPj7FZdV.js";import"./DrawingToolbar-CQouNTtJ.js";import"./QBtnToggle-CO55A_1i.js";import"./SlideAnnotationOverlay-DRPB5HyJ.js";import"./reward_sys_point_action-oLy4sW63.js";import"./PeriodSelectionRefactored-CT_ttYJH.js";import"./ClassroomSelection-DFsO_V-T.js";import"./TopLeaderboard-D08TxZUZ.js";import"./html2canvas.esm-Cq3pa7K9.js";import"./CertificateGenerator-D6gN64KK.js";import"./jspdf.es.min-KPg7L82s.js";import"./StudentCard-DbZCVyli.js";import"./AvatarManager-CEvP1T-P.js";import"./CameraCapture-CL8mYJbX.js";import"./StudentGrouping-Cyb3NJFR.js";import"./vuedraggable.umd-C4qRof-w.js";import"./index-DTdDyFNb.js";import"./BehaviorIncidents-DeJpdoXo.js";import"./IncidentPrintReport-CZcACHfC.js";function xe(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const n=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:"function"!=typeof e.constructor?Object.create(null):void 0!==e.prototype&&"function"==typeof e.prototype.constructor?e:new e.constructor;if("function"==typeof e.constructor&&"function"==typeof e.valueOf){const n=e.valueOf();if(Object(n)!==n){const l=new e.constructor(n);return t.set(e,l),l}}return t.set(e,n),e instanceof Set?e.forEach(e=>{n.add(xe(e,t))}):e instanceof Map&&e.forEach((e,l)=>{n.set(l,xe(e,t))}),Object.assign(n,...Object.keys(e).map(n=>({[n]:xe(e[n],t)})))}const _e=e({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:s,emit:o}){const{proxy:i}=k(),{$q:r}=i,d=_(null),c=_(""),u=_("");let p=!1;const m=w(()=>t({initialValue:c.value,validate:e.validate,set:v,cancel:f,updatePosition:g},"value",()=>u.value,e=>{u.value=e}));function v(){!1!==e.validate(u.value)&&(!0===b()&&(o("save",u.value,c.value),o("update:modelValue",u.value)),y())}function f(){!0===b()&&o("cancel",u.value,c.value),y()}function g(){S(()=>{d.value.updatePosition()})}function b(){return!1===n(u.value,c.value)}function y(){p=!0,d.value.hide()}function h(){p=!1,c.value=xe(e.modelValue),u.value=xe(e.modelValue),o("beforeShow")}function x(){o("show")}function C(){!1===p&&!0===b()&&(!0===e.autoSave&&!0===e.validate(u.value)?(o("save",u.value,c.value),o("update:modelValue",u.value)):o("cancel",u.value,c.value)),o("beforeHide")}function q(){o("hide")}function I(){const t=void 0!==s.default?[].concat(s.default(m.value)):[];return e.title&&t.unshift(j("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),!0===e.buttons&&t.push(j("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[j(a,{flat:!0,color:e.color,label:e.labelCancel||r.lang.label.cancel,onClick:f}),j(a,{flat:!0,color:e.color,label:e.labelSet||r.lang.label.set,onClick:v})])),t}return Object.assign(i,{set:v,cancel:f,show(e){var t;null==(t=d.value)||t.show(e)},hide(e){var t;null==(t=d.value)||t.hide(e)},updatePosition:g}),()=>{if(!0!==e.disable)return j(l,{ref:d,class:"q-popup-edit",cover:e.cover,onBeforeShow:h,onShow:x,onBeforeHide:C,onHide:q,onEscapeKey:f},I)}}});const we=[{label:"Interactive Lesson",instructions:"Include interactive elements, questions for students, and hands-on activities in each section."},{label:"Visual Learning",instructions:"Focus on visual descriptions, diagrams explanations, and visual metaphors to explain concepts."},{label:"Step-by-Step",instructions:"Break down complex topics into simple, sequential steps. Use numbered lists and clear progression."},{label:"Real-World Examples",instructions:"Include real-world applications and practical examples that students can relate to."},{label:"Differentiated",instructions:"Provide content at multiple difficulty levels to accommodate different learning abilities."}],Se={class:"z-10 w-full left-0 bg-grey-1"},ke={class:"q-pa-md",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},je={class:"row items-center"},Ce={class:"max-w-3xl mx-auto p-6"},qe={class:"mb-6"},Ie={class:"flex flex-wrap gap-2"},Te={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},Pe={class:"grid grid-cols-2 gap-3 text-sm"},Le={class:"ml-2 text-blue-700"},Ee={class:"ml-2 text-blue-700"},Ue={class:"col-span-2"},Ve={class:"ml-2 text-blue-700"},Oe={class:"mb-4"},Ae={class:"grid grid-cols-2 gap-2"},Qe={class:"text-xl"},$e={class:"text-sm font-medium"},ze={class:"flex justify-end gap-2"},Ne={class:"max-w-6xl mx-auto p-6"},Re={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},De={class:"flex items-start gap-2"},Me={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ge={class:"flex items-center justify-between mb-2"},Fe={class:"whitespace-pre-wrap text-xs font-mono"},Be={class:"mt-4"},He={class:"flex items-center justify-between mb-2"},Je={class:"flex gap-2"},We={class:"flex items-center justify-between mb-2"},Ke={class:"border rounded-lg overflow-hidden bg-white",style:{height:"400px"}},Ye=["src"],Xe={key:1,class:"flex items-center justify-center h-full text-gray-400"},Ze={class:"text-center"},et={class:"flex justify-between gap-2 mt-6"},tt={class:"mt-4"},nt={class:"space-y-2"},lt={class:"max-w-4xl mx-auto p-6"},at={class:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4"},st={class:"flex items-start gap-2"},ot={class:"relative mb-4"},it={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},rt={class:"flex items-start gap-2"},dt={class:"flex-1"},ct={class:"list-disc list-inside text-sm text-red-700 space-y-1"},ut={class:"flex justify-between gap-2"},pt={class:"max-w-5xl mx-auto p-6"},mt={key:0,class:"space-y-4"},vt={class:"grid grid-cols-2 gap-4"},ft={class:"ml-2"},gt={class:"ml-2"},bt={class:"bg-gray-100 px-4 py-2 font-semibold flex items-center gap-2"},yt={class:"p-4 space-y-2"},ht={class:"flex-1"},xt={class:"text-xs text-gray-500 mb-1"},_t=["innerHTML"],wt={class:"flex justify-between gap-2 mt-6"},St={class:"flex gap-2"},kt=s({__name:"AILessonPlanGenerator",props:{lessonConfig:{type:Object,required:!0}},emits:["plan-accepted","close"],setup(e,{expose:t,emit:n}){const l=o(),s=n,b=e,y=_(!1),h=_(1),x=_({customInstructions:""}),S=we,k=_(""),j=_(!1),z=_(""),N=_(""),R=_(!1),D=[{name:"Gemini",url:"https://gemini.google.com/"},{name:"ChatGPT",url:"https://chatgpt.com/"},{name:"Claude",url:"https://claude.ai/"},{name:"Perplexity",url:"https://www.perplexity.ai/"}],M=_(""),G=_([]),F=_(null),B=_(!1),H=w(()=>F.value?F.value.sections.reduce((e,t)=>e+t.slides.length,0):0),J=e=>{z.value=e,localStorage.setItem("ai_tool_url",e),l.notify({type:"positive",message:"AI tool updated",position:"top",timeout:1500})},W=()=>{N.value.trim()&&(J(N.value.trim()),R.value=!1)},K=()=>{z.value&&window.open(z.value,"_blank")},Y=()=>{y.value=!1,s("close")},X=()=>{x.value={customInstructions:""},k.value="",M.value="",G.value=[],F.value=null},Z=()=>{k.value=function(e){const{lessonTitle:t,subject:n,grade:l,sections:a,customInstructions:s}=e;return`You are an expert educational content designer specializing in ${n} for ${l} students.\n\nCreate a comprehensive lesson plan for: "${t}"\n\nLESSON STRUCTURE:\nThe lesson has the following sections:\n${a.map(e=>`- ${e.title} (${e.id})`).join("\n")}\n\nREQUIREMENTS:\n1. Generate 3-5 slides for EACH section\n2. Each slide should have educational content appropriate for ${l} level\n3. Content should be engaging, clear, and pedagogically sound\n4. Include variety: text slides, and question slides\n5. For practice/assessment sections, include MORE question slides\n\n${(e=>{const t=e.toLowerCase();return t.includes("math")||t.includes("رياضيات")?"For Mathematics:\n- Use single_choice for concept understanding\n- Use true_false for properties and theorems\n- Include step-by-step problem solving in text slides\n- Add practice problems with multiple choice answers":t.includes("science")||t.includes("علوم")?"For Science:\n- Use single_choice for facts and concepts\n- Use true_false for scientific statements\n- Include diagrams descriptions in text slides\n- Add experiment-based questions":t.includes("language")||t.includes("لغة")?"For Language Arts:\n- Use single_choice for grammar and vocabulary\n- Use true_false for comprehension checks\n- Include reading passages in text slides\n- Add questions about text analysis":"General guidance:\n- Use single_choice for concept testing\n- Use true_false for fact checking\n- Mix question types for engagement"})(n)}\n\n${s?`CUSTOM INSTRUCTIONS:\n${s}\n`:""}\n\nOUTPUT FORMAT:\nReturn a JSON object with this EXACT structure (no markdown, no code blocks):\n\n{\n  "sections": [\n    {\n      "sectionId": "objectives",\n      "slides": [\n        {\n          "slide_type": "text",\n          "slide_content": {\n            "text": "<h2>Learning Objectives</h2><ul><li>Objective 1</li><li>Objective 2</li></ul>"\n          }\n        }\n      ]\n    },\n    {\n      "sectionId": "practice",\n      "slides": [\n        {\n          "slide_type": "question",\n          "slide_content": {\n            "questions": [\n              {\n                "id": "q_abc123",\n                "type": "single_choice",\n                "text": "What is 2 + 2?",\n                "options": [\n                  {"id": "opt_1", "text": "3"},\n                  {"id": "opt_2", "text": "4"},\n                  {"id": "opt_3", "text": "5"}\n                ],\n                "correct_answer": "opt_2",\n                "explanation": "2 + 2 equals 4",\n                "timer": 30\n              }\n            ]\n          }\n        }\n      ]\n    }\n  ]\n}\n\nSLIDE TYPES:\n1. TEXT SLIDES ("slide_type": "text"):\n   - Use for explanations, examples, and content delivery\n   - Content should be HTML formatted (use <h2>, <h3>, <p>, <ul>, <li>, <strong>, <em>)\n   - Keep content concise but informative\n\n2. QUESTION SLIDES ("slide_type": "question"):\n   - Use for practice, assessment, and engagement\n   - Each question slide can have 1-3 questions in the "questions" array\n   \n   QUESTION TYPES:\n   \n   a) SINGLE CHOICE (most common):\n   {\n     "id": "q_unique_id",\n     "type": "single_choice",\n     "text": "Question text here",\n     "options": [\n       {"id": "opt_1", "text": "Option A"},\n       {"id": "opt_2", "text": "Option B"},\n       {"id": "opt_3", "text": "Option C"}\n     ],\n     "correct_answer": "opt_2",\n     "explanation": "Why this is correct",\n     "timer": 30\n   }\n   \n   b) TRUE/FALSE:\n   {\n     "id": "q_unique_id",\n     "type": "true_false",\n     "text": "Statement to evaluate",\n     "correct_answer": true,\n     "explanation": "Explanation here",\n     "timer": 20\n   }\n   \n   c) MULTIPLE CHOICE (select all that apply):\n   {\n     "id": "q_unique_id",\n     "type": "multiple_choice",\n     "text": "Select all correct answers",\n     "options": [\n       {"id": "opt_1", "text": "Option A"},\n       {"id": "opt_2", "text": "Option B"},\n       {"id": "opt_3", "text": "Option C"}\n     ],\n     "correct_answer": ["opt_1", "opt_3"],\n     "explanation": "Why these are correct",\n     "timer": 45\n   }\n\nSECTION GUIDELINES:\n- objectives: Use text slides to list learning goals\n- learn/content: Mix text slides (70%) and question slides (30%) for engagement\n- practice: Use MORE question slides (70%) and some text slides (30%)\n- assessment/review: Primarily question slides (80-90%)\n\nIMPORTANT RULES:\n1. Return ONLY valid JSON\n2. NO markdown code blocks (\`\`\`json)\n3. NO extra text before or after the JSON\n4. Each section MUST have at least 3 slides\n5. HTML content must be properly escaped in JSON strings\n6. Use double quotes for JSON properties and strings\n7. Each question MUST have a unique "id" (use format: q_abc123, q_xyz789, etc.)\n8. Each option MUST have a unique "id" within its question (opt_1, opt_2, etc.)\n9. For single_choice: correct_answer is a STRING (the option id)\n10. For multiple_choice: correct_answer is an ARRAY of strings (option ids)\n11. For true_false: correct_answer is a BOOLEAN (true or false)\n12. Timer is in seconds (20-60 seconds recommended)\n\nGenerate the complete lesson plan now with a good mix of text and question slides.`}({...b.lessonConfig,customInstructions:x.value.customInstructions}),h.value=2},ee=async()=>{j.value=!0;try{await navigator.clipboard.writeText(k.value),l.notify({type:"positive",message:"Prompt copied to clipboard!",position:"top",timeout:2e3})}catch(e){l.notify({type:"negative",message:"Failed to copy to clipboard",position:"top"})}finally{j.value=!1}},te=async()=>{try{const e=await navigator.clipboard.readText();M.value=e,l.notify({type:"positive",message:"Pasted from clipboard!",position:"top",timeout:1500})}catch(e){l.notify({type:"negative",message:"Failed to read from clipboard. Please paste manually.",position:"top"})}},ne=()=>{B.value=!0,G.value=[],setTimeout(()=>{const e=function(e){try{let t=e.trim();t.startsWith("```json")?t=t.replace(/```json\n?/g,"").replace(/```\n?$/g,""):t.startsWith("```")&&(t=t.replace(/```\n?/g,""));const n=t.match(/\{[\s\S]*\}/);return n&&(t=n[0]),{success:!0,data:JSON.parse(t)}}catch(t){return{success:!1,error:`JSON Parse Error: ${t.message}. Please ensure the AI returned valid JSON.`}}}(M.value);if(!e.success)return G.value=[e.error],void(B.value=!1);const t=function(e){const t=[];return e.sections&&Array.isArray(e.sections)?0===e.sections.length?(t.push("Must have at least one section"),{valid:!1,errors:t}):(e.sections.forEach((e,n)=>{e.sectionId&&"string"==typeof e.sectionId||t.push(`Section ${n+1}: Missing or invalid "sectionId"`),e.slides&&Array.isArray(e.slides)?e.slides.length<3?t.push(`Section ${n+1}: Must have at least 3 slides (has ${e.slides.length})`):e.slides.forEach((e,l)=>{e.slide_type||t.push(`Section ${n+1}, Slide ${l+1}: Missing "slide_type"`),e.slide_content?"text"!==e.slide_type||e.slide_content.text?"question"===e.slide_type&&(e.slide_content.questions&&Array.isArray(e.slide_content.questions)?0===e.slide_content.questions.length&&t.push(`Section ${n+1}, Slide ${l+1}: Question slide must have at least 1 question`):t.push(`Section ${n+1}, Slide ${l+1}: Question slide must have "questions" array`)):t.push(`Section ${n+1}, Slide ${l+1}: Text slide must have "text" content`):t.push(`Section ${n+1}, Slide ${l+1}: Missing "slide_content"`)}):t.push(`Section ${n+1}: Missing or invalid "slides" array`)}),{valid:0===t.length,errors:t}):(t.push('Response must have a "sections" array'),{valid:!1,errors:t})}(e.data);if(!t.valid)return G.value=t.errors,void(B.value=!1);F.value=e.data,h.value=4,B.value=!1},500)},le=e=>{const t=b.lessonConfig.sections.find(t=>t.id===e);return t?t.title:e},ae=e=>{var t;if("text"===e.slide_type&&(null==(t=e.slide_content)?void 0:t.text)){const t=e.slide_content.text.replace(/<[^>]*>/g," ").trim();return t.length>150?t.substring(0,150)+"...":t}return"Content preview not available"},se=()=>{s("plan-accepted",F.value),y.value=!1};return t({open:()=>{y.value=!0,h.value=1,(()=>{const e=localStorage.getItem("ai_tool_url");z.value=e||D[0].url})(),X()}}),(t,n)=>(q(),C(p,{modelValue:y.value,"onUpdate:modelValue":n[10]||(n[10]=e=>y.value=e),persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:I(()=>[T(c,{class:"bg-grey-1"},{default:I(()=>[P("div",Se,[P("div",ke,[P("div",je,[T(i,{size:"36px",color:"white","text-color":"purple-8",class:"q-mr-md"},{default:I(()=>[T(r,{name:"auto_awesome",size:"24px"})]),_:1}),n[11]||(n[11]=P("div",{class:"col"},[P("div",{class:"text-h5 text-white font-bold"},"AI Lesson Plan Generator"),P("div",{class:"text-subtitle2 text-white",style:{opacity:"0.9"}},"Generate complete lesson content with intelligent AI assistance")],-1)),T(a,{flat:"",round:"",dense:"",icon:"close",color:"white",onClick:Y,size:"md"})])])]),T(ge,{modelValue:h.value,"onUpdate:modelValue":n[9]||(n[9]=e=>h.value=e),ref:"stepper",color:"primary",animated:"",flat:"",class:"flex-1 bg-grey-1"},{default:I(()=>[T(be,{name:1,title:"Configure",icon:"settings",done:h.value>1},{default:I(()=>[P("div",Ce,[n[18]||(n[18]=P("h3",{class:"text-xl font-semibold mb-4"},"Lesson Configuration",-1)),P("div",qe,[n[12]||(n[12]=P("label",{class:"text-sm font-medium text-gray-700 mb-2 block"},"Quick Suggestions",-1)),P("div",Ie,[(q(!0),L(V,null,E(U(S),e=>(q(),C(a,{key:e.label,outline:"",color:"primary",label:e.label,onClick:t=>(e=>{x.value.customInstructions=e.instructions})(e),size:"sm"},null,8,["label","onClick"]))),128))])]),P("div",Te,[P("div",Pe,[P("div",null,[n[13]||(n[13]=P("span",{class:"font-semibold text-blue-900"},"Subject:",-1)),P("span",Le,O(e.lessonConfig.subject),1)]),P("div",null,[n[14]||(n[14]=P("span",{class:"font-semibold text-blue-900"},"Grade:",-1)),P("span",Ee,O(e.lessonConfig.grade),1)]),P("div",Ue,[n[15]||(n[15]=P("span",{class:"font-semibold text-blue-900"},"Lesson:",-1)),P("span",Ve,O(e.lessonConfig.lessonTitle),1)])])]),P("div",Oe,[n[16]||(n[16]=P("label",{class:"text-sm font-medium text-gray-700 mb-2 block"},"Lesson Sections",-1)),P("div",Ae,[(q(!0),L(V,null,E(e.lessonConfig.sections,e=>(q(),L("div",{key:e.id,class:"flex items-center gap-2 p-2 bg-gray-50 rounded border"},[P("span",Qe,O(e.icon),1),P("span",$e,O(e.title),1)]))),128))]),n[17]||(n[17]=P("p",{class:"text-xs text-gray-500 mt-2"}," AI will generate 3-5 slides for each section ",-1))]),T(d,{modelValue:x.value.customInstructions,"onUpdate:modelValue":n[0]||(n[0]=e=>x.value.customInstructions=e),type:"textarea",label:"Additional Instructions (Optional)",outlined:"",rows:"4",hint:"Add specific requirements, topics to cover, or teaching style preferences",class:"mb-4"},null,8,["modelValue"]),P("div",ze,[T(a,{flat:"",label:"Cancel",onClick:Y}),T(a,{unelevated:"",color:"primary",label:"Generate Prompt","icon-right":"arrow_forward",onClick:Z})])])]),_:1},8,["done"]),T(be,{name:2,title:"Use AI Tool",icon:"smart_toy",done:h.value>2},{default:I(()=>[P("div",Ne,[n[24]||(n[24]=P("h3",{class:"text-xl font-semibold mb-4"},"Work with AI Tool",-1)),P("div",Re,[P("div",De,[T(r,{name:"info",color:"blue",size:"20px",class:"mt-1"}),n[19]||(n[19]=P("div",{class:"text-sm text-blue-800"},[P("strong",null,"Instructions:"),A(" Copy the prompt below and paste it into your AI tool. The AI will generate slides for all sections. ")],-1))])]),P("div",Me,[P("div",null,[P("div",Ge,[n[20]||(n[20]=P("label",{class:"text-sm font-medium text-gray-700"},"Generated Prompt",-1)),T(a,{dense:"",unelevated:"",color:"primary",icon:"content_copy",label:"Copy",onClick:ee,size:"sm",loading:j.value},null,8,["loading"])]),T(c,{flat:"",bordered:"",class:"bg-gray-50",style:{"max-height":"400px","overflow-y":"auto"}},{default:I(()=>[T(u,null,{default:I(()=>[P("pre",Fe,O(k.value),1)]),_:1})]),_:1}),P("div",Be,[P("div",He,[n[21]||(n[21]=P("label",{class:"text-sm font-medium text-gray-700"},"AI Tool URL",-1)),T(a,{dense:"",flat:"",color:"primary",icon:"settings",label:"Change",onClick:n[1]||(n[1]=e=>R.value=!0),size:"sm"})]),P("div",Je,[(q(),L(V,null,E(D,e=>T(a,{key:e.name,dense:"",outline:"",color:z.value===e.url?"primary":"grey",label:e.name,onClick:t=>J(e.url),size:"sm"},null,8,["color","label","onClick"])),64))])])]),P("div",null,[P("div",We,[n[22]||(n[22]=P("label",{class:"text-sm font-medium text-gray-700"},"AI Tool (Embedded)",-1)),T(a,{dense:"",flat:"",color:"primary",icon:"open_in_new",label:"Open in New Tab",onClick:K,size:"sm"})]),P("div",Ke,[z.value?(q(),L("iframe",{key:0,src:z.value,class:"w-full h-full",frameborder:"0",sandbox:"allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"},null,8,Ye)):(q(),L("div",Xe,[P("div",Ze,[T(r,{name:"smart_toy",size:"48px",class:"mb-2"}),n[23]||(n[23]=P("div",null,"Select an AI tool to get started",-1))])]))])])]),P("div",et,[T(a,{flat:"",label:"Back",icon:"arrow_back",onClick:n[2]||(n[2]=e=>h.value=1)}),T(a,{unelevated:"",color:"primary",label:"I Have the Response","icon-right":"arrow_forward",onClick:n[3]||(n[3]=e=>h.value=3)})])])]),_:1},8,["done"]),T(p,{modelValue:R.value,"onUpdate:modelValue":n[5]||(n[5]=e=>R.value=e)},{default:I(()=>[T(c,{style:{"min-width":"400px"}},{default:I(()=>[T(u,{class:"bg-primary text-white"},{default:I(()=>n[25]||(n[25]=[P("div",{class:"text-h6"},"Configure AI Tool URL",-1)])),_:1}),T(u,null,{default:I(()=>[T(d,{modelValue:N.value,"onUpdate:modelValue":n[4]||(n[4]=e=>N.value=e),label:"Custom AI Tool URL",outlined:"",dense:"",placeholder:"https://chatgpt.com",hint:"Enter the URL of your preferred AI tool"},null,8,["modelValue"]),P("div",tt,[n[26]||(n[26]=P("div",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Presets:",-1)),P("div",nt,[(q(),L(V,null,E(D,e=>T(a,{key:e.name,outline:"",color:"primary",label:e.name,onClick:t=>N.value=e.url,class:"w-full",align:"left"},{default:I(()=>[T(m,null,{default:I(()=>[A(O(e.url),1)]),_:2},1024)]),_:2},1032,["label","onClick"])),64))])])]),_:1}),T(v,{align:"right"},{default:I(()=>[Q(T(a,{flat:"",label:"Cancel"},null,512),[[f]]),T(a,{unelevated:"",color:"primary",label:"Save",onClick:W})]),_:1})]),_:1})]),_:1},8,["modelValue"]),T(be,{name:3,title:"Paste Response",icon:"content_paste",done:h.value>3},{default:I(()=>[P("div",lt,[n[29]||(n[29]=P("h3",{class:"text-xl font-semibold mb-4"},"Paste AI Response",-1)),P("div",at,[P("div",st,[T(r,{name:"tips_and_updates",color:"amber",size:"20px",class:"mt-1"}),n[27]||(n[27]=P("div",{class:"text-sm text-amber-800"},[P("strong",null,"Tip:"),A(" Paste the complete JSON response from your AI tool. The system will validate and create slides for all sections. ")],-1))])]),P("div",ot,[T(d,{modelValue:M.value,"onUpdate:modelValue":n[6]||(n[6]=e=>M.value=e),type:"textarea",label:"AI Response *",outlined:"",rows:"12",placeholder:"Paste the AI response here...",class:"font-mono"},null,8,["modelValue"]),T(a,{unelevated:"",color:"secondary",icon:"content_paste",label:"Paste from Clipboard",onClick:te,class:"absolute top-4 right-4",size:"sm"})]),G.value.length>0?(q(),L("div",it,[P("div",rt,[T(r,{name:"error",color:"red",size:"20px",class:"mt-1"}),P("div",dt,[n[28]||(n[28]=P("div",{class:"font-semibold text-red-800 mb-2"},"Validation Errors:",-1)),P("ul",ct,[(q(!0),L(V,null,E(G.value,(e,t)=>(q(),L("li",{key:t},O(e),1))),128))])])])])):$("",!0),P("div",ut,[T(a,{flat:"",label:"Back",icon:"arrow_back",onClick:n[7]||(n[7]=e=>h.value=2)}),T(a,{unelevated:"",color:"primary",label:"Validate & Preview","icon-right":"arrow_forward",onClick:ne,disable:!M.value.trim(),loading:B.value},null,8,["disable","loading"])])])]),_:1},8,["done"]),T(be,{name:4,title:"Preview",icon:"visibility",done:h.value>4},{default:I(()=>[P("div",pt,[n[33]||(n[33]=P("h3",{class:"text-xl font-semibold mb-4"},"Preview Generated Lesson Plan",-1)),F.value?(q(),L("div",mt,[T(c,{flat:"",bordered:""},{default:I(()=>[T(u,null,{default:I(()=>[n[32]||(n[32]=P("div",{class:"text-sm text-gray-600 mb-2"},"Summary",-1)),P("div",vt,[P("div",null,[n[30]||(n[30]=P("span",{class:"font-semibold"},"Total Sections:",-1)),P("span",ft,O(F.value.sections.length),1)]),P("div",null,[n[31]||(n[31]=P("span",{class:"font-semibold"},"Total Slides:",-1)),P("span",gt,O(H.value),1)])])]),_:1})]),_:1}),(q(!0),L(V,null,E(F.value.sections,(e,t)=>(q(),L("div",{key:t,class:"border rounded-lg overflow-hidden"},[P("div",bt,[T(r,{name:"folder",size:"sm"}),P("span",null,O(le(e.sectionId)),1),T(g,{dense:"",size:"sm",color:"primary","text-color":"white"},{default:I(()=>[A(O(e.slides.length)+" slides ",1)]),_:2},1024)]),P("div",yt,[(q(!0),L(V,null,E(e.slides,(e,t)=>(q(),L("div",{key:t,class:"flex items-start gap-3 p-3 bg-gray-50 rounded border"},[T(r,{name:"description",size:"sm",color:"primary"}),P("div",ht,[P("div",xt,"Slide "+O(t+1)+" - "+O(e.slide_type),1),P("div",{class:"text-sm",innerHTML:ae(e)},null,8,_t)])]))),128))])]))),128))])):$("",!0),P("div",wt,[T(a,{flat:"",label:"Back",icon:"arrow_back",onClick:n[8]||(n[8]=e=>h.value=3)}),P("div",St,[T(a,{flat:"",label:"Reject",color:"negative",onClick:Y}),T(a,{unelevated:"",color:"positive",label:"Accept & Create Slides",icon:"check_circle",onClick:se})])])])]),_:1},8,["done"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-da9894a4"]]),jt={class:"row items-center"},Ct={class:"row q-col-gutter-md"},qt={class:"col-12 col-md-5"},It={class:"row q-mb-md"},Tt={class:"row items-center q-mb-sm"},Pt={class:"q-pl-lg"},Lt={class:"col-12 col-md-7"},Et={class:"row items-center"},Ut={id:"printable-lesson-plan",class:"printable-content"},Vt={class:"print-header"},Ot={class:"school-logo"},At=["src"],Qt={class:"lesson-title"},$t={class:"lesson-description"},zt={class:"lesson-info"},Nt={class:"info-row"},Rt={class:"info-item"},Dt={class:"info-item"},Mt={class:"info-row"},Gt={class:"info-item"},Ft={class:"info-item"},Bt={class:"info-row"},Ht={class:"info-item"},Jt={class:"info-item"},Wt={class:"section-icon"},Kt={class:"slide-number"},Yt={class:"slide-content"},Xt=["innerHTML"],Zt={key:1,class:"question-content"},en={class:"question-text"},tn={key:0,class:"question-options"},nn={key:1,class:"question-answer"},ln={key:2,class:"question-explanation"},an={key:2,class:"slide-placeholder"},sn={class:"print-footer"},on=s({__name:"PrintLessonPlan",props:{presentation:{type:Object,required:!0},sections:{type:Array,required:!0},slides:{type:Array,required:!0},teacherName:{type:String,default:"Teacher Name"},subjectName:{type:String,default:"Subject"},gradeName:{type:String,default:"Grade"},schoolLogo:{type:String,default:""}},emits:["close"],setup(e,{expose:t,emit:n}){o();const l=e,s=n,i=_(!1),d=_([]),m=w(()=>(new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),f=w(()=>2*d.value.length),h=e=>l.slides.filter(t=>t.section===e),x=e=>d.value.filter(t=>t.section===e),S=e=>{const t=h(e);return 0!==t.length&&t.every(e=>d.value.includes(e))},k=()=>{d.value=[...l.slides]},j=()=>{d.value=[]},U=e=>{var t,n,l;if("text"===e.slide_type){const n=((null==(t=e.slide_content)?void 0:t.text)||"").replace(/<[^>]*>/g,"").trim();return n.substring(0,50)+(n.length>50?"...":"")}if("question"===e.slide_type){const t=(null==(l=null==(n=e.slide_content)?void 0:n.questions)?void 0:l.length)||0;return`${t} question${1!==t?"s":""}`}return e.slide_type},Q=(e,t)=>"single_choice"===e.type?e.correct_answer===t:"multiple_choice"===e.type&&(Array.isArray(e.correct_answer)&&e.correct_answer.includes(t)),R=()=>{const e=document.getElementById("printable-lesson-plan").innerHTML,t=window.open("","_blank");t.document.write(`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${l.presentation.name||"Lesson Plan"}</title>\n      <style>\n        @media print {\n          @page { margin: 1cm; }\n          body { margin: 0; }\n        }\n        \n        body {\n          font-family: 'Arial', sans-serif;\n          line-height: 1.6;\n          color: #333;\n          max-width: 210mm;\n          margin: 0 auto;\n          padding: 20px;\n        }\n        \n        .print-header {\n          text-align: center;\n          border-bottom: 3px solid #1976d2;\n          padding-bottom: 20px;\n          margin-bottom: 30px;\n        }\n        \n        .print-header h1 {\n          margin: 10px 0;\n          color: #1976d2;\n          font-size: 28px;\n        }\n        \n        .lesson-description {\n          color: #666;\n          font-size: 14px;\n        }\n        \n        .lesson-info {\n          background: #f5f5f5;\n          padding: 15px;\n          border-radius: 8px;\n          margin-bottom: 30px;\n        }\n        \n        .info-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 8px;\n        }\n        \n        .info-item {\n          flex: 1;\n        }\n        \n        .section-block {\n          page-break-inside: avoid;\n          margin-bottom: 30px;\n        }\n        \n        .section-header {\n          background: #1976d2;\n          color: white;\n          padding: 12px 20px;\n          border-left: 5px solid;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n        \n        .section-header h2 {\n          margin: 0;\n          font-size: 20px;\n        }\n        \n        .section-icon {\n          font-size: 24px;\n        }\n        \n        .slide-block {\n          margin-bottom: 20px;\n          padding: 15px;\n          border: 1px solid #ddd;\n          border-radius: 8px;\n          background: white;\n          page-break-inside: avoid;\n        }\n        \n        .slide-number {\n          font-weight: bold;\n          color: #1976d2;\n          margin-bottom: 10px;\n          font-size: 14px;\n        }\n        \n        .slide-content {\n          font-size: 14px;\n        }\n        \n        .question-item {\n          margin-bottom: 15px;\n          padding: 10px;\n          background: #f9f9f9;\n          border-radius: 4px;\n        }\n        \n        .question-text {\n          font-weight: bold;\n          margin-bottom: 8px;\n        }\n        \n        .question-options {\n          margin-left: 20px;\n        }\n        \n        .option-item {\n          margin: 5px 0;\n        }\n        \n        .correct-answer {\n          color: #4caf50;\n          font-weight: bold;\n        }\n        \n        .question-explanation {\n          margin-top: 8px;\n          padding: 8px;\n          background: #e3f2fd;\n          border-left: 3px solid #2196f3;\n          font-size: 13px;\n        }\n        \n        .slide-placeholder {\n          text-align: center;\n          padding: 20px;\n          color: #999;\n        }\n        \n        .print-footer {\n          margin-top: 40px;\n          padding-top: 20px;\n          border-top: 2px solid #ddd;\n          text-align: center;\n          font-size: 12px;\n          color: #666;\n        }\n      </style>\n    </head>\n    <body>\n      ${e}\n    </body>\n    </html>\n  `),t.document.close(),t.focus(),setTimeout(()=>{t.print()},500)},D=()=>{i.value=!1,s("close")};return t({open:()=>{i.value=!0,d.value=[...l.slides]}}),(t,n)=>(q(),C(p,{modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=e=>i.value=e),persistent:"",maximized:""},{default:I(()=>[T(c,null,{default:I(()=>[T(u,{class:"bg-primary text-white"},{default:I(()=>[P("div",jt,[T(r,{name:"print",size:"32px",class:"q-mr-sm"}),n[2]||(n[2]=P("div",{class:"text-h5"},"Print Lesson Plan",-1)),T(oe),T(a,{flat:"",round:"",dense:"",icon:"close",onClick:D})])]),_:1}),T(u,{class:"q-pa-md"},{default:I(()=>[P("div",Ct,[P("div",qt,[T(c,{flat:"",bordered:""},{default:I(()=>[T(u,{class:"bg-grey-2"},{default:I(()=>n[3]||(n[3]=[P("div",{class:"text-h6"},"Select Slides to Print",-1),P("div",{class:"text-caption text-grey-7"},"Choose which slides to include in the lesson plan",-1)])),_:1}),T(u,null,{default:I(()=>[P("div",It,[T(a,{flat:"",dense:"",color:"primary",label:"Select All",onClick:k,class:"q-mr-sm"}),T(a,{flat:"",dense:"",color:"negative",label:"Deselect All",onClick:j})]),T(b,{style:{height:"calc(100vh - 350px)"}},{default:I(()=>[(q(!0),L(V,null,E(e.sections,e=>(q(),L("div",{key:e.id,class:"q-mb-md"},[P("div",Tt,[T(y,{"model-value":S(e.id),"onUpdate:modelValue":t=>(e=>{const t=h(e);S(e)?d.value=d.value.filter(t=>t.section!==e):t.forEach(e=>{d.value.includes(e)||d.value.push(e)})})(e.id),label:e.title,color:"primary",class:"text-weight-bold"},null,8,["model-value","onUpdate:modelValue","label"]),T(oe),T(g,{dense:"",style:z({background:e.bg,color:e.textColor})},{default:I(()=>[A(O(h(e.id).length)+" slides ",1)]),_:2},1032,["style"])]),P("div",Pt,[(q(!0),L(V,null,E(h(e.id),(e,t)=>(q(),C(y,{key:t,modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),val:e,label:`Slide ${t+1}: ${U(e)}`,color:"primary",dense:"",class:"q-mb-xs"},null,8,["modelValue","val","label"]))),128))])]))),128))]),_:1})]),_:1})]),_:1})]),P("div",Lt,[T(c,{flat:"",bordered:""},{default:I(()=>[T(u,{class:"bg-grey-2"},{default:I(()=>[P("div",Et,[n[4]||(n[4]=P("div",{class:"text-h6"},"Preview",-1)),T(oe),T(g,{color:"primary","text-color":"white"},{default:I(()=>[A(O(d.value.length)+" slides selected ",1)]),_:1})])]),_:1}),T(u,null,{default:I(()=>[T(b,{style:{height:"calc(100vh - 350px)"}},{default:I(()=>[P("div",Ut,[P("div",Vt,[P("div",Ot,[e.schoolLogo?(q(),L("img",{key:0,src:e.schoolLogo,alt:"School Logo",style:{"max-height":"60px"}},null,8,At)):$("",!0)]),P("div",Qt,[P("h1",null,O(e.presentation.name||"Lesson Plan"),1),P("p",$t,O(e.presentation.description),1)])]),P("div",zt,[P("div",Nt,[P("div",Rt,[n[5]||(n[5]=P("strong",null,"Teacher:",-1)),A(" "+O(e.teacherName),1)]),P("div",Dt,[n[6]||(n[6]=P("strong",null,"Subject:",-1)),A(" "+O(e.subjectName),1)])]),P("div",Mt,[P("div",Gt,[n[7]||(n[7]=P("strong",null,"Grade:",-1)),A(" "+O(e.gradeName),1)]),P("div",Ft,[n[8]||(n[8]=P("strong",null,"Date:",-1)),A(" "+O(m.value),1)])]),P("div",Bt,[P("div",Ht,[n[9]||(n[9]=P("strong",null,"Duration:",-1)),A(" "+O(f.value)+" minutes ",1)]),P("div",Jt,[n[10]||(n[10]=P("strong",null,"Total Slides:",-1)),A(" "+O(d.value.length),1)])])]),(q(!0),L(V,null,E(e.sections,e=>(q(),L("div",{key:e.id,class:"section-block"},[x(e.id).length>0?(q(),L(V,{key:0},[P("div",{class:"section-header",style:z({borderLeftColor:e.borderColor})},[P("span",Wt,O(e.icon),1),P("h2",null,O(e.title),1)],4),(q(!0),L(V,null,E(x(e.id),(e,t)=>{var l,a,s;return q(),L("div",{key:t,class:"slide-block"},[P("div",Kt,"Slide "+O(t+1),1),P("div",Yt,["text"===e.slide_type?(q(),L("div",{key:0,innerHTML:(null==(l=e.slide_content)?void 0:l.text)||"No content"},null,8,Xt)):"question"===e.slide_type?(q(),L("div",Zt,[(q(!0),L(V,null,E((null==(a=e.slide_content)?void 0:a.questions)||[],(e,t)=>(q(),L("div",{key:t,class:"question-item"},[P("div",en,[P("strong",null,"Q"+O(t+1)+":",1),A(" "+O(e.text),1)]),e.options?(q(),L("div",tn,[(q(!0),L(V,null,E(e.options,(t,n)=>(q(),L("div",{key:n,class:"option-item"},[P("span",{class:N({"correct-answer":Q(e,t.id)})},[A(O(String.fromCharCode(65+n))+". "+O(t.text)+" ",1),Q(e,t.id)?(q(),C(r,{key:0,name:"check_circle",color:"positive",size:"sm"})):$("",!0)],2)]))),128))])):"true_false"===e.type?(q(),L("div",nn,[n[11]||(n[11]=P("strong",null,"Answer:",-1)),A(" "+O(e.correct_answer?"True":"False"),1)])):$("",!0),e.explanation?(q(),L("div",ln,[P("em",null,"Explanation: "+O(e.explanation),1)])):$("",!0)]))),128))])):(q(),L("div",an,[T(r,{name:(s=e.slide_type,{text:"description",image:"image",video:"videocam",audio:"audiotrack",pdf:"picture_as_pdf",question:"quiz",drawing:"brush"}[s]||"article"),size:"md",color:"grey"},null,8,["name"]),P("div",null,O(e.slide_type.toUpperCase())+" Slide",1)]))])])}),128))],64)):$("",!0)]))),128)),P("div",sn,[P("div",null,"Prepared by "+O(e.teacherName),1),P("div",null,"Printed on "+O(m.value),1)])])]),_:1})]),_:1})]),_:1})])])]),_:1}),T(v,{align:"right",class:"q-pa-md"},{default:I(()=>[T(a,{flat:"",label:"Cancel",onClick:D}),T(a,{unelevated:"",color:"primary",icon:"print",label:"Print",onClick:R,disable:0===d.value.length},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-fe9e0d57"]]),rn={class:"row items-center q-gutter-x-md"},dn={class:"cursor-pointer"},cn={class:"text-caption text-blue-2 cursor-pointer ellipsis",style:{"max-width":"300px"}},un={class:"row items-center q-gutter-sm"},pn={class:"column q-mr-md text-right text-caption text-grey-1"},mn={class:"text-weight-bold"},vn={class:"text-weight-bold"},fn={class:"col-12 col-lg-10",style:{"max-width":"1200px"}},gn={key:0,class:"bg-white rounded-borders shadow-1 q-pa-lg"},bn={class:"row items-center justify-between q-mb-md"},yn={class:"row items-center q-gutter-sm"},hn={class:"row items-center q-gutter-sm"},xn={style:{"min-height":"500px"}},_n={key:1,class:"column items-center justify-center text-grey-5 q-pa-xl bg-white rounded-borders shadow-1 fit",style:{"min-height":"500px"}},wn={class:"text-h6 flex items-center gap-2"},Sn={key:0,class:"text-h6 q-ml-sm"},kn={key:1,class:"text-subtitle2 q-ml-sm"},jn=s({__name:"lesson_presentation",props:{presentationId:{type:[Number,String],default:null},defaultContext:{type:Object,default:()=>({school_id:1,teacher_id:1,subject_id:1})},sections:{type:Array,default:()=>[]}},setup(e){const t=e,n=ye(),l=o(),s=new URLSearchParams(window.location.search).get("id"),i=t.presentationId||(s?parseInt(s):null),v=_(i),g=_({name:"New Lesson",description:"Lesson description",grade_id:null,quiz_id:null,slides:[]}),b=_(t.sections),y=_(""),S=_(!0),k=_(null),j=_([]),E=_(0),N=_(!1),ge=_(!1),be=_(null),xe=_(null),we=_(!0);_(!0);const Se=_(!1),ke=_(!1),je=w(()=>{var e,n;return{lessonTitle:g.value.name||"New Lesson",subject:(null==(e=t.defaultContext)?void 0:e.subject_name)||"General",grade:(null==(n=t.defaultContext)?void 0:n.grade_name)||"General",sections:b.value}}),Ce=w({get:()=>!l.screen.lt.sm&&we.value,set(e){we.value=e}});w(()=>{const e=b.value.find(e=>e.id===y.value);return e?`Section: ${e.title}`:"Select a section"});const qe=w(()=>j.value.filter(e=>e.section===y.value)),Ie=w(()=>0===qe.value.length?null:qe.value[E.value]),Te=w(()=>{if(!g.value.grade_id)return"No Grade";const e=n.grades.find(e=>e.id===g.value.grade_id);return e?e.name:"Unknown Grade"}),Pe=e=>{switch(e){case"text":default:return re;case"question":return ce;case"pdf":return ue;case"video":return pe;case"image":case"audio":return de;case"drawing":return fe}},Le=()=>{const e={slide_type:"text",slide_content:{},section:y.value};j.value.push(e),E.value=qe.value.length-1},Ee=e=>{const t=document.createElement("DIV");return t.innerHTML=e||"",t.textContent||t.innerText||""},Ue=()=>{E.value>0&&E.value--},Ve=()=>{E.value<qe.value.length-1&&E.value++},Oe=e=>{"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("ArrowLeft"===e.key?(e.preventDefault(),Ue()):"ArrowRight"===e.key&&(e.preventDefault(),Ve()))},Ae=async()=>{if((()=>{var e,t;if(!g.value.name.trim())return l.notify({type:"warning",message:"Please enter a lesson name",icon:"warning",position:"top"}),!1;if(!g.value.grade_id)return l.notify({type:"warning",message:"Please select a grade",icon:"warning",position:"top"}),!1;for(let n=0;n<j.value.length;n++){const a=j.value[n];if("question"===a.slide_type){const t=(null==(e=a.slide_content)?void 0:e.questions)||[];if(0===t.length)return l.notify({type:"warning",message:`Slide ${n+1}: Please add at least one question`,icon:"warning",position:"top"}),E.value=n,!1;for(let e=0;e<t.length;e++){const a=t[e];if(!Ee(a.text).trim())return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Question text cannot be empty`,icon:"warning",position:"top"}),E.value=n,!1;if(["short_answer","number"].includes(a.type)&&!a.correct_answer)return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Please provide a correct answer`,icon:"warning",position:"top"}),E.value=n,!1;if("single_choice"===a.type&&!a.correct_answer)return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Please select a correct option`,icon:"warning",position:"top"}),E.value=n,!1;if(["single_choice","multiple_choice"].includes(a.type)){if(!a.options||a.options.length<2)return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Must have at least 2 options`,icon:"warning",position:"top"}),E.value=n,!1;for(let t=0;t<a.options.length;t++)if(!Ee(a.options[t].text).trim())return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}, Option ${t+1}: Option text cannot be empty`,icon:"warning",position:"top"}),E.value=n,!1}}}else if("text"===a.slide_type&&(null==(t=a.slide_content)?void 0:t.text)&&!Ee(a.slide_content.text).trim())return l.notify({type:"warning",message:`Slide ${n+1}: Text content cannot be empty. Please add content or delete the slide.`,icon:"warning",position:"top"}),E.value=n,!1}return!0})()){N.value=!0;try{const e={...g.value,school_id:t.defaultContext.school_id,teacher_id:t.defaultContext.teacher_id,subject_id:t.defaultContext.subject_id,grade_id:g.value.grade_id||t.defaultContext.grade_id};let n;n=v.value?await K.put(route("lesson-presentation.update",{id:v.value}),e):await K.post(route("lesson-presentation.store"),e);const a=n.data;for(const t of j.value){const e={slide_type:t.slide_type,slide_content:t.slide_content||{},section:t.section||y.value||"learn",order_index:t.order_index||0};t.id?await K.put(route("lesson-presentation.slides.update",{id:a.id,slideId:t.id}),e):await K.post(route("lesson-presentation.slides.add",{id:a.id}),e)}l.notify({type:"positive",message:"Lesson saved successfully! Redirecting...",icon:"check_circle",position:"top",timeout:1500}),setTimeout(()=>{window.location.href="/lesson-presentation/dashboard"},1500)}catch(e){console.error("Save failed:",e),l.notify({type:"negative",message:"Failed to save lesson. Please try again.",icon:"error",position:"top",timeout:3e3})}finally{N.value=!1}}},Qe=async()=>{if(v.value)try{l.notify({type:"info",message:"Duplicating lesson...",icon:"content_copy",position:"top",timeout:1e3});const e={...g.value,name:`${g.value.name} (Copy)`,school_id:t.defaultContext.school_id,teacher_id:t.defaultContext.teacher_id,subject_id:t.defaultContext.subject_id},n=(await K.post(route("lesson-presentation.store"),e)).data;for(const t of j.value){const e={slide_type:t.slide_type,slide_content:t.slide_content,section:t.section};await K.post(route("lesson-presentation.slides.add",{id:n.id}),e)}l.notify({type:"positive",message:"Lesson duplicated successfully!",icon:"check_circle",position:"top",timeout:2e3}),setTimeout(()=>{window.location.href=`/lesson-presentation/edit?id=${n.id}`},500)}catch(e){console.error("Duplicate failed:",e),l.notify({type:"negative",message:"Failed to duplicate lesson",icon:"error",position:"top",timeout:3e3})}},$e=()=>{var e,n;try{const a=g.value.name||"Untitled_Lesson",s=(new Date).toISOString().split("T")[0],o=`lesson_${a.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${s}.json`,i={version:"1.0",exportDate:(new Date).toISOString(),lesson:{name:g.value.name,description:g.value.description,grade_id:g.value.grade_id,quiz_id:g.value.quiz_id},sections:b.value,slides:j.value,metadata:{subject_name:null==(e=t.defaultContext)?void 0:e.subject_name,grade_name:null==(n=t.defaultContext)?void 0:n.grade_name,totalSlides:j.value.length}},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),d=URL.createObjectURL(r),c=document.createElement("a");c.href=d,c.download=o,c.click(),URL.revokeObjectURL(d),l.notify({type:"positive",message:`Lesson exported as ${o}`,icon:"download",position:"top",timeout:2e3})}catch(a){console.error("Export failed:",a),l.notify({type:"negative",message:"Failed to export lesson",icon:"error",position:"top"})}},ze=()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{const t=e.target.files[0];if(t)try{const e=await t.text(),n=JSON.parse(e);if(!n.lesson||!n.slides)throw new Error("Invalid lesson file format");l.dialog({title:"Import Lesson",message:`Import "${n.lesson.name}"? This will replace current unsaved changes.`,cancel:!0,persistent:!0,ok:{label:"Import",color:"primary"}}).onOk(()=>{g.value.name=n.lesson.name,g.value.description=n.lesson.description,g.value.grade_id=n.lesson.grade_id,g.value.quiz_id=n.lesson.quiz_id,j.value=n.slides.map(e=>({...e,id:null})),n.sections&&n.sections.length>0&&(b.value=n.sections,!y.value&&b.value.length>0&&(y.value=b.value[0].id)),l.notify({type:"positive",message:`Lesson "${n.lesson.name}" imported successfully!`,icon:"upload",position:"top",timeout:2e3})})}catch(n){console.error("Import failed:",n),l.notify({type:"negative",message:"Failed to import lesson. Please check the file format.",icon:"error",position:"top",timeout:3e3})}},e.click()},Ne=()=>{var e;g.value.name&&"New Lesson"!==g.value.name?null==(e=be.value)||e.open():l.notify({type:"warning",message:"Please set a lesson title first",icon:"warning",position:"top"})},Re=e=>{let t=0;e.sections.forEach(e=>{e.slides.forEach(n=>{j.value.push({slide_type:n.slide_type,slide_content:n.slide_content,section:e.sectionId}),t++})}),l.notify({type:"positive",message:`Successfully added ${t} slides from AI! Don't forget to save.`,icon:"check_circle",position:"top",timeout:3e3}),e.sections.length>0&&(y.value=e.sections[0].sectionId,E.value=0)},De=()=>{var e;null==(e=xe.value)||e.open()};return R(y,()=>{E.value=0}),D(async()=>{await n.fetchTeacherData(),window.addEventListener("keydown",Oe),v.value?(await(async e=>{try{const t=await K.get(route("lesson-presentation.show",{id:e}));g.value={name:t.data.name,description:t.data.description,grade_id:t.data.grade_id,quiz_id:t.data.quiz_id},j.value=(t.data.slides||[]).map(e=>({...e,section:e.section||"learn"}))}catch(t){console.error("Fetch failed:",t),l.notify({type:"negative",message:"Failed to load lesson",icon:"error",position:"top"})}})(v.value),b.value.length>0&&!y.value&&(y.value=b.value[0].id)):(0===j.value.length&&Le(),b.value.length>0&&(y.value=b.value[0].id),t.defaultContext.grade_id?g.value.grade_id=parseInt(t.defaultContext.grade_id):n.grades.length>0&&(g.value.grade_id=n.grades[0].id))}),M(()=>{window.removeEventListener("keydown",Oe)}),(t,s)=>{var o,i,_;const w=G("Head");return q(),L(V,null,[T(w,{title:g.value.name?`Editing: ${g.value.name}`:"New Lesson"},null,8,["title"]),T(se,{view:"hHh Lpr fFf",class:"bg-grey-1"},{default:I(()=>[T(ee,{elevated:"",class:"bg-primary text-white"},{default:I(()=>[T(X,null,{default:I(()=>{var t,n;return[T(a,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:s[0]||(s[0]=e=>S.value=!S.value)}),T(a,{flat:"",round:"",dense:"",icon:"arrow_back",component:"a",href:"/lesson-presentation/dashboard"},{default:I(()=>[T(m,null,{default:I(()=>s[17]||(s[17]=[A("Back")])),_:1})]),_:1}),T(Z,{class:"q-ml-sm"},{default:I(()=>[P("div",rn,[P("div",dn,[A(O(g.value.name||"New Lesson")+" ",1),T(_e,{modelValue:g.value.name,"onUpdate:modelValue":s[1]||(s[1]=e=>g.value.name=e),"auto-save":""},{default:I(e=>[T(d,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,dense:"",autofocus:"",counter:"",onKeyup:F(e.set,["enter"]),label:"Lesson Name"},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"]),T(r,{name:"edit",size:"xs",class:"q-ml-xs opacity-50"})]),g.value.grade_id?(q(),C(Y,{key:0,color:"white","text-color":"primary",label:Te.value},null,8,["label"])):$("",!0)]),P("div",cn,[A(O(g.value.description||"Add description...")+" ",1),T(_e,{modelValue:g.value.description,"onUpdate:modelValue":s[2]||(s[2]=e=>g.value.description=e),"auto-save":""},{default:I(e=>[T(d,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,dense:"",autofocus:"",type:"textarea",onKeyup:F(e.set,["enter"]),label:"Description"},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),_:1}),P("div",un,[P("div",pn,[P("div",null,[s[18]||(s[18]=A("Subject: ")),P("span",mn,O(null==(t=e.defaultContext)?void 0:t.subject_name),1)]),P("div",null,[s[19]||(s[19]=A("Class: ")),P("span",vn,O(null==(n=e.defaultContext)?void 0:n.grade_name),1)])]),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),v.value?(q(),C(a,{key:0,flat:"",round:"",dense:"",icon:"content_copy",onClick:Qe},{default:I(()=>[T(m,null,{default:I(()=>s[20]||(s[20]=[A("Duplicate")])),_:1})]),_:1})):$("",!0),T(a,{flat:"",round:"",dense:"",icon:"auto_awesome",onClick:Ne,style:{background:"linear-gradient(to right, #9333ea, #4f46e5)"},class:"text-white"},{default:I(()=>[T(m,null,{default:I(()=>s[21]||(s[21]=[A("Generate with AI")])),_:1})]),_:1}),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),T(a,{flat:"",round:"",dense:"",icon:"download",onClick:$e,color:"accent"},{default:I(()=>[T(m,null,{default:I(()=>s[22]||(s[22]=[A("Export Lesson as JSON")])),_:1})]),_:1}),T(a,{flat:"",round:"",dense:"",icon:"upload",onClick:ze,color:"secondary"},{default:I(()=>[T(m,null,{default:I(()=>s[23]||(s[23]=[A("Import Lesson from JSON")])),_:1})]),_:1}),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),T(a,{flat:"",round:"",dense:"",icon:"emoji_events",onClick:s[3]||(s[3]=e=>{Se.value=!0,ke.value=!1}),color:"warning"},{default:I(()=>[T(m,null,{default:I(()=>s[24]||(s[24]=[A("Reward System")])),_:1})]),_:1}),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),T(a,{flat:"",round:"",dense:"",icon:"visibility",onClick:s[4]||(s[4]=e=>ge.value=!0),disable:!v.value},{default:I(()=>[T(m,null,{default:I(()=>s[25]||(s[25]=[A("Preview")])),_:1})]),_:1},8,["disable"]),T(a,{flat:"",round:"",dense:"",icon:"print",onClick:De,disable:!v.value||0===j.value.length,color:"deep-orange"},{default:I(()=>[T(m,null,{default:I(()=>s[26]||(s[26]=[A("Print Lesson Plan")])),_:1})]),_:1},8,["disable"]),T(a,{unelevated:"",color:"positive",icon:"save",label:"Save",onClick:Ae,loading:N.value},null,8,["loading"])])]}),_:1})]),_:1}),T(te,{modelValue:S.value,"onUpdate:modelValue":s[9]||(s[9]=e=>S.value=e),"show-if-above":"",bordered:"",class:"bg-white",width:300},{default:I(()=>[T(me,{sections:b.value,currentSection_data:k.value,"onUpdate:currentSection_data":s[5]||(s[5]=e=>k.value=e),currentSection:y.value,"onUpdate:currentSection":s[6]||(s[6]=e=>y.value=e),slides:j.value,showDrawer:Ce.value,"onUpdate:showDrawer":s[7]||(s[7]=e=>Ce.value=e),"can-edit":!0,"active-slide":Ie.value,onSelectSlide:s[8]||(s[8]=e=>E.value=qe.value.indexOf(e)),onAddSlide:Le,class:"fit"},null,8,["sections","currentSection_data","currentSection","slides","showDrawer","active-slide"])]),_:1},8,["modelValue"]),T(ae,null,{default:I(()=>[T(le,{class:"q-pa-md bg-grey-2 row justify-center"},{default:I(()=>[P("div",fn,[T(B,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:I(()=>[Ie.value?(q(),L("div",gn,[P("div",bn,[P("div",yn,[T(r,{name:"edit_note",color:"primary",size:"md"}),s[30]||(s[30]=P("div",{class:"text-h6 text-grey-8"},"Slide Editor",-1)),T(h,{vertical:"",inset:"",class:"q-mx-sm"}),T(x,{outline:""},{default:I(()=>[T(a,{flat:"",dense:"",icon:"chevron_left",onClick:Ue,disable:0===E.value,color:"primary"},{default:I(()=>[T(m,null,{default:I(()=>s[27]||(s[27]=[A("Previous Slide (←)")])),_:1})]),_:1},8,["disable"]),T(a,{flat:"",dense:"","no-caps":"",label:`${E.value+1} / ${qe.value.length}`,color:"primary",class:"q-px-md"},{default:I(()=>[T(m,null,{default:I(()=>s[28]||(s[28]=[A("Current Slide")])),_:1})]),_:1},8,["label"]),T(a,{flat:"",dense:"",icon:"chevron_right",onClick:Ve,disable:E.value>=qe.value.length-1,color:"primary"},{default:I(()=>[T(m,null,{default:I(()=>s[29]||(s[29]=[A("Next Slide (→)")])),_:1})]),_:1},8,["disable"])]),_:1})]),P("div",hn,[T(ne,{modelValue:Ie.value.slide_type,"onUpdate:modelValue":s[10]||(s[10]=e=>Ie.value.slide_type=e),options:[{label:"📝 Text",value:"text"},{label:"🖼️ Image",value:"image"},{label:"🎥 Video",value:"video"},{label:"🎵 Audio",value:"audio"},{label:"📄 PDF",value:"pdf"},{label:"❓ Question",value:"question"},{label:"🎨 Drawing",value:"drawing"}],dense:"",outlined:"","emit-value":"","map-options":"","options-dense":"",color:"primary",label:"Slide Type",style:{"min-width":"150px"}},null,8,["modelValue"]),T(a,{flat:"",round:"",color:"negative",icon:"delete",onClick:s[11]||(s[11]=e=>{return t=Ie.value,void l.dialog({title:"Delete Slide",message:"Are you sure you want to delete this slide? This action cannot be undone.",cancel:!0,persistent:!0,ok:{label:"Delete",color:"negative",flat:!0},cancel:{label:"Cancel",color:"grey",flat:!0}}).onOk(()=>{const e=j.value.indexOf(t);-1!==e&&(j.value.splice(e,1),qe.value.length>0?E.value>=qe.value.length&&(E.value=qe.value.length-1):E.value=0,l.notify({type:"positive",message:"Slide deleted successfully",icon:"check_circle",position:"top",timeout:1500}))});var t})},{default:I(()=>[T(m,null,{default:I(()=>s[31]||(s[31]=[A("Delete Slide")])),_:1})]),_:1})])]),T(h,{class:"q-mb-md"}),P("div",xn,[(q(),C(H(Pe(Ie.value.slide_type)),{modelValue:Ie.value.slide_content,"onUpdate:modelValue":s[12]||(s[12]=e=>Ie.value.slide_content=e),key:Ie.value.id||E.value},null,8,["modelValue"]))])])):(q(),L("div",_n,[T(r,{name:"touch_app",size:"80px",color:"primary",class:"opacity-20"}),s[32]||(s[32]=P("div",{class:"text-h5 q-mt-md text-weight-medium"},"Select a Slide",-1)),s[33]||(s[33]=P("div",{class:"text-subtitle1 q-mt-sm"},"Choose a section on the left to start editing",-1))]))]),_:1})])]),_:1})]),_:1})]),_:1}),T(p,{modelValue:ge.value,"onUpdate:modelValue":s[13]||(s[13]=e=>ge.value=e),maximized:""},{default:I(()=>[T(c,{class:"bg-grey-1"},{default:I(()=>[T(u,{class:"row items-center q-pb-none bg-primary text-white"},{default:I(()=>[P("div",wn,[T(r,{name:"visibility",size:"28px"}),s[34]||(s[34]=A(" Student View Preview "))]),T(oe),Q(T(a,{icon:"close",flat:"",round:"",dense:""},null,512),[[f]])]),_:1}),T(u,{class:"q-pa-none bg-grey-1",style:{height:"calc(100vh - 60px)"}},{default:I(()=>[T(ve,{presentation:{...g.value,name:"Preview: "+g.value.name},sections:b.value,slides:j.value,"is-preview":!0},null,8,["presentation","sections","slides"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),T(kt,{ref_key:"aiLessonGenerator",ref:be,"lesson-config":je.value,onPlanAccepted:Re},null,8,["lesson-config"]),T(on,{ref_key:"printLessonPlan",ref:xe,presentation:g.value,sections:b.value,slides:j.value,"teacher-name":(null==(o=U(n).teacher)?void 0:o.name)||"Teacher","subject-name":(null==(i=e.defaultContext)?void 0:i.subject_name)||"Subject","grade-name":(null==(_=e.defaultContext)?void 0:_.grade_name)||"Grade"},null,8,["presentation","sections","slides","teacher-name","subject-name","grade-name"]),T(p,{modelValue:Se.value,"onUpdate:modelValue":s[16]||(s[16]=e=>Se.value=e),maximized:!ke.value,seamless:ke.value,position:ke.value?"bottom":"standard","transition-show":"slide-up","transition-hide":"slide-down"},{default:I(()=>[T(c,{style:z(ke.value?"width: 300px":"")},{default:I(()=>[T(ie,{class:"bg-primary text-white"},{default:I(()=>[T(r,{name:"emoji_events"}),ke.value?(q(),L("div",kn,"Rewards")):(q(),L("div",Sn,"Reward System")),T(oe),ke.value?(q(),C(a,{key:2,dense:"",flat:"","no-caps":"",label:"Maximize",icon:"open_in_full",onClick:s[14]||(s[14]=e=>ke.value=!1)},{default:I(()=>[T(m,null,{default:I(()=>s[35]||(s[35]=[A("Maximize")])),_:1})]),_:1})):(q(),C(a,{key:3,dense:"",flat:"",icon:"minimize",onClick:s[15]||(s[15]=e=>ke.value=!0)},{default:I(()=>[T(m,null,{default:I(()=>s[36]||(s[36]=[A("Minimize")])),_:1})]),_:1})),Q((q(),C(a,{dense:"",flat:"",icon:"close"},{default:I(()=>[T(m,null,{default:I(()=>s[37]||(s[37]=[A("Close")])),_:1})]),_:1})),[[f]])]),_:1}),Q(T(u,{class:"q-pa-none",style:{height:"calc(100vh - 32px)"}},{default:I(()=>[(q(),C(W,null,[T(he,{isDialog:!0})],1024))]),_:1},512),[[J,!ke.value]])]),_:1},8,["style"])]),_:1},8,["modelValue","maximized","seamless","position"])],64)}}},[["__scopeId","data-v-0c82afc4"]]);export{jn as default};
