import{D as e,ac as l,T as a,U as t,aC as u,bg as n,at as o,S as s,aw as i,ak as r,a2 as d,Q as c,i as v,j as m,h as p,g as f,m as h,c as _,f as k,d as y,aP as b,l as q,b as g,N as w}from"./app-Buylb2AA.js";import{u as x,a as C,b as V,g as M}from"./use-datetime-BFEr_NcL.js";import{_ as S,f as O}from"./date-CjHtaXn3.js";import{p as j,f as H,a as D,k as U,n as A,h as B,A as K,x as P,a6 as Q,L as $,I as F,M as Y,b as I,J as z,F as L,Q as N,H as T,V as G,U as J,y as R}from"./vendor-CUZ9QTQV.js";import{Q as X}from"./QPopupProxy-Ca7QmIsb.js";import"./offline-BzIlwqNM.js";import"./i18n-CP46N9fu.js";import"./ui-LrZmvB2D.js";function E(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}const W=e({name:"QTime",props:{...a,...l,...C,modelValue:{required:!0,validator:e=>"string"==typeof e||null===e},mask:{...C.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:x,setup(e,{slots:l,emit:a}){const v=j(),{$q:m}=v.proxy,p=t(e,m),{tabindex:f,headerClass:h,getLocale:_,getCurrentDate:k}=V(e,m),y=u(e),b=i(y);let q,g;const w=H(null),x=D(()=>"persian"!==e.calendar&&null!==e.mask?e.mask:"HH:mm"+(!0===e.withSeconds?":ss":"")),C=D(()=>_()),Q=D(()=>function(){if("string"!=typeof e.defaultDate){const e=k(!0);return e.dateHash=M(e),e}return S(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}()),$=S(e.modelValue,x.value,C.value,e.calendar,Q.value),F=H(function(e){return null!==e.hour&&null===e.minute?"minute":"hour"}($)),Y=H($),I=H(null===$.hour||$.hour<12),z=D(()=>"q-time q-time--"+(!0===e.landscape?"landscape":"portrait")+(!0===p.value?" q-time--dark q-dark":"")+(!0===e.disable?" disabled":!0===e.readonly?" q-time--readonly":"")+(!0===e.bordered?" q-time--bordered":"")+(!0===e.square?" q-time--square no-border-radius":"")+(!0===e.flat?" q-time--flat no-shadow":"")),L=D(()=>{const e=Y.value;return{hour:null===e.hour?"--":!0===N.value?n(e.hour):String(!0===I.value?0===e.hour?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:null===e.minute?"--":n(e.minute),second:null===e.second?"--":n(e.second)}}),N=D(()=>null!==e.format24h?e.format24h:m.lang.date.format24h),T=D(()=>{const e="hour"===F.value,l=!0===e?12:60,a=Y.value[F.value];let t=`rotate(${Math.round(a*(360/l))-180}deg) translateX(-50%)`;return!0===e&&!0===N.value&&Y.value.hour>=12&&(t+=" scale(.7)"),{transform:t}}),G=D(()=>null!==Y.value.hour),J=D(()=>!0===G.value&&null!==Y.value.minute),R=D(()=>void 0!==e.hourOptions?l=>e.hourOptions.includes(l):void 0!==e.options?l=>e.options(l,null,null):null),X=D(()=>void 0!==e.minuteOptions?l=>e.minuteOptions.includes(l):void 0!==e.options?l=>e.options(Y.value.hour,l,null):null),W=D(()=>void 0!==e.secondOptions?l=>e.secondOptions.includes(l):void 0!==e.options?l=>e.options(Y.value.hour,Y.value.minute,l):null),Z=D(()=>{if(null===R.value)return null;const e=oe(0,11,R.value),l=oe(12,11,R.value);return{am:e,pm:l,values:e.values.concat(l.values)}}),ee=D(()=>null!==X.value?oe(0,59,X.value):null),le=D(()=>null!==W.value?oe(0,59,W.value):null),ae=D(()=>{switch(F.value){case"hour":return Z.value;case"minute":return ee.value;case"second":return le.value}}),te=D(()=>{let e,l,a=0,t=1;const u=null!==ae.value?ae.value.values:void 0;"hour"===F.value?!0===N.value?(e=0,l=23):(e=0,l=11,!1===I.value&&(a=12)):(e=0,l=55,t=5);const n=[];for(let o=e,s=e;o<=l;o+=t,s++){const e=o+a,l=!1===(null==u?void 0:u.includes(e)),t="hour"===F.value&&0===o?!0===N.value?"00":"12":o;n.push({val:e,index:s,disable:l,label:t})}return n}),ue=D(()=>[[o,ce,void 0,{stop:!0,prevent:!0,mouse:!0}]]);function ne(){const e={...k(),...E()};je(e),Object.assign(Y.value,e),F.value="hour"}function oe(e,l,a){const t=Array.apply(null,{length:l+1}).map((l,t)=>{const u=t+e;return{index:u,val:!0===a(u)}}).filter(e=>!0===e.val).map(e=>e.index);return{min:t[0],max:t[t.length-1],values:t,threshold:l+1}}function se(e,l,a){const t=Math.abs(e-l);return Math.min(t,a-t)}function ie(e,{min:l,max:a,values:t,threshold:u}){if(e===l)return l;if(e<l||e>a)return se(e,l,u)<=se(e,a,u)?l:a;const n=t.findIndex(l=>e<=l),o=t[n-1],s=t[n];return e-o<=s-e?o:s}function re(){return!0===r(v)||null!==ae.value&&(0===ae.value.values.length||"hour"===F.value&&!0!==N.value&&0===Z.value[!0===I.value?"am":"pm"].values.length)}function de(){const e=w.value,{top:l,left:a,width:t}=e.getBoundingClientRect(),u=t/2;return{top:l+u,left:a+u,dist:.7*u}}function ce(e){if(!0!==re()){if(!0===e.isFirst)return q=de(),void(g=me(e.evt,q));g=me(e.evt,q,g),!0===e.isFinal&&(q=!1,g=null,ve())}}function ve(){"hour"===F.value?F.value="minute":e.withSeconds&&"minute"===F.value&&(F.value="second")}function me(e,l,a){const t=d(e),u=Math.abs(t.top-l.top),n=Math.sqrt(Math.pow(Math.abs(t.top-l.top),2)+Math.pow(Math.abs(t.left-l.left),2));let o,s=Math.asin(u/n)*(180/Math.PI);if(s=t.top<l.top?l.left<t.left?90-s:270+s:l.left<t.left?s+90:270-s,"hour"===F.value){if(o=s/30,null!==Z.value){const e=!0!==N.value?!0===I.value:0!==Z.value.am.values.length&&0!==Z.value.pm.values.length?n>=l.dist:0!==Z.value.am.values.length;o=ie(o+(!0===e?0:12),Z.value[!0===e?"am":"pm"])}else o=Math.round(o),!0===N.value?n<l.dist?o<12&&(o+=12):12===o&&(o=0):!0===I.value&&12===o?o=0:!1===I.value&&12!==o&&(o+=12);!0===N.value&&(I.value=o<12)}else o=Math.round(s/6)%60,"minute"===F.value&&null!==ee.value?o=ie(o,ee.value):"second"===F.value&&null!==le.value&&(o=ie(o,le.value));return a!==o&&Ce[F.value](o),o}U(()=>e.modelValue,l=>{const a=S(l,x.value,C.value,e.calendar,Q.value);a.dateHash===Y.value.dateHash&&a.timeHash===Y.value.timeHash||(Y.value=a,null===a.hour?F.value="hour":I.value=a.hour<12)}),U([x,C],()=>{A(()=>{je()})});const pe={hour(){F.value="hour"},minute(){F.value="minute"},second(){F.value="second"}};function fe(e){13===e.keyCode&&Ve()}function he(e){13===e.keyCode&&Me()}function _e(e){!0!==re()&&(!0!==m.platform.is.desktop&&me(e,de()),ve())}function ke(e){!0!==re()&&me(e,de())}function ye(e){if(13===e.keyCode)F.value="hour";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==Z.value){const e=!0===N.value?Z.value.values:Z.value[!0===I.value?"am":"pm"].values;if(0===e.length)return;if(null===Y.value.hour)ge(e[0]);else{const a=(e.length+e.indexOf(Y.value.hour)+l)%e.length;ge(e[a])}}else{const e=!0===N.value?24:12;ge((!0!==N.value&&!1===I.value?12:0)+(24+(null===Y.value.hour?-l:Y.value.hour)+l)%e)}}}function be(e){if(13===e.keyCode)F.value="minute";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==ee.value){const e=ee.value.values;if(0===e.length)return;if(null===Y.value.minute)we(e[0]);else{const a=(e.length+e.indexOf(Y.value.minute)+l)%e.length;we(e[a])}}else{we((60+(null===Y.value.minute?-l:Y.value.minute)+l)%60)}}}function qe(e){if(13===e.keyCode)F.value="second";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==le.value){const e=le.value.values;if(0===e.length)return;if(null===Y.value.seconds)xe(e[0]);else{const a=(e.length+e.indexOf(Y.value.second)+l)%e.length;xe(e[a])}}else{xe((60+(null===Y.value.second?-l:Y.value.second)+l)%60)}}}function ge(e){Y.value.hour!==e&&(Y.value.hour=e,Oe())}function we(e){Y.value.minute!==e&&(Y.value.minute=e,Oe())}function xe(e){Y.value.second!==e&&(Y.value.second=e,Oe())}const Ce={hour:ge,minute:we,second:xe};function Ve(){!1===I.value&&(I.value=!0,null!==Y.value.hour&&(Y.value.hour-=12,Oe()))}function Me(){!0===I.value&&(I.value=!1,null!==Y.value.hour&&(Y.value.hour+=12,Oe()))}function Se(l){const a=e.modelValue;F.value!==l&&null!=a&&""!==a&&"string"!=typeof a&&(F.value=l)}function Oe(){return null!==R.value&&!0!==R.value(Y.value.hour)?(Y.value=S(),void Se("hour")):null!==X.value&&!0!==X.value(Y.value.minute)?(Y.value.minute=null,Y.value.second=null,void Se("minute")):!0===e.withSeconds&&null!==W.value&&!0!==W.value(Y.value.second)?(Y.value.second=null,void Se("second")):void(null===Y.value.hour||null===Y.value.minute||!0===e.withSeconds&&null===Y.value.second||je())}function je(l){const t=Object.assign({...Y.value},l),u="persian"===e.calendar?n(t.hour)+":"+n(t.minute)+(!0===e.withSeconds?":"+n(t.second):""):O(new Date(t.year,null===t.month?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),x.value,C.value,t.year,t.timezoneOffset);t.changed=u!==e.modelValue,a("update:modelValue",u,t)}function He(){const l=[B("div",{class:"q-time__link "+("hour"===F.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:pe.hour,onKeyup:ye},L.value.hour),B("div",":"),B("div",!0===G.value?{class:"q-time__link "+("minute"===F.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:be,onClick:pe.minute}:{class:"q-time__link"},L.value.minute)];!0===e.withSeconds&&l.push(B("div",":"),B("div",!0===J.value?{class:"q-time__link "+("second"===F.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:qe,onClick:pe.second}:{class:"q-time__link"},L.value.second));const a=[B("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},l)];return!1===N.value&&a.push(B("div",{class:"q-time__header-ampm column items-between no-wrap"},[B("div",{class:"q-time__link "+(!0===I.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Ve,onKeyup:fe},"AM"),B("div",{class:"q-time__link "+(!0!==I.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Me,onKeyup:he},"PM")])),B("div",{class:"q-time__header flex flex-center no-wrap "+h.value},a)}function De(){const l=Y.value[F.value];return B("div",{class:"q-time__content col relative-position"},[B(K,{name:"q-transition--scale"},()=>B("div",{key:"clock"+F.value,class:"q-time__container-parent absolute-full"},[B("div",{ref:w,class:"q-time__container-child fit overflow-hidden"},[P(B("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:_e,onMousedown:ke},[B("div",{class:"q-time__clock-circle fit"},[B("div",{class:"q-time__clock-pointer"+(null===Y.value[F.value]?" hidden":void 0!==e.color?` text-${e.color}`:""),style:T.value}),te.value.map(e=>B("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${e.index}`+(e.val===l?" q-time__clock-position--active "+h.value:!0===e.disable?" q-time__clock-position--disable":"")},[B("span",e.label)]))])]),ue.value)])])),!0===e.nowBtn?B(c,{class:"q-time__now-button absolute",icon:m.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:f.value,onClick:ne}):null])}return v.proxy.setNow=ne,()=>{const a=[De()],t=s(l.default);return void 0!==t&&a.push(B("div",{class:"q-time__actions"},t)),void 0!==e.name&&!0!==e.disable&&b(a,"push"),B("div",{class:z.value,tabindex:-1},[He(),B("div",{class:"q-time__main col overflow-auto"},a)])}}}),Z={class:"q-pa-md"},ee={class:"row items-center justify-between q-mb-md"},le={class:"row q-gutter-sm"},ae={class:"text-h6"},te={class:"row q-col-gutter-sm q-mt-sm"},ue={class:"col-6"},ne={class:"row items-center justify-end"},oe={class:"col-6"},se={class:"row items-center justify-end"},ie={__name:"dp_MasterSchedule",props:{tasks:Array},setup(e){const l=H(!1),a=H(!1),t=H(null),u=Q({title:"",start_time:"",end_time:"",description:"",type:"general"}),n=()=>{a.value?u.put(route("dp.master.update",t.value),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸÜÿ¨ÿßÿ≠"})}}):u.post(route("dp.master.store"),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠"})}})},o=()=>{a.value=!1,t.value=null,u.reset()};return(o,s)=>(F(),$("div",Z,[Y("div",ee,[s[8]||(s[8]=Y("div",{class:"text-h5"},"ÿßŸÑÿ¨ÿØŸàŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä üìÖ",-1)),I(c,{label:"ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸáŸÖÿ©",color:"primary",icon:"add",onClick:s[0]||(s[0]=e=>l.value=!0)})]),I(f,{bordered:"",separator:"",class:"bg-white rounded-borders"},{default:z(()=>[(F(!0),$(L,null,N(e.tasks,e=>(F(),T(p,{key:e.id},{default:z(()=>[I(v,null,{default:z(()=>[I(m,null,{default:z(()=>[G(J(e.title),1)]),_:2},1024),I(m,{caption:""},{default:z(()=>[G(J(e.start_time)+" - "+J(e.end_time),1)]),_:2},1024)]),_:2},1024),I(v,{side:""},{default:z(()=>[Y("div",le,[I(c,{flat:"",round:"",color:"primary",icon:"edit",onClick:n=>(e=>{a.value=!0,t.value=e.id,u.title=e.title,u.start_time=e.start_time?e.start_time.substr(0,5):"",u.end_time=e.end_time?e.end_time.substr(0,5):"",u.description=e.description,l.value=!0})(e)},null,8,["onClick"]),I(c,{flat:"",round:"",color:"negative",icon:"delete",onClick:l=>{return a=e.id,void(confirm("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ∞ŸÅÿü")&&u.delete(route("dp.master.destroy",a),{onSuccess:()=>w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ≠ÿ∞ŸÅ"})}));var a}},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),I(g,{modelValue:l.value,"onUpdate:modelValue":s[7]||(s[7]=e=>l.value=e)},{default:z(()=>[I(h,{style:{"min-width":"350px"}},{default:z(()=>[I(_,null,{default:z(()=>[Y("div",ae,J(a.value?"ÿ™ÿπÿØŸäŸÑ ŸÖŸáŸÖÿ©":"ŸÖŸáŸÖÿ© ÿ¨ÿØŸäÿØÿ©"),1)]),_:1}),I(_,{class:"q-pt-none"},{default:z(()=>[I(k,{modelValue:R(u).title,"onUpdate:modelValue":s[1]||(s[1]=e=>R(u).title=e),label:"ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖŸáŸÖÿ©",autofocus:""},null,8,["modelValue"]),Y("div",te,[Y("div",ue,[I(k,{modelValue:R(u).start_time,"onUpdate:modelValue":s[3]||(s[3]=e=>R(u).start_time=e),label:"ŸÖŸÜ",mask:"time",rules:["time"]},{append:z(()=>[I(y,{name:"access_time",class:"cursor-pointer"},{default:z(()=>[I(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:z(()=>[I(W,{modelValue:R(u).start_time,"onUpdate:modelValue":s[2]||(s[2]=e=>R(u).start_time=e),format24h:""},{default:z(()=>[Y("div",ne,[P(I(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),Y("div",oe,[I(k,{modelValue:R(u).end_time,"onUpdate:modelValue":s[5]||(s[5]=e=>R(u).end_time=e),label:"ÿ•ŸÑŸâ",mask:"time",rules:["time"]},{append:z(()=>[I(y,{name:"access_time",class:"cursor-pointer"},{default:z(()=>[I(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:z(()=>[I(W,{modelValue:R(u).end_time,"onUpdate:modelValue":s[4]||(s[4]=e=>R(u).end_time=e),format24h:""},{default:z(()=>[Y("div",se,[P(I(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),I(k,{modelValue:R(u).description,"onUpdate:modelValue":s[6]||(s[6]=e=>R(u).description=e),label:"ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ™ÿ≠ŸÅŸäÿ≤Ÿäÿ©",type:"textarea",rows:"2"},null,8,["modelValue"])]),_:1}),I(q,{align:"right",class:"text-primary"},{default:z(()=>[P(I(c,{flat:"",label:"ÿ•ŸÑÿ∫ÿßÿ°"},null,512),[[b]]),I(c,{flat:"",label:"ÿ≠ŸÅÿ∏",onClick:n})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ie as default};
