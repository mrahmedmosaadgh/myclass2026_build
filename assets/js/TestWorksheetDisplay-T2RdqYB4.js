import{r as e}from"./questionParser-DdZqDloY.js";import{p as t}from"./app-BzjXrVp9.js";import{k as n,o as s,L as o,I as i,F as r,Q as a,M as l,O as d,U as p,R as m,S as c}from"./vendor-EI0FRBVb.js";import"./katex-BXKQVcz-.js";import"./purify.es-C2Ba6vpb.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";const g={key:0,class:"text-center text-gray-500 py-8"},u={key:1,class:"space-y-8"},y={class:"flex justify-between items-start mb-4"},f={class:"font-semibold text-lg text-gray-800 flex items-center"},h={class:"bg-indigo-600 text-white rounded-full w-8 h-8 flex items-center justify-center mr-3"},b={key:0},v=["onClick"],w=["innerHTML"],x={class:"p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},k={class:"flex items-start gap-3"},q={class:"option-marker font-medium text-gray-600 flex-shrink-0"},C=["innerHTML"],$={key:1,class:"mt-4 bg-green-50 p-4 rounded-lg border border-green-200"},j={class:"text-green-700"},S={key:2,class:"mt-4 text-sm text-gray-600 flex items-center"},A={class:"ml-2 bg-gray-100 px-2 py-1 rounded"},T={key:3,class:"mt-4 bg-blue-50 p-4 rounded-lg border border-blue-100"},E=["innerHTML"],N=t({__name:"TestWorksheetDisplay",props:{questions:{type:Array,required:!0,default:()=>[]},settings:{type:Object,required:!0,default:()=>({showOptions:!0,show_title:!0,showCorrectAnswers:!1,showExplanations:!1,showScore:!0,layout:"compact",showStepNumbers:!0,showNotes:!0,optionsPerRow:"1"})}},emits:["questionDeleted"],setup(t,{expose:N,emit:O}){const _=t,M=O;n(()=>_.settings,e=>{console.log("Settings changed:",e),console.log("Options per row:",e.optionsPerRow)},{deep:!0}),s(()=>{console.log("Initial settings:",_.settings),console.log("Options per row:",_.settings.optionsPerRow)});const P=t=>Array.isArray(t)?t.map(t=>({...t,option:e(t.option),feedback:t.feedback?e(t.feedback):""})):[],D=e=>{if(!e)return"";try{const t="string"==typeof e?JSON.parse(e):e;return Array.isArray(t)?t.map((e,t)=>{let n="";return e.step&&(n+=`<div class="explanation-step">\n                        ${_.settings.showStepNumbers?`<span class="step-number">Step ${t+1}:</span> `:""}\n                        ${e.step}\n                    </div>`),_.settings.showNotes&&e.note&&(n+=`<div class="explanation-note text-gray-600 text-sm mt-1 ml-4">${e.note}</div>`),n}).join('<div class="my-2"></div>'):e.toString()}catch(t){return(null==e?void 0:e.toString())||""}},H=e=>{const t=P(e).map((e,t)=>({letter:String.fromCharCode(65+t),text:e.option,isCorrect:e.isCorrect})).filter(e=>e.isCorrect);if(0===t.length)return"No correct answer specified";return`${t.map(e=>e.letter).join(", ")} - ${t.map(e=>e.text).join("; ")}`};N({downloadPDF:async({format:e="A4",includeAnswers:t=!1})=>{try{const e=document.getElementById("worksheet-content");if(!e)throw new Error("Content element not found");(new Date).toISOString().slice(0,10);const n=e.cloneNode(!0),s=document.createElement("style");if(s.textContent="\n            .question-item {\n                page-break-inside: avoid;\n                margin-bottom: 20px;\n            }\n            img {\n                max-width: 100%;\n                height: auto;\n            }\n            @media print {\n                .question-item {\n                    page-break-inside: avoid;\n                }\n            }\n        ",n.prepend(s),!t){n.querySelectorAll(".correct-answer").forEach(e=>e.style.display="none")}return console.log("not working html2pdf___....."),!0}catch(n){throw console.error("PDF generation failed:",n),n}},print:()=>{const e=window.open("","_blank"),t=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <title>Test Worksheet</title>\n            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">\n            <style>\n                @page { margin: 1cm; }\n                body {\n                    font-family: system-ui, -apple-system, sans-serif;\n                    line-height: 1.5;\n                    margin: 0;\n                    padding: 1cm;\n                }\n                * { box-sizing: border-box; }\n            </style>\n        </head>\n        <body>\n            ${_.questions.map((e,t)=>`\n        <div class="question-item" style="margin-bottom: 2em; page-break-inside: avoid;">\n            <div style="font-weight: bold; margin-bottom: 1em;">\n                <span>${t+1}. </span>\n                <span>${e.title||"Question"}</span>\n            </div>\n\n            <div style="margin-bottom: 1.5em;">${L(e.body)}</div>\n\n            ${e.options&&_.settings.showOptions?`\n                <div style="\n                    display: grid;\n                    grid-template-columns: repeat(${Number(_.settings.optionsPerRow)||1}, minmax(0, 1fr));\n                    gap: 12px;\n                    width: 100%;\n                    margin-bottom: 1.5em;\n                ">\n                    ${P(e.options).map((e,t)=>`\n                        <div style="break-inside: avoid; min-width: 0;">\n                            <div style="\n                                border: 1px solid #ddd;\n                                border-radius: 6px;\n                                padding: 12px;\n                                display: flex;\n                                align-items: start;\n                                gap: 8px;\n                            ">\n                                <span style="font-weight: bold; flex-shrink: 0;">\n                                    ${String.fromCharCode(65+t)}.\n                                </span>\n                                <span style="flex-grow: 1; min-width: 0; word-wrap: break-word;">${e.option}</span>\n                            </div>\n                        </div>\n                    `).join("")}\n                </div>\n            `:""}\n\n            ${_.settings.showCorrectAnswers&&e.options?`\n                <div style="\n                    margin-top: 1em;\n                    padding: 1em;\n                    background-color: #f0fdf4;\n                    border: 1px solid #bbf7d0;\n                    border-radius: 6px;\n                ">\n                    <div style="font-weight: 500; color: #15803d;">Correct Answer:</div>\n                    <div style="color: #166534;">${H(e.options)}</div>\n                </div>\n            `:""}\n\n            ${_.settings.showExplanations&&e.explanation?`\n                <div style="\n                    margin-top: 1em;\n                    padding: 1em;\n                    background-color: #eff6ff;\n                    border: 1px solid #bfdbfe;\n                    border-radius: 6px;\n                ">\n                    <div style="font-weight: 500; color: #1e40af;">Explanation:</div>\n                    <div style="color: #1e3a8a;">${D(e.explanation)}</div>\n                </div>\n            `:""}\n        </div>\n    `).join("")}\n        </body>\n        </html>\n    `;e.document.write(t),e.document.close(),setTimeout(()=>{e.print(),e.onafterprint=()=>{e.close()}},500)}});const L=t=>t?e(t):"";return(e,n)=>(i(),o("div",{class:c(["p-6",t.settings.layout])},[t.questions&&0!==t.questions.length?(i(),o("div",u,[(i(!0),o(r,null,a(t.questions,(e,s)=>(i(),o("div",{key:s,class:"question-item bg-white rounded-lg shadow-sm border border-gray-200 p-6"},[l("div",y,[l("div",f,[l("span",h,p(s+1),1),t.settings.show_title?(i(),o("span",b,p(e.title||"Question"),1)):d("",!0)]),l("button",{onClick:t=>((e,t)=>{if(confirm("Are you sure you want to delete this question?"))try{M("questionDeleted",{question:e,index:t})}catch(n){console.error("Error deleting question:",n),alert("Failed to delete question")}})(e,s),class:"text-red-600 hover:text-red-800 transition-colors",title:"Delete question"},n[0]||(n[0]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[l("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,v)]),l("div",{class:"mb-6 text-gray-700 question-content",innerHTML:L(e.body)},null,8,w),t.settings.showOptions&&e.options?(i(),o("div",{key:0,class:"options-container",style:m({display:"grid",gridTemplateColumns:`repeat(${Number(t.settings.optionsPerRow)||1}, minmax(0, 1fr))`,gap:"0.75rem",width:"100%"})},[(i(!0),o(r,null,a(P(e.options),(e,t)=>(i(),o("div",{key:t,class:"option-item",style:{minWidth:"0",breakInside:"avoid"}},[l("div",x,[l("div",k,[l("span",q,p(String.fromCharCode(65+t))+". ",1),l("div",{class:"flex-grow",innerHTML:e.option},null,8,C)])])]))),128))],4)):d("",!0),t.settings.showCorrectAnswers&&e.options?(i(),o("div",$,[n[1]||(n[1]=l("div",{class:"font-medium text-green-800 mb-2"},"The Correct Answer:",-1)),l("div",j,p(H(e.options)),1)])):d("",!0),t.settings.showScore&&e.score?(i(),o("div",S,[n[2]||(n[2]=l("span",{class:"font-medium"},"Score:",-1)),l("span",A,p(e.score),1)])):d("",!0),t.settings.showExplanations&&e.explanation?(i(),o("div",T,[n[3]||(n[3]=l("div",{class:"font-medium text-blue-800 mb-2"},"Explanation:",-1)),l("div",{class:"text-blue-700",innerHTML:D(e.explanation)},null,8,E)])):d("",!0)]))),128))])):(i(),o("div",g," No questions available "))],2))}},[["__scopeId","data-v-edcc35a5"]]);export{N as default};
