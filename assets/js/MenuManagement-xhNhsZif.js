import{u as e,Q as a,a as l,b as s}from"./app-Dccx8xF5.js";import{Q as o}from"./QTab-BJCUrT4L.js";import{Q as u}from"./QTabs-4quOvtr1.js";import{Q as t}from"./QTabPanel-QxVdoii7.js";import{Q as n}from"./QTabPanels-DiqDdK2g.js";import{N as m,f as i,k as r,H as d,I as p,J as c,M as v,b as y,L as f,Q as b,F as g,Z as j,_ as Q}from"./vendor-EI0FRBVb.js";import{u as M,A as V}from"./AdminLayout-Dr395exQ.js";import C from"./MenuList-Cmr-qPvg.js";import _ from"./MenuForm-BvRC3P7R.js";import h from"./MenuDeleteDialog-CHlmESms.js";import k from"./BulkImportDialog-qJQLrsXB.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-DP2_LoYb.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-BoQNzKR2.js";import"./QSpace-BWA-UIs7.js";import"./QSelect-aOnYle6d.js";import"./QForm-Df8AW4W_.js";import"./QStepperNavigation-8KhNfuaY.js";import"./QStepper-BdIp9p9O.js";const U={class:"q-pa-md"},w={class:"row q-mb-md items-center"},F={class:"col-auto"},S={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(S){const x=e();m();const A=S,I=i(A.modules[0]||"academics"),T=i(!1),D=i(!1),L=i(!1),q=i(!1),B=i(null),N=i(null),P=e=>A.menus.filter(a=>a.module===e),H=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");r(D,e=>{e&&(B.value=null,T.value=!0,D.value=!1)});const J=e=>{B.value=e,T.value=!0},R=e=>{N.value=e,L.value=!0},$=async e=>{var a,l;try{B.value?(await j.put(`/api/admin/menus/${B.value.id}`,e),x.notify({type:"positive",message:"Menu updated successfully"})):(await j.post("/api/admin/menus",e),x.notify({type:"positive",message:"Menu created successfully"})),z(),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to save menu"})}},E=async()=>{var e,a;try{await j.delete(`/api/admin/menus/${N.value.id}`),x.notify({type:"positive",message:"Menu deleted successfully"}),L.value=!1,Q.reload({only:["menus"]})}catch(l){x.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},K=async e=>{var a,l;try{await j.post("/api/admin/menus/reorder",{items:e}),x.notify({type:"positive",message:"Menu order updated successfully"}),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to reorder menus"})}},O=M(),Z=async()=>{await O.invalidateCache(),Q.reload({only:["menus"]})},z=()=>{T.value=!1,B.value=null};return(e,m)=>(p(),d(V,null,{default:c(()=>[v("div",U,[v("div",w,[m[8]||(m[8]=v("div",{class:"col"},[v("div",{class:"text-h4"},"Menu Management"),v("div",{class:"text-subtitle2 text-grey-7"},"Manage navigation menus for your application")],-1)),v("div",F,[y(a,{color:"primary",icon:"add",label:"Create Menu",onClick:m[0]||(m[0]=e=>D.value=!0)}),y(a,{color:"secondary",icon:"upload",label:"Bulk Import",class:"q-ml-sm",onClick:m[1]||(m[1]=e=>q.value=!0)})])]),y(u,{modelValue:I.value,"onUpdate:modelValue":m[2]||(m[2]=e=>I.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left"},{default:c(()=>[(p(!0),f(g,null,b(S.modules,e=>(p(),d(o,{key:e,name:e,label:H(e)},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),y(l),y(n,{modelValue:I.value,"onUpdate:modelValue":m[3]||(m[3]=e=>I.value=e),animated:""},{default:c(()=>[(p(!0),f(g,null,b(S.modules,e=>(p(),d(t,{key:e,name:e},{default:c(()=>[y(C,{menus:P(e),module:e,onEdit:J,onDelete:R,onReorder:K},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),y(s,{modelValue:T.value,"onUpdate:modelValue":m[4]||(m[4]=e=>T.value=e),persistent:""},{default:c(()=>[y(_,{menu:B.value,modules:S.modules,onSave:$,onCancel:z},null,8,["menu","modules"])]),_:1},8,["modelValue"]),y(h,{modelValue:L.value,"onUpdate:modelValue":m[5]||(m[5]=e=>L.value=e),menu:N.value,onConfirm:E,onCancel:m[6]||(m[6]=e=>L.value=!1)},null,8,["modelValue","menu"]),y(k,{modelValue:q.value,"onUpdate:modelValue":m[7]||(m[7]=e=>q.value=e),onImported:Z},null,8,["modelValue"])])]),_:1}))}};export{S as default};
