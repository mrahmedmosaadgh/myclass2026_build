import{p as e}from"./app-Dccx8xF5.js";import{f as l,L as o,I as t,M as a,O as s,x as n,aa as r,S as i,F as u,Q as p,R as d,U as c,ab as v}from"./vendor-EI0FRBVb.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";const g={class:"image-marker-container"},y={class:"mb-4 flex gap-4 items-center"},m={class:"flex items-center gap-2"},f=["src"],b={class:"relative group"},x={class:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm"},h={class:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 bg-black text-white px-2 py-1 rounded text-sm whitespace-nowrap opacity-0 group-hover:opacity-100"},k={class:"absolute top-0 left-0 w-full h-full pointer-events-none"},w=["points","fill","stroke"],C={key:0,class:"absolute top-0 left-0 w-full h-full pointer-events-none"},P=["points"],j={class:"mt-4 space-y-4"},M={key:0},U={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white"},$=["onUpdate:modelValue","placeholder"],V=["onClick"],_={key:1},A=["onUpdate:modelValue","placeholder"],B=["onUpdate:modelValue"],I=["onClick"],L=e({__name:"AdvancedImageMarker",props:{imageUrl:{type:String,required:!0},initialPoints:{type:Array,default:()=>[]},initialPolygons:{type:Array,default:()=>[]}},emits:["update:data","export"],setup(e,{emit:L}){const D=e,E=L,F=l("point"),R=l(D.initialPoints),S=l(D.initialPolygons),q=l(null),O=l(null),Q=l(!1),X=l([]),Y=e=>{const l=q.value.getBoundingClientRect(),o=e.clientX-l.left,t=e.clientY-l.top;"point"===F.value?z(o,t):"polygon"===F.value&&G(o,t)},z=(e,l)=>{R.value.push({x:e,y:l,label:`Point ${R.value.length+1}`}),T()},G=(e,l)=>{Q.value||(Q.value=!0,X.value=[]),X.value.push({x:e,y:l})},H=()=>{X.value.length>=3&&(S.value.push({points:[...X.value],label:`Polygon ${S.value.length+1}`,color:W()}),T()),Q.value=!1,X.value=[]},J=e=>e.map(e=>`${e.x},${e.y}`).join(" "),K=()=>{R.value=[],S.value=[],Q.value=!1,X.value=[],T()},N=()=>{const e={points:R.value.map((e,l)=>({id:l+1,label:e.label,coordinates:{x:e.x,y:e.y}})),polygons:S.value.map((e,l)=>({id:l+1,label:e.label,color:e.color,vertices:e.points}))};E("export",e)},T=()=>{E("update:data",{points:R.value,polygons:S.value})},W=()=>{let e="#";for(let l=0;l<6;l++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},Z=()=>{console.log("Image loaded")};return(l,L)=>(t(),o("div",g,[a("div",y,[a("div",m,[L[2]||(L[2]=a("label",{class:"font-medium"},"Marking Mode:",-1)),n(a("select",{"onUpdate:modelValue":L[0]||(L[0]=e=>F.value=e),class:"border rounded px-2 py-1"},L[1]||(L[1]=[a("option",{value:"point"},"Point",-1),a("option",{value:"polygon"},"Polygon",-1)]),512),[[r,F.value]])]),"polygon"===F.value&&Q.value?(t(),o("button",{key:0,onClick:H,class:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"}," Complete Polygon ")):s("",!0)]),a("div",{class:"relative border border-gray-300",ref_key:"imageContainer",ref:q},[a("img",{src:e.imageUrl,onClick:Y,class:i([{"cursor-crosshair":"point"===F.value,"cursor-pointer":"polygon"===F.value},"max-w-full"]),ref_key:"image",ref:O,onLoad:Z},null,42,f),(t(!0),o(u,null,p(R.value,(e,l)=>(t(),o("div",{key:`point-${l}`,class:"absolute w-6 h-6 -ml-3 -mt-3 flex items-center justify-center",style:d({left:e.x+"px",top:e.y+"px"})},[a("div",b,[a("div",x,c(l+1),1),a("div",h,c(e.label),1)])],4))),128)),(t(!0),o(u,null,p(S.value,(e,l)=>(t(),o("div",{key:`polygon-${l}`,class:"absolute top-0 left-0 w-full h-full"},[(t(),o("svg",k,[a("polygon",{points:J(e.points),fill:e.color,"fill-opacity":"0.2",stroke:e.color,"stroke-width":"2"},null,8,w)])),(t(!0),o(u,null,p(e.points,(e,s)=>(t(),o("div",{key:`poly-point-${l}-${s}`,class:"absolute w-4 h-4 -ml-2 -mt-2",style:d({left:e.x+"px",top:e.y+"px"})},L[3]||(L[3]=[a("div",{class:"w-4 h-4 bg-green-500 rounded-full"},null,-1)]),4))),128))]))),128)),Q.value?(t(),o("svg",C,[a("polygon",{points:J(X.value),fill:"rgba(0, 255, 0, 0.2)",stroke:"green","stroke-width":"2"},null,8,P)])):s("",!0)],512),a("div",j,[R.value.length>0?(t(),o("div",M,[L[5]||(L[5]=a("h3",{class:"font-medium mb-2"},"Points",-1)),(t(!0),o(u,null,p(R.value,(e,l)=>(t(),o("div",{key:`point-list-${l}`,class:"flex items-center gap-4 mb-2"},[a("span",U,c(l+1),1),n(a("input",{type:"text","onUpdate:modelValue":l=>e.label=l,class:"border rounded px-2 py-1",placeholder:"Point "+(l+1)},null,8,$),[[v,e.label]]),a("button",{onClick:e=>(e=>{R.value.splice(e,1),T()})(l),class:"text-red-500 hover:text-red-700"},L[4]||(L[4]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,V)]))),128))])):s("",!0),S.value.length>0?(t(),o("div",_,[L[7]||(L[7]=a("h3",{class:"font-medium mb-2"},"Polygons",-1)),(t(!0),o(u,null,p(S.value,(e,l)=>(t(),o("div",{key:`polygon-list-${l}`,class:"flex items-center gap-4 mb-2"},[a("span",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white",style:d({backgroundColor:e.color})},c(l+1),5),n(a("input",{type:"text","onUpdate:modelValue":l=>e.label=l,class:"border rounded px-2 py-1",placeholder:"Polygon "+(l+1)},null,8,A),[[v,e.label]]),n(a("input",{type:"color","onUpdate:modelValue":l=>e.color=l,class:"w-8 h-8 rounded"},null,8,B),[[v,e.color]]),a("button",{onClick:e=>(e=>{S.value.splice(e,1),T()})(l),class:"text-red-500 hover:text-red-700"},L[6]||(L[6]=[a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,I)]))),128))])):s("",!0)]),a("div",{class:"mt-4 space-x-2"},[a("button",{onClick:K,class:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"}," Clear All "),a("button",{onClick:N,class:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600"}," Export Data ")])]))}},[["__scopeId","data-v-463479ff"]]);export{L as default};
