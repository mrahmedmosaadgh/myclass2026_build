import{_ as e}from"./SecondaryButton-WaufSYeJ.js";import{_ as a}from"./PrimaryButton-DVJXOzHH.js";import{M as t}from"./Modal-B3qkoeWC.js";import{read as l,utils as s}from"./xlsx-BHXqx-YI.js";import{f as r,a as o,N as i,J as n,R as d,b as u,K as c,V as p,O as m,L as y,W as f,F as v,Q as x,U as g}from"./vendor-BWKGNkNB.js";import"./app-CWAnT6CT.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const h={class:"p-6"},w={class:"flex justify-between items-center mb-4"},b={class:"text-lg font-medium text-gray-900"},k={class:"text-sm text-gray-500"},j={key:0,class:"overflow-x-auto mb-4"},_={class:"min-w-full divide-y divide-gray-200"},C={class:"bg-gray-50"},I={class:"bg-white divide-y divide-gray-200"},S={key:0,class:"text-xs text-red-500"},T={class:"flex justify-end"},A={__name:"ImportExcel",props:{buttonText:{type:String,default:"Import Excel"},previewTitle:{type:String,default:"Import Preview"},columns:{type:Array,default:()=>[]},validator:{type:Function,default:null}},emits:["data"],setup(A,{emit:B}){const E=A,F=B,P=r(null),R=r(!1),M=r(!1),N=r([]),O=o(()=>N.value.some(e=>Object.keys(e.errors||{}).length>0)),U=async e=>{const a=e.target.files[0];if(a){R.value=!0;try{const e=await W(a);N.value=E.validator?e.map(e=>E.validator(e)):e,M.value=!0}catch(t){console.error("Error reading file:",t)}finally{R.value=!1,e.target.value=""}}},W=e=>new Promise((a,t)=>{const r=new FileReader;r.onload=e=>{try{const t=new Uint8Array(e.target.result),r=l(t,{type:"array"}),o=r.Sheets[r.SheetNames[0]],i=s.sheet_to_json(o);a(i.map(e=>({data:e,errors:{}})))}catch(r){t(r)}},r.onerror=t,r.readAsArrayBuffer(e)}),$=()=>{F("data",N.value),J()},J=()=>{M.value=!1,N.value=[]};return(l,s)=>(n(),i("div",null,[d("input",{type:"file",ref_key:"fileInput",ref:P,class:"hidden",accept:".xlsx,.xls",onChange:U},null,544),u(e,{onClick:s[0]||(s[0]=e=>l.$refs.fileInput.click()),disabled:R.value,class:"relative"},{default:c(()=>[d("span",null,p(A.buttonText),1)]),_:1},8,["disabled"]),u(t,{show:M.value,onClose:J,maxWidth:"4xl"},{default:c(()=>[d("div",h,[d("div",w,[d("h3",b,p(A.previewTitle),1),d("div",k," Total Records: "+p(N.value.length),1)]),M.value?(n(),i("div",j,[y(l.$slots,"preview",{data:N.value},()=>[d("table",_,[d("thead",C,[d("tr",null,[(n(!0),i(v,null,x(A.columns,(e,a)=>(n(),i("th",{key:a,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},p(e.label),1))),128))])]),d("tbody",I,[(n(!0),i(v,null,x(N.value,(e,a)=>(n(),i("tr",{key:a},[(n(!0),i(v,null,x(A.columns,(a,t)=>{var l,s;return n(),i("td",{key:t,class:g(["px-6 py-4 whitespace-nowrap text-sm",(null==(l=e.errors)?void 0:l[a.key])?"text-red-600":"text-gray-900"])},[f(p(e.data[a.key])+" ",1),(null==(s=e.errors)?void 0:s[a.key])?(n(),i("p",S,p(e.errors[a.key]),1)):m("",!0)],2)}),128))]))),128))])])])])):m("",!0),d("div",T,[u(e,{onClick:J,class:"mr-2"},{default:c(()=>s[1]||(s[1]=[f(" Cancel ")])),_:1}),u(a,{onClick:$,disabled:O.value},{default:c(()=>s[2]||(s[2]=[f(" Confirm Import ")])),_:1},8,["disabled"])])])]),_:3},8,["show"])]))}};export{A as default};
