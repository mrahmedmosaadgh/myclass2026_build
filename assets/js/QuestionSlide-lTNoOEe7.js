import e from"./EnhancedQuestionEditor-C-MxIJUY.js";import t from"./QuestionTypeSelector-CsQXFzMJ.js";import s from"./QuizEngine-D4REl3s0.js";import{o as r}from"./app-BB4Fw2oM.js";import{f as l,o as a,e as o,a as i,M as n,J as d,N as u,Q as c,U as p,V as m,W as b,F as f,R as g,an as v,I as y,b as x}from"./vendor-DuKqz2x4.js";const w={class:"flex justify-between items-start mb-4"},h=["innerHTML"],_={class:"flex flex-col items-end gap-2"},q={key:1,class:"text-xs text-gray-500"},k={class:"space-y-3"},C={key:0,class:"space-y-2"},j=["onClick"],V=["innerHTML"],T={key:0,class:"fas fa-check-circle text-blue-500"},M={key:1,class:"space-y-2"},A=["onClick"],I={key:0,class:"fas fa-check text-white text-xs"},S=["innerHTML"],L={key:2,class:"flex gap-4"},U={key:3,class:"space-y-2"},Q=["value","disabled"],O={key:4,class:"space-y-2"},z=["value","disabled"],H={class:"mt-6 pt-4 border-t border-gray-100"},N={key:0},F=["disabled"],B={key:1},E={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3"},R={key:1},P={key:0,class:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-3"},W={class:"flex items-center gap-3 mb-2"},$={class:"text-sm text-orange-700"},D={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},G={class:"text-sm text-gray-700 bg-white p-3 rounded border border-gray-200"},J=["innerHTML"],Y=r({__name:"UniversalQuestionPlayer",props:{question:{type:Object,required:!0},answer:{type:[String,Number,Array,Boolean],default:null},attempts:{type:Number,default:0},solved:{type:Boolean,default:!1},submitted:{type:Boolean,default:!1},mode:{type:String,default:"learn"},juniorMode:{type:Boolean,default:!1}},emits:["update:answer","update:attempts","update:solved","update:submitted"],setup(e,{emit:t}){const s=e,r=t,y=l(s.question.timer||0);let x=null;a(()=>{s.question.timer>0&&!s.solved&&(x=setInterval(()=>{y.value>0?y.value--:clearInterval(x)},1e3))}),o(()=>{x&&clearInterval(x)});const Y=e=>r("update:answer",e),K=e=>Array.isArray(s.answer)?s.answer.includes(e):s.answer===e,X=i(()=>Array.isArray(s.answer)?s.answer.length>0:null!==s.answer&&void 0!==s.answer&&""!==s.answer),Z=()=>{const e=s.question,t=s.answer;if(null==t)return!1;if("single_choice"===e.type){const s=e.options.find(e=>e.is_correct);return s&&t===s.id}if("multiple_choice"===e.type){const s=e.options.filter(e=>e.is_correct).map(e=>e.id);return!(!Array.isArray(t)||t.length!==s.length)&&t.every(e=>s.includes(e))}return"true_false"===e.type?t===(!0===e.correct_answer||"true"===e.correct_answer||1===e.correct_answer):!!["short_answer","number"].includes(e.type)&&String(t).trim().toLowerCase()===String(e.correct_answer).trim().toLowerCase()},ee=i(()=>Z()),te=i(()=>{var e;const t=s.question;return"single_choice"===t.type?(null==(e=t.options.find(e=>e.is_correct))?void 0:e.text)||"":"multiple_choice"===t.type?t.options.filter(e=>e.is_correct).map(e=>e.text).join(", "):"true_false"===t.type?!0===t.correct_answer||"true"===t.correct_answer||1===t.correct_answer?"True":"False":["short_answer","number"].includes(t.type)?t.correct_answer:""}),se=()=>{const e=s.attempts+1;r("update:attempts",e),r("update:submitted",!0),(Z()||e>=3)&&(r("update:solved",!0),x&&clearInterval(x))},re=()=>{r("update:submitted",!1)},le=e=>{var t;const r=K(e);if(!s.submitted)return r?"bg-blue-50 border-blue-500 ring-1 ring-blue-500":"bg-white border-gray-200 hover:border-blue-300";const l=null==(t=s.question.options.find(t=>t.id===e))?void 0:t.is_correct;return l?"bg-green-50 border-green-500 ring-1 ring-green-500":r&&!l?"bg-red-50 border-red-500 ring-1 ring-red-500":"bg-white border-gray-200 opacity-50"},ae=e=>{const t=K(e);if(!s.submitted)return t?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-blue-300";const r=(!0===s.question.correct_answer||"true"===s.question.correct_answer||1===s.question.correct_answer)===e;return r?"bg-green-600 text-white border-green-600":t&&!r?"bg-red-600 text-white border-red-600":"bg-white text-gray-400 border-gray-200"};return(t,l)=>(d(),n("div",{class:p(["bg-white p-6 rounded-lg border border-gray-200 shadow-sm overflow-hidden",e.juniorMode?"bg-gradient-to-r from-indigo-100 via-purple-100 to-pink-100":""])},[u("div",w,[u("h3",{class:"text-lg font-medium text-gray-900 flex-1 mr-4",innerHTML:e.question.text},null,8,h),u("div",_,[u("span",{class:p(["text-xs font-medium px-2.5 py-0.5 rounded",e.juniorMode?"bg-yellow-200 text-yellow-800":"bg-blue-100 text-blue-800"])},m(e.question.points)+" Points ",3),e.question.timer>0?(d(),n("div",{key:0,class:p(["flex items-center gap-1 text-sm font-mono",y.value<10?"text-red-600 font-bold":"text-gray-600"])},[l[4]||(l[4]=u("i",{class:"fas fa-clock"},null,-1)),b(" "+m(y.value)+"s ",1)],2)):c("",!0),e.solved?c("",!0):(d(),n("div",q," Attempts: "+m(e.attempts)+"/3 ",1))])]),u("div",k,["single_choice"===e.question.type?(d(),n("div",C,[(d(!0),n(f,null,g(e.question.options,t=>(d(),n("button",{key:t.id,onClick:s=>!e.submitted&&Y(t.id),class:p(["w-full text-left p-4 rounded-lg border transition-all flex items-center justify-between",le(t.id)])},[u("span",{innerHTML:t.text},null,8,V),K(t.id)?(d(),n("i",T)):c("",!0)],10,j))),128))])):"multiple_choice"===e.question.type?(d(),n("div",M,[(d(!0),n(f,null,g(e.question.options,t=>(d(),n("button",{key:t.id,onClick:l=>!e.submitted&&(e=>{const t=Array.isArray(s.answer)?[...s.answer]:[],l=t.indexOf(e);-1===l?t.push(e):t.splice(l,1),r("update:answer",t)})(t.id),class:p(["w-full text-left p-4 rounded-lg border transition-all flex items-center gap-3",le(t.id)])},[u("div",{class:p(["w-5 h-5 border rounded flex items-center justify-center",K(t.id)?"bg-blue-600 border-blue-600":"border-gray-300"])},[K(t.id)?(d(),n("i",I)):c("",!0)],2),u("span",{innerHTML:t.text},null,8,S)],10,A))),128))])):"true_false"===e.question.type?(d(),n("div",L,[u("button",{onClick:l[0]||(l[0]=t=>!e.submitted&&Y(!0)),class:p(["flex-1 p-4 rounded-lg border text-center font-medium transition-all",ae(!0)])}," True ",2),u("button",{onClick:l[1]||(l[1]=t=>!e.submitted&&Y(!1)),class:p(["flex-1 p-4 rounded-lg border text-center font-medium transition-all",ae(!1)])}," False ",2)])):["short_answer","number"].includes(e.question.type)?(d(),n("div",U,[u("input",{type:"text",value:e.answer||"",onInput:l[2]||(l[2]=t=>!e.submitted&&Y(t.target.value)),class:"w-full p-4 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:e.submitted,placeholder:"Type your answer..."},null,40,Q)])):"long_answer"===e.question.type?(d(),n("div",O,[u("textarea",{value:e.answer||"",onInput:l[3]||(l[3]=t=>!e.submitted&&Y(t.target.value)),class:"w-full p-4 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all min-h-[120px]",disabled:e.submitted,placeholder:"Type your answer..."},null,40,z)])):c("",!0)]),u("div",H,[e.submitted?(d(),n("div",B,[ee.value?(d(),n("div",E,l[5]||(l[5]=[u("div",{class:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0"},[u("i",{class:"fas fa-check text-green-600 text-xl"})],-1),u("div",null,[u("h4",{class:"font-bold text-green-800"},"Correct!"),u("p",{class:"text-sm text-green-700"},"Great job!")],-1)]))):(d(),n("div",R,[e.attempts<3?(d(),n("div",P,[u("div",W,[l[7]||(l[7]=u("div",{class:"w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center flex-shrink-0"},[u("i",{class:"fas fa-exclamation-triangle text-orange-600 text-xl"})],-1)),u("div",null,[l[6]||(l[6]=u("h4",{class:"font-bold text-orange-800"},"Incorrect",-1)),u("p",$,"You have "+m(3-e.attempts)+" attempts remaining.",1)])]),u("button",{onClick:re,class:"mt-2 inline-flex items-center px-4 py-2 border border-orange-300 shadow-sm text-sm font-medium rounded-md text-orange-700 bg-white hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500"},l[8]||(l[8]=[u("i",{class:"fas fa-redo mr-2"},null,-1),b(" Try Again ")]))])):(d(),n("div",D,[l[10]||(l[10]=v('<div class="flex items-center gap-3 mb-3" data-v-f5fd0c3a><div class="w-10 h-10 rounded-full bg-red-100 flex items-center justify-center flex-shrink-0" data-v-f5fd0c3a><i class="fas fa-times text-red-600 text-xl" data-v-f5fd0c3a></i></div><div data-v-f5fd0c3a><h4 class="font-bold text-red-800" data-v-f5fd0c3a>Incorrect</h4><p class="text-sm text-red-700" data-v-f5fd0c3a>No attempts remaining.</p></div></div>',1)),u("div",G,[l[9]||(l[9]=u("span",{class:"font-bold text-gray-900"},"Correct Answer:",-1)),u("span",{class:"font-medium ml-1",innerHTML:te.value},null,8,J)])]))]))])):(d(),n("div",N,[u("button",{onClick:se,disabled:!X.value,class:"w-full sm:w-auto px-6 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-sm"}," Submit Answer ",8,F)]))])],2))}},[["__scopeId","data-v-f5fd0c3a"]]),K={class:"min-h-full flex flex-col"},X={key:0,class:"flex-1 space-y-4 p-1"},Z={key:0,class:"text-center py-10 text-gray-500"},ee={class:"mt-4 pt-4 border-t border-gray-200"},te={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},se={class:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"},re={class:"p-6"},le={key:1,class:"flex-1"},ae={key:2,class:"flex-1 space-y-8"},oe=r({__name:"QuestionSlide",props:{modelValue:{type:Object,default:()=>({questions:[]})},mode:{type:String,default:"edit",validator:e=>["edit","play"].includes(e)},quizConfig:{type:Object,default:()=>({allowReviewMode:!1,autoAdvance:!1,showRationaleOnCorrect:!0})},attemptId:{type:[String,Number],default:void 0},legacyMode:{type:String,default:"learn"}},emits:["update:modelValue","answer-selected","quiz-completed"],setup(r,{emit:a}){const o=r,p=a,m=l(!1),v=l({}),w=l({}),h=l({}),_=l({}),q=i(()=>{const e=o.modelValue.questions||[];if(0===e.length)return!1;const t=["single_choice","multiple_choice","true_false"];return e.every(e=>t.includes(e.type))}),k=i(()=>(o.modelValue.questions||[]).map((e,t)=>{const s={id:C(e.type),slug:e.type,name:j(e.type),hasOptions:["single_choice","multiple_choice","true_false"].includes(e.type),supportsHints:!0,supportsExplanation:!0};let r=[];return"single_choice"===e.type||"multiple_choice"===e.type?r=(e.options||[]).map((t,s)=>{const r="single_choice"===e.type?e.correct_answer===t.id:(e.correct_answer||[]).includes(t.id);return{id:t.id||`opt_${s}`,text:t.text||"",isCorrect:r,rationale:t.rationale||void 0}}):"true_false"===e.type&&(r=[{id:"true",text:"True",isCorrect:!0===e.correct_answer,rationale:void 0},{id:"false",text:"False",isCorrect:!1===e.correct_answer,rationale:void 0}]),{id:e.id||`q_${t}`,questionNumber:t+1,questionTypeId:s.id,questionType:s,question:e.text||e.question||"",answerOptions:r,explanation:e.explanation||void 0,hints:e.hints||void 0,bloomLevel:e.bloomLevel||void 0,difficultyLevel:e.difficultyLevel||void 0,estimatedTimeSec:e.timer||void 0,metadata:{originalType:e.type,points:e.points||0}}})),C=e=>({single_choice:1,multiple_choice:2,true_false:3,fill_blank:4,short_answer:5,essay:6}[e]||1),j=e=>({single_choice:"Multiple Choice",multiple_choice:"Multi-Select",true_false:"True/False",fill_blank:"Fill in the Blank",short_answer:"Short Answer",essay:"Essay"}[e]||"Unknown"),V=e=>{p("answer-selected",e)},T=e=>{console.log("Question changed to:",e)},M=e=>{p("quiz-completed",e)},A=e=>{const t=o.modelValue.questions||[],s={id:"q_"+Math.random().toString(36).substr(2,6),type:e.value,active:!0};"classic"===e.category?(s.text="",s.timer=0,"single_choice"===e.value||"multiple_choice"===e.value?(s.options=[{id:"opt_1",text:"Option 1"},{id:"opt_2",text:"Option 2"}],s.correct_answer="single_choice"===e.value?null:[]):"true_false"===e.value?s.correct_answer=!0:"step_by_step"===e.value&&(s.steps=[])):(s.title="",s.description="",s.points=10,s.timeLimit=0,s.version="default","labelled-diagram"===e.value?(s.imageUrl="",s.labels=[],s.instructions="Click on each point to label it"):"match-up"===e.value?(s.pairs=[],s.shuffleRight=!0):"speaking-cards"===e.value?(s.cards=[],s.recordingRequired=!1):"image-quiz"===e.value?(s.question="",s.options=[]):"group-sort"===e.value?(s.categories=[],s.items=[]):"sequence"===e.value?s.items=[]:"missing-word"===e.value?(s.sentence="",s.blanks=[]):"anagram"===e.value&&(s.scrambledWord="",s.correctWord="")),t.push(s),p("update:modelValue",{...o.modelValue,questions:t}),m.value=!1};return(l,a)=>(d(),n("div",K,["edit"===r.mode?(d(),n("div",X,[r.modelValue.questions&&0!==r.modelValue.questions.length?c("",!0):(d(),n("div",Z,' No questions added yet. Click "Add Question" to get started. ')),(d(!0),n(f,null,g(r.modelValue.questions||[],(t,s)=>(d(),y(e,{key:t.id||s,modelValue:t,"onUpdate:modelValue":e=>((e,t)=>{const s=[...o.modelValue.questions||[]];s[e]=t,p("update:modelValue",{...o.modelValue,questions:s})})(s,e),onDelete:e=>(e=>{const t=[...o.modelValue.questions||[]];t.splice(e,1),p("update:modelValue",{...o.modelValue,questions:t})})(s),uniqueId:t.id||`q_${s}`},null,8,["modelValue","onUpdate:modelValue","onDelete","uniqueId"]))),128)),u("div",ee,[u("button",{onClick:a[0]||(a[0]=e=>m.value=!0),class:"w-full py-3 border-2 border-dashed border-blue-300 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors font-medium flex items-center justify-center gap-2"},a[2]||(a[2]=[u("i",{class:"fas fa-plus-circle"},null,-1),b(" Add Question ")]))]),m.value?(d(),n("div",te,[u("div",se,[u("div",re,[x(t,{onSelect:A,onCancel:a[1]||(a[1]=e=>m.value=!1)})])])])):c("",!0)])):"play"===r.mode&&q.value?(d(),n("div",le,[x(s,{quiz:k.value,config:r.quizConfig,attemptId:r.attemptId,onAnswerSelected:V,onQuestionChanged:T,onQuizCompleted:M},null,8,["quiz","config","attemptId"])])):"play"===r.mode?(d(),n("div",ae,[(d(!0),n(f,null,g(r.modelValue.questions||[],(e,t)=>(d(),y(Y,{key:e.id||t,question:e,answer:v.value[e.id],"onUpdate:answer":t=>v.value[e.id]=t,attempts:w.value[e.id],"onUpdate:attempts":t=>w.value[e.id]=t,solved:h.value[e.id],"onUpdate:solved":t=>h.value[e.id]=t,submitted:_.value[e.id],"onUpdate:submitted":t=>_.value[e.id]=t,mode:r.legacyMode},null,8,["question","answer","onUpdate:answer","attempts","onUpdate:attempts","solved","onUpdate:solved","submitted","onUpdate:submitted","mode"]))),128))])):c("",!0)]))}},[["__scopeId","data-v-7f514f61"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"}));export{oe as Q,Y as U,ie as a};
