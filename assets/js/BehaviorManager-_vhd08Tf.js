import{r as e,u as a,Q as t,t as s,b as i,f as o,d as n,o as l,e as r}from"./app-YpH5vqWh.js";import{Q as c}from"./QTab-D15tnj4c.js";import{Q as u}from"./QTabs-CSqR0VCn.js";import{Q as d}from"./QTabPanel-BAPJ1DQL.js";import{Q as v}from"./QTabPanels-DBSQeA0j.js";import{f as p,a as m,N as g,J as f,R as h,b,O as y,V as T,K as w,W as _,U as k,F as j,Q as V,I as S,_ as C}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-Di-bjwYZ.js";import"./use-render-cache-CmTcazfP.js";const $={class:"behavior-manager"},A={class:"student-header"},N={class:"student-avatar"},x={class:"student-info"},z={class:"student-name"},Q={class:"encouragement-text"},G={class:"tab-content"},L={class:"tab-content"},Y={class:"panel-header"},M={class:"behavior-grid"},P={class:"behavior-icon positive-icon"},O={class:"behavior-name"},I={class:"behavior-points positive-points"},J={class:"behavior-grid"},U={class:"behavior-icon negative-icon"},q={class:"behavior-name"},W={class:"behavior-points negative-points"},B={class:"score-display"},K={class:"score-card positive-score"},R={class:"score-number"},F={class:"score-card total-score"},D={class:"score-number"},E={class:"score-card negative-score"},H={class:"score-number"},X={class:"confirm-icon"},Z={class:"confirm-title"},ee={class:"confirm-message"},ae={class:"student-name-large"},te={class:"behavior-description"},se={class:"behavior-name-large"},ie={class:"points-info"},oe={key:0,class:"success-animation"},ne={class:"success-content"},le={class:"success-text"},re=e({__name:"BehaviorManager",props:{studentId:Number,read:Boolean,studentName:{type:String,default:"Student"},periodCode:String,date:{type:String,default:()=>(new Date).toISOString().slice(0,10)},behaviors:{type:Array,default:()=>[]},summary:{type:Object,default:()=>({positive:0,negative:0,total:0})}},emits:["recorded","close"],setup(e,{emit:re}){const ce=e,ue=re,de=a(),ve=p("positive"),pe=p(!1),me=p(null),ge=p(!1),fe=p(""),he=p(null),be=p(null),ye=m(()=>ce.summary||{positive:0,negative:0,total:0}),Te=m(()=>(ce.behaviors||[]).filter(e=>"positive"===e.type)),we=m(()=>(ce.behaviors||[]).filter(e=>"negative"===e.type)),_e=["You're doing great!","Keep up the good work!","You're awesome!","Learning every day!","You're a star!","Great effort!","You're amazing!"],ke=m(()=>{const e=Math.floor(Math.random()*_e.length);return _e[e]}),je=(e,a=1,t=1.2)=>{if(ce.read&&"speechSynthesis"in window){speechSynthesis.cancel();const s=new SpeechSynthesisUtterance(e);s.rate=a,s.pitch=t,s.volume=.8;const i=speechSynthesis.getVoices().find(e=>e.name.includes("child")||e.name.includes("kid")||e.name.includes("young")||"female"===e.gender&&e.lang.startsWith("en"));i&&(s.voice=i),speechSynthesis.speak(s)}},Ve=()=>{je(`  ${ce.studentName} `,.9,1.3)},Se=e=>{try{const a=new(window.AudioContext||window.webkitAudioContext),t=a.createOscillator(),s=a.createGain();t.connect(s),s.connect(a.destination),"positive"===e?(t.frequency.setValueAtTime(523.25,a.currentTime),t.frequency.setValueAtTime(659.25,a.currentTime+.1),t.frequency.setValueAtTime(783.99,a.currentTime+.2),t.type="sine",s.gain.setValueAtTime(.3,a.currentTime),s.gain.exponentialRampToValueAtTime(.01,a.currentTime+.5),t.start(a.currentTime),t.stop(a.currentTime+.5)):(t.frequency.setValueAtTime(440,a.currentTime),t.type="sine",s.gain.setValueAtTime(.2,a.currentTime),s.gain.exponentialRampToValueAtTime(.01,a.currentTime+.3),t.start(a.currentTime),t.stop(a.currentTime+.3))}catch(a){console.log("Web Audio not available")}},Ce=(e,a)=>{const t={positive:{listening:"ðŸ‘‚",helping:"ðŸ¤",sharing:"ðŸ¤²","following directions":"âœ…","being kind":"ðŸ’","working hard":"ðŸ’ª","raising hand":"ðŸ™‹","good effort":"â­",teamwork:"ðŸ‘¥",respect:"ðŸ™",default:"ðŸŒŸ"},negative:{"talking out":"ðŸ—£ï¸","not listening":"ðŸ‘‚","not following directions":"ðŸ“‹",disrupting:"âš ï¸","not sharing":"ðŸ¤²","not helping":"ðŸ¤","off task":"ðŸ“š",default:"ðŸ“–"}},s=t[a]||t.positive,i=e.toLowerCase();for(const o in s)if(i.includes(o))return s[o];return s.default},$e=e=>{me.value=e,pe.value=!0;const a="positive"===e.type?`Great job   ${e.name}!`:`  ${e.name}`;je(a,.9,1.2)},Ae=()=>{pe.value=!1,me.value=null},Ne=async()=>{var e,a,t,s,i;if(!me.value)return;const o=me.value;try{await C.post("/api/student-behaviors",{student_id:ce.studentId,behavior_id:o.id,points:o.points,period_code:ce.periodCode,date:ce.date}),"positive"===o.type?((()=>{try{he.value?(he.value.currentTime=0,he.value.play().catch(()=>{Se("positive")})):Se("positive")}catch(e){console.log("Sound not available")}})(),fe.value=`ðŸŽ‰ Great job, ${ce.studentName}! You earned ${o.points} points for ${o.name}!`,je(`Fantastic ${ce.studentName}! You earned ${o.points} points for ${o.name}! Keep up the great work!`,.9,1.3)):((()=>{try{be.value?(be.value.currentTime=0,be.value.play().catch(()=>{Se("negative")})):Se("negative")}catch(e){console.log("Sound not available")}})(),fe.value=`  ${ce.studentName}  ${o.name} do better next time!`,je(` ${ce.studentName}.   ${o.name}.  you lost ${Math.abs(o.points)||0} points  `,.9,1.1)),ge.value=!0,pe.value=!1,me.value=null,ue("recorded"),setTimeout(()=>{ge.value=!1,setTimeout(()=>{ue("close")},500)},3e3)}catch(n){let o="Oops! Something went wrong.";if(409===(null==(e=n.response)?void 0:e.status))o="This was already recorded today!";else if(null==(t=null==(a=n.response)?void 0:a.data)?void 0:t.errors){o=Object.values(n.response.data.errors).flat().join(". ")}else(null==(i=null==(s=n.response)?void 0:s.data)?void 0:i.message)&&(o=n.response.data.message);de.notify({message:o,color:"negative",position:"top",timeout:3e3,actions:[{icon:"close",color:"white"}]}),je(o,.9,1)}};return(a,p)=>(f(),g("div",$,[h("div",A,[h("div",N,[b(t,{name:"face",size:"3rem",color:"primary"})]),h("div",x,[h("h2",z,T(e.studentName),1),h("p",Q,T(ke.value),1)]),b(i,{round:"",color:"primary",icon:"volume_up",onClick:Ve,class:"speak-btn",size:"lg"},{default:w(()=>[b(s,null,{default:w(()=>p[3]||(p[3]=[_("Say student name")])),_:1})]),_:1})]),b(u,{modelValue:ve.value,"onUpdate:modelValue":p[0]||(p[0]=e=>ve.value=e),class:"fun-tabs","indicator-color":"transparent","active-color":"white",align:"justify"},{default:w(()=>[b(c,{name:"positive",class:k(["positive-tab",{"active-positive":"positive"===ve.value}])},{default:w(()=>[h("div",G,[b(t,{name:"star",size:"2rem"}),p[4]||(p[4]=h("div",{class:"tab-label"},"Great Job!",-1)),p[5]||(p[5]=h("div",{class:"tab-emoji"},"â­",-1))])]),_:1},8,["class"]),b(c,{name:"negative",class:k(["negative-tab",{"active-negative":"negative"===ve.value}])},{default:w(()=>[h("div",L,[b(t,{name:"school",size:"2rem"}),p[6]||(p[6]=h("div",{class:"tab-label"},"Let's Practice",-1)),p[7]||(p[7]=h("div",{class:"tab-emoji"},"ðŸ“š",-1))])]),_:1},8,["class"])]),_:1},8,["modelValue"]),b(v,{modelValue:ve.value,"onUpdate:modelValue":p[1]||(p[1]=e=>ve.value=e),animated:"",class:"behavior-panels"},{default:w(()=>[b(d,{name:"positive",class:"positive-panel"},{default:w(()=>[h("div",Y,[p[8]||(p[8]=h("h3",null,"ðŸŒŸ Awesome Behaviors! ðŸŒŸ",-1)),h("p",null,"Click on what "+T(e.studentName)+" did great!",1)]),h("div",M,[(f(!0),g(j,null,V(Te.value,e=>(f(),S(n,{key:e.id,class:"behavior-card positive-card",onClick:a=>$e(e)},{default:w(()=>[b(o,{class:"card-content"},{default:w(()=>[h("div",P,T(Ce(e.name,"positive")),1),h("div",O,T(e.name),1),h("div",I," +"+T(e.points)+" points ",1),p[9]||(p[9]=h("div",{class:"sparkles"},"âœ¨",-1))]),_:2},1024)]),_:2},1032,["onClick"]))),128))])]),_:1}),b(d,{name:"negative",class:"negative-panel"},{default:w(()=>[p[11]||(p[11]=h("div",{class:"panel-header"},[h("h3",null,"ðŸ“š Let's Learn Together! ðŸ“š"),h("p",null,"We can practice and get better at these!")],-1)),h("div",J,[(f(!0),g(j,null,V(we.value,e=>(f(),S(n,{key:e.id,class:"behavior-card negative-card",onClick:a=>$e(e)},{default:w(()=>[b(o,{class:"card-content"},{default:w(()=>[h("div",U,T(Ce(e.name,"negative")),1),h("div",q,T(e.name),1),h("div",W,T(e.points)+" points ",1),p[10]||(p[10]=h("div",{class:"practice-text"},"Let's practice!",-1))]),_:2},1024)]),_:2},1032,["onClick"]))),128))])]),_:1})]),_:1},8,["modelValue"]),h("div",B,[h("div",K,[b(t,{name:"star",size:"2rem",color:"positive"}),h("div",R,"+"+T(ye.value.positive),1),p[12]||(p[12]=h("div",{class:"score-label"},"Great Jobs!",-1))]),h("div",F,[b(t,{name:"emoji_events",size:"2rem",color:"primary"}),h("div",D,T(ye.value.total),1),p[13]||(p[13]=h("div",{class:"score-label"},"Total Points",-1))]),h("div",E,[b(t,{name:"school",size:"2rem",color:"orange"}),h("div",H,T(Math.abs(ye.value.negative)),1),p[14]||(p[14]=h("div",{class:"score-label"},"Practice More",-1))])]),b(r,{modelValue:pe.value,"onUpdate:modelValue":p[2]||(p[2]=e=>pe.value=e),persistent:""},{default:w(()=>[b(n,{class:"confirm-dialog"},{default:w(()=>[b(o,{class:"dialog-header"},{default:w(()=>{var e,a;return[h("div",X,T("positive"===(null==(e=me.value)?void 0:e.type)?"ðŸŒŸ":"ðŸ“š"),1),h("h3",Z,T("positive"===(null==(a=me.value)?void 0:a.type)?"Great Job!":"Let's Practice!"),1)]}),_:1}),b(o,{class:"dialog-content"},{default:w(()=>{var a,t,s,i;return[h("div",ee,[h("p",ae,T(e.studentName),1),h("p",te,T("positive"===(null==(a=me.value)?void 0:a.type)?"did a great job with:":"needs to practice:"),1),h("p",se,T(null==(t=me.value)?void 0:t.name),1),h("p",ie,[_(" This will "+T("positive"===(null==(s=me.value)?void 0:s.type)?"add":"subtract")+" ",1),h("strong",null,T(Math.abs((null==(i=me.value)?void 0:i.points)||0))+" points",1)])])]}),_:1}),b(l,{class:"dialog-actions"},{default:w(()=>{var e,a;return[b(i,{flat:"",label:"Cancel",color:"grey",onClick:Ae,class:"cancel-btn",size:"lg"}),b(i,{color:"positive"===(null==(e=me.value)?void 0:e.type)?"positive":"orange",label:"positive"===(null==(a=me.value)?void 0:a.type)?"Yes, Great Job!":"Yes, Let's Practice!",onClick:Ne,class:"confirm-btn",size:"lg"},null,8,["color","label"])]}),_:1})]),_:1})]),_:1},8,["modelValue"]),ge.value?(f(),g("div",oe,[h("div",ne,[p[15]||(p[15]=h("div",{class:"success-icon"},"ðŸŽ‰",-1)),h("div",le,T(fe.value),1)])])):y("",!0),h("audio",{ref_key:"positiveSound",ref:he,preload:"auto"},p[16]||(p[16]=[h("source",{src:"/sounds/positive-chime.mp3",type:"audio/mpeg"},null,-1),h("source",{src:"/sounds/positive-chime.wav",type:"audio/wav"},null,-1)]),512),h("audio",{ref_key:"negativeSound",ref:be,preload:"auto"},p[17]||(p[17]=[h("source",{src:"/sounds/gentle-reminder.mp3",type:"audio/mpeg"},null,-1),h("source",{src:"/sounds/gentle-reminder.wav",type:"audio/wav"},null,-1)]),512)]))}},[["__scopeId","data-v-9b952bdc"]]);export{re as default};
