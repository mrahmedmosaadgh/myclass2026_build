import{Q as e}from"./QSpinnerDots-BItRr4QS.js";import{r as t,Q as s,g as l}from"./app-CCwy2VVq.js";import a from"./timeline-C6_WLMiN.js";import{f as r,k as o,a as i,r as n,N as u,J as d,O as m,R as c,V as p,y as f,ac as b,b as v,K as g,W as y,F as x,Q as j,S as h}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./QInnerLoading-BkSxTGQJ.js";import"./QBadge-BmqcVL7P.js";import"./QTab-Bsf5uinQ.js";import"./QTabs-Ddh79dFw.js";import"./rtl-Cr6c3OOr.js";import"./CurrentEventCard-DoDD2wWa.js";import"./UpcomingEventsCard-BlTeEef6.js";import"./PeriodActivityDrawer-irbr6GaX.js";import"./QSelect-DZElG_R-.js";import"./StudentRecordsGrid-DzUvK5ew.js";import"./QTabPanel-D3EMF9t6.js";import"./use-panel-Bv0wrwFr.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-C7WMGDee.js";import"./purify.es-C2Ba6vpb.js";import"./katex-BXKQVcz-.js";const w={class:"p-6"},k={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Q={class:"bg-white rounded-lg p-6 w-full max-w-md"},T={class:"text-lg font-semibold mb-4"},C={class:"space-y-4"},D={class:"flex gap-4"},_={class:"flex-1"},A={class:"flex-1"},E=["min"],S={class:"mt-6 flex justify-end gap-3"},U={class:"timeline-wrapper"},V={class:"timeline-container"},I={key:0,class:"flex justify-center items-center h-64"},L={key:1,class:"flex justify-center items-center h-64"},P={key:2,class:"schedule-grid"},$={class:"p-2"},z={class:"font-bold"},B={class:"text-sm"},N={class:"text-xs text-gray-500"},R=t({__name:"timeline_main",props:{title:{type:String,default:""},events:{type:Array,default:()=>[]},schedule:{type:Array,default:()=>[]},timings:{type:Object,default:null},loading:{type:Boolean,default:!1}},emits:["update:events"],setup(t,{emit:R}){const q=t,F=R,O=e=>{const t=new Date,[s,l]=e.split(":");return t.setHours(parseInt(s),parseInt(l),0,0),t},G=r([...q.events]);o(()=>q.events,e=>{G.value=[...e]},{deep:!0});const H=i(()=>{const e=[...G.value].sort((e,t)=>O(e.from)-O(t.from));return e.map(t=>{const s=O(t.from),l=O(t.to),a=e.filter(e=>{if(e.id===t.id)return!1;const a=O(e.from),r=O(e.to);return s<r&&l>a}),r=a.length>0?a.length:0,o=Math.max(r+1,1);return{...t,column:r,totalColumns:o,startTime:s,endTime:l}})}),J=r(!1),K=r(null),M=n({title:"",description:"",from:"",to:""}),W=()=>{J.value=!1,K.value=null,M.title="",M.description="",M.from="",M.to=""},X=()=>{if(!M.title.trim()||!M.from||!M.to)return void alert("Please fill in all required fields");if(M.from>=M.to)return void alert("End time must be after start time");const e=O(M.from),t=O(M.to),s=G.value.find(s=>{var l;if((null==(l=K.value)?void 0:l.id)===s.id)return!1;const a=O(s.from),r=O(s.to);return e<r&&t>a});if(s&&!confirm(`There is already an event "${s.title}" from ${s.from} to ${s.to}. Do you want to schedule anyway?`))return;const l={title:M.title,description:M.description,from:M.from,to:M.to};let a;a=K.value?G.value.map(e=>e.id===K.value.id?{...e,...l}:e):[...G.value,{id:Date.now(),...l}],G.value=a,F("update:events",a),W()},Y=e=>new Date(`2000-01-01T${e}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(r,o)=>(d(),u("div",w,[J.value?(d(),u("div",k,[c("div",Q,[c("h3",T,p(K.value?"Edit Event":"Add New Event"),1),c("div",C,[c("div",null,[o[4]||(o[4]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Title",-1)),f(c("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>M.title=e),type:"text",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,M.title]])]),c("div",null,[o[5]||(o[5]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),f(c("textarea",{"onUpdate:modelValue":o[1]||(o[1]=e=>M.description=e),class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,M.description]])]),c("div",D,[c("div",_,[o[6]||(o[6]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"From",-1)),f(c("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>M.from=e),type:"time",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,M.from]])]),c("div",A,[o[7]||(o[7]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To",-1)),f(c("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>M.to=e),type:"time",min:M.from,class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,E),[[b,M.to]])])])]),c("div",S,[c("button",{onClick:W,class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancel "),c("button",{onClick:X,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"},p(K.value?"Update":"Add"),1)])])])):m("",!0),c("div",U,[v(a,{events:H.value},null,8,["events"])]),c("div",V,[t.loading?(d(),u("div",I,[v(e,{color:"primary",size:"40px",class:"q-mr-xs"}),o[8]||(o[8]=c("span",{class:"text-primary text-subtitle1"},"Loading schedule...",-1))])):t.schedule.length?(d(),u("div",P,[(d(!0),u(x,null,j(t.schedule,(e,t)=>(d(),u("div",{key:t,class:"schedule-item",style:h({backgroundColor:"#f3f4f6",borderLeft:"4px solid #3b82f6"})},[c("div",$,[c("h3",z,p(e.subject),1),c("p",B,p(e.classroom),1),c("p",N,p(Y(e.start_time))+" - "+p(Y(e.end_time)),1)])],4))),128))])):(d(),u("div",L,[v(l,{class:"bg-grey-3"},{avatar:g(()=>[v(s,{name:"schedule",color:"primary"})]),default:g(()=>[o[9]||(o[9]=y(" No schedule available for today "))]),_:1})]))])]))}},[["__scopeId","data-v-83951720"]]);export{R as default};
