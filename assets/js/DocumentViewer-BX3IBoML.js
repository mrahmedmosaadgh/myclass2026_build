import{p as e,u as l,d as n,e as t,D as o,Q as a,h as c,k as i,i as r,j as s,n as d,b as u}from"./app-DXXarK7I.js";import{Q as m}from"./QSpace-B3qNlK-o.js";import{Q as v}from"./QSpinnerDots-iSvAMlO9.js";import{Q as p}from"./QDrawer-CmhfkAoQ.js";import{f as y,a as g,k as h,Z as f,H as k,I as b,J as w,b as L,O as x,M as H,U as M,V as T,L as $,F as _,Q as q,S as C}from"./vendor-EI0FRBVb.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";const V={class:"col"},j={class:"row items-center"},Q={class:"text-h5 text-weight-bold"},z={class:"text-subtitle2 text-grey-7"},E={key:0},S={class:"col-auto"},I={key:0,class:"text-center q-py-xl"},A={key:1,class:"text-center q-py-xl"},D={class:"text-body2 text-grey-7 q-mt-sm"},F={key:2,class:"content-display"},O={key:0,class:"rendered-content"},U=["innerHTML"],B={key:1,class:"database-content"},J={key:0,class:"rich-content"},R=["innerHTML"],Z=["innerHTML"],N=["innerHTML"],P=["innerHTML"],G={key:4,class:"code-block"},K=["innerHTML"],W={key:5},X=["innerHTML"],Y=["innerHTML"],ee=["innerHTML"],le={key:1,class:"source-content"},ne={class:"source-code"},te=e({__name:"DocumentViewer",props:{modelValue:Boolean,document:Object},emits:["update:modelValue","close"],setup(e,{emit:te}){const oe=l(),ae=e,ce=y(!1),ie=y(null),re=y("rendered"),se=y(!1),de=y(""),ue=y(""),me=y([]),ve=g(()=>{var e,l;return"file"===(null==(e=ae.document)?void 0:e.source)?de.value:(null==(l=ae.document)?void 0:l.content)?"string"==typeof ae.document.content?ae.document.content:JSON.stringify(ae.document.content,null,2):""});h(()=>ae.document,e=>{e&&ae.modelValue&&pe()},{immediate:!0}),h(()=>ae.modelValue,e=>{e&&ae.document&&pe()});const pe=async()=>{var e,l;if(ae.document){ce.value=!0,ie.value=null;try{if("file"===ae.document.source){const e=await f.get("/admin/documentation-portal/file-content",{params:{path:ae.document.path}});de.value=e.data.content,ue.value=await ye(e.data.content),ge(e.data.content)}else de.value=ve.value,Array.isArray(ae.document.content)&&he(ae.document.content)}catch(n){ie.value=(null==(l=null==(e=n.response)?void 0:e.data)?void 0:l.error)||"Failed to load content"}finally{ce.value=!1}}},ye=async e=>e.replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/\*(.+?)\*/g,"<em>$1</em>").replace(/`(.+?)`/g,"<code>$1</code>").replace(/```([\s\S]*?)```/g,"<pre><code>$1</code></pre>").replace(/\n/g,"<br>"),ge=e=>{const l=e.match(/^#{1,6}\s+.+$/gm)||[];me.value=l.map((e,l)=>({id:`heading-${l}`,level:e.match(/^#+/)[0].length,text:e.replace(/^#+\s+/,"")}))},he=e=>{me.value=e.filter(e=>["heading1","heading2","heading3"].includes(e.type)).map((e,l)=>({id:`heading-${l}`,level:parseInt(e.type.replace("heading","")),text:e.content.replace(/<[^>]*>/g,"")}))},fe=()=>{var e,l;return{code:"code",tutorial:"school",guide:"map",api:"api",reference:"book",note:"note",research:"science",question:"help",comment:"comment",idea:"lightbulb"}[null==(l=null==(e=ae.document)?void 0:e.type)?void 0:l.toLowerCase()]||"description"},ke=()=>{var e,l;return{code:"green",tutorial:"blue",guide:"purple",api:"red",reference:"indigo",note:"yellow",research:"teal",question:"pink",comment:"cyan",idea:"amber"}[null==(l=null==(e=ae.document)?void 0:e.type)?void 0:l.toLowerCase()]||"primary"},be=()=>{window.print()},we=()=>{oe.notify({type:"info",message:"Export functionality coming soon",position:"top"})},Le=()=>{var e;"database"===(null==(e=ae.document)?void 0:e.source)&&window.open(`/admin/documentation/${ae.document.id}/edit`,"_blank")},xe=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};return(l,y)=>(b(),k(u,{"model-value":e.modelValue,"onUpdate:modelValue":y[5]||(y[5]=e=>l.$emit("update:modelValue",e)),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:w(()=>[L(d,{class:"document-viewer"},{default:w(()=>[L(n,{class:"viewer-header row items-center"},{default:w(()=>{var n,c,i,r;return[H("div",V,[H("div",j,[L(t,{name:fe(),color:ke(),size:"2rem",class:"q-mr-md"},null,8,["name","color"]),H("div",null,[H("div",Q,M(null==(n=e.document)?void 0:n.title),1),H("div",z,[T(M(null==(c=e.document)?void 0:c.category)+" • "+M(null==(i=e.document)?void 0:i.source)+" ",1),(null==(r=e.document)?void 0:r.author)?(b(),$("span",E," • by "+M(e.document.author.name),1)):x("",!0)])])])]),H("div",S,[L(o,{outline:""},{default:w(()=>[L(a,{color:"rendered"===re.value?"primary":"grey",icon:"visibility",label:"Rendered",onClick:y[0]||(y[0]=e=>re.value="rendered"),disable:ce.value},null,8,["color","disable"]),L(a,{color:"source"===re.value?"primary":"grey",icon:"code",label:"Source",onClick:y[1]||(y[1]=e=>re.value="source"),disable:ce.value},null,8,["color","disable"])]),_:1}),L(a,{flat:"",round:"",icon:"close",onClick:y[2]||(y[2]=e=>l.$emit("close")),class:"q-ml-md"})])]}),_:1}),L(n,{class:"viewer-toolbar row items-center q-py-sm"},{default:w(()=>{var l;return[L(a,{flat:"",icon:"print",label:"Print",onClick:be,size:"sm",class:"q-mr-sm"}),L(a,{flat:"",icon:"download",label:"Export",onClick:we,size:"sm",class:"q-mr-sm"}),"database"===(null==(l=e.document)?void 0:l.source)?(b(),k(a,{key:0,flat:"",icon:"edit",label:"Edit",onClick:Le,size:"sm",class:"q-mr-sm"})):x("",!0),L(m),L(a,{flat:"",icon:"fullscreen",onClick:xe,size:"sm"})]}),_:1}),L(n,{class:"viewer-content"},{default:w(()=>{var l,n,o;return[ce.value?(b(),$("div",I,[L(v,{size:"3rem",color:"primary"}),y[6]||(y[6]=H("div",{class:"text-subtitle1 q-mt-md"},"Loading content...",-1))])):ie.value?(b(),$("div",A,[L(t,{name:"error",size:"3rem",color:"negative"}),y[7]||(y[7]=H("div",{class:"text-h6 text-negative q-mt-md"},"Error loading content",-1)),H("div",D,M(ie.value),1),L(a,{color:"primary",icon:"refresh",label:"Retry",onClick:pe,class:"q-mt-md"})])):(b(),$("div",F,["rendered"===re.value?(b(),$("div",O,["file"===(null==(l=e.document)?void 0:l.source)?(b(),$("div",{key:0,class:"markdown-content",innerHTML:ue.value},null,8,U)):(b(),$("div",B,[Array.isArray(null==(n=e.document)?void 0:n.content)?(b(),$("div",J,[(b(!0),$(_,null,q(e.document.content,(e,l)=>(b(),$("div",{key:l,class:"content-block q-mb-md"},["paragraph"===e.type?(b(),$("div",{key:0,innerHTML:e.content},null,8,R)):"heading1"===e.type?(b(),$("h1",{key:1,innerHTML:e.content},null,8,Z)):"heading2"===e.type?(b(),$("h2",{key:2,innerHTML:e.content},null,8,N)):"heading3"===e.type?(b(),$("h3",{key:3,innerHTML:e.content},null,8,P)):"code"===e.type?(b(),$("pre",G,[H("code",{innerHTML:e.content},null,8,K)])):"list"===e.type?(b(),$("ul",W,[(b(!0),$(_,null,q(e.items,(e,l)=>(b(),$("li",{key:l,innerHTML:e},null,8,X))),128))])):(b(),$("div",{key:6,innerHTML:e.content},null,8,Y))]))),128))])):(b(),$("div",{key:1,class:"simple-content",innerHTML:null==(o=e.document)?void 0:o.content},null,8,ee))]))])):(b(),$("div",le,[H("pre",ne,[H("code",null,M(ve.value),1)])]))]))]}),_:1}),me.value.length>0?(b(),k(p,{key:0,modelValue:se.value,"onUpdate:modelValue":y[3]||(y[3]=e=>se.value=e),side:"right",overlay:"",bordered:"",width:300,class:"toc-drawer"},{default:w(()=>[L(c,null,{default:w(()=>[L(i,{header:""},{default:w(()=>y[8]||(y[8]=[T("Table of Contents")])),_:1}),(b(!0),$(_,null,q(me.value,(e,l)=>(b(),k(r,{key:l,clickable:"",onClick:l=>(e=>{const l=document.getElementById(e);l&&l.scrollIntoView({behavior:"smooth"})})(e.id),class:C(`toc-level-${e.level}`)},{default:w(()=>[L(s,null,{default:w(()=>[L(i,null,{default:w(()=>[T(M(e.text),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1},8,["modelValue"])):x("",!0),me.value.length>0?(b(),k(a,{key:1,fab:"",icon:"list",color:"primary",onClick:y[4]||(y[4]=e=>se.value=!se.value),class:"toc-toggle"})):x("",!0)]),_:1})]),_:1},8,["model-value"]))}},[["__scopeId","data-v-ec111f36"]]);export{te as default};
