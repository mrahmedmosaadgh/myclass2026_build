import{Q as e}from"./QLinearProgress-L5RdawR6.js";import{p as s,e as t,d as a,Q as r,n as l}from"./app-BzjXrVp9.js";import{Q as o}from"./QBadge-D2ciqrkO.js";import{f as c,a as i,o as n,L as d,I as u,M as p,O as g,U as v,b as m,F as _,Q as y,J as k,S as b,$ as q,V as x,Z as f,_ as h}from"./vendor-EI0FRBVb.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";const z={class:"student-lesson-list q-pa-md"},w={class:"row items-center q-mb-lg"},L={class:"col"},j={class:"text-grey-7 q-mb-none"},I={class:"col-auto"},Q={class:"progress-card"},P={class:"text-h6"},C={class:"row q-col-gutter-md"},S={key:0,class:"lock-overlay"},N={class:"row items-center q-mb-sm"},F={class:"col"},M={class:"text-overline text-grey-7"},R={class:"col-auto"},T={class:"text-h6 q-mb-sm"},W={class:"text-caption text-grey-7 line-clamp-2"},B={class:"progress-indicators q-mt-md"},O={class:"row q-gutter-xs"},A={class:"col"},E={class:"col"},G={class:"col"},J={class:"q-mt-md"},U={key:0,class:"q-mt-sm"},V={key:0,class:"text-caption text-grey-7"},Y={key:1,class:"text-caption text-grey-7"},Z={key:0},$={key:0,class:"text-center q-pa-xl"},D=s({__name:"StudentLessonList",props:{studentId:{type:Number,required:!0},gradeId:{type:Number,required:!0},subjectId:{type:Number,required:!0}},setup(s){const D=s,H=c([]),K=c(null),X=c(null),ee=c(!1),se=i(()=>{const e=H.value.filter(e=>{var s;return null==(s=e.progress)?void 0:s.opened_at});if(0===e.length)return 0;const s=e.filter(e=>{var s,t;return"completed"===(null==(s=e.progress)?void 0:s.status)||(null==(t=e.progress)?void 0:t.force_passed)});return Math.round(s.length/e.length*100)}),te={gray:"card-gray",light_blue:"card-light-blue",blue:"card-blue",purple:"card-purple",green:"card-green",yellow:"card-yellow",dark_yellow:"card-dark-yellow",orange:"card-orange",red:"card-red"},ae=e=>{var s;return te[null==(s=e.progress)?void 0:s.color_status]||"card-gray"},re=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return t&&"locked"!==t?"opened"===t?"Ready":"learning"===t?"In Progress":"practice_pending"===t?"Practice":"practice_submitted"===t?"Waiting":"quiz_unlocked"===t?"Quiz Ready":"completed"===t?"Completed":"failed"===t?"Failed":t:"Locked"},le=e=>{var s;const t=null==(s=e.progress)?void 0:s.color_status;return"green"===t?"positive":"yellow"===t||"dark_yellow"===t?"warning":"red"===t?"negative":"purple"===t?"purple":"blue"===t||"light_blue"===t?"info":"grey"},oe=(e,s)=>{const t=e.progress;return t?"learn"===s?t.learn_completed_at?"stage-completed":"learning"===t.status||"opened"===t.status?"stage-active":"stage-locked":"practice"===s?null!==t.practice_score?"stage-completed":"practice_pending"===t.status||"practice_submitted"===t.status?"stage-active":t.learn_completed_at?"stage-available":"stage-locked":"quiz"===s?t.quiz_passed?"stage-completed":"quiz_unlocked"===t.status?"stage-active":t.practice_score>=6?"stage-available":"stage-locked":"stage-locked":"stage-locked"},ce=e=>{var s;return"locked"!==(null==(s=e.progress)?void 0:s.status)},ie=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return t&&"locked"!==t?"opened"===t?"Start Learning":"learning"===t?"Continue Learning":"practice_pending"===t?"Submit Practice":"practice_submitted"===t?"Waiting for Teacher":"quiz_unlocked"===t?"Take Quiz":"completed"===t?"Review":"failed"===t?"Contact Teacher":"Open":"Locked"},ne=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return"completed"===t?"positive":"failed"===t?"negative":"practice_submitted"===t?"grey":"primary"},de=e=>{var s;const t=null==(s=e.progress)?void 0:s.status;return t&&"locked"!==t?"opened"===t||"learning"===t?"play_arrow":"practice_pending"===t?"edit_note":"practice_submitted"===t?"hourglass_empty":"quiz_unlocked"===t?"quiz":"completed"===t?"check_circle":"failed"===t?"error":"arrow_forward":"lock"},ue=e=>{ce(e)&&h.visit(route("lesson-presentation.student.view",{id:e.id}))};return n(()=>{(async()=>{ee.value=!0;try{const e=await f.get(route("lesson-presentation.progress.student",{studentId:D.studentId})),s={};e.data.forEach(e=>{s[e.lesson_presentation_id]=e});const t=await f.get(route("lesson-presentation.list"),{params:{grade_id:D.gradeId,subject_id:D.subjectId}});H.value=t.data.map(e=>({...e,progress:s[e.id]||{status:"locked",color_status:"gray"}})).sort((e,s)=>(e.order||0)-(s.order||0))}catch(e){console.error("Failed to fetch lessons:",e)}finally{ee.value=!1}})()}),(s,c)=>{var i,n;return u(),d("div",z,[p("div",w,[p("div",L,[c[0]||(c[0]=p("h4",{class:"text-h4 q-my-none"},"My Lessons",-1)),p("p",j,v(null==(i=K.value)?void 0:i.name)+" - Grade "+v(null==(n=X.value)?void 0:n.name),1)]),p("div",I,[p("div",Q,[p("div",P,v(se.value)+"%",1),c[1]||(c[1]=p("div",{class:"text-caption text-grey-7"},"Progress",-1)),m(e,{value:se.value/100,color:"primary",class:"q-mt-sm"},null,8,["value"])])])]),p("div",C,[(u(!0),d(_,null,y(H.value,(e,s)=>(u(),d("div",{key:e.id,class:"col-12 col-sm-6 col-md-4"},[m(l,{class:b([ae(e),"lesson-card cursor-pointer"]),onClick:s=>(e=>{ce(e)&&ue(e)})(e)},{default:k(()=>{var l;return["locked"===(null==(l=e.progress)?void 0:l.status)?(u(),d("div",S,[m(t,{name:"lock",size:"48px",color:"grey-5"}),c[2]||(c[2]=p("div",{class:"text-caption text-grey-6 q-mt-sm"},"Waiting for teacher",-1))])):g("",!0),m(a,null,{default:k(()=>[p("div",N,[p("div",F,[p("div",M,"Lesson "+v(e.order||s+1),1)]),p("div",R,[m(o,{color:le(e),label:re(e)},null,8,["color","label"])])]),p("div",T,v(e.name),1),p("div",W,v(e.description),1),p("div",B,[p("div",O,[p("div",A,[p("div",{class:b(["stage-indicator",oe(e,"learn")])},[m(t,{name:"school",size:"sm"}),c[3]||(c[3]=p("div",{class:"text-caption"},"Learn",-1))],2)]),p("div",E,[p("div",{class:b(["stage-indicator",oe(e,"practice")])},[m(t,{name:"edit_note",size:"sm"}),c[4]||(c[4]=p("div",{class:"text-caption"},"Practice",-1))],2)]),p("div",G,[p("div",{class:b(["stage-indicator",oe(e,"quiz")])},[m(t,{name:"quiz",size:"sm"}),c[5]||(c[5]=p("div",{class:"text-caption"},"Quiz",-1))],2)])])]),p("div",J,[m(r,{label:ie(e),color:ne(e),icon:de(e),disable:!ce(e),unelevated:"","no-caps":"",class:"full-width",onClick:q(s=>ue(e),["stop"])},null,8,["label","color","icon","disable","onClick"])]),e.progress?(u(),d("div",U,[null!==e.progress.practice_score?(u(),d("div",V," Practice Score: "+v(e.progress.practice_score)+"/10 ",1)):g("",!0),e.progress.quiz_attempts>0?(u(),d("div",Y,[x(" Quiz Attempts: "+v(e.progress.quiz_attempts)+" ",1),null!==e.progress.quiz_best_score?(u(),d("span",Z," (Best: "+v(e.progress.quiz_best_score)+"%) ",1)):g("",!0)])):g("",!0)])):g("",!0)]),_:2},1024)]}),_:2},1032,["class","onClick"])]))),128))]),0===H.value.length?(u(),d("div",$,[m(t,{name:"school",size:"64px",color:"grey-5"}),c[6]||(c[6]=p("div",{class:"text-h6 text-grey-7 q-mt-md"},"No lessons available yet",-1)),c[7]||(c[7]=p("div",{class:"text-caption text-grey-6"},"Your teacher will open lessons for you soon",-1))])):g("",!0)])}}},[["__scopeId","data-v-1a72d99c"]]);export{D as default};
