import{Q as e}from"./QSelect-CnZtzPIC.js";import{p as l,u as a,o as s,e as t,g as o,Q as r,D as i,n as u,d,aD as n,m as c,b as m}from"./app-BXm70mdJ.js";import{Q as v}from"./QSpace-Bu8V-QDa.js";import{Q as p}from"./QTd-BIxMTYzb.js";import{Q as f}from"./QTable-rnEofRem.js";import{f as b,a as y,k as g,o as w,L as h,I as k,M as V,b as x,J as q,S as _,H as j,U as S,O as Q,R as U,x as C,F as P,Q as N,a1 as z,aO as A}from"./vendor-DNM7Y6Xn.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";import"./QMarkupTable-Dmg3C5Wm.js";import"./QLinearProgress-Cix0cchl.js";import"./use-fullscreen-FlxrEg_V.js";const I={class:"q-pa-md"},L={class:"row q-col-gutter-md q-mb-md items-center"},M={class:"col-12 col-sm-3"},B={class:"col-12 col-sm-3"},D={class:"col-12 col-sm-3"},F={class:"col-12 col-sm-3"},O={class:"row full-width q-pb-md items-center"},$={class:"text-h6"},E={key:1,class:"cell-content"},R={class:"row q-col-gutter-md"},T={class:"text-grey-7"},H={class:"text-grey-7"},K=l({__name:"1",props:{rows:{type:Array,required:!0,default:()=>[]},columns:{type:Array,required:!0,default:()=>[]},title:{type:String,default:"Array Editor"}},emits:["update:rows"],setup(l,{emit:K}){const J=a(),W=l,G=K,X=[{label:"Small",value:"12px"},{label:"Medium",value:"14px"},{label:"Large",value:"16px"},{label:"Extra Large",value:"18px"}],Y=[{label:"Compact",value:"compact"},{label:"Comfortable",value:"comfortable"}],Z=b({fontSize:"14px",density:"comfortable"}),ee=b(""),le=y(()=>{if(!ee.value)return re.value;const e=ee.value.toLowerCase();return re.value.filter(l=>Object.values(l).some(l=>String(l).toLowerCase().includes(e)))}),ae=e=>{Z.value.fontSize=e},se=e=>{Z.value.density=e},te=e=>{ee.value=e},oe=b({sortBy:"name",descending:!1,page:1,rowsPerPage:10,rowsNumber:10}),re=b([...W.rows]),ie=b([...W.columns]),ue=b([]),de=b(!1),ne=b({}),ce=()=>{ne.value=ie.value.reduce((e,l)=>("id"!==l.field&&(e[l.field]=l.default||""),e),{})};ce(),y(()=>Object.values(ne.value).every(e=>""!==e)),g(()=>W.rows,e=>{re.value=[...e]},{deep:!0});const me=()=>{const e=ue.value.map(e=>e.id);re.value=re.value.filter(l=>!e.includes(l.id)),ue.value=[],G("update:rows",re.value)},ve=()=>{re.value=[...W.rows],ue.value=[],ee.value="",G("update:rows",re.value)},pe=b(!1),fe=b(!1),be=b([]),ye=b({}),ge=b({}),we=b(!1),he=async()=>{try{if((await Promise.all(ie.value.filter(e=>"id"!==e.field).map(e=>Ve(e.field)))).includes(!1))return void J.notify({progress:!0,type:"negative",actions:[{icon:"close",color:"white"}],message:"Please fill in all required fields correctly",position:"top-right"});fe.value=!0;const e={id:Date.now().toString(),...ne.value};re.value.push(e),G("update:rows",re.value),J.notify({type:"positive",message:"Item added successfully",position:"top-right"}),ke()}catch(e){console.error("Error adding item:",e),J.notify({type:"negative",message:"Failed to add item",position:"top-right"})}finally{fe.value=!1}},ke=()=>{pe.value=!1,ce(),ye.value={},ge.value={},we.value=!1},Ve=e=>{try{ge.value[e]=!0;const l=ne.value[e];if(ye.value[e]=null,!l||0===l.trim().length)return ye.value[e]=`${xe(e)} is required`,!1;const a=ie.value.find(l=>l.field===e);if(a&&l)switch(a.type){case"email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l))return ye.value[e]="Please enter a valid email",!1;break;case"number":if(isNaN(l))return ye.value[e]="Please enter a valid number",!1}return!0}catch(l){return console.error("Validation error:",l),!1}},xe=e=>{const l=ie.value.find(l=>l.field===e);return l?l.label:e};return w(()=>{ie.value=W.columns.map(e=>({...e,required:!1!==e.required,rules:[...e.rules||[],..."email"===e.type?[e=>!e||/^[^@]+@[^@]+\.[^@]+$/.test(e)||"Please enter a valid email"]:[],..."number"===e.type?[e=>!e||!isNaN(e)||"Please enter a valid number"]:[]]}))}),g(ne,()=>{try{(()=>{try{const e=ie.value.filter(e=>"id"!==e.field).map(e=>e.field);we.value=e.every(e=>{const l=ne.value[e];return l&&l.trim().length>0&&!ye.value[e]})}catch(e){console.error("Form validity update error:",e),we.value=!1}})()}catch(e){console.error("Watch error:",e)}},{deep:!0}),(a,b)=>(k(),h("div",I,[V("div",L,[V("div",M,[x(e,{modelValue:Z.value.fontSize,"onUpdate:modelValue":[b[0]||(b[0]=e=>Z.value.fontSize=e),ae],options:X,label:"Font Size",dense:"",outlined:"",class:"q-mr-sm"},null,8,["modelValue"])]),V("div",B,[x(e,{modelValue:Z.value.density,"onUpdate:modelValue":[b[1]||(b[1]=e=>Z.value.density=e),se],options:Y,label:"Row Height",dense:"",outlined:""},null,8,["modelValue"])]),V("div",D,[x(s,{modelValue:de.value,"onUpdate:modelValue":b[2]||(b[2]=e=>de.value=e),label:"Edit Mode",color:"primary",class:"q-ml-sm"},null,8,["modelValue"])]),V("div",F,[x(o,{modelValue:ee.value,"onUpdate:modelValue":[b[3]||(b[3]=e=>ee.value=e),te],dense:"",outlined:"",placeholder:"Search"},{append:q(()=>[x(t,{name:"search"})]),_:1},8,["modelValue"])])]),x(f,{rows:le.value,columns:ie.value,"row-key":"id",filter:ee.value,pagination:oe.value,class:"my-custom-table",style:U({"--table-font-size":Z.value.fontSize}),dense:"compact"===Z.value.density,flat:"",bordered:"",selection:"multiple",selected:ue.value,"onUpdate:selected":b[7]||(b[7]=e=>ue.value=e)},{top:q(()=>[V("div",O,[V("div",$,S(l.title),1),x(v),de.value?(k(),j(i,{key:0,flat:""},{default:q(()=>[x(r,{color:"primary",icon:"add",label:"Add New",onClick:b[4]||(b[4]=e=>pe.value=!0)}),x(r,{color:"negative",icon:"delete",label:"Delete Selected",onClick:me,disable:!ue.value.length},null,8,["disable"]),x(r,{color:"warning",icon:"refresh",label:"Reset",onClick:ve,flat:""})]),_:1})):Q("",!0)])]),"body-cell":q(e=>[x(p,{onDblclick:b[6]||(b[6]=e=>de.value=!0),props:e,class:_({"cursor-pointer":!de.value})},{default:q(()=>[e.col.editable&&de.value?(k(),j(o,{key:0,modelValue:e.row[e.col.field],"onUpdate:modelValue":[l=>e.row[e.col.field]=l,l=>(e=>{const l=re.value.findIndex(l=>l.id===e.id);-1!==l&&(re.value[l]={...e},G("update:rows",re.value))})(e.row)],dense:"",outlined:"",class:_("comfortable"===Z.value.density?"q-py-sm":""),onBlur:b[5]||(b[5]=e=>de.value=!1)},null,8,["modelValue","onUpdate:modelValue","class"])):(k(),h("div",E,S(e.row[e.col.field]),1))]),_:2},1032,["props","class"])]),_:1},8,["rows","columns","filter","pagination","style","dense","selected"]),x(m,{modelValue:pe.value,"onUpdate:modelValue":b[8]||(b[8]=e=>pe.value=e),persistent:""},{default:q(()=>[x(u,{style:{"min-width":"400px","max-width":"600px"}},{default:q(()=>[x(d,{class:"row items-center q-pb-none"},{default:q(()=>[b[9]||(b[9]=V("div",{class:"text-h6"},"Add New Item",-1)),x(v),C(x(r,{icon:"close",flat:"",round:"",dense:""},null,512),[[n]])]),_:1}),x(d,{class:"q-pt-md"},{default:q(()=>[V("div",R,[(k(!0),h(P,null,N(ie.value.filter(e=>"id"!==e.field),e=>(k(),h("div",{key:e.field,class:"col-12"},[x(o,{modelValue:ne.value[e.field],"onUpdate:modelValue":l=>ne.value[e.field]=l,label:e.label,hint:e.hint,outlined:"",dense:"",rules:[l=>!!l||`${e.label} is required`,l=>l.trim().length>0||`${e.label} cannot be empty`,...e.rules||[]],type:e.type||"text",mask:e.mask,"fill-mask":e.fillMask,"reverse-fill-mask":e.reverseFillMask,ref_for:!0,ref_key:"inputRefs",ref:be,onKeyup:z(he,["enter"]),onInput:l=>Ve(e.field),onBlur:l=>Ve(e.field),error:!!ye.value[e.field],"error-message":ye.value[e.field],"hide-bottom-space":""},A({_:2},[e.prefix?{name:"prepend",fn:q(()=>[V("div",T,S(e.prefix),1)]),key:"0"}:void 0,e.suffix?{name:"append",fn:q(()=>[V("div",H,S(e.suffix),1)]),key:"1"}:void 0]),1032,["modelValue","onUpdate:modelValue","label","hint","rules","type","mask","fill-mask","reverse-fill-mask","onInput","onBlur","error","error-message"])]))),128))])]),_:1}),x(c,{align:"right",class:"text-primary q-pa-md"},{default:q(()=>[x(r,{flat:"",label:"Cancel",color:"grey-7",onClick:ke,disable:fe.value},null,8,["disable"]),x(r,{loading:fe.value,label:"Add",color:"primary",onClick:he,disable:!we.value},null,8,["loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-3e971a94"]]);export{K as default};
