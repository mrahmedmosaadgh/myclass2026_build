import{E as e,ac as a,aE as o,aF as t,ba as l,H as s,e as n,b0 as r,aT as i,K as c,p as d,u,A as m,C as f,D as v,Q as p,q as _,aj as g,h as w,aD as y,i as b,j as h,d as x,n as k,b2 as q,a as A,b as C}from"./app-Dccx8xF5.js";import{f as S,a as V,p as L,E as j,h as z,o as I,H as M,I as $,J as H,b as B,M as D,V as U,U as E,x as Q,L as R,O as N,F,Q as K,y as O}from"./vendor-EI0FRBVb.js";import{Q as P}from"./QSpace-BWA-UIs7.js";import T from"./CommentsSection-uN6bf9GH.js";import J from"./VoicePlayer-JAj45uGM.js";import G from"./VoiceRecorderDialog-ChkZ3tyg.js";import W from"./TextToSpeechButton-DTfDGMCI.js";import{r as X}from"./resumeApi-BgW6JfPs.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./QBadge-BoQNzKR2.js";import"./QLinearProgress-BYmNETNA.js";import"./QSelect-aOnYle6d.js";import"./rtl-Cr6c3OOr.js";const Y=e({name:"QRating",props:{...o,...a,modelValue:{type:Number,required:!0},max:{type:[String,Number],default:5},icon:[String,Array],iconHalf:[String,Array],iconSelected:[String,Array],iconAriaLabel:[String,Array],color:[String,Array],colorHalf:[String,Array],colorSelected:[String,Array],noReset:Boolean,noDimming:Boolean,readonly:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{slots:a,emit:o}){const{proxy:{$q:d}}=L(),u=t(e),m=l(e),f=r(m),v=S(0);let p={};const _=V(()=>!0!==e.readonly&&!0!==e.disable),g=V(()=>`q-rating row inline items-center q-rating--${!0===_.value?"":"non-"}editable`+(!0===e.noDimming?" q-rating--no-dimming":"")+(!0===e.disable?" disabled":"")+(void 0!==e.color&&!1===Array.isArray(e.color)?` text-${e.color}`:"")),w=V(()=>{const a=!0===Array.isArray(e.icon)?e.icon.length:0,o=!0===Array.isArray(e.iconSelected)?e.iconSelected.length:0,t=!0===Array.isArray(e.iconHalf)?e.iconHalf.length:0,l=!0===Array.isArray(e.color)?e.color.length:0,s=!0===Array.isArray(e.colorSelected)?e.colorSelected.length:0,n=!0===Array.isArray(e.colorHalf)?e.colorHalf.length:0;return{iconLen:a,icon:a>0?e.icon[a-1]:e.icon,selIconLen:o,selIcon:o>0?e.iconSelected[o-1]:e.iconSelected,halfIconLen:t,halfIcon:t>0?e.iconHalf[o-1]:e.iconHalf,colorLen:l,color:l>0?e.color[l-1]:e.color,selColorLen:s,selColor:s>0?e.colorSelected[s-1]:e.colorSelected,halfColorLen:n,halfColor:n>0?e.colorHalf[n-1]:e.colorHalf}}),y=V(()=>{if("string"==typeof e.iconAriaLabel){const a=0!==e.iconAriaLabel.length?`${e.iconAriaLabel} `:"";return e=>`${a}${e}`}if(!0===Array.isArray(e.iconAriaLabel)){const a=e.iconAriaLabel.length;if(a>0)return o=>e.iconAriaLabel[Math.min(o,a)-1]}return(e,a)=>`${a} ${e}`}),b=V(()=>{const a=[],o=w.value,t=Math.ceil(e.modelValue),l=!0===_.value?0:null,s=void 0===e.iconHalf||t===e.modelValue?-1:t;for(let n=1;n<=e.max;n++){const r=0===v.value&&e.modelValue>=n||v.value>0&&v.value>=n,i=s===n&&v.value<n,c=v.value>0&&(!0===i?t:e.modelValue)>=n&&v.value<n,u=!0===i?n<=o.halfColorLen?e.colorHalf[n-1]:o.halfColor:void 0!==o.selColor&&!0===r?n<=o.selColorLen?e.colorSelected[n-1]:o.selColor:n<=o.colorLen?e.color[n-1]:o.color,m=(!0===i?n<=o.halfIconLen?e.iconHalf[n-1]:o.halfIcon:void 0===o.selIcon||!0!==r&&!0!==c?n<=o.iconLen?e.icon[n-1]:o.icon:n<=o.selIconLen?e.iconSelected[n-1]:o.selIcon)||d.iconSet.rating.icon;a.push({name:(!0===i?n<=o.halfIconLen?e.iconHalf[n-1]:o.halfIcon:void 0===o.selIcon||!0!==r&&!0!==c?n<=o.iconLen?e.icon[n-1]:o.icon:n<=o.selIconLen?e.iconSelected[n-1]:o.selIcon)||d.iconSet.rating.icon,attrs:{tabindex:l,role:"radio","aria-checked":e.modelValue===n?"true":"false","aria-label":y.value(n,m)},iconClass:"q-rating__icon"+(!0===r||!0===i?" q-rating__icon--active":"")+(!0===c?" q-rating__icon--exselected":"")+(v.value===n?" q-rating__icon--hovered":"")+(void 0!==u?` text-${u}`:"")})}return a}),h=V(()=>{const a={role:"radiogroup"};return!0===e.disable&&(a["aria-disabled"]="true"),!0===e.readonly&&(a["aria-readonly"]="true"),a});function x(a){if(!0===_.value){const t=i(parseInt(a,10),1,parseInt(e.max,10)),l=!0!==e.noReset&&e.modelValue===t?0:t;l!==e.modelValue&&o("update:modelValue",l),v.value=0}}function k(e){!0===_.value&&(v.value=e)}function q(){v.value=0}return j(()=>{p={}}),()=>{const o=[];return b.value.forEach(({iconClass:e,name:t,attrs:l},r)=>{const i=r+1;o.push(z("div",{key:i,ref:e=>{p[`rt${i}`]=e},class:"q-rating__icon-container flex flex-center",...l,onClick(){x(i)},onMouseover(){k(i)},onMouseout:q,onFocus(){k(i)},onBlur:q,onKeyup(e){!function(e,a){switch(e.keyCode){case 13:case 32:return x(a),c(e);case 37:case 40:return p["rt"+(a-1)]&&p["rt"+(a-1)].focus(),c(e);case 39:case 38:p[`rt${a+1}`]&&p[`rt${a+1}`].focus(),c(e)}}(e,i)}},s(a[`tip-${i}`],[z(n,{class:e,name:t})])))}),void 0!==e.name&&!0!==e.disable&&f(o,"push"),z("div",{class:g.value,style:u.value,...h.value},o)}}}),Z={class:"row items-center"},ee={class:"col"},ae={class:"row items-center q-gutter-sm"},oe={class:"text-subtitle2"},te={class:"text-caption text-grey-6"},le={class:"col-auto"},se={class:"answer-text q-mb-md"},ne={class:"row items-start q-gutter-sm"},re={class:"col text-body1"},ie={class:"col-auto"},ce={key:0,class:"q-mb-md"},de={class:"text-subtitle2 q-mb-sm"},ue={class:"row q-gutter-sm"},me={key:1,class:"q-mb-md"},fe={class:"text-subtitle2 q-mb-sm"},ve={class:"row q-gutter-sm"},pe={key:2,class:"q-mb-md"},_e={class:"text-subtitle2 q-mb-sm text-blue-8"},ge={key:3,class:"q-mb-md"},we={class:"text-caption"},ye={key:4,class:"q-mb-md"},be={class:"row items-center justify-between"},he={class:"col-auto"},xe={class:"row items-center q-gutter-sm"},ke={class:"text-caption text-grey-6"},qe={class:"col-auto"},Ae={class:"col-auto"},Ce={class:"column"},Se={class:"text-h6 text-primary"},Ve={class:"text-caption text-grey-6"},Le={class:"text-body2 text-blue-8"},je={class:"text-body2 text-grey-7 q-mt-xs"},ze=d({__name:"AnswerCard",props:{answer:{type:Object,required:!0},question:{type:Object,required:!0}},emits:["edit","delete","rate","comment","refresh"],setup(e,{emit:a}){const o=e,t=a,l=u(),s=S(0),r=S(!1),i=S(!1),c=S([]),d=S(!1),V=e=>{X.rateAnswer(o.answer.id,e).then(a=>{void 0!==o.answer.average_rating&&(o.answer.average_rating=a.average_rating),void 0!==o.answer.ratings_count&&(o.answer.ratings_count=a.ratings_count),t("rate",o.answer.id,e),l.notify({type:"positive",message:`Rated ${e} stars`,position:"top"})}).catch(e=>{console.error("Error submitting rating:",e),s.value=o.answer.user_rating||0,l.notify({type:"negative",message:"Failed to submit rating",position:"top"})})},L=()=>{X.toggleAnswerLike(o.answer.id).then(e=>{r.value=e.liked,void 0!==o.answer.likes_count&&(o.answer.likes_count=e.likes_count),l.notify({type:"positive",message:e.liked?"Liked!":"Unliked",position:"top"})}).catch(e=>{console.error("Error toggling like:",e),l.notify({type:"negative",message:"Failed to update like",position:"top"})})},j=()=>{i.value=!0,z()},z=()=>{console.log("Loading comments for answer:",o.answer.id),X.getComments(o.answer.id).then(e=>{c.value=e,console.log("Comments loaded:",e)}).catch(e=>{console.error("Error loading comments:",e),l.notify({type:"negative",message:"Failed to load comments",position:"top"})})},ze=()=>{z(),t("refresh")},Ie=()=>{d.value=!0},Me=e=>{console.log("Voice note recorded:",e),X.uploadVoiceNote(e,o.answer.id).then(a=>{console.log("Voice note uploaded successfully:",a),a.path&&(o.answer.voice_note_path=a.path,o.answer.voice_note_url=a.url,o.answer.voice_note_size=e.size),t("refresh"),l.notify({type:"positive",message:"Voice note saved successfully!",position:"top",icon:"mic"})}).catch(e=>{console.error("Error uploading voice note:",e),l.notify({type:"negative",message:"Failed to save voice note. Please try again.",position:"top",icon:"error"})})},$e=()=>{l.notify({type:"info",message:"Answer reported",position:"top"})},He=()=>{l.notify({type:"positive",message:"Share link copied to clipboard",position:"top"})},Be=e=>({draft:"edit",published:"check_circle",review:"schedule",archived:"archive"}[e]||"help"),De=e=>{if(!e)return"";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["Bytes","KB","MB","GB"][a]};return I(()=>{s.value=o.answer.user_rating||0,r.value=o.answer.user_liked||!1}),(a,o)=>($(),M(k,{class:"answer-card q-mb-lg shadow-3",bordered:""},{default:H(()=>[B(x,{class:"q-pb-none"},{default:H(()=>{var t,l,s;return[D("div",Z,[D("div",ee,[D("div",ae,[B(m,{size:"36px",color:"primary","text-color":"white"},{default:H(()=>{var a,o,t;return[U(E((null==(t=null==(o=null==(a=e.answer.user)?void 0:a.name)?void 0:o.charAt(0))?void 0:t.toUpperCase())||"U"),1)]}),_:1}),D("div",null,[D("div",oe,E((null==(t=e.answer.user)?void 0:t.name)||`User ${e.answer.user_id}`),1),D("div",te,E((s=e.answer.created_at,s?new Date(s).toLocaleDateString():"")),1)]),B(f,{color:(l=e.answer.status,{draft:"grey-6",published:"positive",review:"warning",archived:"negative"}[l]||"grey-6"),icon:Be(e.answer.status),label:e.answer.status||"draft",size:"sm",class:"q-ml-sm"},null,8,["color","icon","label"])])]),D("div",le,[B(v,{flat:""},{default:H(()=>[B(p,{icon:"edit",size:"sm",flat:"",color:"primary",onClick:o[0]||(o[0]=o=>a.$emit("edit",e.answer))},{default:H(()=>[B(_,null,{default:H(()=>o[7]||(o[7]=[U("Edit Answer")])),_:1})]),_:1}),B(p,{icon:"delete",size:"sm",flat:"",color:"negative",onClick:o[1]||(o[1]=o=>a.$emit("delete",e.answer.id))},{default:H(()=>[B(_,null,{default:H(()=>o[8]||(o[8]=[U("Delete Answer")])),_:1})]),_:1}),B(p,{icon:"more_vert",size:"sm",flat:"",color:"grey-7"},{default:H(()=>[B(_,null,{default:H(()=>o[9]||(o[9]=[U("More Options")])),_:1}),B(g,null,{default:H(()=>[B(w,{style:{"min-width":"150px"}},{default:H(()=>[Q(($(),M(b,{clickable:"",onClick:$e},{default:H(()=>[B(h,{avatar:""},{default:H(()=>[B(n,{name:"flag"})]),_:1}),B(h,null,{default:H(()=>o[10]||(o[10]=[U("Report")])),_:1})]),_:1})),[[y]]),Q(($(),M(b,{clickable:"",onClick:He},{default:H(()=>[B(h,{avatar:""},{default:H(()=>[B(n,{name:"share"})]),_:1}),B(h,null,{default:H(()=>o[11]||(o[11]=[U("Share")])),_:1})]),_:1})),[[y]])]),_:1})]),_:1})]),_:1})]),_:1})])])]}),_:1}),B(x,null,{default:H(()=>[D("div",se,[D("div",ne,[D("div",re,E(e.answer.answer_text),1),D("div",ie,[B(W,{text:e.answer.answer_text,size:"xs",round:"",dense:!1},null,8,["text"])])])]),e.answer.media_links&&e.answer.media_links.length>0?($(),R("div",ce,[D("div",de,[B(n,{name:"link",class:"q-mr-xs"}),o[12]||(o[12]=U(" Media Links "))]),D("div",ue,[($(!0),R(F,null,K(e.answer.media_links,(e,a)=>($(),M(f,{key:a,clickable:"",color:"blue-1","text-color":"blue-8",icon:"open_in_new",onClick:a=>{return o=e,void window.open(o,"_blank");var o}},{default:H(()=>{return[U(E((a=e,a?a.length>30?a.substring(0,30)+"...":a:"")),1)];var a}),_:2},1032,["onClick"]))),128))])])):N("",!0),e.answer.attachments&&e.answer.attachments.length>0?($(),R("div",me,[D("div",fe,[B(n,{name:"attach_file",class:"q-mr-xs"}),o[13]||(o[13]=U(" Attachments "))]),D("div",ve,[($(!0),R(F,null,K(e.answer.attachments,(e,a)=>{return $(),M(f,{key:a,clickable:"",color:"green-1","text-color":"green-8",icon:(o=e.type,(null==o?void 0:o.includes("image"))?"image":(null==o?void 0:o.includes("video"))?"videocam":(null==o?void 0:o.includes("audio"))?"audiotrack":(null==o?void 0:o.includes("pdf"))?"picture_as_pdf":"description"),onClick:a=>(e=>{console.log("Download file:",e)})(e)},{default:H(()=>[U(E(e.name)+" ",1),B(_,null,{default:H(()=>[U(E(De(e.size)),1)]),_:2},1024)]),_:2},1032,["icon","onClick"]);var o}),128))])])):N("",!0),e.answer.voice_note_path||e.answer.voice_note_url?($(),R("div",pe,[B(k,{flat:"",bordered:"",class:"bg-blue-1"},{default:H(()=>[B(x,{class:"q-pa-md"},{default:H(()=>[D("div",_e,[B(n,{name:"mic",class:"q-mr-xs"}),o[14]||(o[14]=U(" Voice Note ")),B(f,{size:"sm",color:"blue-3","text-color":"blue-8",class:"q-ml-sm"},{default:H(()=>{return[U(E((a=e.answer.voice_note_size,a?a<1024?a+" B":a<1048576?Math.round(a/1024)+" KB":Math.round(a/1048576)+" MB":"")),1)];var a}),_:1})]),B(J,{"audio-url":e.answer.voice_note_url||e.answer.voice_note_path},null,8,["audio-url"])]),_:1})]),_:1})])):N("",!0),O(l).dev?($(),R("div",ge,[B(q,{icon:"bug_report",label:"Debug: Voice Note Data","header-class":"text-caption text-grey-6"},{default:H(()=>[B(k,{flat:"",bordered:"",class:"bg-grey-1"},{default:H(()=>[B(x,{class:"q-pa-sm"},{default:H(()=>[D("pre",we,E(JSON.stringify({voice_note_path:e.answer.voice_note_path,voice_note_url:e.answer.voice_note_url,voice_note_size:e.answer.voice_note_size},null,2)),1)]),_:1})]),_:1})]),_:1})])):N("",!0),e.answer.notes?($(),R("div",ye,[B(q,{icon:"note",label:"Notes","header-class":"text-subtitle2"},{default:H(()=>[B(k,{flat:"",class:"bg-grey-1 q-pa-md"},{default:H(()=>[U(E(e.answer.notes),1)]),_:1})]),_:1})])):N("",!0)]),_:1}),B(x,{class:"q-pt-none"},{default:H(()=>[B(A,{class:"q-mb-md"}),D("div",be,[D("div",he,[D("div",xe,[o[15]||(o[15]=D("span",{class:"text-body2"},"Rate this answer:",-1)),B(Y,{modelValue:s.value,"onUpdate:modelValue":[o[2]||(o[2]=e=>s.value=e),V],size:"sm",color:"amber",icon:"star"},null,8,["modelValue"]),D("span",ke," ("+E(e.answer.average_rating||0)+"/5 from "+E(e.answer.ratings_count||0)+" votes) ",1)])]),D("div",qe,[B(v,{flat:""},{default:H(()=>[B(p,{icon:"thumb_up",size:"sm",flat:"",color:r.value?"positive":"grey-7",onClick:L},{default:H(()=>[U(E(e.answer.likes_count||0)+" ",1),B(_,null,{default:H(()=>[U(E(r.value?"Unlike":"Like"),1)]),_:1})]),_:1},8,["color"]),B(p,{icon:"comment",size:"sm",flat:"",color:"grey-7",onClick:j},{default:H(()=>[U(E(e.answer.comments_count||0)+" ",1),B(_,null,{default:H(()=>o[16]||(o[16]=[U("View Comments")])),_:1})]),_:1}),B(p,{icon:"mic",size:"sm",flat:"",color:"red-6",onClick:Ie},{default:H(()=>[B(_,null,{default:H(()=>o[17]||(o[17]=[U("Add Voice Note")])),_:1})]),_:1})]),_:1})]),D("div",Ae,[B(v,{flat:""},{default:H(()=>[B(p,{icon:"edit",size:"sm",flat:"",color:"blue-6",onClick:o[3]||(o[3]=a=>t("edit",e.answer))},{default:H(()=>[B(_,null,{default:H(()=>o[18]||(o[18]=[U("Edit Answer")])),_:1})]),_:1}),B(p,{icon:"delete",size:"sm",flat:"",color:"red-6",onClick:o[4]||(o[4]=a=>t("delete",e.answer))},{default:H(()=>[B(_,null,{default:H(()=>o[19]||(o[19]=[U("Delete Answer")])),_:1})]),_:1})]),_:1})])])]),_:1}),B(C,{modelValue:i.value,"onUpdate:modelValue":o[5]||(o[5]=e=>i.value=e),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:H(()=>[B(k,{class:"column bg-grey-1"},{default:H(()=>[B(x,{class:"row items-center q-pb-none bg-white shadow-1"},{default:H(()=>[D("div",Ce,[D("div",Se,[B(n,{name:"comment",class:"q-mr-sm"}),o[20]||(o[20]=U(" Comments "))]),D("div",Ve,E(e.answer.comments_count||0)+" comment"+E(1!==(e.answer.comments_count||0)?"s":""),1)]),B(P),Q(($(),M(p,{icon:"close",flat:"",round:"",dense:"",color:"grey-7"},{default:H(()=>[B(_,null,{default:H(()=>o[21]||(o[21]=[U("Close")])),_:1})]),_:1})),[[y]])]),_:1}),B(x,{class:"q-py-sm bg-blue-1 border-bottom"},{default:H(()=>{var a;return[D("div",Le,[B(n,{name:"help_outline",class:"q-mr-xs"}),o[22]||(o[22]=D("strong",null,"Question:",-1)),U(" "+E(e.question.question_text||e.question.title),1)]),D("div",je,[B(n,{name:"person",class:"q-mr-xs"}),o[23]||(o[23]=D("strong",null,"Answer by:",-1)),U(" "+E((null==(a=e.answer.user)?void 0:a.name)||"Unknown User"),1)])]}),_:1}),B(x,{class:"col q-pt-md bg-white",style:{"overflow-y":"auto"}},{default:H(()=>[B(T,{"answer-id":e.answer.id,comments:c.value,onCommentAdded:ze,onCommentUpdated:ze,onCommentDeleted:ze},null,8,["answer-id","comments"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),B(G,{modelValue:d.value,"onUpdate:modelValue":o[6]||(o[6]=e=>d.value=e),onVoiceRecorded:Me},null,8,["modelValue"])]),_:1}))}},[["__scopeId","data-v-7502de4b"]]);export{ze as default};
