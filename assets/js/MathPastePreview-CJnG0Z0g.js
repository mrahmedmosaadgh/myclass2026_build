import{p as e,e as l,aD as a,Q as s,a as r,o as t,g as o}from"./app-BXm70mdJ.js";import{Q as d}from"./QBadge-ZzhN1X9C.js";import{k as n}from"./katex-BXKQVcz-.js";import c from"./purify.es-C2Ba6vpb.js";import{f as u,a as i,o as m,L as p,I as b,M as v,b as x,x as g,V as f,ab as y,H as $,O as h,J as w}from"./vendor-DNM7Y6Xn.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";const V={class:"math-paste-preview flex flex-col h-full bg-gray-50 p-4 rounded-xl"},k={class:"flex justify-between items-center mb-4"},S={class:"flex items-center gap-2"},U={class:"flex gap-2"},T={class:"flex flex-1 gap-6 overflow-hidden min-h-0"},C={class:"w-64 relative flex flex-col max-h-full overflow-scroll gap-4 bg-white p-4 rounded-xl shadow-sm overflow-y-auto"},_={class:"flex flex-col gap-2"},j={class:"flex flex-col gap-2 bg-yellow-50 p-2 rounded-lg border border-yellow-100"},B={class:"mt-auto bg-blue-50 p-3 rounded-lg text-xs text-blue-800"},q={class:"flex-1 flex gap-4 min-h-0 h-[calc(100vh-200px)] overflow-scroll"},z={class:"flex-1 flex flex-col bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200 min-h-0"},M={class:"bg-gray-100 px-4 fixed top-0 z-50 py-2 border-b border-gray-200 flex justify-between items-center"},A={class:"flex-1 flex flex-col bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200 min-h-0"},E={class:"bg-gray-100 px-4 py-2 border-b border-gray-200 flex justify-between items-center"},F=["innerHTML"],H={class:"flex justify-end gap-3 mt-4 pt-2 border-t border-gray-200"},L=e({__name:"MathPastePreview",props:{initialText:{type:String,default:""}},emits:["insert"],setup(e,{emit:L}){const N=e,P=L,R=u(""),I=u(""),D=u(""),O=u({markdown:!0,extended:!0,lists:!0,tables:!0,separators:!0,newlines:!0,codeBlocks:!1,links:!1,math:!0,currency:!0,blanks:!0,quotes:!1,trimSpaces:!0,fixArabicNumbers:!1}),Q={markdown:!0,extended:!0,lists:!0,tables:!0,separators:!0,newlines:!0,codeBlocks:!1,links:!1,math:!0,currency:!0,blanks:!0,quotes:!1,trimSpaces:!0,fixArabicNumbers:!1},W=i(()=>Object.values(O.value).every(e=>e)),G=()=>{const e=!W.value;for(const l in O.value)O.value[l]=e},J=()=>{O.value={...Q},I.value="",D.value=""},K=async()=>{try{const e=await navigator.clipboard.readText();R.value=e}catch(e){console.log("Clipboard access denied or empty")}};m(()=>{N.initialText?R.value=N.initialText:K()});const X=i(()=>{const e=(e=>{let l=e;if(O.value.markdown&&(l=l.replace(/^####\s+(.*)$/gm,"<h4>$1</h4>"),l=l.replace(/^###\s+(.*)$/gm,"<h3>$1</h3>"),l=l.replace(/^##\s+(.*)$/gm,"<h2>$1</h2>"),l=l.replace(/^#\s+(.*)$/gm,"<h1>$1</h1>"),l=l.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>"),l=l.replace(/\*(.*?)\*/g,"<i>$1</i>")),O.value.extended&&(l=l.replace(/~~(.*?)~~/g,"<s>$1</s>"),l=l.replace(/==(.*?)==/g,"<mark>$1</mark>")),O.value.separators&&(l=l.replace(/^(\*\*\*|---)$/gm,'<hr class="my-4 border-t border-gray-300">')),O.value.blanks&&(l=l.replace(/_{3,}/g,'<u class="px-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u>')),O.value.lists&&(l=l.replace(/^>\s+(.*)$/gm,'<blockquote class="border-l-4 border-gray-300 pl-4 italic my-2">$1</blockquote>'),l=l.replace(/^(\s{4}|\t)\*\s+(.*)$/gm,'<div class="q-ml-md">&bull; $2</div>'),l=l.replace(/^\*\s+(.*)$/gm,"<div>&bull; $1</div>"),l=l.replace(/^(\d+\.)\s+(.*)$/gm,"<div><b>$1</b> $2</div>")),O.value.tables){const e=/((?:^\|.*\|\r?\n?)+)/gm;l=l.replace(e,e=>{const l=e.trim().split("\n");let a='<table class="w-full border-collapse border border-gray-300 my-4">';return l.forEach((e,l)=>{if(e.includes("---"))return;const s=e.split("|").filter(e=>""!==e.trim());a+="<tr>",s.forEach(e=>{const s=0===l?"th":"td";a+=`<${s} class="border border-gray-300 p-2 ${0===l?"bg-gray-100":""}">${e.trim()}</${s}>`}),a+="</tr>"}),a+="</table>",a})}if(O.value.codeBlocks&&(l=l.replace(/`([^`]+)`/g,'<code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">$1</code>'),l=l.replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-100 p-3 rounded-lg overflow-x-auto my-2"><code class="font-mono text-sm">$1</code></pre>')),O.value.links&&(l=l.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" class="text-blue-600 hover:underline" target="_blank" rel="noopener">$1</a>'),l=l.replace(/(https?:\/\/[^\s<]+)/g,'<a href="$1" class="text-blue-600 hover:underline" target="_blank" rel="noopener">$1</a>')),O.value.currency&&(l=l.replace(/\$(\d+(?:[.,]\d+)?)\$/g,(e,l)=>l.includes(".")||l.includes(",")?`&dollar;${l}`:e),l=l.replace(/\$(\d+(?:[.,]\d+)?)/g,"&dollar;$1"),l=l.replace(/(\d+(?:[.,]\d+)?)\$/g,"$1&dollar;")),O.value.quotes&&(l=l.replace(/"([^"]+)"/g,"“$1”"),l=l.replace(/'([^']+)'/g,"‘$1’")),O.value.trimSpaces&&(l=l.replace(/ {2,}/g," "),l=l.replace(/^\s+|\s+$/gm,"")),O.value.fixArabicNumbers){const e={"٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9"};l=l.replace(/[٠-٩]/g,l=>e[l])}if(I.value)try{const e=new RegExp(I.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");l=l.replace(e,D.value)}catch(a){}return O.value.math&&(l=l.replace(/\\\((.+?)\\\)/g,"$$$1$$"),l=l.replace(/\\\[(.+?)\\\]/g,"$$$$$$1$$$$$$"),l=l.replace(/(?<!\\)\$((?:[^$]|\\.)+)(?<!\\)\$/g,(e,l)=>{if(/^\s*[\d,.]+\s*$/.test(l))return e;try{return n.renderToString(l,{throwOnError:!1,displayMode:!1})}catch(a){return e}}),l=l.replace(/\$\$(.+?)\$\$/g,(e,l)=>{try{return n.renderToString(l,{throwOnError:!1,displayMode:!0})}catch(a){return e}})),O.value.newlines&&(l=l.replace(/\n/g,"<br>")),l})(R.value);return c.sanitize(e)}),Y=()=>{P("insert",X.value)};return(e,n)=>(b(),p("div",V,[v("div",k,[v("div",S,[x(l,{name:"auto_fix_high",size:"md",color:"primary"}),n[17]||(n[17]=v("div",{class:"text-h6 text-primary font-bold"},"Smart Paste Studio",-1))]),v("div",U,[g(x(s,{flat:"",round:"",icon:"close",color:"grey-7"},null,512),[[a]])])]),v("div",T,[v("div",C,[n[24]||(n[24]=v("div",{class:"text-subtitle2 absolute font-bold text-gray-700 uppercase tracking-wide"},"Magic Filters",-1)),v("div",_,[x(s,{unelevated:"",label:W.value?"Deselect All":"Select All",color:W.value?"grey-7":"primary",size:"sm",class:"mb-2 rounded-lg",onClick:G},null,8,["label","color"]),x(s,{unelevated:"",label:"Reset Defaults",color:"grey-5",size:"sm",class:"mb-2 rounded-lg",onClick:J}),x(r,{class:"mb-2"}),n[18]||(n[18]=v("div",{class:"text-xs font-bold text-gray-500 uppercase mt-2 mb-1"},"Text Formatting",-1)),x(t,{modelValue:O.value.markdown,"onUpdate:modelValue":n[0]||(n[0]=e=>O.value.markdown=e),label:"Basic (Headers, Bold, Italic)",color:"purple",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.extended,"onUpdate:modelValue":n[1]||(n[1]=e=>O.value.extended=e),label:"Extended (Strike, Highlight)",color:"deep-purple",dense:"",class:"text-sm"},null,8,["modelValue"]),n[19]||(n[19]=v("div",{class:"text-xs font-bold text-gray-500 uppercase mt-2 mb-1"},"Structure",-1)),x(t,{modelValue:O.value.lists,"onUpdate:modelValue":n[2]||(n[2]=e=>O.value.lists=e),label:"Lists & Blockquotes",color:"teal",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.tables,"onUpdate:modelValue":n[3]||(n[3]=e=>O.value.tables=e),label:"Tables (GitHub Style)",color:"cyan",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.separators,"onUpdate:modelValue":n[4]||(n[4]=e=>O.value.separators=e),label:"Horizontal Lines",color:"cyan",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.newlines,"onUpdate:modelValue":n[5]||(n[5]=e=>O.value.newlines=e),label:"Preserve Newlines",color:"indigo",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.codeBlocks,"onUpdate:modelValue":n[6]||(n[6]=e=>O.value.codeBlocks=e),label:"Code Blocks (```)",color:"blue-grey",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.links,"onUpdate:modelValue":n[7]||(n[7]=e=>O.value.links=e),label:"Clickable Links",color:"light-blue",dense:"",class:"text-sm"},null,8,["modelValue"]),n[20]||(n[20]=v("div",{class:"text-xs font-bold text-gray-500 uppercase mt-2 mb-1"},"Math & Data",-1)),x(t,{modelValue:O.value.math,"onUpdate:modelValue":n[8]||(n[8]=e=>O.value.math=e),label:"Render Math ($...$)",color:"blue",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.currency,"onUpdate:modelValue":n[9]||(n[9]=e=>O.value.currency=e),label:"Currency & Dollar Fixes",color:"pink",dense:"",class:"text-sm"},null,8,["modelValue"]),n[21]||(n[21]=v("div",{class:"text-xs font-bold text-gray-500 uppercase mt-2 mb-1"},"Fixes & Conversions",-1)),x(t,{modelValue:O.value.blanks,"onUpdate:modelValue":n[10]||(n[10]=e=>O.value.blanks=e),label:"Convert Blanks (___)",color:"orange",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.quotes,"onUpdate:modelValue":n[11]||(n[11]=e=>O.value.quotes=e),label:"Smart Quotes",color:"amber",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.trimSpaces,"onUpdate:modelValue":n[12]||(n[12]=e=>O.value.trimSpaces=e),label:"Trim Extra Spaces",color:"green",dense:"",class:"text-sm"},null,8,["modelValue"]),x(t,{modelValue:O.value.fixArabicNumbers,"onUpdate:modelValue":n[13]||(n[13]=e=>O.value.fixArabicNumbers=e),label:"Fix Arabic Numbers to Western",color:"deep-orange",dense:"",class:"text-sm"},null,8,["modelValue"]),x(r,{class:"my-2"}),n[22]||(n[22]=v("div",{class:"text-xs font-bold text-gray-500 uppercase mb-2"},"Custom Replace (Grade 4 Friendly)",-1)),v("div",j,[x(o,{modelValue:I.value,"onUpdate:modelValue":n[14]||(n[14]=e=>I.value=e),dense:"",outlined:"",label:"Find Text","bg-color":"white",class:"text-sm",placeholder:"e.g. difficult word"},null,8,["modelValue"]),x(o,{modelValue:D.value,"onUpdate:modelValue":n[15]||(n[15]=e=>D.value=e),dense:"",outlined:"",label:"Replace With","bg-color":"white",class:"text-sm",placeholder:"e.g. easy word"},null,8,["modelValue"])])]),v("div",B,[x(l,{name:"info",class:"mr-1"}),n[23]||(n[23]=f(" Tip: Toggle filters to see how they affect your text in real-time! "))])]),v("div",q,[v("div",z,[v("div",M,[n[25]||(n[25]=v("span",{class:"font-bold bg-white px-4 py-2 text-gray-700 text-sm"},"Raw Text (Input)",-1)),x(s,{flat:"",dense:"",size:"sm",icon:"content_paste",label:"Paste Clipboard",color:"primary",onClick:K})]),g(v("textarea",{"onUpdate:modelValue":n[16]||(n[16]=e=>R.value=e),class:"flex-1 p-4 w-full resize-none outline-none font-mono text-sm text-gray-600 overflow-auto",placeholder:"Paste your text here..."},null,512),[[y,R.value]])]),v("div",A,[v("div",E,[n[27]||(n[27]=v("span",{class:"font-bold text-gray-700 text-sm"},"Live Preview (Output)",-1)),R.value?(b(),$(d,{key:0,color:"green"},{default:w(()=>n[26]||(n[26]=[f("Ready to Insert")])),_:1})):h("",!0)]),v("div",{class:"preview-content flex-1 p-4 overflow-y-auto prose max-w-none",innerHTML:X.value},null,8,F)])])]),v("div",H,[g(x(s,{flat:"",label:"Cancel",color:"grey-8",class:"rounded-lg px-4"},null,512),[[a]]),x(s,{unelevated:"",color:"primary",icon:"check",label:"Insert Content",class:"rounded-lg px-6",onClick:Y})])]))}},[["__scopeId","data-v-8061e082"]]);export{L as default};
