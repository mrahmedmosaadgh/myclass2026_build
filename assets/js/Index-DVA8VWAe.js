import{u as e,f as l,H as a,b as t,h as o,Q as n,t as r,d as u,p as i,o as s,e as c}from"./app-DlLesFGi.js";import{Q as d}from"./QSelect-BTh0khse.js";import{Q as m}from"./QTd-BU_S4ffH.js";import{Q as f}from"./QTable-BIAJAIui.js";import{Q as v}from"./QForm-CDvMxBSt.js";import{a1 as p,v as b,f as y,r as h,a as j,N as _,J as g,b as S,z as V,a4 as N,K as x,R as k,V as w,W as C,F as T,$ as q}from"./vendor-BWKGNkNB.js";import{e as O}from"./exportHelper-Jl5p4jiq.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./QMarkupTable-CzIo4GGA.js";import"./QLinearProgress-CX6G9yBK.js";import"./use-fullscreen-BQHoXYBI.js";import"./xlsx-BHXqx-YI.js";var Q,U,A,$,I,E,F,M,P,z,W,D,H,L,G,J,K,R,X,Y,B,Z,ee,le,ae,te,oe,ne;function re(){if(U)return Q;return U=1,Q=function(e){var l=typeof e;return null!=e&&("object"==l||"function"==l)}}function ue(){if($)return A;$=1;var e="object"==typeof p&&p&&p.Object===Object&&p;return A=e}function ie(){if(E)return I;E=1;var e=ue(),l="object"==typeof self&&self&&self.Object===Object&&self,a=e||l||Function("return this")();return I=a}function se(){if(M)return F;M=1;var e=ie();return F=function(){return e.Date.now()}}function ce(){if(z)return P;z=1;var e=/\s/;return P=function(l){for(var a=l.length;a--&&e.test(l.charAt(a)););return a}}function de(){if(D)return W;D=1;var e=ce(),l=/^\s+/;return W=function(a){return a?a.slice(0,e(a)+1).replace(l,""):a}}function me(){if(L)return H;L=1;var e=ie().Symbol;return H=e}function fe(){if(J)return G;J=1;var e=me(),l=Object.prototype,a=l.hasOwnProperty,t=l.toString,o=e?e.toStringTag:void 0;return G=function(e){var l=a.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch(i){}var u=t.call(e);return r&&(l?e[o]=n:delete e[o]),u}}function ve(){if(R)return K;R=1;var e=Object.prototype.toString;return K=function(l){return e.call(l)}}function pe(){if(Y)return X;Y=1;var e=me(),l=fe(),a=ve(),t=e?e.toStringTag:void 0;return X=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":t&&t in Object(e)?l(e):a(e)}}function be(){if(Z)return B;return Z=1,B=function(e){return null!=e&&"object"==typeof e}}function ye(){if(le)return ee;le=1;var e=pe(),l=be();return ee=function(a){return"symbol"==typeof a||l(a)&&"[object Symbol]"==e(a)}}function he(){if(te)return ae;te=1;var e=de(),l=re(),a=ye(),t=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,n=/^0o[0-7]+$/i,r=parseInt;return ae=function(u){if("number"==typeof u)return u;if(a(u))return NaN;if(l(u)){var i="function"==typeof u.valueOf?u.valueOf():u;u=l(i)?i+"":i}if("string"!=typeof u)return 0===u?u:+u;u=e(u);var s=o.test(u);return s||n.test(u)?r(u.slice(2),s?2:8):t.test(u)?NaN:+u}}function je(){if(ne)return oe;ne=1;var e=re(),l=se(),a=he(),t=Math.max,o=Math.min;return oe=function(n,r,u){var i,s,c,d,m,f,v=0,p=!1,b=!1,y=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function h(e){var l=i,a=s;return i=s=void 0,v=e,d=n.apply(a,l)}function j(e){var l=e-f;return void 0===f||l>=r||l<0||b&&e-v>=c}function _(){var e=l();if(j(e))return g(e);m=setTimeout(_,function(e){var l=r-(e-f);return b?o(l,c-(e-v)):l}(e))}function g(e){return m=void 0,y&&i?h(e):(i=s=void 0,d)}function S(){var e=l(),a=j(e);if(i=arguments,s=this,f=e,a){if(void 0===m)return function(e){return v=e,m=setTimeout(_,r),p?h(e):d}(f);if(b)return clearTimeout(m),m=setTimeout(_,r),h(f)}return void 0===m&&(m=setTimeout(_,r)),d}return r=a(r)||0,e(u)&&(p=!!u.leading,c=(b="maxWait"in u)?t(a(u.maxWait)||0,r):c,y="trailing"in u?!!u.trailing:y),S.cancel=function(){void 0!==m&&clearTimeout(m),v=0,i=f=s=m=void 0},S.flush=function(){return void 0===m?d:g(l())},S},oe}const _e=b(je()),ge={class:"row q-col-gutter-md q-mt-sm"},Se={class:"col-12 col-md-6"},Ve={class:"col-12 col-md-6"},Ne={class:"text-h6"},xe="Subjects Management",ke="/admin/subject",we={__name:"Index",props:{records:Object,schools:Array},setup(p){const b=p,Q=e(),U=y(!1),A=y(!1),$=y(null),I=y(!1),E=y(null),F=h({name:"",nour_name:"",school_id:null,active:!0,description:"",notes:""}),M=y({search:"",school_id:null,status:null}),P=j(()=>{var e;return(null==(e=b.records)?void 0:e.data)||[]});j(()=>{var e;return(null==(e=b.records)?void 0:e.current_page)||1});const z=j(()=>{var e;return(null==(e=b.records)?void 0:e.per_page)||10}),W=j(()=>[...b.schools.map(e=>({value:e.id,label:e.name}))]),D=[{name:"name",label:"Name",field:"name",align:"left"},{name:"nour_name",label:"Nour Name",field:"nour_name"},{name:"school",label:"School",field:e=>{var l;return null==(l=e.school)?void 0:l.name}},{name:"active",label:"Status",field:"active",format:e=>e?"Active":"Inactive"},{name:"actions",label:"Actions",field:"actions",align:"right"}],H=()=>{I.value=!0,q.get("/admin/subject",{...M.value,preserveState:!0,preserveScroll:!0,only:["records"]})},L=_e(H,300),G=()=>{F.name="",F.nour_name="",F.school_id=null,F.active=!0,F.description="",F.notes=""},J=(e=null)=>{$.value=e,e?(F.name=e.name,F.nour_name=e.nour_name,F.school_id=e.school_id,F.active=e.active,F.description=e.description||"",F.notes=e.notes||""):G(),U.value=!0},K=()=>{U.value=!1,$.value=null,G()},R=()=>{E.value&&q.delete(`${ke}/${E.value.id}`,{onSuccess:()=>{Q.notify({type:"positive",message:"Subject deleted successfully"}),A.value=!1,E.value=null},onError:()=>{Q.notify({type:"negative",message:"Failed to delete subject"})}})},X=()=>{var e;const l=null==(e=$.value)?void 0:e.id,a=l?`${ke}/${l}`:ke;q[l?"put":"post"](a,F,{onSuccess:()=>{Q.notify({type:"positive",message:`Subject ${l?"updated":"created"} successfully`}),K()},onError:e=>{Object.values(e).forEach(e=>{Q.notify({type:"negative",message:e})})}})},Y=()=>{Q.dialog({title:"Import Subjects",message:"Import functionality coming soon!"})},B=()=>{O({items:P.value,columns:[{key:"name",label:"Name"},{key:"nour_name",label:"Nour Name"},{key:"school.name",label:"School"},{key:"active",label:"Status"}],fileName:"subjects",sheetName:"Subjects"})};return(e,p)=>(g(),_(T,null,[S(V(N),{title:xe}),S(u,{flat:"",class:"q-pa-md"},{default:x(()=>[S(l,null,{default:x(()=>[k("div",{class:"text-h5 text-weight-bold"},w(xe))]),_:1}),S(l,null,{default:x(()=>[S(a,{spread:""},{default:x(()=>[S(t,{color:"primary",label:"Add Subject",icon:"add",onClick:J}),S(t,{color:"secondary",label:"Import",icon:"upload_file",onClick:Y}),S(t,{color:"info",label:"Export",icon:"download",onClick:B})]),_:1})]),_:1}),S(l,null,{default:x(()=>[S(o,{modelValue:M.value.search,"onUpdate:modelValue":p[0]||(p[0]=e=>M.value.search=e),label:"Search Subjects",clearable:"",onInput:V(L)},{prepend:x(()=>[S(n,{name:"search"})]),_:1},8,["modelValue","onInput"]),k("div",ge,[k("div",Se,[S(d,{modelValue:M.value.school_id,"onUpdate:modelValue":[p[1]||(p[1]=e=>M.value.school_id=e),H],options:W.value,label:"Filter by School","option-value":"value","option-label":"label","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"])]),k("div",Ve,[S(d,{modelValue:M.value.status,"onUpdate:modelValue":[p[2]||(p[2]=e=>M.value.status=e),H],options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],label:"Filter by Status","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])])]),_:1}),S(l,null,{default:x(()=>[S(f,{rows:P.value,columns:D,loading:I.value,"row-key":"id",pagination:{rowsPerPage:z.value}},{"body-cell-actions":x(e=>[S(m,{props:e},{default:x(()=>[S(a,{flat:""},{default:x(()=>[S(t,{icon:"edit",color:"primary",size:"sm",onClick:l=>J(e.row),class:"q-mr-xs"},null,8,["onClick"]),S(t,{icon:"delete",color:"negative",size:"sm",onClick:l=>{return a=e.row,E.value=a,void(A.value=!0);var a},class:"q-mr-xs"},null,8,["onClick"]),S(t,{icon:"description",color:"info",size:"sm",onClick:l=>{return a=e.row,void q.get(route("admin.subject.lesson-plan-templates",a.id));var a},class:"q-mr-xs"},{default:x(()=>[S(r,null,{default:x(()=>p[10]||(p[10]=[C("Manage Lesson Plan Templates")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),_:1}),S(c,{modelValue:U.value,"onUpdate:modelValue":p[7]||(p[7]=e=>U.value=e),persistent:""},{default:x(()=>[S(u,{style:{"min-width":"500px"}},{default:x(()=>[S(l,null,{default:x(()=>[k("div",Ne,w($.value?"Edit":"Add")+" Subject",1)]),_:1}),S(l,null,{default:x(()=>[S(v,{onSubmit:X,class:"q-gutter-md"},{default:x(()=>[S(o,{modelValue:F.name,"onUpdate:modelValue":p[3]||(p[3]=e=>F.name=e),label:"Name",rules:[e=>!!e||"Name is required"],required:""},null,8,["modelValue","rules"]),S(o,{modelValue:F.nour_name,"onUpdate:modelValue":p[4]||(p[4]=e=>F.nour_name=e),label:"Nour Name",rules:[e=>!!e||"Nour Name is required"],required:""},null,8,["modelValue","rules"]),S(d,{modelValue:F.school_id,"onUpdate:modelValue":p[5]||(p[5]=e=>F.school_id=e),options:W.value,label:"School","option-value":"value","option-label":"label","emit-value":"","map-options":"",rules:[e=>!!e||"School is required"],required:""},null,8,["modelValue","options","rules"]),S(i,{modelValue:F.active,"onUpdate:modelValue":p[6]||(p[6]=e=>F.active=e),label:"Active"},null,8,["modelValue"]),S(s,{align:"right"},{default:x(()=>[S(t,{flat:"",label:"Cancel",color:"primary",onClick:K}),S(t,{label:"Save",type:"submit",color:"primary"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),S(c,{modelValue:A.value,"onUpdate:modelValue":p[9]||(p[9]=e=>A.value=e),persistent:""},{default:x(()=>[S(u,null,{default:x(()=>[S(l,null,{default:x(()=>p[11]||(p[11]=[k("div",{class:"text-h6"},"Delete Subject",-1)])),_:1}),S(l,null,{default:x(()=>p[12]||(p[12]=[C(" Are you sure you want to delete this subject? This action cannot be undone. ")])),_:1}),S(s,{align:"right"},{default:x(()=>[S(t,{flat:"",label:"Cancel",color:"primary",onClick:p[8]||(p[8]=e=>A.value=!1)}),S(t,{label:"Delete",color:"negative",onClick:R})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{we as default};
