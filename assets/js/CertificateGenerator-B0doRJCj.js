const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/jspdf.es.min-hSIUEwIk.js","assets/js/app-4gpSDtVV.js","assets/js/vendor-BWKGNkNB.js","assets/js/offline-BzIlwqNM.js","assets/js/i18n-B0T1C7j3.js","assets/js/ui-B7TfxbV_.js","assets/css/app-o3SF-dGU.css"])))=>i.map(i=>d[i]);
import{r as e,u as t,b as l,c as a,p as o,Q as i,h as s,d as n,e as r,_ as u,aS as d}from"./app-4gpSDtVV.js";import{Q as c}from"./QSpace-BaiVAeLS.js";import{Q as v}from"./QBar-BEE9v3eh.js";import{Q as m}from"./QSlider-Dse-7IkD.js";import{a as p,f as g,k as f,o as h,e as w,I as b,J as y,K as x,b as k,R as S,y as _,N as V,Q as L,F as j,O as C,W as z,V as N,S as O,U as $,n as D}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const E={class:"flex-1 flex flex-col lg:flex-row overflow-hidden print:block print:overflow-visible"},M={class:"w-full lg:w-96 bg-gray-800 p-6 overflow-y-auto border-r border-gray-700 flex flex-col gap-6 print:hidden shadow-xl z-20"},P={class:"grid grid-cols-2 gap-3"},A=["onClick"],I=["src"],Y={key:0,class:"absolute bottom-1 right-1 bg-primary text-white text-xs px-1.5 py-0.5 rounded-full shadow-sm"},J={class:"space-y-4"},U={class:"flex items-center justify-between"},Q={key:0,class:"bg-gray-700 p-3 rounded-lg space-y-3"},T={class:"text-xs text-yellow-500 font-bold mb-1"},F={class:"text-xs text-gray-300 mb-2"},R={class:"text-xs text-gray-400 mb-1"},G={class:"grid grid-cols-2 gap-3"},X={class:"grid grid-cols-1 gap-3 mt-auto"},B={class:"flex-1 bg-gray-900 relative p-4 lg:p-8 overflow-auto print:p-0 print:block flex flex-col items-center"},W={key:0,class:"w-full max-w-4xl mb-4 print:hidden"},K={class:"bg-gray-800 rounded-lg p-3 flex items-center justify-between"},H={class:"text-yellow-400 font-bold"},q={class:"text-white ml-2"},Z=["src"],ee=["src"],te={class:"absolute inset-0 text-black font-serif z-20 pointer-events-none"},le=e({__name:"CertificateGenerator",props:{modelValue:Boolean,student:Object,students:{type:Array,default:()=>[]},defaultDate:String,schoolLogo:String},emits:["update:modelValue"],setup(e,{emit:le}){const ae=t(),oe=e,ie=le,se=p({get:()=>oe.modelValue,set:e=>ie("update:modelValue",e)}),ne=p(()=>oe.students&&oe.students.length>0),re=g(0),ue=p(()=>ne.value?oe.students[re.value]||oe.students[0]:oe.student),de=g({academicYear:"2024-2025",week:"1",date:oe.defaultDate||(new Date).toLocaleDateString(),message:"For your outstanding performance and excellent behavior."}),ce=[{id:1,name:"Classic Gold",image:"/images/certificate1.png",styles:{name:{top:"301px",left:"0",right:"0",width:"100%",textAlign:"center",color:"#111827"},message:{top:"436px",left:"112px",right:"112px",width:"899px",textAlign:"center",color:"#4b5563",fontSize:"1.5rem"},year:{top:"635px",left:"168px",fontSize:"1.5rem",color:"#374151"},date:{top:"635px",left:"800px",fontSize:"1.5rem",color:"#374151"},week:{top:"198px",left:"800px",fontSize:"1.5rem",color:"#374151"},logo:{top:"63px",left:"460px",height:"80px",opacity:"0.9"}}},{id:2,name:"Modern Blue",image:"/images/certificate2.png",styles:{name:{top:"333px",left:"0",width:"80%",textAlign:"center",color:"#1e3a8a"},message:{top:"476px",left:"112px",width:"65%",textAlign:"center",color:"#1e3a8a",fontSize:"1.25rem"},year:{top:"680px",left:"471px",color:"#1e3a8a",fontSize:"1.25rem"},date:{top:"680px",left:"112px",color:"#1e3a8a",fontSize:"1.25rem"},week:{top:"238px",left:"101px",color:"#1e3a8a",fontSize:"1.25rem"},logo:{top:"40px",left:"56px",height:"90px"}}}],ve=g(ce),me=g(ve.value[0]),pe=g(JSON.parse(JSON.stringify(ve.value[0].styles))),ge=g(!1);function fe(e){const t=localStorage.getItem(`cert_styles_${e}`);if(t)pe.value=JSON.parse(t);else{const t=ce.find(t=>t.id===e);t&&(pe.value=JSON.parse(JSON.stringify(t.styles)))}}function he(){localStorage.setItem(`cert_styles_${me.value.id}`,JSON.stringify(pe.value)),ae.notify({message:"Layout saved!",color:"positive",position:"top",timeout:1e3})}function we(){const e=ce.find(e=>e.id===me.value.id);e&&(pe.value=JSON.parse(JSON.stringify(e.styles)),he())}f(me,e=>{fe(e.id)});const be=g({active:!1,element:null,startX:0,startY:0,initialTop:0,initialLeft:0});function ye(e,t){if(!ge.value)return;e.preventDefault(),be.value.active=!0,be.value.element=t,be.value.startX=e.clientX,be.value.startY=e.clientY;const l=pe.value[t];be.value.initialTop=parseInt(l.top)||0,be.value.initialLeft=parseInt(l.left)||0,window.addEventListener("mousemove",xe),window.addEventListener("mouseup",ke)}function xe(e){if(!be.value.active)return;const t=(e.clientX-be.value.startX)/Ve.value,l=(e.clientY-be.value.startY)/Ve.value,a=be.value.element;pe.value[a]&&(pe.value[a].top=`${be.value.initialTop+l}px`,pe.value[a].left=`${be.value.initialLeft+t}px`,delete pe.value[a].right,delete pe.value[a].bottom)}function ke(){be.value.active=!1,window.removeEventListener("mousemove",xe),window.removeEventListener("mouseup",ke),he()}const Se=g(!1),_e=g(null),Ve=g(1);async function Le(){Se.value=!0,ge.value=!1;try{const[{default:e},{default:t}]=await Promise.all([u(()=>import("./html2canvas.esm-Cq3pa7K9.js"),[]),u(()=>import("./jspdf.es.min-hSIUEwIk.js").then(e=>e.j),__vite__mapDeps([0,1,2,3,4,5,6]))]),l=_e.value;if(!l)throw new Error("Certificate element not found");const a=new t({orientation:"landscape",unit:"px",format:[1123,794]}),o=ne.value?oe.students:[oe.student];for(let s=0;s<o.length;s++){ne.value&&ae.notify({message:`Generating certificate ${s+1} of ${o.length}...`,color:"info",position:"top",timeout:500}),re.value=s,await D(),await new Promise(e=>setTimeout(e,100));const t=l.style.transform;l.style.transform="none";const i=await e(l,{scale:2,useCORS:!0,logging:!1,allowTaint:!0});l.style.transform=t;const n=i.toDataURL("image/png");s>0&&a.addPage(),a.addImage(n,"PNG",0,0,1123,794)}const i=ne.value?`Certificates_${o.length}_Students.pdf`:`${oe.student.firstName}_Certificate.pdf`;a.save(i),ae.notify({message:ne.value?`${o.length} certificates downloaded!`:"Certificate downloaded!",color:"positive"})}catch(e){console.error(e),ae.notify({message:"Failed to generate PDF",color:"negative"})}finally{Se.value=!1,re.value=0}}function je(){ge.value=!1,window.print()}return h(()=>{fe(me.value.id)}),w(()=>{window.removeEventListener("mousemove",xe),window.removeEventListener("mouseup",ke)}),(t,u)=>(y(),b(r,{modelValue:se.value,"onUpdate:modelValue":u[14]||(u[14]=e=>se.value=e),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:x(()=>[k(n,{class:"bg-gray-900 text-white flex flex-col print:bg-white print:text-black"},{default:x(()=>{var n,r,p,g;return[k(v,{class:"bg-gray-800 p-4 print:hidden border-b border-gray-700"},{default:x(()=>[u[15]||(u[15]=S("div",{class:"text-h6 flex items-center gap-2"}," ðŸŽ“ Certificate Generator ",-1)),k(c),_(k(l,{dense:"",flat:"",icon:"close"},null,512),[[d]])]),_:1}),S("div",E,[S("div",M,[S("div",null,[u[17]||(u[17]=S("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3"},"Select Template",-1)),S("div",P,[(y(!0),V(j,null,L(ve.value,e=>(y(),V("div",{key:e.id,class:$(["cursor-pointer rounded-lg overflow-hidden transition-all duration-300 relative group",me.value.id===e.id?"ring-2 ring-primary shadow-lg scale-[1.02]":"opacity-70 hover:opacity-100 hover:scale-[1.02]"]),onClick:t=>me.value=e},[S("img",{src:e.image,class:"w-full h-24 object-cover"},null,8,I),u[16]||(u[16]=S("div",{class:"absolute inset-0 bg-black/20 group-hover:bg-transparent transition-colors"},null,-1)),me.value.id===e.id?(y(),V("div",Y,[k(i,{name:"check",size:"xs"})])):C("",!0)],10,A))),128))])]),k(a,{dark:""}),S("div",J,[S("div",U,[u[18]||(u[18]=S("div",{class:"text-xs font-bold text-gray-400 uppercase tracking-wider"},"Certificate Details",-1)),k(o,{modelValue:ge.value,"onUpdate:modelValue":u[0]||(u[0]=e=>ge.value=e),label:t.$t("rewardSys.certificate.editLayout"),dense:"",color:"secondary",class:"text-xs"},null,8,["modelValue","label"])]),ge.value?(y(),V("div",Q,[S("div",T,[k(i,{name:"warning",class:"mr-1"}),z(" "+N(t.$t("rewardSys.certificate.editModeActive")),1)]),S("div",F,N(t.$t("rewardSys.certificate.dragInstruction")),1),S("div",null,[S("div",R,N(t.$t("rewardSys.certificate.logoHeight")),1),k(m,{modelValue:pe.value.logo.height,"onUpdate:modelValue":u[1]||(u[1]=e=>pe.value.logo.height=e),min:40,max:200,label:"","label-value":pe.value.logo.height+"px",color:"secondary"},null,8,["modelValue","label-value"])]),k(l,{outline:"",dense:"",color:"warning",icon:"restore",label:t.$t("rewardSys.certificate.resetLayout"),size:"sm",class:"w-full",onClick:we},null,8,["label"])])):C("",!0),k(s,{modelValue:de.value.academicYear,"onUpdate:modelValue":u[2]||(u[2]=e=>de.value.academicYear=e),label:"Academic Year",dark:"",outlined:"",dense:"","bg-color":"gray-900",color:"white","label-color":"grey-4"},{prepend:x(()=>[k(i,{name:"event"})]),_:1},8,["modelValue"]),S("div",G,[k(s,{modelValue:de.value.week,"onUpdate:modelValue":u[3]||(u[3]=e=>de.value.week=e),label:"Week",dark:"",outlined:"",dense:"","bg-color":"gray-900",color:"white","label-color":"grey-4"},null,8,["modelValue"]),k(s,{modelValue:de.value.date,"onUpdate:modelValue":u[4]||(u[4]=e=>de.value.date=e),label:"Date",dark:"",outlined:"",dense:"","bg-color":"gray-900",color:"white","label-color":"grey-4"},null,8,["modelValue"])]),k(s,{modelValue:de.value.message,"onUpdate:modelValue":u[5]||(u[5]=e=>de.value.message=e),label:"Custom Message",dark:"",outlined:"",dense:"",autogrow:"","bg-color":"gray-900",color:"white","label-color":"grey-4",hint:"Short appreciation text"},null,8,["modelValue"])]),k(c,{class:"hidden lg:block"}),S("div",X,[k(l,{color:"primary",icon:"download",label:"Download PDF",class:"py-3 font-bold shadow-lg",onClick:Le,loading:Se.value},null,8,["loading"]),k(l,{color:"white","text-color":"black",icon:"print",label:"Print Certificate",class:"py-2",onClick:je})])]),S("div",B,[ne.value?(y(),V("div",W,[S("div",K,[k(l,{flat:"",dense:"",icon:"chevron_left",color:"yellow-500",onClick:u[6]||(u[6]=e=>re.value=Math.max(0,re.value-1)),disable:0===re.value},null,8,["disable"]),S("div",H,[z(" Student "+N(re.value+1)+" of "+N(e.students.length)+" ",1),S("span",q,N(null==(n=ue.value)?void 0:n.firstName)+" "+N(null==(r=ue.value)?void 0:r.lastName),1)]),k(l,{flat:"",dense:"",icon:"chevron_right",color:"yellow-500",onClick:u[7]||(u[7]=t=>re.value=Math.min(e.students.length-1,re.value+1)),disable:re.value===e.students.length-1},null,8,["disable"])])])):C("",!0),u[19]||(u[19]=S("div",{class:"text-center absolute top-2 left-0 right-0 text-gray-500 text-sm italic lg:hidden print:hidden z-10 pointer-events-none"}," Scroll to view full certificate ",-1)),S("div",{ref_key:"certificateRef",ref:_e,class:"certificate-container relative shadow-2xl overflow-hidden bg-white print:shadow-none print:m-0 shrink-0",style:O({width:"1123px",height:"794px",transform:`scale(${Ve.value})`,transformOrigin:"top center"})},[S("img",{src:me.value.image,class:"absolute inset-0 w-full h-full object-cover select-none pointer-events-none"},null,8,Z),e.schoolLogo?(y(),V("img",{key:0,src:e.schoolLogo,class:$(["absolute object-contain z-30",{"cursor-move hover:outline-dashed hover:outline-2 hover:outline-blue-500":ge.value}]),style:O({...pe.value.logo,height:"number"==typeof pe.value.logo.height?pe.value.logo.height+"px":pe.value.logo.height}),onMousedown:u[8]||(u[8]=e=>ye(e,"logo"))},null,46,ee)):C("",!0),S("div",te,[S("div",{class:$(["absolute pointer-events-auto",{"cursor-move hover:outline-dashed hover:outline-2 hover:outline-blue-500":ge.value}]),style:O(pe.value.name),onMousedown:u[9]||(u[9]=e=>ye(e,"name"))},[S("h1",{class:"font-bold capitalize leading-none select-none",style:O({fontFamily:"'Pinyon Script', cursive, serif",color:pe.value.name.color||"#111827",fontSize:"5rem"})},N(null==(p=ue.value)?void 0:p.firstName)+" "+N(null==(g=ue.value)?void 0:g.lastName),5)],38),S("div",{class:$(["absolute font-medium italic pointer-events-auto select-none",{"cursor-move hover:outline-dashed hover:outline-2 hover:outline-blue-500":ge.value}]),style:O(pe.value.message),onMousedown:u[10]||(u[10]=e=>ye(e,"message"))},' "'+N(de.value.message)+'" ',39),S("div",{class:$(["absolute font-bold pointer-events-auto select-none",{"cursor-move hover:outline-dashed hover:outline-2 hover:outline-blue-500":ge.value}]),style:O(pe.value.year),onMousedown:u[11]||(u[11]=e=>ye(e,"year"))},N(de.value.academicYear),39),S("div",{class:$(["absolute font-bold pointer-events-auto select-none",{"cursor-move hover:outline-dashed hover:outline-2 hover:outline-blue-500":ge.value}]),style:O(pe.value.date),onMousedown:u[12]||(u[12]=e=>ye(e,"date"))},N(de.value.date),39),S("div",{class:$(["absolute font-bold pointer-events-auto select-none",{"cursor-move hover:outline-dashed hover:outline-2 hover:outline-blue-500":ge.value}]),style:O(pe.value.week),onMousedown:u[13]||(u[13]=e=>ye(e,"week"))}," Week: "+N(de.value.week),39)])],4)])])]}),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-3ea4de3e"]]);export{le as default};
