import{u as e,Q as a,a as l,b as s}from"./app-BXm70mdJ.js";import{Q as o}from"./QTab-DhKL91H_.js";import{Q as u}from"./QTabs-CDJ215OP.js";import{Q as t}from"./QTabPanel-sB32VrK8.js";import{Q as n}from"./QTabPanels-LFwTBPSC.js";import{N as m,f as i,k as r,H as d,I as p,J as c,M as v,b as y,L as f,Q as b,F as g,Z as j,_ as Q}from"./vendor-DNM7Y6Xn.js";import{u as V,A as M}from"./AdminLayout-DU5U6oBC.js";import C from"./MenuList-ccPtLvpl.js";import _ from"./MenuForm-Cx17HLCf.js";import h from"./MenuDeleteDialog-GlgsDcR6.js";import k from"./BulkImportDialog-CCVoQdKq.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-D2HepUiw.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-ZzhN1X9C.js";import"./QSpace-Bu8V-QDa.js";import"./QSelect-CnZtzPIC.js";import"./QForm-DyZk5PSh.js";import"./QStepperNavigation-d60Xs3zk.js";import"./QStepper-9iCkKHrv.js";const w={class:"q-pa-md"},x={class:"row q-mb-md items-center"},A={class:"col-auto"},F={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(F){const U=e();m();const D=F,S=i(D.modules[0]||"academics"),B=i(!1),I=i(!1),T=i(!1),q=i(!1),L=i(null),E=i(null),N=e=>D.menus.filter(a=>a.module===e),P=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");r(I,e=>{e&&(L.value=null,B.value=!0,I.value=!1)});const $=e=>{L.value=e,B.value=!0},z=e=>{E.value=e,T.value=!0},H=async e=>{var a,l;try{L.value?(await j.put(`/api/admin/menus/${L.value.id}`,e),U.notify({type:"positive",message:"Menu updated successfully"})):(await j.post("/api/admin/menus",e),U.notify({type:"positive",message:"Menu created successfully"})),K(),Q.reload({only:["menus"]})}catch(s){U.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to save menu"})}},J=async()=>{var e,a;try{await j.delete(`/api/admin/menus/${E.value.id}`),U.notify({type:"positive",message:"Menu deleted successfully"}),T.value=!1,Q.reload({only:["menus"]})}catch(l){U.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},R=async e=>{var a,l;try{await j.post("/api/admin/menus/reorder",{items:e}),U.notify({type:"positive",message:"Menu order updated successfully"}),Q.reload({only:["menus"]})}catch(s){U.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to reorder menus"})}},Z=V(),G=async()=>{await Z.invalidateCache(),Q.reload({only:["menus"]})},K=()=>{B.value=!1,L.value=null};return(e,m)=>(p(),d(M,null,{default:c(()=>[v("div",w,[v("div",x,[m[8]||(m[8]=v("div",{class:"col"},[v("div",{class:"text-h4"},"Menu Management"),v("div",{class:"text-subtitle2 text-grey-7"},"Manage navigation menus for your application")],-1)),v("div",A,[y(a,{color:"primary",icon:"add",label:"Create Menu",onClick:m[0]||(m[0]=e=>I.value=!0)}),y(a,{color:"secondary",icon:"upload",label:"Bulk Import",class:"q-ml-sm",onClick:m[1]||(m[1]=e=>q.value=!0)})])]),y(u,{modelValue:S.value,"onUpdate:modelValue":m[2]||(m[2]=e=>S.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left"},{default:c(()=>[(p(!0),f(g,null,b(F.modules,e=>(p(),d(o,{key:e,name:e,label:P(e)},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),y(l),y(n,{modelValue:S.value,"onUpdate:modelValue":m[3]||(m[3]=e=>S.value=e),animated:""},{default:c(()=>[(p(!0),f(g,null,b(F.modules,e=>(p(),d(t,{key:e,name:e},{default:c(()=>[y(C,{menus:N(e),module:e,onEdit:$,onDelete:z,onReorder:R},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),y(s,{modelValue:B.value,"onUpdate:modelValue":m[4]||(m[4]=e=>B.value=e),persistent:""},{default:c(()=>[y(_,{menu:L.value,modules:F.modules,onSave:H,onCancel:K},null,8,["menu","modules"])]),_:1},8,["modelValue"]),y(h,{modelValue:T.value,"onUpdate:modelValue":m[5]||(m[5]=e=>T.value=e),menu:E.value,onConfirm:J,onCancel:m[6]||(m[6]=e=>T.value=!1)},null,8,["modelValue","menu"]),y(k,{modelValue:q.value,"onUpdate:modelValue":m[7]||(m[7]=e=>q.value=e),onImported:G},null,8,["modelValue"])])]),_:1}))}};export{F as default};
