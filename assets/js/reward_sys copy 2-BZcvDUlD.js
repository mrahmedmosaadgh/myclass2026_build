import{o as e,u as a,c as l,d as t,Q as s,m as o,b as i,a as n,h as d,i as r,j as u,l as c,aP as v,n as p,k as m}from"./app-ggGwxJON.js";import{Q as g,a as b}from"./QToolbar-DMbCF1rG.js";import{Q as f}from"./QSelect-DOo83gJW.js";import{Q as x}from"./QTab-Dz6RnWyq.js";import{Q as y}from"./QTabs-DMYUh0Ok.js";import{Q as h}from"./QTabPanel-DWPrbrYB.js";import{Q as _}from"./QTabPanels-BH2gx17B.js";import{f as w,k,a as j,o as C,_ as S,N as V,J as U,b as A,Q as P,W as F,O as Q,I,K as z,V as T,y as N,F as $,R,ag as E,ah as D,U as M,a0 as B}from"./vendor-nQjeLEvd.js";import{r as L}from"./reward_sys_point_action-oLy4sW63.js";import O from"./PeriodSelectionRefactored-CT_ttYJH.js";import W from"./ClassroomSelection-DFsO_V-T.js";import G from"./TopLeaderboard-D08TxZUZ.js";import K from"./StudentCard-DbZCVyli.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-BQ7QSG7B.js";import"./use-render-cache-CmTcazfP.js";import"./html2canvas.esm-Cq3pa7K9.js";import"./CertificateGenerator-D6gN64KK.js";import"./QSpace-DKhB4IlP.js";import"./QBar-CrRFYR5C.js";import"./QSlider-rHpK1y__.js";import"./jspdf.es.min-KPg7L82s.js";import"./AvatarManager-CEvP1T-P.js";import"./CameraCapture-CL8mYJbX.js";const q={class:"p-6 space-y-6 bg-gradient-to-br from-blue-50 to-indigo-50 min-h-screen"},J={class:"flex items-center justify-between bg-white p-4 rounded-lg border border-gray-200 shadow-sm"},Y={class:"flex items-center gap-4"},H={class:"bg-blue-100 p-3 rounded-full text-blue-600"},X={class:"text-lg font-bold text-gray-800 flex items-center gap-2"},Z={key:0},ee={key:1,class:"text-gray-400 italic"},ae={class:"text-blue-600 font-mono bg-blue-50 px-2 py-0.5 rounded text-base"},le={class:"text-xs text-gray-500 mt-1"},te={class:"max-w-7xl mx-auto space-y-8"},se={class:"bg-white p-6 rounded-xl shadow-sm border border-gray-200"},oe={class:"text-lg font-bold text-gray-700 mb-4 flex items-center gap-2"},ie={class:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-100 flex justify-center"},ne={class:"text-sm text-gray-700"},de={class:"font-bold text-blue-600 font-mono text-lg"},re={class:"bg-white p-6 rounded-xl shadow-sm border border-gray-200"},ue={class:"text-lg font-bold text-gray-700 mb-4 flex items-center gap-2"},ce={key:0,class:"mb-6"},ve={class:"flex items-center justify-between mb-4"},pe={class:"text-sm text-gray-600"},me={class:"text-blue-600"},ge={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},be={class:"flex gap-2"},fe={class:"flex gap-2"},xe={class:"dojo-container"},ye={class:"space-y-4"},he={class:"flex justify-between items-center mb-4"},_e={class:"flex gap-2"},we={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ke=["onClick"],je={class:"flex items-center justify-between mb-3"},Ce={class:"flex-1"},Se={class:"font-semibold text-lg"},Ve={class:"text-xs text-gray-600"},Ue={class:"text-center mb-3 font-semibold"},Ae={class:"space-y-2"},Pe={class:"p-2 bg-green-100 rounded flex justify-between items-center"},Fe={class:"text-sm font-bold text-green-900"},Qe={class:"p-2 bg-red-100 rounded flex justify-between items-center"},Ie={class:"text-sm font-bold text-red-900"},ze={class:"p-2 bg-blue-100 rounded flex justify-between items-center"},Te={class:"text-lg font-bold text-blue-600"},Ne={class:"space-y-4"},$e={class:"p-4 bg-green-50 rounded-lg border border-green-200"},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Ee={class:"mt-2 text-sm"},De={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Me=["onClick"],Be={class:"flex items-start justify-between mb-3"},Le={class:"flex-1"},Oe={class:"font-semibold text-lg"},We={class:"text-xs text-gray-600"},Ge={key:0,class:"text-xs text-red-600 mt-1"},Ke={class:"space-y-2"},qe={class:"p-2 bg-green-100 rounded flex justify-between items-center"},Je={class:"text-sm font-bold text-green-900"},Ye={class:"p-2 bg-red-100 rounded flex justify-between items-center"},He={class:"text-sm font-bold text-red-900"},Xe={class:"p-2 bg-blue-100 rounded flex justify-between items-center"},Ze={class:"text-lg font-bold text-blue-600"},ea={class:"space-y-4"},aa={class:"p-4 bg-red-50 rounded-lg border border-red-200"},la={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ta={class:"mt-2 text-sm"},sa={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},oa=["onClick"],ia={class:"flex items-start justify-between mb-3"},na={class:"flex-1"},da={class:"font-semibold text-lg"},ra={class:"text-xs text-gray-600"},ua={key:0,class:"text-xs text-red-600 mt-1"},ca={class:"space-y-2"},va={class:"p-2 bg-green-100 rounded flex justify-between items-center"},pa={class:"text-sm font-bold text-green-900"},ma={class:"p-2 bg-red-100 rounded flex justify-between items-center"},ga={class:"text-sm font-bold text-red-900"},ba={class:"p-2 bg-blue-100 rounded flex justify-between items-center"},fa={class:"text-lg font-bold text-blue-600"},xa={class:"space-y-4"},ya={class:"flex justify-between items-center mb-4"},ha={key:0,class:"text-center py-8"},_a={class:"flex items-start justify-between"},wa={class:"flex-1"},ka={class:"flex items-center gap-2 mb-1"},ja={class:"font-bold text-lg"},Ca={class:"text-2xl"},Sa={class:"text-sm text-gray-700"},Va={class:"text-xs text-gray-500 mt-1"},Ua={key:0,class:"text-xs text-gray-600 mt-1 italic"},Aa={key:1,class:"text-xs text-red-600 mt-1"},Pa=e({__name:"reward_sys copy 2",setup(e){w("https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf");const Pa=a(),Fa=w("attendance");k(Fa,(e,a)=>{e!==a&&(La.value=[])});const Qa=w([]),Ia=w([]),za=w([]),Ta=w(null),Na=w((new Date).toISOString().split("T")[0]),$a=w(1),Ra=w(1),Ea=w(1),Da=w(1),Ma=w(null),Ba=w(null),La=w([]),Oa=w({}),Wa=w({}),Ga=w({}),Ka=w([]);w([]);const qa=w(!1),Ja=w(!1),Ya=w(!1),Ha=w(!1),Xa=w(!1),Za=w(null),el=w(null),al=w({message:"",created:0,skipped:0}),ll=w(!1),tl=w(!1),sl=j(()=>`${$a.value}.${Ra.value}.${Ea.value}.${Da.value}`),ol=j(()=>{console.log("ðŸ” All behaviors:",za.value);const e=za.value.filter(e=>{if(e.type)return"positive"===e.type||"reward"===e.type;return(e.value||e.points||0)>0});return console.log("âœ… Positive behaviors:",e),e}),il=j(()=>{const e=za.value.filter(e=>{if(e.type)return"negative"===e.type||"penalty"===e.type;return(e.value||e.points||0)<0});return console.log("âš ï¸ Negative behaviors:",e),e});function nl(e){Na.value=e.date,$a.value=e.semester,Ra.value=e.week,Ea.value=e.day,Da.value=e.periodNumber,console.log("ðŸ“… Period changed:",{periodCode:sl.value,...e})}function dl(e){if(!Wa.value[e])return void Pa.notify({message:"Cannot select absent students",color:"warning",position:"top",timeout:1e3});const a=La.value.indexOf(e);-1===a?La.value.push(e):La.value.splice(a,1)}function rl(){La.value=[]}async function ul(e){if(!e)return Ia.value=[],void(La.value=[]);try{Ja.value=!0,Ia.value=[],La.value=[],el.value=null,al.value={message:"",created:0,skipped:0}}catch(a){console.error("Failed to load classroom:",a),Pa.notify({message:"Failed to load classroom: "+a.message,color:"negative",position:"top"})}finally{Ja.value=!1}}async function cl(){if(Ta.value){Ja.value=!0,al.value={message:"Initializing...",created:0,skipped:0};try{const e={classroom_id:Ta.value,date:Na.value,period_code:sl.value},a=await S.post("/api/student-behaviors/init-classroom",e);if(a&&a.data){const e=a.data;el.value=e.student_behaviors_mains_id,al.value={message:`Session initialized (created ${e.created}, skipped ${e.skipped})`,created:e.created,skipped:e.skipped};const l=e.student_behaviors||[],t=l.map(e=>({id:e.student.id,name:e.student.name||`Student ${e.student_id}`,avatar:e.student.avatar,behaviorRecordId:e.id}));Ia.value=t,La.value=[];const s={};for(const a of l)Wa.value[a.student_id]=void 0===a.attend||a.attend,s[a.student_id]={attend:void 0===a.attend||a.attend,points_plus:a.points_plus||0,points_minus:a.points_minus||0};Oa.value=s,Pa.notify({message:"Session initialized",color:"positive",position:"top"}),await yl(),ll.value=!1}}catch(e){console.error("Failed to init classroom session:",e),al.value={message:"Initialization failed",created:0,skipped:0},Pa.notify({message:"Failed to init session: "+(e.message||"error"),color:"negative",position:"top"})}finally{Ja.value=!1}}}async function vl(){await ml(Ma.value),Ma.value=null}async function pl(){await ml(Ba.value),Ba.value=null}async function ml(e){if(La.value.length&&e)try{Ya.value=!0;const a=await L.applyBehaviorToStudents(La.value,e,{date:Na.value,periodCode:sl.value,classroomId:Ta.value});a.success?(Pa.notify({message:`Applied behavior to ${La.value.length} students`,color:"positive",position:"top"}),await cl(),La.value=[]):Pa.notify({message:a.error||"Failed to apply behavior",color:"negative",position:"top"})}catch(a){console.error("Error applying behavior:",a),Pa.notify({message:a.message||"Error applying behavior",color:"negative",position:"top"})}finally{Ya.value=!1}}async function gl(e,a){const l=void 0===Wa.value[e]||Wa.value[e],t="boolean"==typeof a?a:!l;if(!1===t){const a=Oa.value[e];if(a&&(a.points_plus>0||a.points_minus>0))return void Pa.dialog({title:"Warning",message:`This student has ${a.points_plus} positive and ${a.points_minus} negative points for this session. Marking them absent will remove all their points for this session. Continue?`,cancel:!0,persistent:!0,ok:{label:"Yes, Mark Absent",color:"negative"},cancel:{label:"Cancel",color:"grey"}}).onOk(async()=>{await bl(e,t,l)})}await bl(e,t,l)}async function bl(e,a,l){Wa.value[e]=a,Ga.value[e]=!0;try{const l=await L.updateAttendance(e,a,{date:Na.value,periodCode:sl.value,classroomId:Ta.value});if(!l.success)throw new Error(l.error||"Failed to update attendance");Pa.notify({message:l.message||"Attendance updated",color:"positive",position:"top"}),!1===a&&await cl()}catch(t){console.error("Failed to persist attendance for",e,t),Wa.value[e]=l,Pa.notify({message:"Failed to update attendance. Reverted.",color:"negative",position:"top"})}finally{Ga.value[e]=!1}}async function fl(){Ha.value=!0;const e={};for(const l of Ia.value)e[l.id]=!0,Wa.value[l.id]=!0;try{(await L.batchUpdateAttendance(e,{date:Na.value,periodCode:sl.value,classroomId:Ta.value})).success&&Pa.notify({message:"All students marked present",color:"positive",position:"top"})}catch(a){console.error("Failed to mark all present:",a),Pa.notify({message:"Failed to mark all present",color:"negative",position:"top"})}finally{Ha.value=!1}}async function xl(){Ha.value=!0;const e={};for(const l of Ia.value)e[l.id]=!1,Wa.value[l.id]=!1;try{(await L.batchUpdateAttendance(e,{date:Na.value,periodCode:sl.value,classroomId:Ta.value})).success&&Pa.notify({message:"All students marked absent",color:"warning",position:"top"})}catch(a){console.error("Failed to mark all absent:",a),Pa.notify({message:"Failed to mark all absent",color:"negative",position:"top"})}finally{Ha.value=!1}}async function yl(){Xa.value=!0;try{const e=await L.getRecentActions({classroomId:Ta.value,date:Na.value,limit:10});e.success?Ka.value=e.data:console.error("Failed to load history:",e.error)}catch(e){console.error("Error loading history:",e)}finally{Xa.value=!1}}function hl(e){if(!e)return"";return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}return C(async()=>{try{console.log("ðŸš€ Initializing reward system...");const e=await S.get("/my_classes_with_students");Qa.value=e.data,console.log(`âœ… Loaded ${Qa.value.length} classrooms`);const a=await L.fetchBehaviors();a.success?(za.value=a.data,console.log(`âœ… Loaded ${za.value.length} behaviors`),console.log("ðŸ“‹ Behaviors data:",za.value),za.value=za.value.map(e=>({...e,value:e.value||e.points||0})),console.log("ðŸ“‹ Normalized behaviors:",za.value)):(console.error("âŒ Failed to load behaviors:",a.error),Pa.notify({message:"Failed to load behaviors: "+a.error,color:"negative",position:"top"})),console.log("âœ… Reward system initialized")}catch(e){console.error("âŒ Failed to initialize reward system:",e),Pa.notify({message:"Failed to initialize reward system: "+e.message,color:"negative",position:"top"})}}),(e,a)=>(U(),V("div",q,[A(o,{class:"shadow-lg rounded-2xl overflow-hidden"},{default:z(()=>[A(l,{class:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white"},{default:z(()=>a[18]||(a[18]=[Q("h1",{class:"text-3xl font-bold"},"ðŸ† Reward System",-1),Q("p",{class:"text-blue-100"},"Manage student behaviors and track achievements",-1)])),_:1}),A(l,{class:"p-6 space-y-4"},{default:z(()=>{var e;return[Q("div",J,[Q("div",Y,[Q("div",H,[A(t,{name:"event_note",size:"md"})]),Q("div",null,[a[20]||(a[20]=Q("div",{class:"text-sm text-gray-500 font-medium"},"Current Session",-1)),Q("div",X,[Ta.value?(U(),V("span",Z,T((null==(e=Qa.value.find(e=>e.classroom_id===Ta.value))?void 0:e.classroom_name)||"Unknown Class"),1)):(U(),V("span",ee,"No classroom selected")),a[19]||(a[19]=Q("span",{class:"text-gray-300"},"|",-1)),Q("span",ae,T(sl.value),1)]),Q("div",le,T(new Date(Na.value).toLocaleDateString())+" â€¢ Period "+T(Da.value),1)])]),A(s,{color:"primary",icon:"settings",label:"Setup Session",onClick:a[0]||(a[0]=e=>ll.value=!0),size:"lg",class:"shadow-md"})])]}),_:1})]),_:1}),A(i,{modelValue:ll.value,"onUpdate:modelValue":a[8]||(a[8]=e=>ll.value=e),"full-width":"","full-height":""},{default:z(()=>[A(o,{class:"flex flex-col bg-gray-50"},{default:z(()=>[A(g,{class:"bg-white border-b border-gray-200 p-4"},{default:z(()=>[A(b,{class:"text-xl font-bold text-gray-800 flex items-center gap-2"},{default:z(()=>[A(t,{name:"settings_suggest",color:"primary"}),a[21]||(a[21]=F(" Session Setup "))]),_:1}),N(A(s,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),A(l,{class:"flex-1 overflow-auto p-6"},{default:z(()=>[Q("div",te,[Q("div",se,[Q("h3",oe,[A(t,{name:"schedule",class:"text-blue-500"}),a[22]||(a[22]=F(" Time & Period "))]),A(O,{date:Na.value,semester:$a.value,week:Ra.value,day:Ea.value,"period-number":Da.value,"onUpdate:date":a[1]||(a[1]=e=>Na.value=e),"onUpdate:semester":a[2]||(a[2]=e=>$a.value=e),"onUpdate:week":a[3]||(a[3]=e=>Ra.value=e),"onUpdate:day":a[4]||(a[4]=e=>Ea.value=e),"onUpdate:periodNumber":a[5]||(a[5]=e=>Da.value=e),onChange:nl,persist:!0,persistKey:"reward-system-period-selection"},null,8,["date","semester","week","day","period-number"]),Q("div",ie,[Q("p",ne,[a[23]||(a[23]=F(" Active Period Code: ")),Q("span",de,T(sl.value),1)])])]),Q("div",re,[Q("h3",ue,[A(t,{name:"school",class:"text-blue-500"}),a[24]||(a[24]=F(" Classroom "))]),A(W,{modelValue:Ta.value,"onUpdate:modelValue":a[6]||(a[6]=e=>Ta.value=e),classrooms:Qa.value,loading:Ja.value,"init-status":al.value,"avatar-edit-enabled":tl.value,"onUpdate:avatarEditEnabled":a[7]||(a[7]=e=>tl.value=e),onChange:ul,onInit:cl},null,8,["modelValue","classrooms","loading","init-status","avatar-edit-enabled"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Ia.value.length?(U(),V("div",ce,[A(o,{class:"shadow-lg rounded-2xl"},{default:z(()=>[A(l,{class:"p-4"},{default:z(()=>[Q("div",ve,[a[27]||(a[27]=Q("h3",{class:"text-xl font-bold"},"Quick Actions",-1)),Q("div",pe,[a[25]||(a[25]=F(" Selected: ")),Q("strong",me,T(La.value.length),1),a[26]||(a[26]=F(" students "))])]),Q("div",ge,[Q("div",be,[A(f,{modelValue:Ma.value,"onUpdate:modelValue":a[9]||(a[9]=e=>Ma.value=e),options:ol.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:"+ Behavior","emit-value":"","map-options":"",class:"flex-1"},null,8,["modelValue","options"]),A(s,{color:"positive",icon:"add_circle",onClick:vl,disable:!La.value.length||!Ma.value,loading:Ya.value},null,8,["disable","loading"])]),Q("div",fe,[A(f,{modelValue:Ba.value,"onUpdate:modelValue":a[10]||(a[10]=e=>Ba.value=e),options:il.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:"- Behavior","emit-value":"","map-options":"",class:"flex-1"},null,8,["modelValue","options"]),A(s,{color:"negative",icon:"remove_circle",onClick:pl,disable:!La.value.length||!Ba.value,loading:Ya.value},null,8,["disable","loading"])]),A(s,{color:"grey",icon:"clear",label:"Clear Selection",outline:"",onClick:rl,disable:!La.value.length},null,8,["disable"])])]),_:1})]),_:1})])):P("",!0),a[47]||(a[47]=F(" ---------------------------------------------- ")),Q("div",xe,[(U(!0),V($,null,R(Ia.value,e=>{var a,l,t,s;return U(),I(K,{key:e.id,student:e,selected:La.value.includes(e.id),"selected-id":La.value.includes(e.id)?e.id:null,"disable-behavior":!Wa.value[e.id],"avatar-edit-enabled":tl.value,"student-summary":{positive:(null==(a=Oa.value[e.id])?void 0:a.points_plus)||0,negative:(null==(l=Oa.value[e.id])?void 0:l.points_minus)||0,total:((null==(t=Oa.value[e.id])?void 0:t.points_plus)||0)-((null==(s=Oa.value[e.id])?void 0:s.points_minus)||0)},onSelect:a=>dl(e.id)},null,8,["student","selected","selected-id","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))]),Ia.value.length?(U(),I(o,{key:1,class:"shadow-lg rounded-2xl"},{default:z(()=>[A(y,{modelValue:Fa.value,"onUpdate:modelValue":a[12]||(a[12]=e=>Fa.value=e),dense:"",class:"text-grey-7","active-color":"primary","indicator-color":"primary",align:"left"},{default:z(()=>[A(x,{name:"attendance",icon:"how_to_reg",label:"Attendance"}),A(x,{name:"positive",icon:"add_circle",label:"+ Points"}),A(x,{name:"negative",icon:"remove_circle",label:"- Points"}),A(x,{name:"history",icon:"cancel",label:"Cancel"}),A(x,{name:"champions",icon:"emoji_events",label:"Champions",onClick:a[11]||(a[11]=e=>qa.value=!0)})]),_:1},8,["modelValue"]),A(n),A(_,{modelValue:Fa.value,"onUpdate:modelValue":a[16]||(a[16]=e=>Fa.value=e),animated:""},{default:z(()=>[A(h,{name:"attendance"},{default:z(()=>[Q("div",ye,[Q("div",he,[a[28]||(a[28]=Q("h3",{class:"text-xl font-bold"},"Manage Attendance",-1)),Q("div",_e,[A(s,{color:"positive",label:"Mark All Present",onClick:fl,loading:Ha.value},null,8,["loading"]),A(s,{color:"warning",label:"Mark All Absent",onClick:xl,loading:Ha.value},null,8,["loading"])])]),Q("div",we,[(U(!0),V($,null,R(Ia.value,e=>{var l,t,s,o,i;return U(),V("div",{key:e.id,class:M(["p-4 border-2 rounded-lg transition cursor-pointer",(i=e.id,Wa.value[i]?"bg-green-50 border-green-300":"bg-red-50 border-red-300 opacity-60")]),onClick:a=>gl(e.id)},[Q("div",je,[Q("div",Ce,[Q("p",Se,T(e.name),1),Q("p",Ve,"ID: "+T(e.id),1)]),A(p,{"model-value":Wa.value[e.id],"onUpdate:modelValue":a=>gl(e.id,a),color:Wa.value[e.id]?"positive":"negative",disable:Ga.value[e.id],size:"lg",onClick:a[13]||(a[13]=B(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue","color","disable"])]),Q("p",Ue,T(Wa.value[e.id]?"âœ… Present":"âŒ Absent"),1),Q("div",Ae,[Q("div",Pe,[a[29]||(a[29]=Q("span",{class:"text-xs font-semibold text-green-800"},"Positive",-1)),Q("span",Fe,"+"+T((null==(l=Oa.value[e.id])?void 0:l.points_plus)||0)+" â­",1)]),Q("div",Qe,[a[30]||(a[30]=Q("span",{class:"text-xs font-semibold text-red-800"},"Negative",-1)),Q("span",Ie,"-"+T((null==(t=Oa.value[e.id])?void 0:t.points_minus)||0)+" âš ï¸",1)]),Q("div",ze,[a[31]||(a[31]=Q("span",{class:"text-xs font-semibold text-blue-800"},"Total",-1)),Q("span",Te,T(((null==(s=Oa.value[e.id])?void 0:s.points_plus)||0)-((null==(o=Oa.value[e.id])?void 0:o.points_minus)||0)),1)])])],10,ke)}),128))])])]),_:1}),A(h,{name:"positive"},{default:z(()=>[Q("div",Ne,[a[37]||(a[37]=Q("div",{class:"mb-4"},[Q("h3",{class:"text-xl font-bold mb-2"},"Add Positive Points"),Q("p",{class:"text-sm text-gray-600"},"Select students and choose a positive behavior")],-1)),Q("div",$e,[Q("div",Re,[A(f,{modelValue:Ma.value,"onUpdate:modelValue":a[14]||(a[14]=e=>Ma.value=e),options:ol.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:"Select positive behavior","emit-value":"","map-options":""},{option:z(e=>[A(d,E(D(e.itemProps)),{default:z(()=>[A(r,null,{default:z(()=>[A(u,null,{default:z(()=>[F(T(e.opt.name),1)]),_:2},1024),A(u,{caption:""},{default:z(()=>[F("+"+T(e.opt.value||e.opt.points||0)+" points",1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),A(s,{color:"positive",icon:"add_circle",label:"Apply to Selected",onClick:vl,disable:!La.value.length||!Ma.value,loading:Ya.value},null,8,["disable","loading"])]),Q("div",Ee,[a[32]||(a[32]=F("Selected: ")),Q("strong",null,T(La.value.length),1),a[33]||(a[33]=F(" students"))])]),Q("div",De,[(U(!0),V($,null,R(Ia.value,e=>{var l,t,s,o;return U(),V("div",{key:e.id,class:M(["p-4 border-2 rounded-lg transition",[Wa.value[e.id]?La.value.includes(e.id)?"bg-green-100 border-green-500 cursor-pointer":"bg-white border-gray-200 cursor-pointer":"bg-gray-100 border-gray-300 opacity-50 cursor-not-allowed"]]),onClick:a=>Wa.value[e.id]&&dl(e.id)},[Q("div",Be,[Q("div",Le,[Q("p",Oe,T(e.name),1),Q("p",We,"ID: "+T(e.id),1),Wa.value[e.id]?P("",!0):(U(),V("p",Ge,"âŒ Absent"))]),A(m,{"model-value":La.value.includes(e.id),"onUpdate:modelValue":a=>dl(e.id),disable:!Wa.value[e.id],color:"positive",size:"lg"},null,8,["model-value","onUpdate:modelValue","disable"])]),Q("div",Ke,[Q("div",qe,[a[34]||(a[34]=Q("span",{class:"text-xs font-semibold text-green-800"},"Positive",-1)),Q("span",Je,"+"+T((null==(l=Oa.value[e.id])?void 0:l.points_plus)||0)+" â­",1)]),Q("div",Ye,[a[35]||(a[35]=Q("span",{class:"text-xs font-semibold text-red-800"},"Negative",-1)),Q("span",He,"-"+T((null==(t=Oa.value[e.id])?void 0:t.points_minus)||0)+" âš ï¸",1)]),Q("div",Xe,[a[36]||(a[36]=Q("span",{class:"text-xs font-semibold text-blue-800"},"Total",-1)),Q("span",Ze,T(((null==(s=Oa.value[e.id])?void 0:s.points_plus)||0)-((null==(o=Oa.value[e.id])?void 0:o.points_minus)||0)),1)])])],10,Me)}),128))])])]),_:1}),A(h,{name:"negative"},{default:z(()=>[Q("div",ea,[a[43]||(a[43]=Q("div",{class:"mb-4"},[Q("h3",{class:"text-xl font-bold mb-2"},"Deduct Points"),Q("p",{class:"text-sm text-gray-600"},"Select students and choose a negative behavior")],-1)),Q("div",aa,[Q("div",la,[A(f,{modelValue:Ba.value,"onUpdate:modelValue":a[15]||(a[15]=e=>Ba.value=e),options:il.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:"Select negative behavior","emit-value":"","map-options":""},{option:z(e=>[A(d,E(D(e.itemProps)),{default:z(()=>[A(r,null,{default:z(()=>[A(u,null,{default:z(()=>[F(T(e.opt.name),1)]),_:2},1024),A(u,{caption:""},{default:z(()=>[F(T(e.opt.value||e.opt.points||0)+" points",1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),A(s,{color:"negative",icon:"remove_circle",label:"Apply to Selected",onClick:pl,disable:!La.value.length||!Ba.value,loading:Ya.value},null,8,["disable","loading"])]),Q("div",ta,[a[38]||(a[38]=F("Selected: ")),Q("strong",null,T(La.value.length),1),a[39]||(a[39]=F(" students"))])]),Q("div",sa,[(U(!0),V($,null,R(Ia.value,e=>{var l,t,s,o;return U(),V("div",{key:e.id,class:M(["p-4 border-2 rounded-lg transition",[Wa.value[e.id]?La.value.includes(e.id)?"bg-red-100 border-red-500 cursor-pointer":"bg-white border-gray-200 cursor-pointer":"bg-gray-100 border-gray-300 opacity-50 cursor-not-allowed"]]),onClick:a=>Wa.value[e.id]&&dl(e.id)},[Q("div",ia,[Q("div",na,[Q("p",da,T(e.name),1),Q("p",ra,"ID: "+T(e.id),1),Wa.value[e.id]?P("",!0):(U(),V("p",ua,"âŒ Absent"))]),A(m,{"model-value":La.value.includes(e.id),"onUpdate:modelValue":a=>dl(e.id),disable:!Wa.value[e.id],color:"negative",size:"lg"},null,8,["model-value","onUpdate:modelValue","disable"])]),Q("div",ca,[Q("div",va,[a[40]||(a[40]=Q("span",{class:"text-xs font-semibold text-green-800"},"Positive",-1)),Q("span",pa,"+"+T((null==(l=Oa.value[e.id])?void 0:l.points_plus)||0)+" â­",1)]),Q("div",ma,[a[41]||(a[41]=Q("span",{class:"text-xs font-semibold text-red-800"},"Negative",-1)),Q("span",ga,"-"+T((null==(t=Oa.value[e.id])?void 0:t.points_minus)||0)+" âš ï¸",1)]),Q("div",ba,[a[42]||(a[42]=Q("span",{class:"text-xs font-semibold text-blue-800"},"Total",-1)),Q("span",fa,T(((null==(s=Oa.value[e.id])?void 0:s.points_plus)||0)-((null==(o=Oa.value[e.id])?void 0:o.points_minus)||0)),1)])])],10,oa)}),128))])])]),_:1}),A(h,{name:"history"},{default:z(()=>[Q("div",xa,[Q("div",ya,[a[44]||(a[44]=Q("h3",{class:"text-xl font-bold"},"Recent Actions",-1)),A(s,{color:"primary",icon:"refresh",label:"Refresh",onClick:yl,loading:Xa.value},null,8,["loading"])]),Ka.value.length?P("",!0):(U(),V("div",ha,a[45]||(a[45]=[Q("p",{class:"text-gray-500 text-lg"},"No recent actions",-1)]))),(U(!0),V($,null,R(Ka.value,e=>{var a,l,t,o;return U(),V("div",{key:e.id,class:M(["p-4 bg-white rounded-lg border-l-4",[e.canceled?"border-gray-400 opacity-60":e.value>0?"border-green-500":"border-red-500"]])},[Q("div",_a,[Q("div",wa,[Q("div",ka,[Q("span",ja,T((null==(l=null==(a=e.student_behavior)?void 0:a.student)?void 0:l.name)||"Unknown"),1),Q("span",Ca,T(e.value>0?"â­":"âš ï¸"),1)]),Q("p",Sa,[Q("strong",null,T((null==(t=e.behavior)?void 0:t.name)||"Unknown Behavior"),1),Q("span",{class:M(e.value>0?"text-green-600":"text-red-600")}," ("+T(e.value>0?"+":"")+T(e.value)+" points) ",3)]),Q("p",Va,T(hl(e.created_at))+" by "+T((null==(o=e.created_by)?void 0:o.name)||"Unknown"),1),e.note?(U(),V("p",Ua,"Note: "+T(e.note),1)):P("",!0),e.canceled?(U(),V("p",Aa," âŒ Canceled: "+T(e.cancel_reason)+" ("+T(hl(e.canceled_at))+") ",1)):P("",!0)]),e.canceled?P("",!0):(U(),I(s,{key:0,color:"warning",icon:"undo",label:"Undo",size:"sm",onClick:a=>async function(e){Za.value=e;try{const a=await L.undoAction(e,"Undone by teacher");a.success?(Pa.notify({message:"Action undone successfully",color:"positive",position:"top"}),await yl(),await cl()):Pa.notify({message:a.error||"Failed to undo action",color:"negative",position:"top"})}catch(a){console.error("Error undoing action:",a),Pa.notify({message:"Error undoing action",color:"negative",position:"top"})}finally{Za.value=null}}(e.id),loading:Za.value===e.id},null,8,["onClick","loading"]))])],2)}),128))])]),_:1})]),_:1},8,["modelValue"])]),_:1})):P("",!0),Ia.value.length?P("",!0):(U(),I(o,{key:2,class:"shadow-lg rounded-2xl"},{default:z(()=>[A(l,{class:"text-center py-12"},{default:z(()=>a[46]||(a[46]=[Q("p",{class:"text-2xl font-semibold text-gray-600"},'ðŸ“š Select a classroom and click "Init Session" to get started',-1)])),_:1})]),_:1})),A(i,{modelValue:qa.value,"onUpdate:modelValue":a[17]||(a[17]=e=>qa.value=e),maximized:""},{default:z(()=>[A(o,null,{default:z(()=>[A(l,{class:"p-0"},{default:z(()=>[A(G,{students:Ia.value,"student-behaviors":Oa.value},null,8,["students","student-behaviors"])]),_:1}),A(c,{align:"right"},{default:z(()=>[N(A(s,{flat:"",label:"Close",color:"primary"},null,512),[[v]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-a7e21855"]]);export{Pa as default};
