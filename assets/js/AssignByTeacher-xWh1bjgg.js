import{p as e,u as s,n as a,d as l,Q as t,a as r,g as o,e as c,A as i,C as n}from"./app-DXXarK7I.js";import{Q as u}from"./QTd-DaKXGNl2.js";import{Q as d}from"./QTable-CIXbyzJI.js";import{f as m,a as v,L as p,I as g,b as h,y as f,a3 as b,J as y,M as _,H as w,O as x,F as C,Q as j,S as q,V as k,U as A,_ as S}from"./vendor-EI0FRBVb.js";import{_ as L}from"./AppLayout-CE2yjlSr.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./QMarkupTable-BVGvqYSu.js";import"./QSelect-OI6RFhnT.js";import"./rtl-Cr6c3OOr.js";import"./QLinearProgress-BEkk-xFg.js";import"./use-fullscreen-DIOkwRkq.js";const T={class:"q-pa-md"},V={class:"row items-center justify-between"},Q={class:"q-gutter-sm"},U={class:"row q-col-gutter-md"},z={class:"col-12 col-md-6"},F={class:"row q-col-gutter-md q-mt-md"},N={class:"row items-center q-gutter-md"},P={class:"col"},$={class:"text-h6 text-primary"},M={class:"text-caption text-grey-7"},O={class:"text-caption text-grey-7"},R={class:"q-mt-sm"},B={class:"text-h6 q-mb-md"},D={key:0,class:"q-mb-md"},E={class:"row q-col-gutter-sm"},I={class:"row q-col-gutter-md q-mb-md"},H={class:"col-12 col-md-6"},J={class:"text-subtitle2"},G={class:"text-caption text-grey-7"},K={class:"q-mt-md"},W={class:"row justify-end q-gutter-sm q-mt-md"},X=e({__name:"AssignByTeacher",props:{teachers:{type:Array,required:!0},courses:{type:Array,required:!0}},setup(e){const X=e,Y=s(),Z=m(""),ee=m(""),se=m(null),ae=m([]),le=m(""),te=m(!1),re=[{name:"name",label:"Course",field:"name",align:"left",sortable:!0},{name:"levels",label:"Levels",field:"levels",align:"center"},{name:"teachers",label:"Teachers",field:"teachers",align:"center"},{name:"created_at",label:"Created",field:"created_at",align:"left",sortable:!0}],oe=v(()=>{if(!Z.value)return X.teachers;const e=Z.value.toLowerCase();return X.teachers.filter(s=>{var a;return s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e)||(null==(a=s.subject)?void 0:a.toLowerCase().includes(e))})}),ce=v(()=>se.value&&se.value.course_assignments||[]),ie=v(()=>{if(!se.value)return X.courses;const e=ce.value.map(e=>e.course.id);return X.courses.filter(s=>!e.includes(s.id))}),ne=()=>{ae.value=[],le.value=""},ue=()=>{if(0===ae.value.length)return void Y.notify({type:"warning",message:"Please select at least one course.",icon:"warning"});te.value=!0;const e={teacher_id:se.value.id,course_ids:ae.value.map(e=>e.id),notes:le.value};S.post(route("course-management.teachers.assign-courses-to-teacher"),e,{onSuccess:()=>{Y.notify({type:"positive",message:`${ae.value.length} course(s) assigned to teacher successfully!`,icon:"check_circle"}),ae.value=[],le.value="",S.reload()},onError:e=>{Y.notify({type:"negative",message:"Failed to assign courses to teacher.",caption:Object.values(e).join(" "),icon:"error"})},onFinish:()=>{te.value=!1}})};return(e,s)=>(g(),p(C,null,[h(f(b),{title:"Assign Courses to Teacher"}),h(L,{title:"Assign Courses to Teacher"},{default:y(()=>[_("div",T,[h(a,{flat:"",bordered:""},{default:y(()=>[h(l,null,{default:y(()=>[_("div",V,[s[6]||(s[6]=_("div",null,[_("div",{class:"text-h6"},"Assign Courses to Teacher"),_("div",{class:"text-subtitle2"},"Select a teacher and assign multiple courses to them")],-1)),_("div",Q,[h(t,{flat:"",color:"grey-7",icon:"arrow_back",label:"Back to Assignments",onClick:s[0]||(s[0]=s=>e.$inertia.visit(e.route("course-management.teachers.index")))}),h(t,{flat:"",color:"primary",icon:"school",label:"Assign by Course",onClick:s[1]||(s[1]=s=>e.$inertia.visit(e.route("course-management.teachers.assign-by-course")))})])])]),_:1}),h(r),h(l,null,{default:y(()=>[s[7]||(s[7]=_("div",{class:"text-h6 q-mb-md"},"Step 1: Select Teacher",-1)),_("div",U,[_("div",z,[h(o,{modelValue:Z.value,"onUpdate:modelValue":s[2]||(s[2]=e=>Z.value=e),outlined:"",dense:"",placeholder:"Search teachers...",clearable:""},{prepend:y(()=>[h(c,{name:"search"})]),_:1},8,["modelValue"])])]),_("div",F,[(g(!0),p(C,null,j(oe.value,e=>{var s;return g(),p("div",{key:e.id,class:"col-12 col-sm-6 col-md-4"},[h(a,{flat:"",bordered:"",class:q(["cursor-pointer teacher-card",{"bg-orange-1 border-orange":(null==(s=se.value)?void 0:s.id)===e.id}]),onClick:s=>(e=>{se.value=e,ae.value=[],le.value=""})(e)},{default:y(()=>[h(l,null,{default:y(()=>[_("div",N,[h(i,{size:"48px",color:"primary","text-color":"white"},{default:y(()=>{return[k(A((s=e.name,s?s.split(" ").map(e=>e.charAt(0)).join("").toUpperCase():"?")),1)];var s}),_:2},1024),_("div",P,[_("div",$,A(e.name),1),_("div",M,A(e.email),1),_("div",O,A(e.phone||"No phone"),1)])]),_("div",R,[h(n,{size:"sm",color:"orange-1","text-color":"orange-8",icon:"school"},{default:y(()=>{var s;return[k(A((null==(s=e.course_assignments)?void 0:s.length)||0)+" Courses ",1)]}),_:2},1024),h(n,{size:"sm",color:"blue-1","text-color":"blue-8",icon:"subject",class:"q-ml-xs"},{default:y(()=>[k(A(e.subject||"No subject"),1)]),_:2},1024)])]),_:2},1024)]),_:2},1032,["class","onClick"])])}),128))])]),_:1}),se.value?(g(),w(l,{key:0},{default:y(()=>[_("div",B,"Step 2: Select Courses for "+A(se.value.name),1),ce.value.length>0?(g(),p("div",D,[s[8]||(s[8]=_("div",{class:"text-subtitle1 q-mb-sm"},"Currently Assigned Courses:",-1)),_("div",E,[(g(!0),p(C,null,j(ce.value,e=>(g(),p("div",{key:e.course.id,class:"col-auto"},[h(n,{color:"orange","text-color":"white",icon:"school",removable:"",onRemove:s=>{return a=e,void S.delete(route("course-management.teachers.remove-assignment-by-ids"),{teacher_id:se.value.id,course_id:a.id},{onSuccess:()=>{Y.notify({type:"positive",message:"Course removed from teacher successfully.",icon:"check_circle"})},onError:()=>{Y.notify({type:"negative",message:"Failed to remove course from teacher.",icon:"error"})}});var a}},{default:y(()=>[k(A(e.course.name),1)]),_:2},1032,["onRemove"])]))),128))])])):x("",!0),_("div",I,[_("div",H,[h(o,{modelValue:ee.value,"onUpdate:modelValue":s[3]||(s[3]=e=>ee.value=e),outlined:"",dense:"",placeholder:"Search courses...",clearable:""},{prepend:y(()=>[h(c,{name:"search"})]),_:1},8,["modelValue"])])]),h(d,{rows:ie.value,columns:re,"row-key":"id",selection:"multiple",selected:ae.value,"onUpdate:selected":s[4]||(s[4]=e=>ae.value=e),flat:"",bordered:"",pagination:{rowsPerPage:10},filter:ee.value},{"body-cell-name":y(e=>[h(u,{props:e},{default:y(()=>[_("div",null,[_("div",J,A(e.row.name),1),_("div",G,A(e.row.description||"No description"),1)])]),_:2},1032,["props"])]),"body-cell-levels":y(e=>[h(u,{props:e},{default:y(()=>[h(n,{size:"sm",color:"blue-1","text-color":"blue-8",icon:"layers"},{default:y(()=>{var s;return[k(A((null==(s=e.row.levels)?void 0:s.length)||0)+" Levels ",1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-teachers":y(e=>[h(u,{props:e},{default:y(()=>[h(n,{size:"sm",color:"green-1","text-color":"green-8",icon:"person"},{default:y(()=>{var s;return[k(A((null==(s=e.row.teacher_assignments)?void 0:s.length)||0)+" Teachers ",1)]}),_:2},1024)]),_:2},1032,["props"])]),"body-cell-created_at":y(e=>[h(u,{props:e},{default:y(()=>{return[k(A((s=e.row.created_at,new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))),1)];var s}),_:2},1032,["props"])]),_:1},8,["rows","selected","filter"]),_("div",K,[h(o,{modelValue:le.value,"onUpdate:modelValue":s[5]||(s[5]=e=>le.value=e),outlined:"",type:"textarea",rows:"3",label:"Assignment Notes (Optional)",placeholder:"Add any notes about this assignment..."},null,8,["modelValue"])]),_("div",W,[h(t,{flat:"",label:"Clear Selection",color:"grey-7",onClick:ne}),h(t,{color:"primary",icon:"school",label:"Assign Courses",disable:0===ae.value.length,loading:te.value,onClick:ue},null,8,["disable","loading"])])]),_:1})):x("",!0)]),_:1})])]),_:1})],64))}},[["__scopeId","data-v-5e2af78b"]]);export{X as default};
