import{f as e,L as a,I as l,M as s,b as o,x as u,aa as t,F as d,Q as i,U as r,J as n,V as v,Z as c}from"./vendor-CUZ9QTQV.js";import{_ as m}from"./PrimaryButton-DNYxrPcC.js";const g={class:"flex space-x-4"},p={class:"w-48"},b=["value"],f={class:"w-48"},y=["disabled"],h=["value"],w={class:"w-48"},x=["disabled"],k=["value"],_={class:"w-48"},S=["disabled"],C=["value"],F={__name:"StudentFilters",props:{schools:{type:Array,required:!0,default:()=>[]}},emits:["filter-applied"],setup(F,{emit:U}){const V=U,$=e([]),E=e([]),j=e([]),A=e(""),P=e(""),q=e(""),B=e(""),G=e(!1),I=async()=>{P.value="",q.value="",B.value="",$.value=[],E.value=[],j.value=[],G.value=!1,A.value&&(Q(A.value),await z(A.value,"school"),G.value=!0)},J=async()=>{q.value="",B.value="",E.value=[],G.value=!0,P.value?(await Z(P.value),await z(P.value,"stage")):A.value?await z(A.value,"school"):j.value=[]},L=async()=>{B.value="",G.value=!0,q.value?await z(q.value,"grade"):P.value?await z(P.value,"stage"):A.value?await z(A.value,"school"):j.value=[]},M=()=>{G.value=!0},Q=e=>{c.get(`/admin/stages/by-school/${e}`).then(e=>{$.value=e.data}).catch(e=>{var a,l;console.error("Error loading stages:",e),$.value=[],(null==(l=null==(a=e.response)?void 0:a.data)?void 0:l.message)?alert(e.response.data.message):alert("Failed to load stages")})},Z=async e=>{try{const a=await c.get(`/admin/grades/by-stage/${e}`);E.value=a.data}catch(a){console.error("Error loading grades:",a),E.value=[]}},z=async(e,a)=>{try{let l="";"school"===a?l=`/admin/classrooms/by-school/${e}`:"stage"===a?l=`/admin/classrooms/by-stage/${e}`:"grade"===a&&(l=`/admin/classrooms/by-grade/${e}`);const s=await c.get(l);j.value=s.data}catch(l){console.error("Error loading classrooms:",l),j.value=[]}},D=()=>{if(!A.value)return void alert("Please select a school first");const e={school_id:A.value,stage_id:P.value,grade_id:q.value,classroom_id:B.value};V("filter-applied",e)};return(e,c)=>(l(),a("div",g,[s("div",p,[u(s("select",{"onUpdate:modelValue":c[0]||(c[0]=e=>A.value=e),onChange:I,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},[c[4]||(c[4]=s("option",{value:""},"Select School",-1)),(l(!0),a(d,null,i(F.schools,e=>(l(),a("option",{key:e.id,value:e.id},r(e.name),9,b))),128))],544),[[t,A.value]])]),s("div",f,[u(s("select",{"onUpdate:modelValue":c[1]||(c[1]=e=>P.value=e),onChange:J,disabled:!A.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},[c[5]||(c[5]=s("option",{value:""},"Select Stage",-1)),(l(!0),a(d,null,i($.value,e=>(l(),a("option",{key:e.id,value:e.id},r(e.name),9,h))),128))],40,y),[[t,P.value]])]),s("div",w,[u(s("select",{"onUpdate:modelValue":c[2]||(c[2]=e=>q.value=e),onChange:L,disabled:!P.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},[c[6]||(c[6]=s("option",{value:""},"Select Grade",-1)),(l(!0),a(d,null,i(E.value,e=>(l(),a("option",{key:e.id,value:e.id},r(e.name),9,k))),128))],40,x),[[t,q.value]])]),s("div",_,[u(s("select",{"onUpdate:modelValue":c[3]||(c[3]=e=>B.value=e),onChange:M,disabled:!A.value,class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},[c[7]||(c[7]=s("option",{value:""},"Select Classroom",-1)),(l(!0),a(d,null,i(j.value,e=>(l(),a("option",{key:e.id,value:e.id},r(e.name),9,C))),128))],40,S),[[t,B.value]])]),o(m,{onClick:D,disabled:!G.value,class:"h-full"},{default:n(()=>c[8]||(c[8]=[v(" Apply Filters ")])),_:1},8,["disabled"])]))}};export{F as default};
