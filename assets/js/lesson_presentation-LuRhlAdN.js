import{D as e,as as t,K as n,aj as l,Q as a,o as s,u as o,A as i,d as r,f as d,m as c,c as u,b as p,p as m,l as v,aP as f,C as g,B as b,k as y,a as h,aF as x}from"./app-BwCflFkV.js";import{f as _,a as w,n as S,p as k,h as j,H as C,I as q,J as I,b as T,M as L,L as P,Q as E,y as O,F as U,U as V,V as A,x as Q,O as $,R as N,S as z,k as R,o as D,z as M,ae as F,a1 as G,A as B,am as H,Z as J}from"./vendor-CUZ9QTQV.js";import{Q as W}from"./QBadge-CShv2hr3.js";import{Q as K,a as Y}from"./QToolbar-DYAggbbc.js";import{Q as X}from"./QHeader-DoDuKqws.js";import{Q as Z}from"./QDrawer-Fa5lB7ME.js";import{Q as ee}from"./QSelect-Cyosk05W.js";import{Q as te}from"./QPage-C0ie96_6.js";import{Q as ne}from"./QPageContainer-B5jqF1te.js";import{Q as le}from"./QLayout-D7wSZYOa.js";import{Q as ae}from"./QSpace-CtVAwmqA.js";import se from"./TextSlide-DWhDAchf.js";import oe from"./MediaSlide-DgHNKC8p.js";import{Q as ie}from"./QuestionSlide-BmlDXeV-.js";import re from"./PDFSlide-uCFAarRu.js";import de from"./VideoSlide-C0GSHeik.js";import ce from"./LessonSidebar-xmVftyD5.js";import ue from"./LessonPlayer-BN58U_5C.js";import pe from"./FingerDrawingSlide-1-_ndAXq.js";import{Q as me,a as ve}from"./QStepper-lAHFGRsC.js";import{u as fe}from"./teacherStore-DrPGRQaY.js";import"./offline-BzIlwqNM.js";import"./i18n-CP46N9fu.js";import"./ui-LrZmvB2D.js";import"./rtl-Cr6c3OOr.js";import"./RichTextEditor-DB-s0F5v.js";import"./QColor-CmDqgPG_.js";import"./QSlider-DTH_vv2V.js";import"./QTabs-DEEJZhkK.js";import"./QTab-DaEQqAL1.js";import"./QTabPanels-BUOq7-x1.js";import"./use-panel-BLnXhVTM.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanel-Do4XKmfC.js";import"./purify.es-C2Ba6vpb.js";import"./MathEditor-DobPOPic.js";import"./katex-BXKQVcz-.js";import"./MathPastePreview-LN00eGSK.js";import"./EnhancedQuestionEditor-CorSFRnf.js";import"./QuestionEditor-CASd5EYN.js";import"./StepByStepEditor-C4sJFPI4.js";import"./QuestionTypeSelector-sCdA1GB7.js";import"./QuizEngine-Bz9HPnPW.js";import"./useQuizI18n-RdF52uR0.js";import"./QLinearProgress-BKKQOFX1.js";import"./QSpinnerDots-CdUqmAKQ.js";import"./PlayerSidebar-VQRUL3go.js";import"./SectionCard-BDQcphN1.js";import"./SectionBanner-C1lO0IdY.js";import"./SlideRenderer-BOsIU47n.js";import"./QPopupProxy-CUxsJkoO.js";import"./NavigationFooter-DKQ70BHd.js";import"./DrawingOverlay-BuJsU6H0.js";import"./DrawingCanvas-DfkutSlv.js";import"./DrawingToolbar-CqyFrwz7.js";import"./QBtnToggle-jUeIyLRJ.js";import"./SlideAnnotationOverlay-C0Az0-T9.js";function ge(e,t=new WeakMap){if(Object(e)!==e)return e;if(t.has(e))return t.get(e);const n=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:"function"!=typeof e.constructor?Object.create(null):void 0!==e.prototype&&"function"==typeof e.prototype.constructor?e:new e.constructor;if("function"==typeof e.constructor&&"function"==typeof e.valueOf){const n=e.valueOf();if(Object(n)!==n){const l=new e.constructor(n);return t.set(e,l),l}}return t.set(e,n),e instanceof Set?e.forEach(e=>{n.add(ge(e,t))}):e instanceof Map&&e.forEach((e,l)=>{n.set(l,ge(e,t))}),Object.assign(n,...Object.keys(e).map(n=>({[n]:ge(e[n],t)})))}const be=e({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:s,emit:o}){const{proxy:i}=k(),{$q:r}=i,d=_(null),c=_(""),u=_("");let p=!1;const m=w(()=>t({initialValue:c.value,validate:e.validate,set:v,cancel:f,updatePosition:g},"value",()=>u.value,e=>{u.value=e}));function v(){!1!==e.validate(u.value)&&(!0===b()&&(o("save",u.value,c.value),o("update:modelValue",u.value)),y())}function f(){!0===b()&&o("cancel",u.value,c.value),y()}function g(){S(()=>{d.value.updatePosition()})}function b(){return!1===n(u.value,c.value)}function y(){p=!0,d.value.hide()}function h(){p=!1,c.value=ge(e.modelValue),u.value=ge(e.modelValue),o("beforeShow")}function x(){o("show")}function C(){!1===p&&!0===b()&&(!0===e.autoSave&&!0===e.validate(u.value)?(o("save",u.value,c.value),o("update:modelValue",u.value)):o("cancel",u.value,c.value)),o("beforeHide")}function q(){o("hide")}function I(){const t=void 0!==s.default?[].concat(s.default(m.value)):[];return e.title&&t.unshift(j("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),!0===e.buttons&&t.push(j("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[j(a,{flat:!0,color:e.color,label:e.labelCancel||r.lang.label.cancel,onClick:f}),j(a,{flat:!0,color:e.color,label:e.labelSet||r.lang.label.set,onClick:v})])),t}return Object.assign(i,{set:v,cancel:f,show(e){var t;null==(t=d.value)||t.show(e)},hide(e){var t;null==(t=d.value)||t.hide(e)},updatePosition:g}),()=>{if(!0!==e.disable)return j(l,{ref:d,class:"q-popup-edit",cover:e.cover,onBeforeShow:h,onShow:x,onBeforeHide:C,onHide:q,onEscapeKey:f},I)}}});const ye=[{label:"Interactive Lesson",instructions:"Include interactive elements, questions for students, and hands-on activities in each section."},{label:"Visual Learning",instructions:"Focus on visual descriptions, diagrams explanations, and visual metaphors to explain concepts."},{label:"Step-by-Step",instructions:"Break down complex topics into simple, sequential steps. Use numbered lists and clear progression."},{label:"Real-World Examples",instructions:"Include real-world applications and practical examples that students can relate to."},{label:"Differentiated",instructions:"Provide content at multiple difficulty levels to accommodate different learning abilities."}],he={class:"z-10 w-full left-0 bg-grey-1"},xe={class:"q-pa-md",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"}},_e={class:"row items-center"},we={class:"max-w-3xl mx-auto p-6"},Se={class:"mb-6"},ke={class:"flex flex-wrap gap-2"},je={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},Ce={class:"grid grid-cols-2 gap-3 text-sm"},qe={class:"ml-2 text-blue-700"},Ie={class:"ml-2 text-blue-700"},Te={class:"col-span-2"},Le={class:"ml-2 text-blue-700"},Pe={class:"mb-4"},Ee={class:"grid grid-cols-2 gap-2"},Oe={class:"text-xl"},Ue={class:"text-sm font-medium"},Ve={class:"flex justify-end gap-2"},Ae={class:"max-w-6xl mx-auto p-6"},Qe={class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4"},$e={class:"flex items-start gap-2"},Ne={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ze={class:"flex items-center justify-between mb-2"},Re={class:"whitespace-pre-wrap text-xs font-mono"},De={class:"mt-4"},Me={class:"flex items-center justify-between mb-2"},Fe={class:"flex gap-2"},Ge={class:"flex items-center justify-between mb-2"},Be={class:"border rounded-lg overflow-hidden bg-white",style:{height:"400px"}},He=["src"],Je={key:1,class:"flex items-center justify-center h-full text-gray-400"},We={class:"text-center"},Ke={class:"flex justify-between gap-2 mt-6"},Ye={class:"mt-4"},Xe={class:"space-y-2"},Ze={class:"max-w-4xl mx-auto p-6"},et={class:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4"},tt={class:"flex items-start gap-2"},nt={class:"relative mb-4"},lt={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},at={class:"flex items-start gap-2"},st={class:"flex-1"},ot={class:"list-disc list-inside text-sm text-red-700 space-y-1"},it={class:"flex justify-between gap-2"},rt={class:"max-w-5xl mx-auto p-6"},dt={key:0,class:"space-y-4"},ct={class:"grid grid-cols-2 gap-4"},ut={class:"ml-2"},pt={class:"ml-2"},mt={class:"bg-gray-100 px-4 py-2 font-semibold flex items-center gap-2"},vt={class:"p-4 space-y-2"},ft={class:"flex-1"},gt={class:"text-xs text-gray-500 mb-1"},bt=["innerHTML"],yt={class:"flex justify-between gap-2 mt-6"},ht={class:"flex gap-2"},xt=s({__name:"AILessonPlanGenerator",props:{lessonConfig:{type:Object,required:!0}},emits:["plan-accepted","close"],setup(e,{expose:t,emit:n}){const l=o(),s=n,b=e,y=_(!1),h=_(1),x=_({customInstructions:""}),S=ye,k=_(""),j=_(!1),N=_(""),z=_(""),R=_(!1),D=[{name:"Gemini",url:"https://gemini.google.com/"},{name:"ChatGPT",url:"https://chatgpt.com/"},{name:"Claude",url:"https://claude.ai/"},{name:"Perplexity",url:"https://www.perplexity.ai/"}],M=_(""),F=_([]),G=_(null),B=_(!1),H=w(()=>G.value?G.value.sections.reduce((e,t)=>e+t.slides.length,0):0),J=e=>{N.value=e,localStorage.setItem("ai_tool_url",e),l.notify({type:"positive",message:"AI tool updated",position:"top",timeout:1500})},W=()=>{z.value.trim()&&(J(z.value.trim()),R.value=!1)},K=()=>{N.value&&window.open(N.value,"_blank")},Y=()=>{y.value=!1,s("close")},X=()=>{x.value={customInstructions:""},k.value="",M.value="",F.value=[],G.value=null},Z=()=>{k.value=function(e){const{lessonTitle:t,subject:n,grade:l,sections:a,customInstructions:s}=e;return`You are an expert educational content designer specializing in ${n} for ${l} students.\n\nCreate a comprehensive lesson plan for: "${t}"\n\nLESSON STRUCTURE:\nThe lesson has the following sections:\n${a.map(e=>`- ${e.title} (${e.id})`).join("\n")}\n\nREQUIREMENTS:\n1. Generate 3-5 slides for EACH section\n2. Each slide should have educational content appropriate for ${l} level\n3. Content should be engaging, clear, and pedagogically sound\n4. Include variety: text slides, and question slides\n5. For practice/assessment sections, include MORE question slides\n\n${(e=>{const t=e.toLowerCase();return t.includes("math")||t.includes("رياضيات")?"For Mathematics:\n- Use single_choice for concept understanding\n- Use true_false for properties and theorems\n- Include step-by-step problem solving in text slides\n- Add practice problems with multiple choice answers":t.includes("science")||t.includes("علوم")?"For Science:\n- Use single_choice for facts and concepts\n- Use true_false for scientific statements\n- Include diagrams descriptions in text slides\n- Add experiment-based questions":t.includes("language")||t.includes("لغة")?"For Language Arts:\n- Use single_choice for grammar and vocabulary\n- Use true_false for comprehension checks\n- Include reading passages in text slides\n- Add questions about text analysis":"General guidance:\n- Use single_choice for concept testing\n- Use true_false for fact checking\n- Mix question types for engagement"})(n)}\n\n${s?`CUSTOM INSTRUCTIONS:\n${s}\n`:""}\n\nOUTPUT FORMAT:\nReturn a JSON object with this EXACT structure (no markdown, no code blocks):\n\n{\n  "sections": [\n    {\n      "sectionId": "objectives",\n      "slides": [\n        {\n          "slide_type": "text",\n          "slide_content": {\n            "text": "<h2>Learning Objectives</h2><ul><li>Objective 1</li><li>Objective 2</li></ul>"\n          }\n        }\n      ]\n    },\n    {\n      "sectionId": "practice",\n      "slides": [\n        {\n          "slide_type": "question",\n          "slide_content": {\n            "questions": [\n              {\n                "id": "q_abc123",\n                "type": "single_choice",\n                "text": "What is 2 + 2?",\n                "options": [\n                  {"id": "opt_1", "text": "3"},\n                  {"id": "opt_2", "text": "4"},\n                  {"id": "opt_3", "text": "5"}\n                ],\n                "correct_answer": "opt_2",\n                "explanation": "2 + 2 equals 4",\n                "timer": 30\n              }\n            ]\n          }\n        }\n      ]\n    }\n  ]\n}\n\nSLIDE TYPES:\n1. TEXT SLIDES ("slide_type": "text"):\n   - Use for explanations, examples, and content delivery\n   - Content should be HTML formatted (use <h2>, <h3>, <p>, <ul>, <li>, <strong>, <em>)\n   - Keep content concise but informative\n\n2. QUESTION SLIDES ("slide_type": "question"):\n   - Use for practice, assessment, and engagement\n   - Each question slide can have 1-3 questions in the "questions" array\n   \n   QUESTION TYPES:\n   \n   a) SINGLE CHOICE (most common):\n   {\n     "id": "q_unique_id",\n     "type": "single_choice",\n     "text": "Question text here",\n     "options": [\n       {"id": "opt_1", "text": "Option A"},\n       {"id": "opt_2", "text": "Option B"},\n       {"id": "opt_3", "text": "Option C"}\n     ],\n     "correct_answer": "opt_2",\n     "explanation": "Why this is correct",\n     "timer": 30\n   }\n   \n   b) TRUE/FALSE:\n   {\n     "id": "q_unique_id",\n     "type": "true_false",\n     "text": "Statement to evaluate",\n     "correct_answer": true,\n     "explanation": "Explanation here",\n     "timer": 20\n   }\n   \n   c) MULTIPLE CHOICE (select all that apply):\n   {\n     "id": "q_unique_id",\n     "type": "multiple_choice",\n     "text": "Select all correct answers",\n     "options": [\n       {"id": "opt_1", "text": "Option A"},\n       {"id": "opt_2", "text": "Option B"},\n       {"id": "opt_3", "text": "Option C"}\n     ],\n     "correct_answer": ["opt_1", "opt_3"],\n     "explanation": "Why these are correct",\n     "timer": 45\n   }\n\nSECTION GUIDELINES:\n- objectives: Use text slides to list learning goals\n- learn/content: Mix text slides (70%) and question slides (30%) for engagement\n- practice: Use MORE question slides (70%) and some text slides (30%)\n- assessment/review: Primarily question slides (80-90%)\n\nIMPORTANT RULES:\n1. Return ONLY valid JSON\n2. NO markdown code blocks (\`\`\`json)\n3. NO extra text before or after the JSON\n4. Each section MUST have at least 3 slides\n5. HTML content must be properly escaped in JSON strings\n6. Use double quotes for JSON properties and strings\n7. Each question MUST have a unique "id" (use format: q_abc123, q_xyz789, etc.)\n8. Each option MUST have a unique "id" within its question (opt_1, opt_2, etc.)\n9. For single_choice: correct_answer is a STRING (the option id)\n10. For multiple_choice: correct_answer is an ARRAY of strings (option ids)\n11. For true_false: correct_answer is a BOOLEAN (true or false)\n12. Timer is in seconds (20-60 seconds recommended)\n\nGenerate the complete lesson plan now with a good mix of text and question slides.`}({...b.lessonConfig,customInstructions:x.value.customInstructions}),h.value=2},ee=async()=>{j.value=!0;try{await navigator.clipboard.writeText(k.value),l.notify({type:"positive",message:"Prompt copied to clipboard!",position:"top",timeout:2e3})}catch(e){l.notify({type:"negative",message:"Failed to copy to clipboard",position:"top"})}finally{j.value=!1}},te=async()=>{try{const e=await navigator.clipboard.readText();M.value=e,l.notify({type:"positive",message:"Pasted from clipboard!",position:"top",timeout:1500})}catch(e){l.notify({type:"negative",message:"Failed to read from clipboard. Please paste manually.",position:"top"})}},ne=()=>{B.value=!0,F.value=[],setTimeout(()=>{const e=function(e){try{let t=e.trim();t.startsWith("```json")?t=t.replace(/```json\n?/g,"").replace(/```\n?$/g,""):t.startsWith("```")&&(t=t.replace(/```\n?/g,""));const n=t.match(/\{[\s\S]*\}/);return n&&(t=n[0]),{success:!0,data:JSON.parse(t)}}catch(t){return{success:!1,error:`JSON Parse Error: ${t.message}. Please ensure the AI returned valid JSON.`}}}(M.value);if(!e.success)return F.value=[e.error],void(B.value=!1);const t=function(e){const t=[];return e.sections&&Array.isArray(e.sections)?0===e.sections.length?(t.push("Must have at least one section"),{valid:!1,errors:t}):(e.sections.forEach((e,n)=>{e.sectionId&&"string"==typeof e.sectionId||t.push(`Section ${n+1}: Missing or invalid "sectionId"`),e.slides&&Array.isArray(e.slides)?e.slides.length<3?t.push(`Section ${n+1}: Must have at least 3 slides (has ${e.slides.length})`):e.slides.forEach((e,l)=>{e.slide_type||t.push(`Section ${n+1}, Slide ${l+1}: Missing "slide_type"`),e.slide_content?"text"!==e.slide_type||e.slide_content.text?"question"===e.slide_type&&(e.slide_content.questions&&Array.isArray(e.slide_content.questions)?0===e.slide_content.questions.length&&t.push(`Section ${n+1}, Slide ${l+1}: Question slide must have at least 1 question`):t.push(`Section ${n+1}, Slide ${l+1}: Question slide must have "questions" array`)):t.push(`Section ${n+1}, Slide ${l+1}: Text slide must have "text" content`):t.push(`Section ${n+1}, Slide ${l+1}: Missing "slide_content"`)}):t.push(`Section ${n+1}: Missing or invalid "slides" array`)}),{valid:0===t.length,errors:t}):(t.push('Response must have a "sections" array'),{valid:!1,errors:t})}(e.data);if(!t.valid)return F.value=t.errors,void(B.value=!1);G.value=e.data,h.value=4,B.value=!1},500)},le=e=>{const t=b.lessonConfig.sections.find(t=>t.id===e);return t?t.title:e},ae=e=>{var t;if("text"===e.slide_type&&(null==(t=e.slide_content)?void 0:t.text)){const t=e.slide_content.text.replace(/<[^>]*>/g," ").trim();return t.length>150?t.substring(0,150)+"...":t}return"Content preview not available"},se=()=>{s("plan-accepted",G.value),y.value=!1};return t({open:()=>{y.value=!0,h.value=1,(()=>{const e=localStorage.getItem("ai_tool_url");N.value=e||D[0].url})(),X()}}),(t,n)=>(q(),C(p,{modelValue:y.value,"onUpdate:modelValue":n[10]||(n[10]=e=>y.value=e),persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:I(()=>[T(c,{class:"bg-grey-1"},{default:I(()=>[L("div",he,[L("div",xe,[L("div",_e,[T(i,{size:"36px",color:"white","text-color":"purple-8",class:"q-mr-md"},{default:I(()=>[T(r,{name:"auto_awesome",size:"24px"})]),_:1}),n[11]||(n[11]=L("div",{class:"col"},[L("div",{class:"text-h5 text-white font-bold"},"AI Lesson Plan Generator"),L("div",{class:"text-subtitle2 text-white",style:{opacity:"0.9"}},"Generate complete lesson content with intelligent AI assistance")],-1)),T(a,{flat:"",round:"",dense:"",icon:"close",color:"white",onClick:Y,size:"md"})])])]),T(me,{modelValue:h.value,"onUpdate:modelValue":n[9]||(n[9]=e=>h.value=e),ref:"stepper",color:"primary",animated:"",flat:"",class:"flex-1 bg-grey-1"},{default:I(()=>[T(ve,{name:1,title:"Configure",icon:"settings",done:h.value>1},{default:I(()=>[L("div",we,[n[18]||(n[18]=L("h3",{class:"text-xl font-semibold mb-4"},"Lesson Configuration",-1)),L("div",Se,[n[12]||(n[12]=L("label",{class:"text-sm font-medium text-gray-700 mb-2 block"},"Quick Suggestions",-1)),L("div",ke,[(q(!0),P(U,null,E(O(S),e=>(q(),C(a,{key:e.label,outline:"",color:"primary",label:e.label,onClick:t=>(e=>{x.value.customInstructions=e.instructions})(e),size:"sm"},null,8,["label","onClick"]))),128))])]),L("div",je,[L("div",Ce,[L("div",null,[n[13]||(n[13]=L("span",{class:"font-semibold text-blue-900"},"Subject:",-1)),L("span",qe,V(e.lessonConfig.subject),1)]),L("div",null,[n[14]||(n[14]=L("span",{class:"font-semibold text-blue-900"},"Grade:",-1)),L("span",Ie,V(e.lessonConfig.grade),1)]),L("div",Te,[n[15]||(n[15]=L("span",{class:"font-semibold text-blue-900"},"Lesson:",-1)),L("span",Le,V(e.lessonConfig.lessonTitle),1)])])]),L("div",Pe,[n[16]||(n[16]=L("label",{class:"text-sm font-medium text-gray-700 mb-2 block"},"Lesson Sections",-1)),L("div",Ee,[(q(!0),P(U,null,E(e.lessonConfig.sections,e=>(q(),P("div",{key:e.id,class:"flex items-center gap-2 p-2 bg-gray-50 rounded border"},[L("span",Oe,V(e.icon),1),L("span",Ue,V(e.title),1)]))),128))]),n[17]||(n[17]=L("p",{class:"text-xs text-gray-500 mt-2"}," AI will generate 3-5 slides for each section ",-1))]),T(d,{modelValue:x.value.customInstructions,"onUpdate:modelValue":n[0]||(n[0]=e=>x.value.customInstructions=e),type:"textarea",label:"Additional Instructions (Optional)",outlined:"",rows:"4",hint:"Add specific requirements, topics to cover, or teaching style preferences",class:"mb-4"},null,8,["modelValue"]),L("div",Ve,[T(a,{flat:"",label:"Cancel",onClick:Y}),T(a,{unelevated:"",color:"primary",label:"Generate Prompt","icon-right":"arrow_forward",onClick:Z})])])]),_:1},8,["done"]),T(ve,{name:2,title:"Use AI Tool",icon:"smart_toy",done:h.value>2},{default:I(()=>[L("div",Ae,[n[24]||(n[24]=L("h3",{class:"text-xl font-semibold mb-4"},"Work with AI Tool",-1)),L("div",Qe,[L("div",$e,[T(r,{name:"info",color:"blue",size:"20px",class:"mt-1"}),n[19]||(n[19]=L("div",{class:"text-sm text-blue-800"},[L("strong",null,"Instructions:"),A(" Copy the prompt below and paste it into your AI tool. The AI will generate slides for all sections. ")],-1))])]),L("div",Ne,[L("div",null,[L("div",ze,[n[20]||(n[20]=L("label",{class:"text-sm font-medium text-gray-700"},"Generated Prompt",-1)),T(a,{dense:"",unelevated:"",color:"primary",icon:"content_copy",label:"Copy",onClick:ee,size:"sm",loading:j.value},null,8,["loading"])]),T(c,{flat:"",bordered:"",class:"bg-gray-50",style:{"max-height":"400px","overflow-y":"auto"}},{default:I(()=>[T(u,null,{default:I(()=>[L("pre",Re,V(k.value),1)]),_:1})]),_:1}),L("div",De,[L("div",Me,[n[21]||(n[21]=L("label",{class:"text-sm font-medium text-gray-700"},"AI Tool URL",-1)),T(a,{dense:"",flat:"",color:"primary",icon:"settings",label:"Change",onClick:n[1]||(n[1]=e=>R.value=!0),size:"sm"})]),L("div",Fe,[(q(),P(U,null,E(D,e=>T(a,{key:e.name,dense:"",outline:"",color:N.value===e.url?"primary":"grey",label:e.name,onClick:t=>J(e.url),size:"sm"},null,8,["color","label","onClick"])),64))])])]),L("div",null,[L("div",Ge,[n[22]||(n[22]=L("label",{class:"text-sm font-medium text-gray-700"},"AI Tool (Embedded)",-1)),T(a,{dense:"",flat:"",color:"primary",icon:"open_in_new",label:"Open in New Tab",onClick:K,size:"sm"})]),L("div",Be,[N.value?(q(),P("iframe",{key:0,src:N.value,class:"w-full h-full",frameborder:"0",sandbox:"allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"},null,8,He)):(q(),P("div",Je,[L("div",We,[T(r,{name:"smart_toy",size:"48px",class:"mb-2"}),n[23]||(n[23]=L("div",null,"Select an AI tool to get started",-1))])]))])])]),L("div",Ke,[T(a,{flat:"",label:"Back",icon:"arrow_back",onClick:n[2]||(n[2]=e=>h.value=1)}),T(a,{unelevated:"",color:"primary",label:"I Have the Response","icon-right":"arrow_forward",onClick:n[3]||(n[3]=e=>h.value=3)})])])]),_:1},8,["done"]),T(p,{modelValue:R.value,"onUpdate:modelValue":n[5]||(n[5]=e=>R.value=e)},{default:I(()=>[T(c,{style:{"min-width":"400px"}},{default:I(()=>[T(u,{class:"bg-primary text-white"},{default:I(()=>n[25]||(n[25]=[L("div",{class:"text-h6"},"Configure AI Tool URL",-1)])),_:1}),T(u,null,{default:I(()=>[T(d,{modelValue:z.value,"onUpdate:modelValue":n[4]||(n[4]=e=>z.value=e),label:"Custom AI Tool URL",outlined:"",dense:"",placeholder:"https://chatgpt.com",hint:"Enter the URL of your preferred AI tool"},null,8,["modelValue"]),L("div",Ye,[n[26]||(n[26]=L("div",{class:"text-sm font-medium text-gray-700 mb-2"},"Quick Presets:",-1)),L("div",Xe,[(q(),P(U,null,E(D,e=>T(a,{key:e.name,outline:"",color:"primary",label:e.name,onClick:t=>z.value=e.url,class:"w-full",align:"left"},{default:I(()=>[T(m,null,{default:I(()=>[A(V(e.url),1)]),_:2},1024)]),_:2},1032,["label","onClick"])),64))])])]),_:1}),T(v,{align:"right"},{default:I(()=>[Q(T(a,{flat:"",label:"Cancel"},null,512),[[f]]),T(a,{unelevated:"",color:"primary",label:"Save",onClick:W})]),_:1})]),_:1})]),_:1},8,["modelValue"]),T(ve,{name:3,title:"Paste Response",icon:"content_paste",done:h.value>3},{default:I(()=>[L("div",Ze,[n[29]||(n[29]=L("h3",{class:"text-xl font-semibold mb-4"},"Paste AI Response",-1)),L("div",et,[L("div",tt,[T(r,{name:"tips_and_updates",color:"amber",size:"20px",class:"mt-1"}),n[27]||(n[27]=L("div",{class:"text-sm text-amber-800"},[L("strong",null,"Tip:"),A(" Paste the complete JSON response from your AI tool. The system will validate and create slides for all sections. ")],-1))])]),L("div",nt,[T(d,{modelValue:M.value,"onUpdate:modelValue":n[6]||(n[6]=e=>M.value=e),type:"textarea",label:"AI Response *",outlined:"",rows:"12",placeholder:"Paste the AI response here...",class:"font-mono"},null,8,["modelValue"]),T(a,{unelevated:"",color:"secondary",icon:"content_paste",label:"Paste from Clipboard",onClick:te,class:"absolute top-4 right-4",size:"sm"})]),F.value.length>0?(q(),P("div",lt,[L("div",at,[T(r,{name:"error",color:"red",size:"20px",class:"mt-1"}),L("div",st,[n[28]||(n[28]=L("div",{class:"font-semibold text-red-800 mb-2"},"Validation Errors:",-1)),L("ul",ot,[(q(!0),P(U,null,E(F.value,(e,t)=>(q(),P("li",{key:t},V(e),1))),128))])])])])):$("",!0),L("div",it,[T(a,{flat:"",label:"Back",icon:"arrow_back",onClick:n[7]||(n[7]=e=>h.value=2)}),T(a,{unelevated:"",color:"primary",label:"Validate & Preview","icon-right":"arrow_forward",onClick:ne,disable:!M.value.trim(),loading:B.value},null,8,["disable","loading"])])])]),_:1},8,["done"]),T(ve,{name:4,title:"Preview",icon:"visibility",done:h.value>4},{default:I(()=>[L("div",rt,[n[33]||(n[33]=L("h3",{class:"text-xl font-semibold mb-4"},"Preview Generated Lesson Plan",-1)),G.value?(q(),P("div",dt,[T(c,{flat:"",bordered:""},{default:I(()=>[T(u,null,{default:I(()=>[n[32]||(n[32]=L("div",{class:"text-sm text-gray-600 mb-2"},"Summary",-1)),L("div",ct,[L("div",null,[n[30]||(n[30]=L("span",{class:"font-semibold"},"Total Sections:",-1)),L("span",ut,V(G.value.sections.length),1)]),L("div",null,[n[31]||(n[31]=L("span",{class:"font-semibold"},"Total Slides:",-1)),L("span",pt,V(H.value),1)])])]),_:1})]),_:1}),(q(!0),P(U,null,E(G.value.sections,(e,t)=>(q(),P("div",{key:t,class:"border rounded-lg overflow-hidden"},[L("div",mt,[T(r,{name:"folder",size:"sm"}),L("span",null,V(le(e.sectionId)),1),T(g,{dense:"",size:"sm",color:"primary","text-color":"white"},{default:I(()=>[A(V(e.slides.length)+" slides ",1)]),_:2},1024)]),L("div",vt,[(q(!0),P(U,null,E(e.slides,(e,t)=>(q(),P("div",{key:t,class:"flex items-start gap-3 p-3 bg-gray-50 rounded border"},[T(r,{name:"description",size:"sm",color:"primary"}),L("div",ft,[L("div",gt,"Slide "+V(t+1)+" - "+V(e.slide_type),1),L("div",{class:"text-sm",innerHTML:ae(e)},null,8,bt)])]))),128))])]))),128))])):$("",!0),L("div",yt,[T(a,{flat:"",label:"Back",icon:"arrow_back",onClick:n[8]||(n[8]=e=>h.value=3)}),L("div",ht,[T(a,{flat:"",label:"Reject",color:"negative",onClick:Y}),T(a,{unelevated:"",color:"positive",label:"Accept & Create Slides",icon:"check_circle",onClick:se})])])])]),_:1},8,["done"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-da9894a4"]]),_t={class:"row items-center"},wt={class:"row q-col-gutter-md"},St={class:"col-12 col-md-5"},kt={class:"row q-mb-md"},jt={class:"row items-center q-mb-sm"},Ct={class:"q-pl-lg"},qt={class:"col-12 col-md-7"},It={class:"row items-center"},Tt={id:"printable-lesson-plan",class:"printable-content"},Lt={class:"print-header"},Pt={class:"school-logo"},Et=["src"],Ot={class:"lesson-title"},Ut={class:"lesson-description"},Vt={class:"lesson-info"},At={class:"info-row"},Qt={class:"info-item"},$t={class:"info-item"},Nt={class:"info-row"},zt={class:"info-item"},Rt={class:"info-item"},Dt={class:"info-row"},Mt={class:"info-item"},Ft={class:"info-item"},Gt={class:"section-icon"},Bt={class:"slide-number"},Ht={class:"slide-content"},Jt=["innerHTML"],Wt={key:1,class:"question-content"},Kt={class:"question-text"},Yt={key:0,class:"question-options"},Xt={key:1,class:"question-answer"},Zt={key:2,class:"question-explanation"},en={key:2,class:"slide-placeholder"},tn={class:"print-footer"},nn=s({__name:"PrintLessonPlan",props:{presentation:{type:Object,required:!0},sections:{type:Array,required:!0},slides:{type:Array,required:!0},teacherName:{type:String,default:"Teacher Name"},subjectName:{type:String,default:"Subject"},gradeName:{type:String,default:"Grade"},schoolLogo:{type:String,default:""}},emits:["close"],setup(e,{expose:t,emit:n}){o();const l=e,s=n,i=_(!1),d=_([]),m=w(()=>(new Date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),f=w(()=>2*d.value.length),h=e=>l.slides.filter(t=>t.section===e),x=e=>d.value.filter(t=>t.section===e),S=e=>{const t=h(e);return 0!==t.length&&t.every(e=>d.value.includes(e))},k=()=>{d.value=[...l.slides]},j=()=>{d.value=[]},O=e=>{var t,n,l;if("text"===e.slide_type){const n=((null==(t=e.slide_content)?void 0:t.text)||"").replace(/<[^>]*>/g,"").trim();return n.substring(0,50)+(n.length>50?"...":"")}if("question"===e.slide_type){const t=(null==(l=null==(n=e.slide_content)?void 0:n.questions)?void 0:l.length)||0;return`${t} question${1!==t?"s":""}`}return e.slide_type},Q=(e,t)=>"single_choice"===e.type?e.correct_answer===t:"multiple_choice"===e.type&&(Array.isArray(e.correct_answer)&&e.correct_answer.includes(t)),R=()=>{const e=document.getElementById("printable-lesson-plan").innerHTML,t=window.open("","_blank");t.document.write(`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${l.presentation.name||"Lesson Plan"}</title>\n      <style>\n        @media print {\n          @page { margin: 1cm; }\n          body { margin: 0; }\n        }\n        \n        body {\n          font-family: 'Arial', sans-serif;\n          line-height: 1.6;\n          color: #333;\n          max-width: 210mm;\n          margin: 0 auto;\n          padding: 20px;\n        }\n        \n        .print-header {\n          text-align: center;\n          border-bottom: 3px solid #1976d2;\n          padding-bottom: 20px;\n          margin-bottom: 30px;\n        }\n        \n        .print-header h1 {\n          margin: 10px 0;\n          color: #1976d2;\n          font-size: 28px;\n        }\n        \n        .lesson-description {\n          color: #666;\n          font-size: 14px;\n        }\n        \n        .lesson-info {\n          background: #f5f5f5;\n          padding: 15px;\n          border-radius: 8px;\n          margin-bottom: 30px;\n        }\n        \n        .info-row {\n          display: flex;\n          justify-content: space-between;\n          margin-bottom: 8px;\n        }\n        \n        .info-item {\n          flex: 1;\n        }\n        \n        .section-block {\n          page-break-inside: avoid;\n          margin-bottom: 30px;\n        }\n        \n        .section-header {\n          background: #1976d2;\n          color: white;\n          padding: 12px 20px;\n          border-left: 5px solid;\n          margin-bottom: 15px;\n          display: flex;\n          align-items: center;\n          gap: 10px;\n        }\n        \n        .section-header h2 {\n          margin: 0;\n          font-size: 20px;\n        }\n        \n        .section-icon {\n          font-size: 24px;\n        }\n        \n        .slide-block {\n          margin-bottom: 20px;\n          padding: 15px;\n          border: 1px solid #ddd;\n          border-radius: 8px;\n          background: white;\n          page-break-inside: avoid;\n        }\n        \n        .slide-number {\n          font-weight: bold;\n          color: #1976d2;\n          margin-bottom: 10px;\n          font-size: 14px;\n        }\n        \n        .slide-content {\n          font-size: 14px;\n        }\n        \n        .question-item {\n          margin-bottom: 15px;\n          padding: 10px;\n          background: #f9f9f9;\n          border-radius: 4px;\n        }\n        \n        .question-text {\n          font-weight: bold;\n          margin-bottom: 8px;\n        }\n        \n        .question-options {\n          margin-left: 20px;\n        }\n        \n        .option-item {\n          margin: 5px 0;\n        }\n        \n        .correct-answer {\n          color: #4caf50;\n          font-weight: bold;\n        }\n        \n        .question-explanation {\n          margin-top: 8px;\n          padding: 8px;\n          background: #e3f2fd;\n          border-left: 3px solid #2196f3;\n          font-size: 13px;\n        }\n        \n        .slide-placeholder {\n          text-align: center;\n          padding: 20px;\n          color: #999;\n        }\n        \n        .print-footer {\n          margin-top: 40px;\n          padding-top: 20px;\n          border-top: 2px solid #ddd;\n          text-align: center;\n          font-size: 12px;\n          color: #666;\n        }\n      </style>\n    </head>\n    <body>\n      ${e}\n    </body>\n    </html>\n  `),t.document.close(),t.focus(),setTimeout(()=>{t.print()},500)},D=()=>{i.value=!1,s("close")};return t({open:()=>{i.value=!0,d.value=[...l.slides]}}),(t,n)=>(q(),C(p,{modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=e=>i.value=e),persistent:"",maximized:""},{default:I(()=>[T(c,null,{default:I(()=>[T(u,{class:"bg-primary text-white"},{default:I(()=>[L("div",_t,[T(r,{name:"print",size:"32px",class:"q-mr-sm"}),n[2]||(n[2]=L("div",{class:"text-h5"},"Print Lesson Plan",-1)),T(ae),T(a,{flat:"",round:"",dense:"",icon:"close",onClick:D})])]),_:1}),T(u,{class:"q-pa-md"},{default:I(()=>[L("div",wt,[L("div",St,[T(c,{flat:"",bordered:""},{default:I(()=>[T(u,{class:"bg-grey-2"},{default:I(()=>n[3]||(n[3]=[L("div",{class:"text-h6"},"Select Slides to Print",-1),L("div",{class:"text-caption text-grey-7"},"Choose which slides to include in the lesson plan",-1)])),_:1}),T(u,null,{default:I(()=>[L("div",kt,[T(a,{flat:"",dense:"",color:"primary",label:"Select All",onClick:k,class:"q-mr-sm"}),T(a,{flat:"",dense:"",color:"negative",label:"Deselect All",onClick:j})]),T(b,{style:{height:"calc(100vh - 350px)"}},{default:I(()=>[(q(!0),P(U,null,E(e.sections,e=>(q(),P("div",{key:e.id,class:"q-mb-md"},[L("div",jt,[T(y,{"model-value":S(e.id),"onUpdate:modelValue":t=>(e=>{const t=h(e);S(e)?d.value=d.value.filter(t=>t.section!==e):t.forEach(e=>{d.value.includes(e)||d.value.push(e)})})(e.id),label:e.title,color:"primary",class:"text-weight-bold"},null,8,["model-value","onUpdate:modelValue","label"]),T(ae),T(g,{dense:"",style:N({background:e.bg,color:e.textColor})},{default:I(()=>[A(V(h(e.id).length)+" slides ",1)]),_:2},1032,["style"])]),L("div",Ct,[(q(!0),P(U,null,E(h(e.id),(e,t)=>(q(),C(y,{key:t,modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),val:e,label:`Slide ${t+1}: ${O(e)}`,color:"primary",dense:"",class:"q-mb-xs"},null,8,["modelValue","val","label"]))),128))])]))),128))]),_:1})]),_:1})]),_:1})]),L("div",qt,[T(c,{flat:"",bordered:""},{default:I(()=>[T(u,{class:"bg-grey-2"},{default:I(()=>[L("div",It,[n[4]||(n[4]=L("div",{class:"text-h6"},"Preview",-1)),T(ae),T(g,{color:"primary","text-color":"white"},{default:I(()=>[A(V(d.value.length)+" slides selected ",1)]),_:1})])]),_:1}),T(u,null,{default:I(()=>[T(b,{style:{height:"calc(100vh - 350px)"}},{default:I(()=>[L("div",Tt,[L("div",Lt,[L("div",Pt,[e.schoolLogo?(q(),P("img",{key:0,src:e.schoolLogo,alt:"School Logo",style:{"max-height":"60px"}},null,8,Et)):$("",!0)]),L("div",Ot,[L("h1",null,V(e.presentation.name||"Lesson Plan"),1),L("p",Ut,V(e.presentation.description),1)])]),L("div",Vt,[L("div",At,[L("div",Qt,[n[5]||(n[5]=L("strong",null,"Teacher:",-1)),A(" "+V(e.teacherName),1)]),L("div",$t,[n[6]||(n[6]=L("strong",null,"Subject:",-1)),A(" "+V(e.subjectName),1)])]),L("div",Nt,[L("div",zt,[n[7]||(n[7]=L("strong",null,"Grade:",-1)),A(" "+V(e.gradeName),1)]),L("div",Rt,[n[8]||(n[8]=L("strong",null,"Date:",-1)),A(" "+V(m.value),1)])]),L("div",Dt,[L("div",Mt,[n[9]||(n[9]=L("strong",null,"Duration:",-1)),A(" "+V(f.value)+" minutes ",1)]),L("div",Ft,[n[10]||(n[10]=L("strong",null,"Total Slides:",-1)),A(" "+V(d.value.length),1)])])]),(q(!0),P(U,null,E(e.sections,e=>(q(),P("div",{key:e.id,class:"section-block"},[x(e.id).length>0?(q(),P(U,{key:0},[L("div",{class:"section-header",style:N({borderLeftColor:e.borderColor})},[L("span",Gt,V(e.icon),1),L("h2",null,V(e.title),1)],4),(q(!0),P(U,null,E(x(e.id),(e,t)=>{var l,a,s;return q(),P("div",{key:t,class:"slide-block"},[L("div",Bt,"Slide "+V(t+1),1),L("div",Ht,["text"===e.slide_type?(q(),P("div",{key:0,innerHTML:(null==(l=e.slide_content)?void 0:l.text)||"No content"},null,8,Jt)):"question"===e.slide_type?(q(),P("div",Wt,[(q(!0),P(U,null,E((null==(a=e.slide_content)?void 0:a.questions)||[],(e,t)=>(q(),P("div",{key:t,class:"question-item"},[L("div",Kt,[L("strong",null,"Q"+V(t+1)+":",1),A(" "+V(e.text),1)]),e.options?(q(),P("div",Yt,[(q(!0),P(U,null,E(e.options,(t,n)=>(q(),P("div",{key:n,class:"option-item"},[L("span",{class:z({"correct-answer":Q(e,t.id)})},[A(V(String.fromCharCode(65+n))+". "+V(t.text)+" ",1),Q(e,t.id)?(q(),C(r,{key:0,name:"check_circle",color:"positive",size:"sm"})):$("",!0)],2)]))),128))])):"true_false"===e.type?(q(),P("div",Xt,[n[11]||(n[11]=L("strong",null,"Answer:",-1)),A(" "+V(e.correct_answer?"True":"False"),1)])):$("",!0),e.explanation?(q(),P("div",Zt,[L("em",null,"Explanation: "+V(e.explanation),1)])):$("",!0)]))),128))])):(q(),P("div",en,[T(r,{name:(s=e.slide_type,{text:"description",image:"image",video:"videocam",audio:"audiotrack",pdf:"picture_as_pdf",question:"quiz",drawing:"brush"}[s]||"article"),size:"md",color:"grey"},null,8,["name"]),L("div",null,V(e.slide_type.toUpperCase())+" Slide",1)]))])])}),128))],64)):$("",!0)]))),128)),L("div",tn,[L("div",null,"Prepared by "+V(e.teacherName),1),L("div",null,"Printed on "+V(m.value),1)])])]),_:1})]),_:1})]),_:1})])])]),_:1}),T(v,{align:"right",class:"q-pa-md"},{default:I(()=>[T(a,{flat:"",label:"Cancel",onClick:D}),T(a,{unelevated:"",color:"primary",icon:"print",label:"Print",onClick:R,disable:0===d.value.length},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-fe9e0d57"]]),ln={class:"row items-center q-gutter-x-md"},an={class:"cursor-pointer"},sn={class:"text-caption text-blue-2 cursor-pointer ellipsis",style:{"max-width":"300px"}},on={class:"row items-center q-gutter-sm"},rn={class:"column q-mr-md text-right text-caption text-grey-1"},dn={class:"text-weight-bold"},cn={class:"text-weight-bold"},un={class:"col-12 col-lg-10",style:{"max-width":"1200px"}},pn={key:0,class:"bg-white rounded-borders shadow-1 q-pa-lg"},mn={class:"row items-center justify-between q-mb-md"},vn={class:"row items-center q-gutter-sm"},fn={class:"row items-center q-gutter-sm"},gn={style:{"min-height":"500px"}},bn={key:1,class:"column items-center justify-center text-grey-5 q-pa-xl bg-white rounded-borders shadow-1 fit",style:{"min-height":"500px"}},yn={class:"text-h6 flex items-center gap-2"},hn=s({__name:"lesson_presentation",props:{presentationId:{type:[Number,String],default:null},defaultContext:{type:Object,default:()=>({school_id:1,teacher_id:1,subject_id:1})},sections:{type:Array,default:()=>[]}},setup(e){const t=e,n=fe(),l=o(),s=new URLSearchParams(window.location.search).get("id"),i=t.presentationId||(s?parseInt(s):null),v=_(i),g=_({name:"New Lesson",description:"Lesson description",grade_id:null,quiz_id:null,slides:[]}),b=_(t.sections),y=_(""),S=_(!0),k=_(null),j=_([]),E=_(0),N=_(!1),z=_(!1),me=_(null),ve=_(null),ge=_(!0);_(!0);const ye=w(()=>{var e,n;return{lessonTitle:g.value.name||"New Lesson",subject:(null==(e=t.defaultContext)?void 0:e.subject_name)||"General",grade:(null==(n=t.defaultContext)?void 0:n.grade_name)||"General",sections:b.value}}),he=w({get:()=>!l.screen.lt.sm&&ge.value,set(e){ge.value=e}});w(()=>{const e=b.value.find(e=>e.id===y.value);return e?`Section: ${e.title}`:"Select a section"});const xe=w(()=>j.value.filter(e=>e.section===y.value)),_e=w(()=>0===xe.value.length?null:xe.value[E.value]),we=w(()=>{if(!g.value.grade_id)return"No Grade";const e=n.grades.find(e=>e.id===g.value.grade_id);return e?e.name:"Unknown Grade"}),Se=e=>{switch(e){case"text":default:return se;case"question":return ie;case"pdf":return re;case"video":return de;case"image":case"audio":return oe;case"drawing":return pe}},ke=()=>{const e={slide_type:"text",slide_content:{},section:y.value};j.value.push(e),E.value=xe.value.length-1},je=e=>{const t=document.createElement("DIV");return t.innerHTML=e||"",t.textContent||t.innerText||""},Ce=()=>{E.value>0&&E.value--},qe=()=>{E.value<xe.value.length-1&&E.value++},Ie=e=>{"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&("ArrowLeft"===e.key?(e.preventDefault(),Ce()):"ArrowRight"===e.key&&(e.preventDefault(),qe()))},Te=async()=>{if((()=>{var e,t;if(!g.value.name.trim())return l.notify({type:"warning",message:"Please enter a lesson name",icon:"warning",position:"top"}),!1;if(!g.value.grade_id)return l.notify({type:"warning",message:"Please select a grade",icon:"warning",position:"top"}),!1;for(let n=0;n<j.value.length;n++){const a=j.value[n];if("question"===a.slide_type){const t=(null==(e=a.slide_content)?void 0:e.questions)||[];if(0===t.length)return l.notify({type:"warning",message:`Slide ${n+1}: Please add at least one question`,icon:"warning",position:"top"}),E.value=n,!1;for(let e=0;e<t.length;e++){const a=t[e];if(!je(a.text).trim())return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Question text cannot be empty`,icon:"warning",position:"top"}),E.value=n,!1;if(["short_answer","number"].includes(a.type)&&!a.correct_answer)return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Please provide a correct answer`,icon:"warning",position:"top"}),E.value=n,!1;if("single_choice"===a.type&&!a.correct_answer)return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Please select a correct option`,icon:"warning",position:"top"}),E.value=n,!1;if(["single_choice","multiple_choice"].includes(a.type)){if(!a.options||a.options.length<2)return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}: Must have at least 2 options`,icon:"warning",position:"top"}),E.value=n,!1;for(let t=0;t<a.options.length;t++)if(!je(a.options[t].text).trim())return l.notify({type:"warning",message:`Slide ${n+1}, Question ${e+1}, Option ${t+1}: Option text cannot be empty`,icon:"warning",position:"top"}),E.value=n,!1}}}else if("text"===a.slide_type&&(null==(t=a.slide_content)?void 0:t.text)&&!je(a.slide_content.text).trim())return l.notify({type:"warning",message:`Slide ${n+1}: Text content cannot be empty. Please add content or delete the slide.`,icon:"warning",position:"top"}),E.value=n,!1}return!0})()){N.value=!0;try{const e={...g.value,school_id:t.defaultContext.school_id,teacher_id:t.defaultContext.teacher_id,subject_id:t.defaultContext.subject_id,grade_id:g.value.grade_id||t.defaultContext.grade_id};let n;n=v.value?await J.put(route("lesson-presentation.update",{id:v.value}),e):await J.post(route("lesson-presentation.store"),e);const a=n.data;for(const t of j.value){const e={slide_type:t.slide_type,slide_content:t.slide_content||{},section:t.section||y.value||"learn",order_index:t.order_index||0};t.id?await J.put(route("lesson-presentation.slides.update",{id:a.id,slideId:t.id}),e):await J.post(route("lesson-presentation.slides.add",{id:a.id}),e)}l.notify({type:"positive",message:"Lesson saved successfully! Redirecting...",icon:"check_circle",position:"top",timeout:1500}),setTimeout(()=>{window.location.href="/lesson-presentation/dashboard"},1500)}catch(e){console.error("Save failed:",e),l.notify({type:"negative",message:"Failed to save lesson. Please try again.",icon:"error",position:"top",timeout:3e3})}finally{N.value=!1}}},Le=async()=>{if(v.value)try{l.notify({type:"info",message:"Duplicating lesson...",icon:"content_copy",position:"top",timeout:1e3});const e={...g.value,name:`${g.value.name} (Copy)`,school_id:t.defaultContext.school_id,teacher_id:t.defaultContext.teacher_id,subject_id:t.defaultContext.subject_id},n=(await J.post(route("lesson-presentation.store"),e)).data;for(const t of j.value){const e={slide_type:t.slide_type,slide_content:t.slide_content,section:t.section};await J.post(route("lesson-presentation.slides.add",{id:n.id}),e)}l.notify({type:"positive",message:"Lesson duplicated successfully!",icon:"check_circle",position:"top",timeout:2e3}),setTimeout(()=>{window.location.href=`/lesson-presentation/edit?id=${n.id}`},500)}catch(e){console.error("Duplicate failed:",e),l.notify({type:"negative",message:"Failed to duplicate lesson",icon:"error",position:"top",timeout:3e3})}},Pe=()=>{var e,n;try{const a=g.value.name||"Untitled_Lesson",s=(new Date).toISOString().split("T")[0],o=`lesson_${a.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${s}.json`,i={version:"1.0",exportDate:(new Date).toISOString(),lesson:{name:g.value.name,description:g.value.description,grade_id:g.value.grade_id,quiz_id:g.value.quiz_id},sections:b.value,slides:j.value,metadata:{subject_name:null==(e=t.defaultContext)?void 0:e.subject_name,grade_name:null==(n=t.defaultContext)?void 0:n.grade_name,totalSlides:j.value.length}},r=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),d=URL.createObjectURL(r),c=document.createElement("a");c.href=d,c.download=o,c.click(),URL.revokeObjectURL(d),l.notify({type:"positive",message:`Lesson exported as ${o}`,icon:"download",position:"top",timeout:2e3})}catch(a){console.error("Export failed:",a),l.notify({type:"negative",message:"Failed to export lesson",icon:"error",position:"top"})}},Ee=()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{const t=e.target.files[0];if(t)try{const e=await t.text(),n=JSON.parse(e);if(!n.lesson||!n.slides)throw new Error("Invalid lesson file format");l.dialog({title:"Import Lesson",message:`Import "${n.lesson.name}"? This will replace current unsaved changes.`,cancel:!0,persistent:!0,ok:{label:"Import",color:"primary"}}).onOk(()=>{g.value.name=n.lesson.name,g.value.description=n.lesson.description,g.value.grade_id=n.lesson.grade_id,g.value.quiz_id=n.lesson.quiz_id,j.value=n.slides.map(e=>({...e,id:null})),n.sections&&n.sections.length>0&&(b.value=n.sections,!y.value&&b.value.length>0&&(y.value=b.value[0].id)),l.notify({type:"positive",message:`Lesson "${n.lesson.name}" imported successfully!`,icon:"upload",position:"top",timeout:2e3})})}catch(n){console.error("Import failed:",n),l.notify({type:"negative",message:"Failed to import lesson. Please check the file format.",icon:"error",position:"top",timeout:3e3})}},e.click()},Oe=()=>{var e;g.value.name&&"New Lesson"!==g.value.name?null==(e=me.value)||e.open():l.notify({type:"warning",message:"Please set a lesson title first",icon:"warning",position:"top"})},Ue=e=>{let t=0;e.sections.forEach(e=>{e.slides.forEach(n=>{j.value.push({slide_type:n.slide_type,slide_content:n.slide_content,section:e.sectionId}),t++})}),l.notify({type:"positive",message:`Successfully added ${t} slides from AI! Don't forget to save.`,icon:"check_circle",position:"top",timeout:3e3}),e.sections.length>0&&(y.value=e.sections[0].sectionId,E.value=0)},Ve=()=>{var e;null==(e=ve.value)||e.open()};return R(y,()=>{E.value=0}),D(async()=>{await n.fetchTeacherData(),window.addEventListener("keydown",Ie),v.value?(await(async e=>{try{const t=await J.get(route("lesson-presentation.show",{id:e}));g.value={name:t.data.name,description:t.data.description,grade_id:t.data.grade_id,quiz_id:t.data.quiz_id},j.value=(t.data.slides||[]).map(e=>({...e,section:e.section||"learn"}))}catch(t){console.error("Fetch failed:",t),l.notify({type:"negative",message:"Failed to load lesson",icon:"error",position:"top"})}})(v.value),b.value.length>0&&!y.value&&(y.value=b.value[0].id)):(0===j.value.length&&ke(),b.value.length>0&&(y.value=b.value[0].id),t.defaultContext.grade_id?g.value.grade_id=parseInt(t.defaultContext.grade_id):n.grades.length>0&&(g.value.grade_id=n.grades[0].id))}),M(()=>{window.removeEventListener("keydown",Ie)}),(t,s)=>{var o,i,_;const w=F("Head");return q(),P(U,null,[T(w,{title:g.value.name?`Editing: ${g.value.name}`:"New Lesson"},null,8,["title"]),T(le,{view:"hHh Lpr fFf",class:"bg-grey-1"},{default:I(()=>[T(X,{elevated:"",class:"bg-primary text-white"},{default:I(()=>[T(K,null,{default:I(()=>{var t,n;return[T(a,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:s[0]||(s[0]=e=>S.value=!S.value)}),T(a,{flat:"",round:"",dense:"",icon:"arrow_back",component:"a",href:"/lesson-presentation/dashboard"},{default:I(()=>[T(m,null,{default:I(()=>s[13]||(s[13]=[A("Back")])),_:1})]),_:1}),T(Y,{class:"q-ml-sm"},{default:I(()=>[L("div",ln,[L("div",an,[A(V(g.value.name||"New Lesson")+" ",1),T(be,{modelValue:g.value.name,"onUpdate:modelValue":s[1]||(s[1]=e=>g.value.name=e),"auto-save":""},{default:I(e=>[T(d,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,dense:"",autofocus:"",counter:"",onKeyup:G(e.set,["enter"]),label:"Lesson Name"},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"]),T(r,{name:"edit",size:"xs",class:"q-ml-xs opacity-50"})]),g.value.grade_id?(q(),C(W,{key:0,color:"white","text-color":"primary",label:we.value},null,8,["label"])):$("",!0)]),L("div",sn,[A(V(g.value.description||"Add description...")+" ",1),T(be,{modelValue:g.value.description,"onUpdate:modelValue":s[2]||(s[2]=e=>g.value.description=e),"auto-save":""},{default:I(e=>[T(d,{modelValue:e.value,"onUpdate:modelValue":t=>e.value=t,dense:"",autofocus:"",type:"textarea",onKeyup:G(e.set,["enter"]),label:"Description"},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),_:1}),L("div",on,[L("div",rn,[L("div",null,[s[14]||(s[14]=A("Subject: ")),L("span",dn,V(null==(t=e.defaultContext)?void 0:t.subject_name),1)]),L("div",null,[s[15]||(s[15]=A("Class: ")),L("span",cn,V(null==(n=e.defaultContext)?void 0:n.grade_name),1)])]),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),v.value?(q(),C(a,{key:0,flat:"",round:"",dense:"",icon:"content_copy",onClick:Le},{default:I(()=>[T(m,null,{default:I(()=>s[16]||(s[16]=[A("Duplicate")])),_:1})]),_:1})):$("",!0),T(a,{flat:"",round:"",dense:"",icon:"auto_awesome",onClick:Oe,style:{background:"linear-gradient(to right, #9333ea, #4f46e5)"},class:"text-white"},{default:I(()=>[T(m,null,{default:I(()=>s[17]||(s[17]=[A("Generate with AI")])),_:1})]),_:1}),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),T(a,{flat:"",round:"",dense:"",icon:"download",onClick:Pe,color:"accent"},{default:I(()=>[T(m,null,{default:I(()=>s[18]||(s[18]=[A("Export Lesson as JSON")])),_:1})]),_:1}),T(a,{flat:"",round:"",dense:"",icon:"upload",onClick:Ee,color:"secondary"},{default:I(()=>[T(m,null,{default:I(()=>s[19]||(s[19]=[A("Import Lesson from JSON")])),_:1})]),_:1}),T(h,{vertical:"",dark:"",class:"q-mx-sm"}),T(a,{flat:"",round:"",dense:"",icon:"visibility",onClick:s[3]||(s[3]=e=>z.value=!0),disable:!v.value},{default:I(()=>[T(m,null,{default:I(()=>s[20]||(s[20]=[A("Preview")])),_:1})]),_:1},8,["disable"]),T(a,{flat:"",round:"",dense:"",icon:"print",onClick:Ve,disable:!v.value||0===j.value.length,color:"deep-orange"},{default:I(()=>[T(m,null,{default:I(()=>s[21]||(s[21]=[A("Print Lesson Plan")])),_:1})]),_:1},8,["disable"]),T(a,{unelevated:"",color:"positive",icon:"save",label:"Save",onClick:Te,loading:N.value},null,8,["loading"])])]}),_:1})]),_:1}),T(Z,{modelValue:S.value,"onUpdate:modelValue":s[8]||(s[8]=e=>S.value=e),"show-if-above":"",bordered:"",class:"bg-white",width:300},{default:I(()=>[T(ce,{sections:b.value,currentSection_data:k.value,"onUpdate:currentSection_data":s[4]||(s[4]=e=>k.value=e),currentSection:y.value,"onUpdate:currentSection":s[5]||(s[5]=e=>y.value=e),slides:j.value,showDrawer:he.value,"onUpdate:showDrawer":s[6]||(s[6]=e=>he.value=e),"can-edit":!0,"active-slide":_e.value,onSelectSlide:s[7]||(s[7]=e=>E.value=xe.value.indexOf(e)),onAddSlide:ke,class:"fit"},null,8,["sections","currentSection_data","currentSection","slides","showDrawer","active-slide"])]),_:1},8,["modelValue"]),T(ne,null,{default:I(()=>[T(te,{class:"q-pa-md bg-grey-2 row justify-center"},{default:I(()=>[L("div",un,[T(B,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:I(()=>[_e.value?(q(),P("div",pn,[L("div",mn,[L("div",vn,[T(r,{name:"edit_note",color:"primary",size:"md"}),s[25]||(s[25]=L("div",{class:"text-h6 text-grey-8"},"Slide Editor",-1)),T(h,{vertical:"",inset:"",class:"q-mx-sm"}),T(x,{outline:""},{default:I(()=>[T(a,{flat:"",dense:"",icon:"chevron_left",onClick:Ce,disable:0===E.value,color:"primary"},{default:I(()=>[T(m,null,{default:I(()=>s[22]||(s[22]=[A("Previous Slide (←)")])),_:1})]),_:1},8,["disable"]),T(a,{flat:"",dense:"","no-caps":"",label:`${E.value+1} / ${xe.value.length}`,color:"primary",class:"q-px-md"},{default:I(()=>[T(m,null,{default:I(()=>s[23]||(s[23]=[A("Current Slide")])),_:1})]),_:1},8,["label"]),T(a,{flat:"",dense:"",icon:"chevron_right",onClick:qe,disable:E.value>=xe.value.length-1,color:"primary"},{default:I(()=>[T(m,null,{default:I(()=>s[24]||(s[24]=[A("Next Slide (→)")])),_:1})]),_:1},8,["disable"])]),_:1})]),L("div",fn,[T(ee,{modelValue:_e.value.slide_type,"onUpdate:modelValue":s[9]||(s[9]=e=>_e.value.slide_type=e),options:[{label:"📝 Text",value:"text"},{label:"🖼️ Image",value:"image"},{label:"🎥 Video",value:"video"},{label:"🎵 Audio",value:"audio"},{label:"📄 PDF",value:"pdf"},{label:"❓ Question",value:"question"},{label:"🎨 Drawing",value:"drawing"}],dense:"",outlined:"","emit-value":"","map-options":"","options-dense":"",color:"primary",label:"Slide Type",style:{"min-width":"150px"}},null,8,["modelValue"]),T(a,{flat:"",round:"",color:"negative",icon:"delete",onClick:s[10]||(s[10]=e=>{return t=_e.value,void l.dialog({title:"Delete Slide",message:"Are you sure you want to delete this slide? This action cannot be undone.",cancel:!0,persistent:!0,ok:{label:"Delete",color:"negative",flat:!0},cancel:{label:"Cancel",color:"grey",flat:!0}}).onOk(()=>{const e=j.value.indexOf(t);-1!==e&&(j.value.splice(e,1),xe.value.length>0?E.value>=xe.value.length&&(E.value=xe.value.length-1):E.value=0,l.notify({type:"positive",message:"Slide deleted successfully",icon:"check_circle",position:"top",timeout:1500}))});var t})},{default:I(()=>[T(m,null,{default:I(()=>s[26]||(s[26]=[A("Delete Slide")])),_:1})]),_:1})])]),T(h,{class:"q-mb-md"}),L("div",gn,[(q(),C(H(Se(_e.value.slide_type)),{modelValue:_e.value.slide_content,"onUpdate:modelValue":s[11]||(s[11]=e=>_e.value.slide_content=e),key:_e.value.id||E.value},null,8,["modelValue"]))])])):(q(),P("div",bn,[T(r,{name:"touch_app",size:"80px",color:"primary",class:"opacity-20"}),s[27]||(s[27]=L("div",{class:"text-h5 q-mt-md text-weight-medium"},"Select a Slide",-1)),s[28]||(s[28]=L("div",{class:"text-subtitle1 q-mt-sm"},"Choose a section on the left to start editing",-1))]))]),_:1})])]),_:1})]),_:1})]),_:1}),T(p,{modelValue:z.value,"onUpdate:modelValue":s[12]||(s[12]=e=>z.value=e),maximized:""},{default:I(()=>[T(c,{class:"bg-grey-1"},{default:I(()=>[T(u,{class:"row items-center q-pb-none bg-primary text-white"},{default:I(()=>[L("div",yn,[T(r,{name:"visibility",size:"28px"}),s[29]||(s[29]=A(" Student View Preview "))]),T(ae),Q(T(a,{icon:"close",flat:"",round:"",dense:""},null,512),[[f]])]),_:1}),T(u,{class:"q-pa-none bg-grey-1",style:{height:"calc(100vh - 60px)"}},{default:I(()=>[T(ue,{presentation:{...g.value,name:"Preview: "+g.value.name},sections:b.value,slides:j.value,"is-preview":!0},null,8,["presentation","sections","slides"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),T(xt,{ref_key:"aiLessonGenerator",ref:me,"lesson-config":ye.value,onPlanAccepted:Ue},null,8,["lesson-config"]),T(nn,{ref_key:"printLessonPlan",ref:ve,presentation:g.value,sections:b.value,slides:j.value,"teacher-name":(null==(o=O(n).teacher)?void 0:o.name)||"Teacher","subject-name":(null==(i=e.defaultContext)?void 0:i.subject_name)||"Subject","grade-name":(null==(_=e.defaultContext)?void 0:_.grade_name)||"Grade"},null,8,["presentation","sections","slides","teacher-name","subject-name","grade-name"])],64)}}},[["__scopeId","data-v-0d359264"]]);export{hn as default};
