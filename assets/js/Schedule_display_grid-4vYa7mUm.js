import{Q as e}from"./QTab-CYxYFXBq.js";import{Q as a}from"./QTabs-BClcf-CB.js";import{Q as l}from"./QSelect-BTh0khse.js";import{Q as r}from"./QTd-BU_S4ffH.js";import{Q as d}from"./QTable-BIAJAIui.js";import{f as o,i as s,k as i,l as u,Q as t,j as n,d as c}from"./app-DlLesFGi.js";import{f as m,a as p,k as v,N as y,O as h,J as f,R as b,b as g,K as j,I as _,W as Q,V as S,F as k,Q as I,_ as w}from"./vendor-BWKGNkNB.js";import C from"./DragDropScheduleTable-BPx8yqw3.js";import"./rtl-Cr6c3OOr.js";import"./QMarkupTable-CzIo4GGA.js";import"./QLinearProgress-CX6G9yBK.js";import"./use-fullscreen-BQHoXYBI.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./QSpace-BK_PGLKv.js";import"./QBar-BlDe36WY.js";import"./ScheduleGrid-CfwdiA_H.js";import"./QSlider-CuF3S-6I.js";import"./ScheduleGridControls-BiLVULvG.js";const T={key:0,class:"mt-4"},q={key:0,class:"p-4"},V={class:"row q-col-gutter-md"},x={class:"text-h6"},P={class:"text-subtitle2"},D={key:0},F={key:1,class:"text-grey q-pa-sm"},N={key:1,class:"p-4"},W={__name:"Schedule_display_grid",props:{schoolId:{type:Number,required:!0},scheduleCopyId:{type:Number,required:!0},schedule_data:{type:Array,required:!1}},setup(W){const A=m("drag"),G=W,M=m(G.schoolId),U=m(G.schedule_data),$=m(!1),E=m(null),J=(e,a)=>U.value.filter(l=>l.day===e&&l.period_number===a),L=[{name:"period_number",label:"Period",field:"period_number",align:"left"},{name:"day",label:"Day",field:"day",align:"left"},{name:"subject",label:"Subject",field:e=>{var a,l;return null==(l=null==(a=e.cst)?void 0:a.subject)?void 0:l.name},align:"left"},{name:"classroom",label:"Classroom",field:e=>{var a,l;return null==(l=null==(a=e.cst)?void 0:a.classroom)?void 0:l.name},align:"left"}],O=p(()=>E.value?U.value.filter(e=>{var a,l;return(null==(l=null==(a=e.cst)?void 0:a.teacher)?void 0:l.id)===E.value.id}):[]),B=p(()=>{if(!U.value.length)return[];return U.value.map(e=>{var a;return null==(a=e.cst)?void 0:a.teacher}).filter(e=>e).reduce((e,a)=>(e.some(e=>e.id===a.id)||e.push(a),e),[]).sort((e,a)=>e.name.localeCompare(a.name))}),H=e=>{console.log("Schedule updated:",e)};return v(()=>G.scheduleCopyId,async()=>{try{$.value=!0;const e=await w.get(`/admin/schedules/${G.schoolId}/${G.scheduleCopyId}`);U.value=e.data}catch(e){console.error("Error fetching schedule data:",e)}finally{$.value=!1}},{immediate:!0}),(m,p)=>M.value&&W.scheduleCopyId?(f(),y("div",T,[p[2]||(p[2]=b("div",{class:"text-h6 q-mb-md"},"Schedule Grid",-1)),g(a,{modelValue:A.value,"onUpdate:modelValue":p[0]||(p[0]=e=>A.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:j(()=>[g(e,{name:"grid",label:"grid"}),g(e,{name:"drag",label:"drag"})]),_:1},8,["modelValue"]),"grid"==A.value?(f(),y("div",q,[g(l,{modelValue:E.value,"onUpdate:modelValue":p[1]||(p[1]=e=>E.value=e),options:B.value,"option-label":"name","option-value":"id",label:"Filter by Teacher",outlined:"",dense:"",clearable:"",class:"q-mb-md"},null,8,["modelValue","options"]),E.value?(f(),_(d,{key:0,rows:O.value,columns:L,"row-key":"id",flat:"",bordered:"",loading:$.value,pagination:{rowsPerPage:0},"hide-pagination":""},{"body-cell-period_number":j(e=>[g(r,{props:e},{default:j(()=>[Q(" Period "+S(e.row.period_number),1)]),_:2},1032,["props"])]),"body-cell-day":j(e=>[g(r,{props:e},{default:j(()=>{return[Q(S((a=e.row.day,["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][a-1]||`Day ${a}`)),1)];var a}),_:2},1032,["props"])]),"body-cell-subject":j(e=>[g(r,{props:e},{default:j(()=>{var a,l;return[Q(S((null==(l=null==(a=e.row.cst)?void 0:a.subject)?void 0:l.name)||"-"),1)]}),_:2},1032,["props"])]),"body-cell-classroom":j(e=>[g(r,{props:e},{default:j(()=>{var a,l;return[Q(S((null==(l=null==(a=e.row.cst)?void 0:a.classroom)?void 0:l.name)||"-"),1)]}),_:2},1032,["props"])]),_:1},8,["rows","loading"])):h("",!0),b("div",V,[(f(),y(k,null,I(7,e=>b("div",{key:e,class:"col-12 col-md-4"},[g(c,{class:"q-pa-md"},{default:j(()=>[g(o,null,{default:j(()=>[b("div",x,"Day "+S(e),1),(f(),y(k,null,I(8,a=>b("div",{key:a,class:"q-mt-sm"},[b("div",P,"Period "+S(a),1),J(e,a).length?(f(),y("div",D,[g(s,{bordered:""},{default:j(()=>[(f(!0),y(k,null,I(J(e,a),e=>(f(),_(n,{key:e.id},{default:j(()=>[g(i,null,{default:j(()=>[g(u,null,{default:j(()=>{var a,l;return[Q(S(null==(l=null==(a=e.cst)?void 0:a.subject)?void 0:l.name),1)]}),_:2},1024),g(u,{caption:""},{default:j(()=>{var a,l,r,d;return[Q(S(null==(l=null==(a=e.cst)?void 0:a.teacher)?void 0:l.name)+" - "+S(null==(d=null==(r=e.cst)?void 0:r.classroom)?void 0:d.name),1)]}),_:2},1024)]),_:2},1024),g(i,{side:""},{default:j(()=>[g(t,{name:e.active?"check_circle":"cancel",color:e.active?"positive":"negative"},null,8,["name","color"])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)])):(f(),y("div",F," No schedule "))])),64))]),_:2},1024)]),_:2},1024)])),64))])])):h("",!0),"drag"==A.value?(f(),y("div",N,[W.schoolId?(f(),_(C,{key:0,"school-id":W.schoolId,scheduleCopyId:W.scheduleCopyId,teachers:B.value,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"],periods:8,initialSchedule:U.value,onScheduleChange:H},null,8,["school-id","scheduleCopyId","teachers","initialSchedule"])):h("",!0)])):h("",!0)])):h("",!0)}};export{W as default};
