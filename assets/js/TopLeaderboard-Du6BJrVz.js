const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/CertificateGenerator-C4ABtknX.js","assets/js/app-NYt77MEb.js","assets/js/vendor-BWKGNkNB.js","assets/js/offline-BzIlwqNM.js","assets/js/i18n-B0T1C7j3.js","assets/js/ui-B7TfxbV_.js","assets/css/app-o3SF-dGU.css","assets/js/QSpace-Cq53gbnC.js","assets/js/QBar-uLpv-h3v.js","assets/js/QSlider-ChpGyxM_.js","assets/css/CertificateGenerator-Dhbx-1tx.css"])))=>i.map(i=>d[i]);
import{r as e,u as l,f as a,b as t,t as o,d as r,_ as s,s as n,m as d}from"./app-NYt77MEb.js";import{Q as i}from"./QSelect-BfJwO5J-.js";import u from"./html2canvas.esm-Cq3pa7K9.js";import{u as c}from"./i18n-B0T1C7j3.js";import{f as v,a as p,o as f,k as b,N as m,O as g,J as w,b as h,K as y,R as x,I as k,V as S,z as _,W as z,F as C,Q as j,aS as V,n as L,U}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";const A={key:0,class:"mb-6"},N={class:"text-4xl md:text-6xl font-black tracking-wider text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-100 to-yellow-500 drop-shadow-lg animate-shine"},O={class:"mt-4"},I={class:"mt-6 flex flex-col md:flex-row items-center justify-center gap-4 px-4"},T={class:"text-sm text-yellow-200 mt-3 font-bold tracking-widest uppercase opacity-80"},W={key:0,class:"text-center py-16"},B={key:1,class:"flex flex-col md:flex-row justify-center items-end gap-6 md:gap-10 min-h-[580px]"},E={class:"text-center mb-6"},F={key:0,class:"text-9xl animate-bounce-slow drop-shadow-2xl"},R={key:1,class:"text-8xl drop-shadow-2xl"},J={class:"text-center pt-8 pb-4 relative z-10"},P={class:"text-4xl font-black italic tracking-wider text-white drop-shadow-2xl"},Q={class:"px-4 pb-4 relative z-10"},D={class:"space-y-4"},$=["src"],G={class:"flex-1 min-w-0"},K={class:"font-black"},M={class:"shiny-name text-3xl md:text-4xl leading-tight block truncate"},X={class:"shiny-name-small block text-lg mt-1 opacity-95 truncate"},q={class:"text-yellow-300 font-bold text-lg mt-1"},H={class:"bg-gradient-to-b from-gray-800 to-gray-900 rounded-2xl p-6 border-2 border-gray-700"},Y={class:"flex items-center justify-between mb-6 flex-wrap gap-3"},Z={class:"text-2xl font-bold text-yellow-400 text-center flex-1"},ee={class:"flex gap-2"},le={class:"space-y-3"},ae={class:"flex items-center gap-5"},te={class:"flex-shrink-0 w-14 h-14 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center border-4 border-yellow-300 shadow-lg"},oe={class:"text-white font-black text-2xl"},re={class:"flex-1 flex flex-wrap gap-4"},se=["src"],ne={class:"font-bold text-lg"},de={class:"shiny-name"},ie={class:"shiny-name-small text-sm ml-1"},ue={class:"text-yellow-300 text-sm font-semibold"},ce=e({__name:"TopLeaderboard",props:{students:{type:Array,default:()=>[]},studentBehaviors:{type:Object,default:()=>({})},periodCode:{type:String,default:""},date:{type:String,default:""},schoolLogo:{type:String,default:null}},setup(e){const ce=V(()=>s(()=>import("./CertificateGenerator-C4ABtknX.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ve=l(),{t:pe}=c(),fe=e,be=v({label:"Current Session",value:"session"}),me=v(5),ge=p(()=>[{label:pe("rewardSys.leaderboard.currentSession"),value:"session"},{label:pe("rewardSys.leaderboard.today"),value:"today"},{label:pe("rewardSys.leaderboard.thisWeek"),value:"week"},{label:pe("rewardSys.leaderboard.allTime"),value:"all"}]);f(()=>{const e=localStorage.getItem("leaderboard_preferences");if(e)try{const l=JSON.parse(e),a=ge.find(e=>e.value===l.scope);a&&(be.value=a),l.topCount&&(me.value=l.topCount)}catch(l){console.error(l)}}),b([be,me],()=>{localStorage.setItem("leaderboard_preferences",JSON.stringify({scope:be.value.value,topCount:me.value}))},{deep:!0});const we=p(()=>{if(!fe.students.length)return[];const e=fe.students.map(e=>{const l=fe.studentBehaviors[e.id]||{},a=(l.points_plus||0)-(l.points_minus||0);return{...e,total:a}}).filter(e=>e.total>0).sort((e,l)=>l.total-e.total);if(!e.length)return[];const l=[];let a={rank:1,total:e[0].total,students:[e[0]]};for(let t=1;t<e.length;t++)e[t].total===a.total?a.students.push(e[t]):(l.push(a),a={rank:l.length+1,total:e[t].total,students:[e[t]]});return l.push(a),l.slice(0,me.value)}),he=p(()=>we.value.slice(0,3)),ye=p(()=>we.value),xe=p(()=>{const e=he.value,l=e.find(e=>1===e.rank);return[e.find(e=>2===e.rank),l,e.find(e=>3===e.rank)].filter(Boolean)});function ke(){console.log("Filters applied")}function Se(){be.value=ge[0],me.value=5}function _e(e){const l=["th","st","nd","rd"],a=e%100;return e+(l[(a-20)%10]||l[a]||l[0])}function ze(e){return 1===e?"bg-gradient-to-b from-yellow-400 via-yellow-500 to-yellow-700 border-yellow-300 shadow-yellow-500/70 ring-8 ring-yellow-400/40":2===e?"bg-gradient-to-b from-gray-300 via-gray-400 to-gray-600 border-gray-200 shadow-gray-500/50":3===e?"bg-gradient-to-b from-orange-400 via-orange-500 to-orange-700 border-orange-300 shadow-orange-500/50":""}const Ce=v(null),je=v(!1);function Ve(){je.value=!0,L(()=>{const e=Ce.value;return e?document.contains(e)?void u(e).then(e=>{const l=e.toDataURL("image/png");navigator.canShare&&navigator.canShare({files:[]})?fetch(l).then(e=>e.blob()).then(e=>{const l=new File([e],"leaderboard.png",{type:"image/png"});return navigator.share({files:[l],title:"Leaderboard"})}).then(()=>{ve.notify({message:"Shared successfully!",color:"positive"})}).catch(()=>{Le(l)}):Le(l)}).catch(e=>{console.error(e),ve.notify({message:"Screenshot failed",color:"negative"})}).finally(()=>{je.value=!1}):(ve.notify({message:"Element not available for screenshot",color:"negative"}),void(je.value=!1)):(ve.notify({message:"Leaderboard element not found",color:"negative"}),void(je.value=!1))})}function Le(e){const l=document.createElement("a");l.href=e,l.download="leaderboard.png",l.click(),ve.notify({message:"Screenshot downloaded â€“ share on WhatsApp!",color:"positive",icon:"download"})}function Ue(e="S"){const l=e.split(" ").map(e=>e[0]).slice(0,2).join("").toUpperCase();return`data:image/svg+xml,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140"><rect width="140" height="140" fill="#1e293b"/><text x="70" y="70" dy="12" text-anchor="middle" font-size="60" font-family="Arial" font-weight="bold" fill="#cbd5e1">${l}</text></svg>`)}`}const Ae=v(new Set),Ne=p(()=>we.value.flatMap(e=>e.students));function Oe(){Ae.value.size===Ne.value.length?Ae.value.clear():Ae.value=new Set(Ne.value.map(e=>e.id))}const Ie=v(!1),Te=v(null),We=v([]);function Be(e){Te.value=e,We.value=[],Ie.value=!0}function Ee(){Ae.value.size>0?We.value=Ne.value.filter(e=>Ae.value.has(e.id)):We.value=Ne.value,Te.value=null,Ie.value=!0}return(l,s)=>e.students.length?(w(),m("div",A,[h(r,{class:"shadow-2xl rounded-3xl overflow-hidden bg-gray-900 border-4 border-yellow-500 relative"},{default:y(()=>[s[7]||(s[7]=x("div",{class:"absolute inset-0 overflow-hidden pointer-events-none"},[x("div",{class:"stars"}),x("div",{class:"twinkling"})],-1)),h(a,{class:"relative z-10 text-center py-6 bg-gradient-to-b from-transparent to-black/50"},{default:y(()=>[x("h1",N," ðŸ† "+S(_(pe)("rewardSys.leaderboard.champions"))+" ðŸ† ",1),x("div",O,[h(t,{color:"yellow-7",icon:"print",label:Ae.value.size>0?_(pe)("rewardSys.leaderboard.printSelected",{count:Ae.value.size,plural:Ae.value.size>1?"s":""}):_(pe)("rewardSys.leaderboard.printAllCertificates"),size:"lg",class:"text-lg font-bold shadow-2xl px-8 py-3",onClick:Ee,disable:0===Ne.value.length},{default:y(()=>[h(o,null,{default:y(()=>[z(S(_(pe)("rewardSys.leaderboard.generateFor",{target:Ae.value.size>0?_(pe)("rewardSys.leaderboard.selectedStudents"):_(pe)("rewardSys.leaderboard.allChampions")})),1)]),_:1})]),_:1},8,["label","disable"])]),x("div",I,[h(i,{modelValue:be.value,"onUpdate:modelValue":[s[0]||(s[0]=e=>be.value=e),ke],options:ge.value,outlined:"",dense:"",dark:"",label:_(pe)("rewardSys.leaderboard.filterScope"),class:"w-full md:w-48 bg-black/30"},null,8,["modelValue","options","label"]),h(i,{modelValue:me.value,"onUpdate:modelValue":[s[1]||(s[1]=e=>me.value=e),ke],options:[{label:"Top 5",value:5},{label:"Top 10",value:10}],outlined:"",dense:"",dark:"",label:_(pe)("rewardSys.leaderboard.showPlaces"),class:"w-full md:w-32 bg-black/30","emit-value":"","map-options":""},null,8,["modelValue","label"]),h(t,{color:"yellow-7",icon:"refresh",label:_(pe)("rewardSys.leaderboard.reset"),onClick:Se,size:"md",class:"w-full md:w-auto"},null,8,["label"])]),x("p",T,S(be.value.label)+" â€¢ "+S(_(pe)("rewardSys.leaderboard.topN",{n:me.value})),1)]),_:1}),h(a,{class:"p-4 md:p-8 relative z-10"},{default:y(()=>[0===he.value.length?(w(),m("div",W,s[3]||(s[3]=[x("p",{class:"text-3xl text-yellow-400 font-bold animate-pulse"},"The arena is empty... Who will rise? âš”ï¸",-1)]))):(w(),m("div",B,[(w(!0),m(C,null,j(xe.value,(e,l)=>{return w(),m(C,{key:(null==e?void 0:e.rank)||l},[e?(w(),m("div",{key:0,class:U(["w-full md:w-1/3 flex flex-col transition-all duration-700 podium-card",[1===e.rank?"order-2 md:mb-32 z-30":2===e.rank?"order-1 md:mb-12 z-20":"order-3 z-20"]])},[x("div",E,[1===e.rank?(w(),m("div",F,"ðŸ‘‘")):(w(),m("div",R,S((a=e.rank,1===a?"ðŸ¥‡":2===a?"ðŸ¥ˆ":3===a?"ðŸ¥‰":"")),1))]),x("div",{class:U(["relative rounded-3xl overflow-hidden border-4 shadow-2xl backdrop-blur-xl flex flex-col mx-4 pb-6",ze(e.rank)])},[s[6]||(s[6]=x("div",{class:"absolute inset-0 bg-gradient-to-tr from-white/0 via-white/30 to-white/0 w-[200%] h-full animate-shine-move pointer-events-none"},null,-1)),x("div",J,[x("h2",P,S(_e(e.rank)),1),s[4]||(s[4]=x("div",{class:"h-1 w-32 mx-auto bg-white/40 rounded-full mt-3"},null,-1))]),x("div",Q,[x("div",D,[(w(!0),m(C,null,j(e.students,e=>(w(),m("div",{key:e.id,class:"bg-black/70 rounded-2xl p-4 backdrop-blur-md border border-white/20 shadow-xl hover:border-yellow-400/50 transition-all flex items-center gap-4"},[h(n,{size:"80px",class:"ring-4 ring-yellow-400/60 shadow-xl border-2 flex-shrink-0"},{default:y(()=>[x("img",{src:e.avatar||Ue(e.name),class:"object-cover"},null,8,$)]),_:2},1024),x("div",G,[x("div",K,[x("span",M,S(e.firstName),1),x("span",X,S(e.lastName),1)]),x("div",q,S(e.total)+" pts",1)]),h(t,{flat:"",round:"",color:"white",icon:"card_membership",onClick:l=>Be(e)},{default:y(()=>[h(o,null,{default:y(()=>s[5]||(s[5]=[z("Print Certificate")])),_:1})]),_:2},1032,["onClick"])]))),128))])])],2)],2)):g("",!0)],64);var a}),128))]))]),_:1}),ye.value.length>0?(w(),k(a,{key:0,ref_key:"leaderboardList",ref:Ce,class:"p-4 md:p-8 pt-0 relative z-10"},{default:y(()=>[x("div",H,[x("div",Y,[x("h3",Z,"ðŸ† "+S(_(pe)("rewardSys.leaderboard.completeLeaderboard"))+" ðŸ†",1),x("div",ee,[h(t,{outline:"",dense:"",color:"yellow-500",icon:Ae.value.size===Ne.value.length?"check_box":"check_box_outline_blank",label:Ae.value.size===Ne.value.length?_(pe)("rewardSys.leaderboard.deselectAll"):_(pe)("rewardSys.leaderboard.selectAll"),onClick:Oe,size:"sm"},null,8,["icon","label"]),h(t,{color:"green",icon:"screenshot",label:_(pe)("rewardSys.leaderboard.share"),onClick:Ve,loading:je.value,class:"shadow-lg"},{default:y(()=>[h(o,null,{default:y(()=>[z(S(_(pe)("rewardSys.leaderboard.shareOnWhatsApp")),1)]),_:1})]),_:1},8,["label","loading"])])]),x("div",le,[(w(!0),m(C,null,j(ye.value,e=>(w(),m("div",{key:e.rank,class:"bg-gradient-to-r from-gray-700 to-gray-800 rounded-xl p-5 border border-gray-600 hover:border-yellow-500 hover:shadow-yellow-500/30 transition-all duration-300"},[x("div",ae,[x("div",te,[x("span",oe,S(e.rank),1)]),x("div",re,[(w(!0),m(C,null,j(e.students,e=>(w(),m("div",{key:e.id,class:"flex items-center gap-3 bg-black/50 rounded-lg px-4 py-3 backdrop-blur-sm"},[h(d,{"model-value":Ae.value.has(e.id),"onUpdate:modelValue":l=>function(e){Ae.value.has(e.id)?Ae.value.delete(e.id):Ae.value.add(e.id),Ae.value=new Set(Ae.value)}(e),color:"yellow-500",dark:""},null,8,["model-value","onUpdate:modelValue"]),h(n,{size:"48px",class:"border-2 border-yellow-500/40"},{default:y(()=>[x("img",{src:e.avatar||Ue(e.name)},null,8,se)]),_:2},1024),x("div",null,[x("div",ne,[x("span",de,S(e.firstName),1),x("span",ie,S(e.lastName),1)]),x("div",ue,S(e.total)+" pts",1)]),h(t,{flat:"",round:"",dense:"",color:"yellow-500",icon:"card_membership",onClick:l=>Be(e)},{default:y(()=>[h(o,null,{default:y(()=>[z(S(_(pe)("rewardSys.leaderboard.printCertificate")),1)]),_:1})]),_:2},1032,["onClick"])]))),128))])])]))),128))])])]),_:1},512)):g("",!0),h(_(ce),{modelValue:Ie.value,"onUpdate:modelValue":s[2]||(s[2]=e=>Ie.value=e),student:Te.value,students:We.value,"default-date":e.date,"school-logo":e.schoolLogo},null,8,["modelValue","student","students","default-date","school-logo"])]),_:1})])):g("",!0)}},[["__scopeId","data-v-3479b303"]]);export{ce as default};
