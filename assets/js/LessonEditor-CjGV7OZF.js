import e from"./LessonVideoPlayer-BD92opUE.js";import s from"./LessonTimeline-BLg9CseJ.js";import t from"./QuestionDisplay-bbCRIZIt.js";import o from"./QuestionEditor-9te7eoEo.js";import n from"./LessonControls-CNZo82v6.js";import i from"./ActivityCard-Cf-Gkbwl.js";import a from"./TeacherPanel-AJwLYz7s.js";import r from"./StudentPanel-ClaRKkoB.js";import{D as l}from"./import-wrapper-prod-CRZ4ZIdA.js";import d from"./fileManager-BJgFtrQl.js";import{o as u}from"./app-C-WHvmzS.js";import{r as c,f as p,a as m,k as v,t as f,N as y,J as q,O as g,b as T,I as w,Q as j,F as h,R as I,V as S}from"./vendor-nQjeLEvd.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";import"./_commonjs-dynamic-modules-BHR_E30J.js";const k={lessonId:"lesson-1",title:"Demo: Introduction to Fractions",slides:[{slideId:"slide-1",title:"Introduction to Fractions",video:{src:"https://cdn.virtualnerd.com/videos/Gr6_10_01_0008.mp4",playFrom:0,playTo:120},timeline:[{id:"t1",type:"videoSegment",start:0,end:30,trigger:"auto"},{id:"t2",type:"question",questionId:"q1",trigger:"time",time:30},{id:"t3",type:"pause",trigger:"click"},{id:"t4",type:"continueVideo",start:30,end:60,trigger:"auto"},{id:"t5",type:"question",questionId:"q2",trigger:"click"},{id:"t6",type:"continueVideo",start:60,end:120,trigger:"auto"}],questions:[{id:"q1",type:"MultipleChoice",questionText:"Which fraction is equivalent to 1/2?",options:["1/3","2/4","3/5"],correctAnswer:"2/4",points:{correct:5,wrong:-1},sounds:{correct:"/assets/sounds/correct.mp3",wrong:"/assets/sounds/wrong.mp3"}},{id:"q2",type:"OpenEnded",questionText:"Write 1/4 as a decimal:",correctAnswer:"0.25",points:{correct:5,wrong:-1},sounds:{correct:"/assets/sounds/correct.mp3",wrong:"/assets/sounds/wrong.mp3"}}]}]},L=new l("LessonEditorDB");L.version(1).stores({lessons:"lessonId, updatedAt"});const b={saveLessonToIndexedDB:async function(e){const s={...e,updatedAt:Date.now()};return await L.lessons.put(s),s},loadLessonFromIndexedDB:async function(e){return await L.lessons.get(e)},loadLastLesson:async function(){const e=await L.lessons.orderBy("updatedAt").reverse().toArray();return e.length?e[0]:null},clearLessons:async function(){await L.table("lessons").clear()}},x={class:"lesson-editor q-gutter-md"},A={class:"row"},D={class:"col-7"},E={class:"player-area"},F={class:"activities q-mt-md"},_={class:"col-5"},O={class:"side-panels q-pa-sm"},B={class:"timeline-card q-mb-md"},Q={class:"teacher-card q-mb-md"},N={class:"student-card q-mb-md"},P={class:"row q-mt-md"},V={class:"col-12"},C=u({__name:"LessonEditor",setup(l){const u=c(JSON.parse(JSON.stringify(k))),L=p(0),C=m(()=>u.slides[L.value]),J=p(null),M=p(0),R=p(0),$=p(null);async function W(){await b.saveLessonToIndexedDB(u)}async function G(){await d.exportLessonAsZip(u)}async function H({lesson:e}){e&&(Object.keys(u).forEach(e=>delete u[e]),Object.assign(u,e))}function K(e){if(e&&"question"===e.type){const s=C.value.questions.find(s=>s.id===e.questionId);s&&(J.value=s)}}function U({questionId:e,correct:s,points:t}){M.value+=t||0,J.value=null}function Z(e){$.value&&$.value.seekTo&&$.value.seekTo(e)}function z(e){const s=C.value.questions.find(s=>s.id===e);J.value=s||null}v(u,e=>{b.saveLessonToIndexedDB(e).catch(()=>{})},{deep:!0});const X=m(()=>{const e=f(u).slides||[],s=[];return e.forEach((e,t)=>{e.video&&s.push({id:`slide-${t}-video`,title:e.title,type:"videoSegment",startTime:e.video.playFrom||0,duration:e.video.playTo?e.video.playTo-(e.video.playFrom||0):e.video.duration||0}),(e.timeline||[]).forEach((o,n)=>{var i,a,r,l;s.push({id:o.id||`t-${t}-${n}`,title:o.title||o.type,type:o.type,startTime:null!=(a=null!=(i=o.time)?i:o.start)?a:0,duration:null!=o.end&&null!=o.start?o.end-o.start:null!=(r=o.duration)?r:0,question:null==(l=e.questions)?void 0:l.find(e=>e.id===o.questionId)})})}),s.sort((e,s)=>(e.startTime||0)-(s.startTime||0)),s});function Y(){console.log("Teacher start")}function ee(){console.log("Teacher pause")}function se(){console.log("Teacher next")}function te(e){console.log("Feedback:",e)}function oe(){console.log("Student requested help")}function ne(){console.log("Student marked done")}function ie(e){console.log("Student submitted:",e)}return(l,d)=>(q(),y("div",x,[g("div",A,[g("div",D,[g("div",E,[T(e,{slide:C.value,onTimelineEvent:K,ref_key:"player",ref:$},null,8,["slide"]),J.value?(q(),w(t,{key:0,question:J.value,onAnswered:U},null,8,["question"])):j("",!0)]),g("div",F,[(q(!0),y(h,null,I(X.value,e=>(q(),w(i,{key:e.id,activity:e},null,8,["activity"]))),128))])]),g("div",_,[g("div",O,[g("div",B,[d[1]||(d[1]=g("h4",null,"Timeline",-1)),T(s,{activities:X.value,onSeekTo:Z,onSelectQuestion:z},null,8,["activities"])]),g("div",Q,[T(a,{onStart:Y,onPause:ee,onNext:se,onFeedback:te})]),g("div",N,[T(r,{onRequestHelp:oe,onMarkDone:ne,onSubmitAnswer:ie})]),T(o,{questions:C.value.questions,onUpdateQuestions:d[0]||(d[0]=e=>C.value.questions=e)},null,8,["questions"]),T(n,{lesson:u,onSave:W,onExport:G,onImported:H},null,8,["lesson"])])])]),g("div",P,[g("div",V,[g("div",null,"Slide progress: "+S(R.value)+"% â€” Total points: "+S(M.value),1)])])]))}},[["__scopeId","data-v-87348e38"]]);export{C as default};
