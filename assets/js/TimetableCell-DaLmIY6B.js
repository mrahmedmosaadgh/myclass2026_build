import{o as e,d as l,p as t,h as s,i as a,g as c,aj as n,aP as u}from"./app-B77gjd5a.js";import{a as o,M as i,J as d,I as r,Q as v,b as h,N as m,V as _,S as f,W as g,K as p,y as b,U as y}from"./vendor-DuKqz2x4.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";const j={key:0,class:"empty-cell"},x={key:1,class:"assigned-cell"},k=["title"],C=["title"],$={key:0,class:"classroom-name text-caption text-grey-6"},I={class:"indicators"},w=e({__name:"TimetableCell",props:{schedule:{type:Object,default:null},showClassroom:{type:Boolean,default:!1},conflictInfo:{type:Object,default:null}},emits:["click","edit","clear"],setup(e){const w=e,z=o(()=>{var e,l,t,s,a;return(null==(t=null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.subject)?void 0:t.name)||(null==(a=null==(s=w.schedule)?void 0:s.cst)?void 0:a.subject_name)||"Subject"});o(()=>{var e,l,t,s,a;return(null==(t=null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.teacher)?void 0:t.name)||(null==(a=null==(s=w.schedule)?void 0:s.cst)?void 0:a.teacher_name)||"Teacher"});const T=o(()=>{var e,l,t,s,a;return(null==(t=null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.subject)?void 0:t.name)||(null==(a=null==(s=w.schedule)?void 0:s.cst)?void 0:a.subject_name)||"Subject"}),S=o(()=>{var e,l,t,s,a;return(null==(t=null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.teacher)?void 0:t.name)||(null==(a=null==(s=w.schedule)?void 0:s.cst)?void 0:a.teacher_name)||"Teacher"});o(()=>{const e=T.value;return e.length>3?e.substring(0,3):e});const H=o(()=>{const e=S.value.split(" ");if(1===e.length)return e[0].length>3?e[0].substring(0,3):e[0];return`${e[0].length>3?e[0].substring(0,3):e[0]} ${e[e.length-1].length>3?e[e.length-1].substring(0,3):e[e.length-1]}`}),O=o(()=>{var e,l,t,s,a;return(null==(t=null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.classroom)?void 0:t.name)||(null==(a=null==(s=w.schedule)?void 0:s.cst)?void 0:a.classroom_name)||""}),q=o(()=>{var e,l,t,s;return(null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.c_bg)||(null==(s=null==(t=w.schedule)?void 0:t.cst)?void 0:s.color_custom)||"#e0e0e0"}),A=o(()=>{var e,l,t,s;return(null==(l=null==(e=w.schedule)?void 0:e.cst)?void 0:l.c_text)||(null==(s=null==(t=w.schedule)?void 0:t.cst)?void 0:s.color_custom_text)||"#333333"}),B=o(()=>{var e,l,t;return{"is-empty":!(null==(e=w.schedule)?void 0:e.cst_id),"is-assigned":!!(null==(l=w.schedule)?void 0:l.cst_id),"has-substitute":!!(null==(t=w.schedule)?void 0:t.teacher_substitute_id),"has-conflict":!!w.conflictInfo,"cursor-pointer":!0}}),E=o(()=>!!w.conflictInfo),J=o(()=>{if(!w.conflictInfo)return"";const e=w.conflictInfo.other_classrooms||[];if(0===e.length)return"Teacher has a scheduling conflict";const l=e.map(e=>`${e.classroom_name} (${e.subject_name})`).join(", ");return`⚠️ Conflict: ${w.conflictInfo.teacher_name} is also assigned to: ${l}`});return(o,w)=>{var K,M;return d(),i("div",{class:y(["timetable-cell",B.value]),onClick:w[2]||(w[2]=l=>o.$emit("click",e.schedule))},[(null==(K=e.schedule)?void 0:K.cst_id)?(d(),i("div",x,[m("div",{class:"subject-badge",style:f({backgroundColor:q.value,color:A.value}),title:T.value},_(z.value),13,k),m("div",{class:"teacher-name text-caption scale-75",title:S.value},[h(l,{name:"person",size:"xs",class:"q-mr-xs text-gray-500"}),g(" "+_(H.value),1)],8,C),e.showClassroom?(d(),i("div",$,_(O.value),1)):v("",!0),m("div",I,[E.value?(d(),r(l,{key:0,name:"warning",size:"sm",color:"red",class:"conflict-icon"},{default:p(()=>[h(t,{class:"bg-red text-white"},{default:p(()=>[g(_(J.value),1)]),_:1})]),_:1})):v("",!0),e.schedule.teacher_substitute_id?(d(),r(l,{key:1,name:"swap_horiz",size:"xs",color:"orange"},{default:p(()=>[h(t,null,{default:p(()=>w[4]||(w[4]=[g("Has substitute teacher")])),_:1})]),_:1})):v("",!0),e.schedule.co_teacher_id?(d(),r(l,{key:2,name:"group",size:"xs",color:"blue"},{default:p(()=>[h(t,null,{default:p(()=>w[5]||(w[5]=[g("Has co-teacher")])),_:1})]),_:1})):v("",!0)])])):(d(),i("div",j,[h(l,{name:"add",size:"sm",color:"grey-5"}),w[3]||(w[3]=m("span",{class:"text-caption text-grey-6"},"Assign",-1))])),(null==(M=e.schedule)?void 0:M.cst_id)?(d(),r(n,{key:2,"touch-position":"","context-menu":""},{default:p(()=>[h(c,{dense:"",style:{"min-width":"150px"}},{default:p(()=>[b((d(),r(s,{clickable:"",onClick:w[0]||(w[0]=l=>o.$emit("edit",e.schedule))},{default:p(()=>[h(a,{avatar:""},{default:p(()=>[h(l,{name:"edit"})]),_:1}),h(a,null,{default:p(()=>w[6]||(w[6]=[g("Edit")])),_:1})]),_:1})),[[u]]),b((d(),r(s,{clickable:"",onClick:w[1]||(w[1]=l=>o.$emit("clear",e.schedule))},{default:p(()=>[h(a,{avatar:""},{default:p(()=>[h(l,{name:"clear",color:"negative"})]),_:1}),h(a,null,{default:p(()=>w[7]||(w[7]=[g("Clear")])),_:1})]),_:1})),[[u]])]),_:1})]),_:1})):v("",!0)],2)}}},[["__scopeId","data-v-7181d38a"]]);export{w as default};
