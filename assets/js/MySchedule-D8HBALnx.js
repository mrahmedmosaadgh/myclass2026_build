import{r as e,u as a,Q as s,d as l}from"./app-4gpSDtVV.js";import{Q as t}from"./QSpinnerDots-BRGXnI5e.js";import{u as r}from"./i18n-B0T1C7j3.js";import{f as c,a as o,o as i,af as d,N as n,J as u,b as m,R as y,z as v,I as p,O as h,W as g,V as k,K as w,F as x,Q as b,_ as S,S as f,$ as j}from"./vendor-BWKGNkNB.js";import _ from"./WeeklyPlanMenu-z9VxScNf.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./QTab-CqyOuMp5.js";import"./QTabs-C8SafNXA.js";import"./rtl-Cr6c3OOr.js";import"./QSpace-BaiVAeLS.js";import"./WeeklySystemGuide-hcv64H-z.js";import"./QTabPanel-B7R9UqSU.js";import"./use-panel-BBaQ5jFM.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-BOmHgprU.js";import"./MainSchoolData-3OP93oEQ.js";import"./QBadge-6oS4ziQU.js";import"./schoolData-CWFtmgnE.js";import"./SchoolSettingsDialog-BAhIxeQR.js";import"./QSelect-Dgk9Cshp.js";import"./QForm-B3HUaoek.js";const q={class:"q-pa-md"},Q={class:"row items-center q-mb-lg"},D={class:"col"},P={class:"q-ma-none text-weight-bold"},$={class:"text-grey-7 q-mb-none"},z={key:0,class:"row justify-center q-pa-xl"},C={class:"text-h6 text-grey-7 q-mt-md"},T={class:"text-grey-6"},B={key:2,class:"timetable-container"},F={class:"grid-row header-row"},M={class:"grid-cell period-header"},W={class:"period-number"},E=["onClick"],I={class:"card-content"},R={class:"subject"},A={class:"classroom"},G={key:1,class:"free-period text-caption text-grey-5"},H={class:"row q-gutter-lg justify-center"},J={class:"text-center"},K={class:"text-h4 text-primary"},N={class:"text-caption text-grey-7"},O={class:"text-center"},V={class:"text-h4 text-secondary"},L={class:"text-caption text-grey-7"},U={class:"text-center"},X={class:"text-h4 text-accent"},Y={class:"text-caption text-grey-7"},Z=e({__name:"MySchedule",setup(e){const{t:Z}=r(),ee=a(),ae=c([]),se=c(!1),le=o(()=>[{value:1,label:Z("weeklyPlans.fullDays.1")},{value:2,label:Z("weeklyPlans.fullDays.2")},{value:3,label:Z("weeklyPlans.fullDays.3")},{value:4,label:Z("weeklyPlans.fullDays.4")},{value:5,label:Z("weeklyPlans.fullDays.5")}]),te=[1,2,3,4,5,6,7,8],re=o(()=>{const e={};return ae.value.forEach(a=>{const s=`${a.day}-${a.period_number}`;e[s]=a}),e}),ce=o(()=>ae.value.length),oe=o(()=>new Set(ae.value.map(e=>{var a;return null==(a=e.cst)?void 0:a.classroom_id})).size),ie=o(()=>new Set(ae.value.map(e=>{var a;return null==(a=e.cst)?void 0:a.subject_id})).size),de=(e,a)=>re.value[`${e}-${a}`],ne=(e,a)=>{const s=de(e,a);return(null==s?void 0:s.cst)?{backgroundColor:s.cst.c_bg||"#e0e0e0",color:s.cst.c_text||"#333"}:{}};return i(()=>{(async()=>{se.value=!0;try{const e=await S.get("/weekly-system/api/teacher/my-schedule");ae.value=e.data.data||e.data||[]}catch(e){console.error("Error fetching schedule:",e),ee.notify({type:"negative",message:Z("weeklySystem.notifications.loadFailed")})}finally{se.value=!1}})()}),(e,a)=>{const r=d("Head");return u(),n(x,null,[m(r,{title:v(Z)("weeklySystem.mySchedule.title")},null,8,["title"]),y("div",q,[m(_),y("div",Q,[y("div",D,[y("h4",P,[m(s,{name:"calendar_month",class:"q-mr-sm",color:"primary"}),g(" "+k(v(Z)("weeklySystem.mySchedule.title")),1)]),y("p",$,k(v(Z)("weeklySystem.mySchedule.subtitle")),1)])]),se.value?(u(),n("div",z,[m(t,{size:"50px",color:"primary"})])):ae.value.length?(u(),n("div",B,[y("div",F,[a[0]||(a[0]=y("div",{class:"grid-cell period-header"},null,-1)),(u(!0),n(x,null,b(le.value,e=>(u(),n("div",{key:e.value,class:"grid-cell day-header"},k(v(Z)(`weeklyPlans.shortDays.${e.value}`)),1))),128))]),(u(),n(x,null,b(te,e=>y("div",{key:e,class:"grid-row"},[y("div",M,[y("div",W,k(e),1)]),(u(!0),n(x,null,b(le.value,a=>{var l,t;return u(),n("div",{key:`${a.value}-${e}`,class:"grid-cell"},[de(a.value,e)?(u(),n("div",{key:0,class:"schedule-card",style:f(ne(a.value,e)),onClick:s=>((e,a)=>{const s=de(e,a);s&&j.visit("/my_table_mnger/weekly_system/teacher/my-weekly-plans",{data:{schedule_id:s.id}})})(a.value,e)},[y("div",I,[y("div",R,k(null==(l=de(a.value,e).cst)?void 0:l.subject_name),1),y("div",A,[m(s,{name:"meeting_room",size:"xs"}),g(" "+k(null==(t=de(a.value,e).cst)?void 0:t.classroom_name),1)])])],12,E)):(u(),n("div",G,k(v(Z)("weeklySystem.mySchedule.free")),1))])}),128))])),64))])):(u(),p(l,{key:1,flat:"",bordered:"",class:"text-center q-pa-xl"},{default:w(()=>[m(s,{name:"event_busy",size:"64px",color:"grey-5"}),y("p",C,k(v(Z)("weeklySystem.schoolBrowser.noDataTitle")),1),y("p",T,k(v(Z)("weeklySystem.mySchedule.emptyState")),1)]),_:1})),ae.value.length?(u(),p(l,{key:3,flat:"",bordered:"",class:"q-mt-lg q-pa-md"},{default:w(()=>[y("div",H,[y("div",J,[y("div",K,k(ce.value),1),y("div",N,k(v(Z)("weeklySystem.mySchedule.totalClasses")),1)]),y("div",O,[y("div",V,k(oe.value),1),y("div",L,k(v(Z)("weeklySystem.mySchedule.classrooms")),1)]),y("div",U,[y("div",X,k(ie.value),1),y("div",Y,k(v(Z)("weeklySystem.mySchedule.subjects")),1)])])]),_:1})):h("",!0)])],64)}}},[["__scopeId","data-v-bd704b76"]]);export{Z as default};
