import{Q as e}from"./QSpace-CfcdpSpD.js";import{u as l,m as a,c as s,aP as t,Q as u,l as o,b as i}from"./app-BB4Fw2oM.js";import{f as n,k as r,o as d,M as c,J as m,N as p,b as f,y as v,ab as b,F as g,R as y,V as x,K as h,ac as _,ae as w,_ as z}from"./vendor-DuKqz2x4.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";const q={class:"space-y-3"},V={class:"flex items-center gap-3 flex-wrap"},j={class:"flex items-center gap-2"},I=["value"],Q={class:"flex items-center gap-2"},k=["value"],N={class:"flex items-center gap-2"},U=["value"],C=["value"],S={class:"space-y-4"},F={class:"flex items-center gap-4"},A={class:"flex items-center gap-2"},E={class:"flex items-center gap-2"},G={__name:"QuizSelector",props:{modelValue:{type:Number,default:null},schoolId:{type:Number,required:!0},gradeId:{type:Number,default:null},subjectId:{type:Number,default:null}},emits:["update:modelValue"],setup(G,{emit:O}){const P=G,R=O,D=l(),J=n([]),K=n([]),L=n([]),M=n(P.gradeId),T=n(P.subjectId),$=n(!1),B=n(!1),H=n({name:"",description:"",time_limit_minutes:null,shuffle_questions:!1,shuffle_options:!1,allow_review:!0}),W=async()=>{var e,l;try{const a={school_id:P.schoolId,status:"active"};M.value&&(a.grade_id=M.value),T.value&&(a.subject_id=T.value);const s=await z.get("/api/quizzes",{params:a});s.data.quizzes?(J.value=s.data.quizzes,K.value=(null==(e=s.data.filters)?void 0:e.grades)||[],L.value=(null==(l=s.data.filters)?void 0:l.subjects)||[]):J.value=s.data}catch(a){console.error("Failed to fetch quizzes:",a),D.notify({type:"negative",message:"Failed to load quizzes",icon:"error",position:"top"})}},X=async()=>{if(H.value.name){B.value=!0;try{const e=await z.post("/api/quizzes",{...H.value,school_id:P.schoolId,grade_id:M.value||P.gradeId,subject_id:T.value||P.subjectId,status:"active"});D.notify({type:"positive",message:"Quiz created successfully!",icon:"check_circle",position:"top"}),await W(),R("update:modelValue",e.data.id),H.value={name:"",description:"",time_limit_minutes:null,shuffle_questions:!1,shuffle_options:!1,allow_review:!0},$.value=!1}catch(e){console.error("Failed to create quiz:",e),D.notify({type:"negative",message:"Failed to create quiz",icon:"error",position:"top"})}finally{B.value=!1}}else D.notify({type:"warning",message:"Please enter a quiz name",icon:"warning",position:"top"})};return r(()=>P.modelValue,e=>{"create-new"===e&&($.value=!0,R("update:modelValue",null))}),r([M,T],()=>{W()}),r([()=>P.gradeId,()=>P.subjectId],()=>{M.value=P.gradeId,T.value=P.subjectId,W()}),d(()=>{W()}),(l,n)=>(m(),c("div",null,[p("div",q,[p("div",V,[p("div",j,[n[10]||(n[10]=p("label",{class:"text-sm font-medium text-gray-700"},"Grade:",-1)),v(p("select",{"onUpdate:modelValue":n[0]||(n[0]=e=>M.value=e),class:"border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500 text-sm px-3 py-2 min-w-[150px]"},[n[9]||(n[9]=p("option",{value:null},"All Grades",-1)),(m(!0),c(g,null,y(K.value,e=>(m(),c("option",{key:e.id,value:e.id},x(e.name),9,I))),128))],512),[[b,M.value]])]),p("div",Q,[n[12]||(n[12]=p("label",{class:"text-sm font-medium text-gray-700"},"Subject:",-1)),v(p("select",{"onUpdate:modelValue":n[1]||(n[1]=e=>T.value=e),class:"border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500 text-sm px-3 py-2 min-w-[150px]"},[n[11]||(n[11]=p("option",{value:null},"All Subjects",-1)),(m(!0),c(g,null,y(L.value,e=>(m(),c("option",{key:e.id,value:e.id},x(e.name),9,k))),128))],512),[[b,T.value]])])]),p("div",N,[n[15]||(n[15]=p("label",{class:"text-sm font-medium text-gray-700"},"Quiz:",-1)),p("select",{value:G.modelValue,onChange:n[2]||(n[2]=e=>l.$emit("update:modelValue",e.target.value?parseInt(e.target.value):null)),class:"border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500 text-sm px-3 py-2 min-w-[200px]"},[n[13]||(n[13]=p("option",{value:null},"No Quiz Assigned",-1)),(m(!0),c(g,null,y(J.value,e=>(m(),c("option",{key:e.id,value:e.id},x(e.name)+" ("+x(e.questions_count)+" questions) ",9,C))),128)),n[14]||(n[14]=p("option",{value:"create-new",class:"font-semibold text-blue-600"}," + Create New Quiz ",-1))],40,U)])]),f(i,{modelValue:$.value,"onUpdate:modelValue":n[8]||(n[8]=e=>$.value=e),persistent:""},{default:h(()=>[f(a,{style:{"min-width":"500px"}},{default:h(()=>[f(s,{class:"row items-center bg-primary text-white"},{default:h(()=>[n[16]||(n[16]=p("div",{class:"text-h6"},"Create New Quiz",-1)),f(e),v(f(u,{icon:"close",flat:"",round:"",dense:""},null,512),[[t]])]),_:1}),f(s,{class:"q-pt-md"},{default:h(()=>[p("div",S,[p("div",null,[n[17]||(n[17]=p("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Quiz Name *",-1)),v(p("input",{"onUpdate:modelValue":n[3]||(n[3]=e=>H.value.name=e),type:"text",class:"w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Enter quiz name"},null,512),[[_,H.value.name]])]),p("div",null,[n[18]||(n[18]=p("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),v(p("textarea",{"onUpdate:modelValue":n[4]||(n[4]=e=>H.value.description=e),rows:"3",class:"w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Enter quiz description (optional)"},null,512),[[_,H.value.description]])]),p("div",null,[n[19]||(n[19]=p("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Time Limit (minutes)",-1)),v(p("input",{"onUpdate:modelValue":n[5]||(n[5]=e=>H.value.time_limit_minutes=e),type:"number",min:"1",class:"w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Optional"},null,512),[[_,H.value.time_limit_minutes,void 0,{number:!0}]])]),p("div",F,[p("label",A,[v(p("input",{"onUpdate:modelValue":n[6]||(n[6]=e=>H.value.shuffle_questions=e),type:"checkbox",class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,512),[[w,H.value.shuffle_questions]]),n[20]||(n[20]=p("span",{class:"text-sm text-gray-700"},"Shuffle Questions",-1))]),p("label",E,[v(p("input",{"onUpdate:modelValue":n[7]||(n[7]=e=>H.value.shuffle_options=e),type:"checkbox",class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,512),[[w,H.value.shuffle_options]]),n[21]||(n[21]=p("span",{class:"text-sm text-gray-700"},"Shuffle Options",-1))])])])]),_:1}),f(o,{align:"right",class:"q-px-md q-pb-md"},{default:h(()=>[v(f(u,{flat:"",label:"Cancel",color:"grey"},null,512),[[t]]),f(u,{unelevated:"",label:"Create Quiz",color:"primary",onClick:X,loading:B.value,disable:!H.value.name},null,8,["loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{G as default};
