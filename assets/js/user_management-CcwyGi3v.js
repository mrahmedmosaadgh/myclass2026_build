import{f as e,a as s,a7 as o,af as r,M as l,J as a,b as t,N as n,Q as i,z as m,V as d,W as u,I as c,F as p,R as v,U as b,K as f,y as x,ac as g,ae as y,ab as w,$ as h}from"./vendor-DuKqz2x4.js";import k from"./DialogModal_7-2sqpPbXd.js";import{_}from"./PrimaryButton-Cw-PZntm.js";import{_ as j}from"./SecondaryButton-BDKLxmbK.js";import C from"./UsersManagement-lNvTAu-X.js";import U from"./RolesManagement-BZAGK_3U.js";import S from"./PermissionsManagement-DnEGuUPb.js";import I from"./UsersRoles-DsQnmuRN.js";import{u as $}from"./i18n-DE5KxGn8.js";import"./app-B77gjd5a.js";import"./offline-BzIlwqNM.js";import"./ui-BITzTqrO.js";import"./QSelect-DB_tK-Lk.js";import"./rtl-Cr6c3OOr.js";import"./QTab-CnAf4tCv.js";import"./QTabs-D_ZwIIJm.js";import"./QTabPanel-B_PJ80R0.js";import"./use-panel-N2fkKyR_.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-B5JhG1n5.js";import"./UsersList-Cqcjmuse.js";import"./QSpinnerDots-CnY0H5Kp.js";import"./QSpace-Bk4F2b8L.js";import"./UserDetailsDialog-Gl3R3q24.js";const E={class:"flex justify-between items-center"},D={class:"font-semibold text-xl text-gray-800 leading-tight"},R={key:0,class:"py-12"},V={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Q={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},M={class:"border-b border-gray-200 mb-5"},P={class:"-mb-px flex space-x-8"},L=["onClick"],A={class:"mb-4"},B={for:"role-name",class:"block text-sm font-medium text-gray-700"},T={key:0,class:"text-red-500 text-sm mt-1"},H={class:"mb-4"},J={class:"block text-sm font-medium text-gray-700 mb-2"},O={class:"max-h-60 overflow-y-auto p-2 border rounded-md"},F={class:"flex items-center h-5"},K=["id","value"],N={class:"ml-3 text-sm"},z=["for"],G={key:0,class:"text-red-500 text-sm mt-1"},W={class:"mb-4"},q={for:"permission-name",class:"block text-sm font-medium text-gray-700"},X={key:0,class:"text-red-500 text-sm mt-1"},Y={class:"mb-4"},Z={class:"max-h-60 overflow-y-auto p-2 border rounded-md"},ee={class:"flex items-center h-5"},se=["id","value"],oe={class:"ml-3 text-sm"},re=["for"],le={class:"space-y-4"},ae={class:"block text-sm font-medium text-gray-700"},te={key:0,class:"text-red-500 text-sm mt-1"},ne={class:"block text-sm font-medium text-gray-700"},ie={key:0,class:"text-red-500 text-sm mt-1"},me={key:0},de={class:"block text-sm font-medium text-gray-700"},ue={key:0,class:"text-red-500 text-sm mt-1"},ce={key:1},pe={class:"block text-sm font-medium text-gray-700"},ve={class:"block text-sm font-medium text-gray-700"},be=["value"],fe={key:0,class:"text-red-500 text-sm mt-1"},xe={__name:"user_management",props:{roles:Array,permissions:Array,users:Array,enhancedUserData:{type:Object,default:()=>({})}},setup(xe){const{t:ge}=$(),ye=xe,we=e("users-management"),he=e(""),ke=e("all"),_e=e(!1),je=e(!1),Ce=e(null),Ue=e(null),Se=s(()=>[{id:"users-management",name:ge("tabs.users_management")},{id:"roles",name:ge("tabs.roles")},{id:"permissions",name:ge("tabs.permissions")},{id:"users",name:ge("tabs.users_roles")}]),Ie=o({name:"",email:"",password:"",password_confirmation:"",roles:[]}),$e=e(!1),Ee=e(null),De=o({name:"",permissionIds:[]}),Re=e(!1),Ve=e(null),Qe=o({name:""}),Me=e(!1),Pe=e(null),Le=o({userId:"",roleIds:[]});function Ae(e=null){Ee.value=e,e?(De.name=e.name,De.permissionIds=e.permissions.map(e=>e.id)):De.reset(),$e.value=!0}function Be(e=null){e?(Ve.value=e,Qe.name=e.name):(Ve.value=null,Qe.reset()),Re.value=!0}function Te(e){Pe.value=e,Le.userId=e.id,Le.roleIds=e.roles.map(e=>e.id),Me.value=!0}function He(){Ee.value?De.put(`/admin/roles/${Ee.value.id}`,{preserveScroll:!0,onSuccess:()=>{$e.value=!1,De.reset()},onError:e=>{console.error(e)}}):De.post("/admin/roles",{preserveScroll:!0,onSuccess:()=>{$e.value=!1,De.reset()},onError:e=>{console.error(e)}})}function Je(e){confirm(ge("role.confirm_delete",{name:e.name}))&&h.delete(`/admin/roles/${e.id}`,{preserveScroll:!0})}function Oe(){Ve.value?Qe.put(`/admin/permissions/${Ve.value.id}`,{preserveScroll:!0,onSuccess:()=>{Re.value=!1,Qe.reset()},onError:e=>{console.error(e)}}):Qe.post("/admin/permissions",{preserveScroll:!0,onSuccess:()=>{Re.value=!1,Qe.reset()},onError:e=>{console.error(e)}})}function Fe(e){confirm(ge("permission.confirm_delete",{name:e.name}))&&h.delete(`/admin/permissions/${e.id}`,{preserveScroll:!0})}function Ke(){h.put(`/admin/users/${Pe.value.id}/roles`,Le,{preserveScroll:!0,onSuccess:()=>{Me.value=!1,Le.reset()}})}s(()=>{let e=[...ye.users];if(he.value){const s=he.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s))}return"active"===ke.value?e=e.filter(e=>!e.deleted_at):"deleted"===ke.value&&(e=e.filter(e=>e.deleted_at)),e});const Ne=(e=null)=>{Ce.value=e,e?(Ie.name=e.name,Ie.email=e.email,Ie.password="",Ie.password_confirmation="",Ie.roles=e.roles.map(e=>e.id)):Ie.reset(),_e.value=!0},ze=()=>{_e.value=!1,Ce.value=null,Ie.reset()},Ge=()=>{Ce.value?(Ie.password||(delete Ie.password,delete Ie.password_confirmation),Ie.put(route("admin.users.update",Ce.value.id),{preserveScroll:!0,onSuccess:()=>{ze()},onError:e=>{console.error(e)}})):Ie.post(route("admin.users.store"),{preserveScroll:!0,onSuccess:()=>{ze()},onError:e=>{console.error(e)}})},We=e=>{Ue.value=e,je.value=!0},qe=()=>{je.value=!1,Ue.value=null},Xe=()=>{Ue.value&&o({}).delete(route("admin.users.destroy",Ue.value.id),{onSuccess:()=>qe()})},Ye=e=>{o({}).put(route("admin.users.restore",e.id))},Ze=()=>{const e=ye.users.map(e=>({name:e.name,email:e.email,password:"12345678",roles:e.roles.map(e=>e.name).join(";")})),s=[["name","email","password","roles"].join(","),...e.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.password}"`,`"${e.roles}"`].join(","))].join("\n"),o=new Blob([s],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),l=URL.createObjectURL(o);r.setAttribute("href",l),r.setAttribute("download","users_export.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)};return(e,s)=>{const o=r("Head");return a(),l(p,null,[t(o,{title:m(ge)("permissions.dashboard")},null,8,["title"]),n("div",null,[n("div",E,[n("h2",D,d(m(ge)("user.management_dashboard")),1),n("button",{onClick:Ze,class:"px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 flex items-center gap-2"},[s[17]||(s[17]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),u(" "+d(m(ge)("user.export_users")),1)])])]),xe.users?(a(),l("div",R,[n("div",V,[n("div",Q,[n("div",M,[n("nav",P,[(a(!0),l(p,null,v(Se.value,e=>(a(),l("button",{key:e.id,onClick:s=>we.value=e.id,class:b([we.value===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},d(e.name),11,L))),128))])]),"users-management"===we.value?(a(),c(C,{key:0,users:xe.users,onEditUser:Ne,onDeleteUser:We,onRestoreUser:Ye},null,8,["users"])):i("",!0),"roles"===we.value?(a(),c(U,{key:1,roles:xe.roles,onCreateRole:s[0]||(s[0]=e=>Ae()),onEditRole:Ae,onDeleteRole:Je},null,8,["roles"])):i("",!0),"permissions"===we.value?(a(),c(S,{key:2,permissions:xe.permissions,onCreatePermission:s[1]||(s[1]=e=>Be()),onEditPermission:Be,onDeletePermission:Fe},null,8,["permissions"])):i("",!0),"users"===we.value?(a(),c(I,{key:3,users:xe.users,"enhanced-user-data":xe.enhancedUserData,onManageUserRoles:Te},null,8,["users","enhanced-user-data"])):i("",!0)])])])):i("",!0),t(k,{show:$e.value,onClose:s[5]||(s[5]=e=>$e.value=!1)},{title:f(()=>[u(d(Ee.value?m(ge)("role.edit"):m(ge)("role.create")),1)]),content:f(()=>[n("div",null,[n("div",A,[n("label",B,d(m(ge)("role.name")),1),x(n("input",{type:"text",id:"role-name","onUpdate:modelValue":s[2]||(s[2]=e=>m(De).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(De).name]]),m(De).errors.name?(a(),l("div",T,d(m(De).errors.name),1)):i("",!0)]),n("div",H,[n("label",J,d(m(ge)("permissions.label")),1),n("div",O,[(a(!0),l(p,null,v(xe.permissions,e=>(a(),l("div",{key:e.id,class:"flex items-start mb-2"},[n("div",F,[x(n("input",{id:`permission-${e.id}`,type:"checkbox",value:e.id,"onUpdate:modelValue":s[3]||(s[3]=e=>m(De).permissionIds=e),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,K),[[y,m(De).permissionIds]])]),n("div",N,[n("label",{for:`permission-${e.id}`,class:"font-medium text-gray-700"},d(e.name),9,z)])]))),128))]),m(De).errors.permissionIds?(a(),l("div",G,d(m(De).errors.permissionIds),1)):i("",!0)])])]),footer:f(()=>[t(j,{onClick:s[4]||(s[4]=e=>$e.value=!1)},{default:f(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:He,disabled:m(De).processing},{default:f(()=>[u(d(Ee.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["disabled"])]),_:1},8,["show"]),t(k,{show:Re.value,onClose:s[8]||(s[8]=e=>Re.value=!1)},{title:f(()=>[u(d(Ve.value?m(ge)("permission.edit"):m(ge)("permission.create")),1)]),content:f(()=>[n("div",null,[n("div",W,[n("label",q,d(m(ge)("permission.name")),1),x(n("input",{type:"text",name:"permission-name",id:"permission-name","onUpdate:modelValue":s[6]||(s[6]=e=>m(Qe).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Qe).name]]),m(Qe).errors.name?(a(),l("div",X,d(m(Qe).errors.name),1)):i("",!0)])])]),footer:f(()=>[t(j,{onClick:s[7]||(s[7]=e=>Re.value=!1)},{default:f(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:Oe,disabled:m(Qe).processing},{default:f(()=>[u(d(Ve.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["disabled"])]),_:1},8,["show"]),t(k,{show:Me.value,onClose:s[11]||(s[11]=e=>Me.value=!1)},{title:f(()=>[u(d(m(ge)("user.manage_roles_for",{name:Pe.value?Pe.value.name:""})),1)]),content:f(()=>[n("div",null,[n("div",Y,[n("div",Z,[(a(!0),l(p,null,v(xe.roles,e=>(a(),l("div",{key:e.id,class:"flex items-start mb-2"},[n("div",ee,[x(n("input",{id:`user-role-${e.id}`,type:"checkbox",value:e.id,"onUpdate:modelValue":s[9]||(s[9]=e=>m(Le).roleIds=e),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,se),[[y,m(Le).roleIds]])]),n("div",oe,[n("label",{for:`user-role-${e.id}`,class:"font-medium text-gray-700"},d(e.name),9,re)])]))),128))])])])]),footer:f(()=>[t(j,{onClick:s[10]||(s[10]=e=>Me.value=!1)},{default:f(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:Ke},{default:f(()=>[u(d(m(ge)("user.save_roles")),1)]),_:1})]),_:1},8,["show"]),t(k,{show:_e.value,onClose:ze},{title:f(()=>[u(d(Ce.value?m(ge)("user.edit"):m(ge)("user.create")),1)]),content:f(()=>[n("div",le,[n("div",null,[n("label",ae,d(m(ge)("user.name")),1),x(n("input",{type:"text","onUpdate:modelValue":s[12]||(s[12]=e=>m(Ie).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).name]]),m(Ie).errors.name?(a(),l("div",te,d(m(Ie).errors.name),1)):i("",!0)]),n("div",null,[n("label",ne,d(m(ge)("user.email")),1),x(n("input",{type:"email","onUpdate:modelValue":s[13]||(s[13]=e=>m(Ie).email=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).email]]),m(Ie).errors.email?(a(),l("div",ie,d(m(Ie).errors.email),1)):i("",!0)]),Ce.value?i("",!0):(a(),l("div",me,[n("label",de,d(m(ge)("user.password")),1),x(n("input",{type:"password","onUpdate:modelValue":s[14]||(s[14]=e=>m(Ie).password=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).password]]),m(Ie).errors.password?(a(),l("div",ue,d(m(Ie).errors.password),1)):i("",!0)])),!Ce.value||m(Ie).password?(a(),l("div",ce,[n("label",pe,d(m(ge)("user.confirm_password")),1),x(n("input",{type:"password","onUpdate:modelValue":s[15]||(s[15]=e=>m(Ie).password_confirmation=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).password_confirmation]])])):i("",!0),n("div",null,[n("label",ve,d(m(ge)("user.roles")),1),x(n("select",{multiple:"","onUpdate:modelValue":s[16]||(s[16]=e=>m(Ie).roles=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[(a(!0),l(p,null,v(xe.roles,e=>(a(),l("option",{key:e.id,value:e.id},d(e.name),9,be))),128))],512),[[w,m(Ie).roles]]),m(Ie).errors.roles?(a(),l("div",fe,d(m(Ie).errors.roles),1)):i("",!0)])])]),footer:f(()=>[n("button",{onClick:ze,class:"mr-3 px-4 py-2 text-gray-700 hover:text-gray-900"},d(m(ge)("common.cancel")),1),n("button",{onClick:Ge,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},d(Ce.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["show"]),t(k,{show:je.value,onClose:qe},{title:f(()=>[u(d(m(ge)("user.delete")),1)]),content:f(()=>[u(d(m(ge)("user.confirm_delete")),1)]),footer:f(()=>[n("button",{onClick:qe,class:"mr-3 px-4 py-2 text-gray-700 hover:text-gray-900"},d(m(ge)("common.cancel")),1),n("button",{onClick:Xe,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"},d(m(ge)("user.delete")),1)]),_:1},8,["show"])],64)}}};export{xe as default};
