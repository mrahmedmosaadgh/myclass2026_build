import{o as e,u as s,d as a,m as l}from"./app-BB4Fw2oM.js";import{Q as t}from"./QSpinnerDots-L0wFsY2y.js";import{u as r}from"./i18n-DE5KxGn8.js";import{f as c,a as o,o as i,af as d,M as n,J as m,b as u,N as y,z as v,I as p,Q as b,W as h,V as g,K as k,F as x,R as S,_ as w,S as f,$ as j}from"./vendor-DuKqz2x4.js";import _ from"./WeeklyPlanMenu-g_5aDzSM.js";import"./offline-BzIlwqNM.js";import"./ui-BITzTqrO.js";import"./QTab-BFa-NGCD.js";import"./QTabs-CG-V162G.js";import"./rtl-Cr6c3OOr.js";import"./QSpace-CfcdpSpD.js";import"./WeeklySystemGuide-CrJuxVxE.js";import"./QTabPanel-BKNysMBn.js";import"./use-panel-DoNmfVmh.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-ewjb0pYP.js";import"./MainSchoolData-DmQajEko.js";import"./QBadge-BkpTfeZ_.js";import"./schoolData-BRFwL7u7.js";import"./SchoolSettingsDialog-81aSfpSx.js";import"./QSelect-BImwntZk.js";import"./QForm-zhfWFjRn.js";const Q={class:"q-pa-md"},q={class:"row items-center q-mb-lg"},D={class:"col"},P={class:"q-ma-none text-weight-bold"},$={class:"text-grey-7 q-mb-none"},z={key:0,class:"row justify-center q-pa-xl"},T={class:"text-h6 text-grey-7 q-mt-md"},M={class:"text-grey-6"},C={key:2,class:"timetable-container"},F={class:"grid-row header-row"},I={class:"grid-cell period-header"},J={class:"period-number"},K=["onClick"],W={class:"card-content"},B={class:"subject"},E={class:"classroom"},N={key:1,class:"free-period text-caption text-grey-5"},R={class:"row q-gutter-lg justify-center"},G={class:"text-center"},H={class:"text-h4 text-primary"},L={class:"text-caption text-grey-7"},O={class:"text-center"},V={class:"text-h4 text-secondary"},A={class:"text-caption text-grey-7"},U={class:"text-center"},X={class:"text-h4 text-accent"},Y={class:"text-caption text-grey-7"},Z=e({__name:"MySchedule",setup(e){const{t:Z}=r(),ee=s(),se=c([]),ae=c(!1),le=o(()=>[{value:1,label:Z("weeklyPlans.fullDays.1")},{value:2,label:Z("weeklyPlans.fullDays.2")},{value:3,label:Z("weeklyPlans.fullDays.3")},{value:4,label:Z("weeklyPlans.fullDays.4")},{value:5,label:Z("weeklyPlans.fullDays.5")}]),te=[1,2,3,4,5,6,7,8],re=o(()=>{const e={};return se.value.forEach(s=>{const a=`${s.day}-${s.period_number}`;e[a]=s}),e}),ce=o(()=>se.value.length),oe=o(()=>new Set(se.value.map(e=>{var s;return null==(s=e.cst)?void 0:s.classroom_id})).size),ie=o(()=>new Set(se.value.map(e=>{var s;return null==(s=e.cst)?void 0:s.subject_id})).size),de=(e,s)=>re.value[`${e}-${s}`],ne=(e,s)=>{const a=de(e,s);return(null==a?void 0:a.cst)?{backgroundColor:a.cst.c_bg||"#e0e0e0",color:a.cst.c_text||"#333"}:{}};return i(()=>{(async()=>{ae.value=!0;try{const e=await w.get("/weekly-system/api/teacher/my-schedule");se.value=e.data.data||e.data||[]}catch(e){console.error("Error fetching schedule:",e),ee.notify({type:"negative",message:Z("weeklySystem.notifications.loadFailed")})}finally{ae.value=!1}})()}),(e,s)=>{const r=d("Head");return m(),n(x,null,[u(r,{title:v(Z)("weeklySystem.mySchedule.title")},null,8,["title"]),y("div",Q,[u(_),y("div",q,[y("div",D,[y("h4",P,[u(a,{name:"calendar_month",class:"q-mr-sm",color:"primary"}),h(" "+g(v(Z)("weeklySystem.mySchedule.title")),1)]),y("p",$,g(v(Z)("weeklySystem.mySchedule.subtitle")),1)])]),ae.value?(m(),n("div",z,[u(t,{size:"50px",color:"primary"})])):se.value.length?(m(),n("div",C,[y("div",F,[s[0]||(s[0]=y("div",{class:"grid-cell period-header"},null,-1)),(m(!0),n(x,null,S(le.value,e=>(m(),n("div",{key:e.value,class:"grid-cell day-header"},g(v(Z)(`weeklyPlans.shortDays.${e.value}`)),1))),128))]),(m(),n(x,null,S(te,e=>y("div",{key:e,class:"grid-row"},[y("div",I,[y("div",J,g(e),1)]),(m(!0),n(x,null,S(le.value,s=>{var l,t;return m(),n("div",{key:`${s.value}-${e}`,class:"grid-cell"},[de(s.value,e)?(m(),n("div",{key:0,class:"schedule-card",style:f(ne(s.value,e)),onClick:a=>((e,s)=>{const a=de(e,s);a&&j.visit("/my_table_mnger/weekly_system/teacher/my-weekly-plans",{data:{schedule_id:a.id}})})(s.value,e)},[y("div",W,[y("div",B,g(null==(l=de(s.value,e).cst)?void 0:l.subject_name),1),y("div",E,[u(a,{name:"meeting_room",size:"xs"}),h(" "+g(null==(t=de(s.value,e).cst)?void 0:t.classroom_name),1)])])],12,K)):(m(),n("div",N,g(v(Z)("weeklySystem.mySchedule.free")),1))])}),128))])),64))])):(m(),p(l,{key:1,flat:"",bordered:"",class:"text-center q-pa-xl"},{default:k(()=>[u(a,{name:"event_busy",size:"64px",color:"grey-5"}),y("p",T,g(v(Z)("weeklySystem.schoolBrowser.noDataTitle")),1),y("p",M,g(v(Z)("weeklySystem.mySchedule.emptyState")),1)]),_:1})),se.value.length?(m(),p(l,{key:3,flat:"",bordered:"",class:"q-mt-lg q-pa-md"},{default:k(()=>[y("div",R,[y("div",G,[y("div",H,g(ce.value),1),y("div",L,g(v(Z)("weeklySystem.mySchedule.totalClasses")),1)]),y("div",O,[y("div",V,g(oe.value),1),y("div",A,g(v(Z)("weeklySystem.mySchedule.classrooms")),1)]),y("div",U,[y("div",X,g(ie.value),1),y("div",Y,g(v(Z)("weeklySystem.mySchedule.subjects")),1)])])]),_:1})):b("",!0)])],64)}}},[["__scopeId","data-v-bd704b76"]]);export{Z as default};
