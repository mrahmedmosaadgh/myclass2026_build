import{D as e,O as i,aD as r,S as t,aE as a,ak as l}from"./app-CqJgtQaN.js";import{a as n,f as o,o as s,h as u,B as g,k as c,p as d}from"./vendor-DuKqz2x4.js";const v=e({name:"QImg",props:{...{ratio:[String,Number]},src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:1.7778},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:v,emit:m}){const p=o(e.initialRatio),S=function(e,i){return n(()=>{const r=Number(e.ratio||(void 0!==i?i.value:void 0));return!0!==isNaN(r)&&r>0?{paddingBottom:100/r+"%"}:null})}(e,p),f=d(),{registerTimeout:h,removeTimeout:y}=i(),{registerTimeout:_,removeTimeout:b}=i(),q=n(()=>void 0!==e.placeholderSrc?{src:e.placeholderSrc}:null),k=n(()=>void 0!==e.errorSrc?{src:e.errorSrc,__qerror:!0}:null),w=[o(null),o(q.value)],z=o(0),N=o(!1),j=o(!1),B=n(()=>`q-img q-img--${!0===e.noNativeMenu?"no-":""}menu`),T=n(()=>({width:e.width,height:e.height})),C=n(()=>`q-img__image ${void 0!==e.imgClass?e.imgClass+" ":""}q-img__image--with${!0===e.noTransition?"out":""}-transition q-img__image--`),D=n(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function x(){b(),N.value=!1}function O({target:e}){!1===l(f)&&(y(),p.value=0===e.naturalHeight?.5:e.naturalWidth/e.naturalHeight,$(e,1))}function $(e,i){1e3!==i&&!0!==l(f)&&(!0===e.complete?function(e){if(!0===l(f))return;z.value=1^z.value,w[z.value].value=null,x(),"true"!==e.getAttribute("__qerror")&&(j.value=!1);m("load",e.currentSrc||e.src)}(e):h(()=>{$(e,i+1)},50))}function E(e){y(),x(),j.value=!0,w[z.value].value=k.value,w[1^z.value].value=q.value,m("error",e)}function H(i){const r=w[i].value,t={key:"img_"+i,class:C.value,style:D.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...r};return z.value===i?Object.assign(t,{class:t.class+"current",onLoad:O,onError:E}):t.class+="loaded",u("div",{class:"q-img__container absolute-full",key:"img"+i},u("img",t))}function M(){return!1===N.value?u("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},t(v[!0===j.value?"error":"default"])):u("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},void 0!==v.loading?v.loading():!0===e.noSpinner?void 0:[u(a,{color:e.spinnerColor,size:e.spinnerSize})])}{let i=function(){c(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,i=>{y(),j.value=!1,null===i?(x(),w[1^z.value].value=q.value):(b(),0!==e.loadingShowDelay?_(()=>{N.value=!0},e.loadingShowDelay):N.value=!0),w[z.value].value=i},{immediate:!0})};!0===r.value?s(i):i()}return()=>{const i=[];return null!==S.value&&i.push(u("div",{key:"filler",style:S.value})),null!==w[0].value&&i.push(H(0)),null!==w[1].value&&i.push(H(1)),i.push(u(g,{name:"q-transition--fade"},M)),u("div",{key:"main",class:B.value,style:T.value,role:"img","aria-label":e.alt},i)}}});export{v as Q};
