import{o as e,u as t,aE as a,p as s,Q as i,m as o,d as r,aP as n,c as l,b as p}from"./app-ggGwxJON.js";import{Q as m}from"./QSpace-DKhB4IlP.js";import{Q as d}from"./QBar-CrRFYR5C.js";import{M as u,f as c,a as j,o as v,af as y,N as f,J as g,b,I as Q,Q as w,K as _,W as S,S as h,y as x,Y as P,ak as k,F as C,_ as I}from"./vendor-nQjeLEvd.js";import T from"./LessonPlayer-BloJUrQM.js";import z from"./reward_sys-utii91bI.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";import"./QSpinnerDots-xIVaxwwk.js";import"./QBadge-DVUbh_5M.js";import"./QPage-B1Nl3adk.js";import"./QPageContainer-CznOqmtM.js";import"./QLayout-D3qfTWrb.js";import"./QuestionSlide-CU5tqDZx.js";import"./EnhancedQuestionEditor-DzTqQgQr.js";import"./QuestionEditor-DAFbQDAu.js";import"./RichTextEditor-BiojowB3.js";import"./QColor-Gten_QEt.js";import"./QSlider-rHpK1y__.js";import"./QTabs-DMYUh0Ok.js";import"./rtl-Cr6c3OOr.js";import"./QTab-Dz6RnWyq.js";import"./QTabPanels-BH2gx17B.js";import"./use-panel-BQ7QSG7B.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanel-DWPrbrYB.js";import"./purify.es-C2Ba6vpb.js";import"./MathEditor-BaYsC1Mk.js";import"./katex-BXKQVcz-.js";import"./MathPastePreview-Beckx_uo.js";import"./QSelect-DOo83gJW.js";import"./StepByStepEditor-WT-qNlOk.js";import"./QuestionTypeSelector-CzZfUg3W.js";import"./QuizEngine-DW37yIyH.js";import"./useQuizI18n-D42PDdQD.js";import"./PlayerSidebar-DSiSWTO0.js";import"./QDrawer-DFCooEAP.js";import"./SectionCard-usptGh1g.js";import"./SectionBanner-nmb_7N5U.js";import"./QLinearProgress-DJHuJoTJ.js";import"./SlideRenderer-DP5TZv_f.js";import"./FingerDrawingSlide-iYc-GhH5.js";import"./QPopupProxy-B_TgS9uL.js";import"./NavigationFooter-CTjx-5Fn.js";import"./DrawingOverlay-RBoppW9i.js";import"./DrawingCanvas-LPj7FZdV.js";import"./DrawingToolbar-CQouNTtJ.js";import"./QBtnToggle-CO55A_1i.js";import"./SlideAnnotationOverlay-DRPB5HyJ.js";import"./QToolbar-DMbCF1rG.js";import"./reward_sys_point_action-oLy4sW63.js";import"./PeriodSelectionRefactored-CT_ttYJH.js";import"./ClassroomSelection-DFsO_V-T.js";import"./TopLeaderboard-D08TxZUZ.js";import"./html2canvas.esm-Cq3pa7K9.js";import"./CertificateGenerator-D6gN64KK.js";import"./jspdf.es.min-KPg7L82s.js";import"./StudentCard-DbZCVyli.js";import"./AvatarManager-CEvP1T-P.js";import"./CameraCapture-CL8mYJbX.js";import"./StudentGrouping-Cyb3NJFR.js";import"./vuedraggable.umd-C4qRof-w.js";import"./index-DTdDyFNb.js";import"./BehaviorIncidents-DeJpdoXo.js";import"./IncidentPrintReport-CZcACHfC.js";const L={key:1,class:"h-screen flex items-center justify-center bg-gray-50"},M={key:2,class:"fixed-bottom-right q-ma-md",style:{"z-index":"2000"}},R={key:0,class:"text-h6 q-ml-sm"},q={key:1,class:"text-subtitle2 q-ml-sm"},D=e({__name:"StudentLessonView",props:{presentationId:{type:[String,Number],required:!0},studentId:{type:[String,Number],required:!0},sections:{type:Array,default:()=>[]}},setup(e){const D=t(),E=u(),B=e,V=c({}),F=c([]),N=c(null),A=c(!0),O=c(!1),G=c(!1),H=j(()=>{var e,t;const a=null==(t=null==(e=E.props.auth)?void 0:e.user)?void 0:t.role;return"teacher"===a||"admin"===a}),U=async()=>{try{A.value=!0;const e=await I.get(route("lesson-presentation.show",{id:B.presentationId}));V.value=e.data,F.value=(e.data.slides||[]).map(e=>({...e,section:e.section||"learn"}));const t=(await I.get(route("lesson-presentation.progress.student",{studentId:B.studentId}))).data.find(e=>e.lesson_presentation_id==B.presentationId);N.value=t}catch(e){console.error("Failed to load data:",e),D.notify({type:"negative",message:"Failed to load lesson data"})}finally{A.value=!1}},W=async()=>{try{await I.put(route("lesson-presentation.progress.complete-learn",{id:N.value.id})),await U(),D.notify({type:"positive",message:"Learn section completed! Practice unlocked."})}catch(e){console.error("Failed to complete learn:",e)}},$=async()=>{await U(),D.notify({type:"positive",message:"Practice submitted! Waiting for teacher review."})};return v(()=>{U()}),(t,u)=>{const c=y("Head");return g(),f(C,null,[b(c,{title:V.value.name?`Lesson: ${V.value.name}`:"Lesson View"},null,8,["title"]),A.value?(g(),f("div",L,[b(a,{color:"primary",size:"3em"})])):(g(),Q(T,{key:0,presentation:V.value,sections:e.sections,slides:F.value,progress:N.value,loading:A.value,onCompleteLearn:W,onSubmitPractice:$},null,8,["presentation","sections","slides","progress","loading"])),H.value?(g(),f("div",M,[b(i,{fab:"",icon:"emoji_events",color:"warning",onClick:u[0]||(u[0]=e=>{O.value=!0,G.value=!1})},{default:_(()=>[b(s,null,{default:_(()=>u[4]||(u[4]=[S("Reward System")])),_:1})]),_:1})])):w("",!0),b(p,{modelValue:O.value,"onUpdate:modelValue":u[3]||(u[3]=e=>O.value=e),maximized:!G.value,seamless:G.value,position:G.value?"bottom":"standard","transition-show":"slide-up","transition-hide":"slide-down"},{default:_(()=>[b(o,{style:h(G.value?"width: 300px":"")},{default:_(()=>[b(d,{class:"bg-primary text-white"},{default:_(()=>[b(r,{name:"emoji_events"}),G.value?(g(),f("div",q,"Rewards")):(g(),f("div",R,"Reward System")),b(m),G.value?(g(),Q(i,{key:2,dense:"",flat:"","no-caps":"",label:"Maximize",icon:"open_in_full",onClick:u[1]||(u[1]=e=>G.value=!1)},{default:_(()=>[b(s,null,{default:_(()=>u[5]||(u[5]=[S("Maximize")])),_:1})]),_:1})):(g(),Q(i,{key:3,dense:"",flat:"",icon:"minimize",onClick:u[2]||(u[2]=e=>G.value=!0)},{default:_(()=>[b(s,null,{default:_(()=>u[6]||(u[6]=[S("Minimize")])),_:1})]),_:1})),x((g(),Q(i,{dense:"",flat:"",icon:"close"},{default:_(()=>[b(s,null,{default:_(()=>u[7]||(u[7]=[S("Close")])),_:1})]),_:1})),[[n]])]),_:1}),x(b(l,{class:"q-pa-none",style:{height:"calc(100vh - 32px)"}},{default:_(()=>[(g(),Q(k,null,[b(z,{isDialog:!0})],1024))]),_:1},512),[[P,!G.value]])]),_:1},8,["style"])]),_:1},8,["modelValue","maximized","seamless","position"])],64)}}},[["__scopeId","data-v-8d7bb35e"]]);export{D as default};
