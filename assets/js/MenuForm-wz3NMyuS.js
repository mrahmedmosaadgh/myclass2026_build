import{Q as e}from"./QSpace-CtVAwmqA.js";import{Q as l,c as a,f as o,h as u,i as t,d as n,n as i,l as r,m as s}from"./app-BwCflFkV.js";import{Q as d}from"./QSelect-Cyosk05W.js";import{Q as m}from"./QForm-BCWodDs-.js";import{f as p,r as c,a as f,o as v,Z as _,H as b,I as g,J as V,b as y,M as h,U as F,V as U,O as j}from"./vendor-CUZ9QTQV.js";import"./offline-BzIlwqNM.js";import"./i18n-CP46N9fu.js";import"./ui-LrZmvB2D.js";import"./rtl-Cr6c3OOr.js";const w={class:"text-h6"},k={class:"q-gutter-sm"},C={__name:"MenuForm",props:{menu:{type:Object,default:null},modules:{type:Array,required:!0}},emits:["save","cancel"],setup(C,{emit:M}){const q=C,L=M,x=p(!1),Q=p(!1),O=p(!1),S=p(!1),$=p([]),A=p([]),I=p([]),P=p([]),D=p([]),N=c({label:"",module:"",parent_id:null,route:null,permission:null,icon:"",order:0,is_active:!0,is_feature_flag:!1,feature_flag_key:null}),E=f(()=>q.modules.map(e=>({label:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),value:e}))),H=f(()=>I.value.map(e=>({label:`${e.label} (${e.module})`,value:e.id})));v(async()=>{await Promise.all([J(),K(),R()]),q.menu&&Object.assign(N,{label:q.menu.label,module:q.menu.module,parent_id:q.menu.parent_id,route:q.menu.route,permission:q.menu.permission,icon:q.menu.icon,order:q.menu.order,is_active:q.menu.is_active,is_feature_flag:q.menu.is_feature_flag||!1,feature_flag_key:q.menu.feature_flag_key})});const J=async()=>{try{Q.value=!0;const e=await _.get("/api/admin/menus/helpers/routes");$.value=e.data.map(e=>e.name),P.value=$.value}catch(e){console.error("Failed to load routes:",e)}finally{Q.value=!1}},K=async()=>{try{O.value=!0;const e=await _.get("/api/admin/menus/helpers/permissions");A.value=e.data.map(e=>e.name),D.value=A.value}catch(e){console.error("Failed to load permissions:",e)}finally{O.value=!1}},R=async()=>{try{S.value=!0;const e=q.menu?{exclude_id:q.menu.id}:{},l=await _.get("/api/admin/menus/helpers/parents",{params:e});I.value=l.data}catch(e){console.error("Failed to load parents:",e)}finally{S.value=!1}},T=(e,l)=>{l(()=>{const l=e.toLowerCase();P.value=$.value.filter(e=>e.toLowerCase().includes(l))})},Z=(e,l)=>{l(()=>{const l=e.toLowerCase();D.value=A.value.filter(e=>e.toLowerCase().includes(l))})},z=()=>{x.value=!0,L("save",{...N}),x.value=!1};return(p,c)=>(g(),b(s,{style:{"min-width":"600px","max-width":"800px"}},{default:V(()=>[y(a,{class:"row items-center q-pb-none"},{default:V(()=>[h("div",w,F(C.menu?"Edit Menu":"Create Menu"),1),y(e),y(l,{icon:"close",flat:"",round:"",dense:"",onClick:c[0]||(c[0]=e=>p.$emit("cancel"))})]),_:1}),y(a,null,{default:V(()=>[y(m,{onSubmit:z,class:"q-gutter-md"},{default:V(()=>[y(o,{modelValue:N.label,"onUpdate:modelValue":c[1]||(c[1]=e=>N.label=e),label:"Menu Label *",hint:"Display name for the menu item",rules:[e=>!!e||"Label is required"],outlined:""},null,8,["modelValue","rules"]),y(d,{modelValue:N.module,"onUpdate:modelValue":c[2]||(c[2]=e=>N.module=e),options:E.value,label:"Module *",hint:"Feature grouping for this menu",rules:[e=>!!e||"Module is required"],outlined:"","emit-value":"","map-options":""},null,8,["modelValue","options","rules"]),y(d,{modelValue:N.parent_id,"onUpdate:modelValue":c[3]||(c[3]=e=>N.parent_id=e),options:H.value,label:"Parent Menu",hint:"Leave empty for root level menu",outlined:"",clearable:"","emit-value":"","map-options":"",loading:S.value},null,8,["modelValue","options","loading"]),y(d,{modelValue:N.route,"onUpdate:modelValue":c[4]||(c[4]=e=>N.route=e),options:P.value,label:"Route",hint:"Named Laravel route (optional for parent menus)",outlined:"",clearable:"","use-input":"","input-debounce":"300",onFilter:T,loading:Q.value},{"no-option":V(()=>[y(u,null,{default:V(()=>[y(t,{class:"text-grey"},{default:V(()=>c[12]||(c[12]=[U(" No routes found ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","loading"]),y(d,{modelValue:N.permission,"onUpdate:modelValue":c[5]||(c[5]=e=>N.permission=e),options:D.value,label:"Permission",hint:"Spatie permission required to see this menu",outlined:"",clearable:"","use-input":"","input-debounce":"300",onFilter:Z,loading:O.value},null,8,["modelValue","options","loading"]),y(o,{modelValue:N.icon,"onUpdate:modelValue":c[6]||(c[6]=e=>N.icon=e),label:"Icon",hint:"Icon name (e.g., 'home', 'settings')",outlined:""},{prepend:V(()=>[y(n,{name:N.icon||"help_outline"},null,8,["name"])]),_:1},8,["modelValue"]),y(o,{modelValue:N.order,"onUpdate:modelValue":c[7]||(c[7]=e=>N.order=e),modelModifiers:{number:!0},type:"number",label:"Order",hint:"Display order (lower numbers appear first)",outlined:"",rules:[e=>e>=0||"Order must be 0 or greater"]},null,8,["modelValue","rules"]),y(i,{modelValue:N.is_active,"onUpdate:modelValue":c[8]||(c[8]=e=>N.is_active=e),label:"Active",color:"positive"},null,8,["modelValue"]),h("div",k,[y(i,{modelValue:N.is_feature_flag,"onUpdate:modelValue":c[9]||(c[9]=e=>N.is_feature_flag=e),label:"Feature Flag",color:"purple"},null,8,["modelValue"]),N.is_feature_flag?(g(),b(o,{key:0,modelValue:N.feature_flag_key,"onUpdate:modelValue":c[10]||(c[10]=e=>N.feature_flag_key=e),label:"Feature Flag Key *",hint:"Configuration key for feature flag",rules:[e=>!N.is_feature_flag||!!e||"Feature flag key is required"],outlined:""},null,8,["modelValue","rules"])):j("",!0)])]),_:1})]),_:1}),y(r,{align:"right"},{default:V(()=>[y(l,{flat:"",label:"Cancel",color:"grey-7",onClick:c[11]||(c[11]=e=>p.$emit("cancel"))}),y(l,{unelevated:"",label:"Save",color:"primary",onClick:z,loading:x.value},null,8,["loading"])]),_:1})]),_:1}))}};export{C as default};
