import{u as e,c as a,d as l,Q as t,e as o,f as r,g as s,h as u,i as n,j as i,k as d,l as m,m as c,b as p}from"./app-B77gjd5a.js";import{Q as v}from"./QSpace-Bk4F2b8L.js";import{Q as y}from"./QStepperNavigation-kWQGGVMQ.js";import{Q as f,a as b}from"./QStepper-ByYk8Nka.js";import{c as g}from"./copy-to-clipboard-5NP8fjIL.js";import{f as _,I as h,J as k,K as w,b as x,N as V,Q as C,V as I,M as j,R as q,W as N,F as A,U as S,_ as Q}from"./vendor-DuKqz2x4.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./use-panel-N2fkKyR_.js";import"./use-render-cache-CmTcazfP.js";const O={class:"text-caption",style:{"white-space":"pre-wrap","max-height":"200px","overflow-y":"auto"}},P={class:"q-mt-md"},J={class:"text-body2"},U={key:0,class:"q-mt-sm"},B={class:"q-mb-none"},M={key:0,class:"text-caption"},R={__name:"BulkImportDialog",props:{modelValue:Boolean},emits:["update:modelValue","imported"],setup(R,{emit:E}){const D=E,F=e(),G=_(1),T=_(!1),$=_(!1),z=_(!1),K=_(""),L=_(""),W=_(""),H=_([]),X=_(!0),Y=_(null),Z=async()=>{var e,a;try{T.value=!0,await Q.get("/sanctum/csrf-cookie");const e=await Q.get("/api/admin/menus/helpers/ai-prompt");K.value=e.data.prompt,await g(K.value),F.notify({type:"positive",message:"AI prompt copied to clipboard!"})}catch(l){console.error("Error generating AI prompt:",l),F.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to generate AI prompt"})}finally{T.value=!1}},ee=()=>{try{$.value=!0,W.value="";const e=JSON.parse(L.value);if(!Array.isArray(e))return void(W.value="JSON must be an array of menu objects");H.value=e,G.value=3}catch(e){W.value=`Invalid JSON: ${e.message}`}finally{$.value=!1}},ae=async()=>{var e,a;try{z.value=!0,await Q.get("/sanctum/csrf-cookie");const e=await Q.post("/api/admin/menus/bulk-import",{menus:H.value,dry_run:X.value});Y.value=e.data,F.notify({type:e.data.error_count>0?"warning":"positive",message:e.data.message}),X.value||0!==e.data.error_count||(D("imported"),setTimeout(()=>le(),2e3))}catch(l){console.error("Error importing menus:",l),F.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to import menus"})}finally{z.value=!1}},le=()=>{G.value=1,L.value="",W.value="",H.value=[],Y.value=null,D("update:modelValue",!1)};return(e,g)=>(k(),h(p,{"model-value":R.modelValue,"onUpdate:modelValue":g[6]||(g[6]=a=>e.$emit("update:modelValue",a)),persistent:""},{default:w(()=>[x(c,{style:{"min-width":"700px","max-width":"900px"}},{default:w(()=>[x(a,{class:"row items-center q-pb-none"},{default:w(()=>[x(l,{name:"upload_file",color:"secondary",size:"md",class:"q-mr-sm"}),g[7]||(g[7]=V("div",{class:"text-h6"},"Bulk Import Menus",-1)),x(v),x(t,{icon:"close",flat:"",round:"",dense:"",onClick:le})]),_:1}),x(a,null,{default:w(()=>[x(f,{modelValue:G.value,"onUpdate:modelValue":g[5]||(g[5]=e=>G.value=e),vertical:"",color:"primary",animated:""},{default:w(()=>[x(b,{name:1,title:"Generate AI Prompt",icon:"smart_toy",done:G.value>1},{default:w(()=>[g[9]||(g[9]=V("div",{class:"text-body2 q-mb-md"}," Click the button below to generate a prompt that you can copy and paste to an AI assistant (ChatGPT, Claude, etc.) to generate menu JSON. ",-1)),x(t,{color:"purple",icon:"content_copy",label:"Generate & Copy AI Prompt",onClick:Z,loading:T.value},null,8,["loading"]),K.value?(k(),h(o,{key:0,class:"bg-grey-2 q-mt-md",rounded:""},{avatar:w(()=>[x(l,{name:"info",color:"primary"})]),default:w(()=>[g[8]||(g[8]=V("div",{class:"text-subtitle2 q-mb-sm"},"AI Prompt (Copied to Clipboard)",-1)),V("pre",O,I(K.value),1)]),_:1})):C("",!0),x(y,null,{default:w(()=>[x(t,{color:"primary",label:"Next",onClick:g[0]||(g[0]=e=>G.value=2)})]),_:1})]),_:1},8,["done"]),x(b,{name:2,title:"Paste JSON",icon:"code",done:G.value>2},{default:w(()=>[g[10]||(g[10]=V("div",{class:"text-body2 q-mb-md"}," Paste the JSON generated by the AI assistant below: ",-1)),x(r,{modelValue:L.value,"onUpdate:modelValue":g[1]||(g[1]=e=>L.value=e),type:"textarea",outlined:"",rows:"15",placeholder:'[{"label": "Menu Label", "route": "route.name", ...}]',error:!!W.value,"error-message":W.value},null,8,["modelValue","error","error-message"]),x(y,null,{default:w(()=>[x(t,{flat:"",color:"grey-7",label:"Back",onClick:g[2]||(g[2]=e=>G.value=1),class:"q-mr-sm"}),x(t,{color:"primary",label:"Validate",onClick:ee,loading:$.value},null,8,["loading"])]),_:1})]),_:1},8,["done"]),x(b,{name:3,title:"Preview & Import",icon:"preview"},{default:w(()=>[g[11]||(g[11]=V("div",{class:"text-body2 q-mb-md"}," Preview the menus that will be created: ",-1)),x(s,{bordered:"",separator:""},{default:w(()=>[(k(!0),j(A,null,q(H.value,(e,a)=>(k(),h(u,{key:a},{default:w(()=>[x(n,{avatar:""},{default:w(()=>[x(l,{name:e.icon||"folder"},null,8,["name"])]),_:2},1024),x(n,null,{default:w(()=>[x(i,null,{default:w(()=>[N(I(e.label),1)]),_:2},1024),x(i,{caption:""},{default:w(()=>[N(" Module: "+I(e.module)+" | Route: "+I(e.route||"None"),1)]),_:2},1024),e.children&&e.children.length>0?(k(),h(i,{key:0,caption:""},{default:w(()=>[N(" Children: "+I(e.children.length),1)]),_:2},1024)):C("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),V("div",P,[x(d,{modelValue:X.value,"onUpdate:modelValue":g[3]||(g[3]=e=>X.value=e),label:"Dry run (preview only, don't save)"},null,8,["modelValue"])]),x(y,null,{default:w(()=>[x(t,{flat:"",color:"grey-7",label:"Back",onClick:g[4]||(g[4]=e=>G.value=2),class:"q-mr-sm"}),x(t,{color:"primary",label:X.value?"Run Dry Run":"Import Menus",onClick:ae,loading:z.value},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Y.value?(k(),h(o,{key:0,class:S([Y.value.error_count>0?"bg-warning":"bg-positive","text-white q-mt-md"]),rounded:""},{avatar:w(()=>[x(l,{name:Y.value.error_count>0?"warning":"check_circle"},null,8,["name"])]),default:w(()=>[g[13]||(g[13]=V("div",{class:"text-subtitle2"},"Import Results",-1)),V("div",J," Success: "+I(Y.value.success_count)+" | Errors: "+I(Y.value.error_count),1),Y.value.results.errors.length>0?(k(),j("div",U,[g[12]||(g[12]=V("div",{class:"text-subtitle2"},"Errors:",-1)),V("ul",B,[(k(!0),j(A,null,q(Y.value.results.errors.slice(0,5),(e,a)=>{var l;return k(),j("li",{key:a},I((null==(l=e.data)?void 0:l.label)||`Item ${e.index}`)+": "+I(Object.values(e.errors).flat().join(", ")),1)}),128))]),Y.value.results.errors.length>5?(k(),j("div",M," ... and "+I(Y.value.results.errors.length-5)+" more errors ",1)):C("",!0)])):C("",!0)]),_:1},8,["class"])):C("",!0)]),_:1}),x(m,{align:"right"},{default:w(()=>[x(t,{flat:"",label:"Close",color:"grey-7",onClick:le})]),_:1})]),_:1})]),_:1},8,["model-value"]))}};export{R as default};
