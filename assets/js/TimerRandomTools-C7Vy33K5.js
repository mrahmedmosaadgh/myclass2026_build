import{r as e,l as t,k as a,Q as l,j as n,c as r,i as o,f as s,G as i,b as c,s as u,t as d,e as m,d as v,h as g,o as f,R as p,aS as y}from"./app-CCwy2VVq.js";import{Q as b}from"./QBadge-BmqcVL7P.js";import{Q as h}from"./QCircularProgress-BESIVsJq.js";import{f as _,k as x,r as k,o as I,e as S,N as w,J as C,R,b as j,K as $,y as O,W as N,V as J,I as V,O as z,F as M,Q as P}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const T={class:"q-pa-md"},q={class:"row q-col-gutter-md"},Q={class:"col-12 col-md-3"},W={class:"col-12 col-md-9"},L={key:0},A={class:"flex items-center justify-between mb-4"},E={class:"text-h5 q-my-none text-primary flex items-center gap-2"},U={class:"flex gap-2"},B={key:0,class:"text-center p-12 bg-blue-50 rounded-xl border border-blue-100 mb-6 transition-all duration-500 transform scale-100 relative overflow-hidden"},D={class:"absolute-top-right p-2"},H=["src"],F={class:"text-h3 font-bold text-blue-900"},G={key:1,class:"text-center p-12 bg-green-50 rounded-xl border border-green-200 mb-6"},K={key:2,class:"text-center p-12 bg-gray-50 rounded-xl border border-dashed border-gray-300 mb-6"},X={key:3},Y={class:"flex justify-between items-center mb-2"},Z={class:"flex flex-wrap gap-2"},ee=["src"],te={key:1},ae={class:"flex items-center justify-between mb-4"},le={class:"text-h5 q-my-none text-green-8 flex items-center gap-2"},ne={class:"flex flex-col items-center justify-center p-8"},re={class:"text-9xl font-mono font-bold text-gray-800 tracking-wider mb-8"},oe={class:"flex gap-4"},se={key:2},ie={class:"flex items-center justify-between mb-4"},ce={class:"text-h5 q-my-none text-orange-9 flex items-center gap-2"},ue={class:"flex flex-col items-center justify-center p-8 relative"},de={class:"text-6xl font-mono font-bold text-gray-800"},me={class:"flex gap-4 mt-6"},ve=e({__name:"TimerRandomTools",props:{students:{type:Array,default:()=>[]}},setup(e){const ve=e,ge=_(localStorage.getItem("timer_random_active_tool")||"random1");x(ge,e=>{localStorage.setItem("timer_random_active_tool",e)});const fe=k({random1:{current:null,history:[],pickedIds:[]},random2:{current:null,history:[],pickedIds:[]}});I(()=>{try{const e=e=>{const t=JSON.parse(localStorage.getItem(`${e}_history`));t&&(fe[e].history=t);const a=JSON.parse(localStorage.getItem(`${e}_picked_ids`));a&&(fe[e].pickedIds=a)};e("random1"),e("random2")}catch(e){console.error("Error loading random history",e)}});const pe=e=>e?e.avatar?e.avatar.startsWith("/")?e.avatar:`/${e.avatar}`:"/images/avatars/default-avatar.svg":"",ye=e=>ve.students.length-fe[e].pickedIds.length,be=e=>{fe[e].pickedIds=[],fe[e].current=null,localStorage.setItem(`${e}_picked_ids`,JSON.stringify([]))},he=k({timer1:{seconds:0,running:!1,intervalId:null},timer2:{seconds:0,running:!1,intervalId:null}});I(()=>{he.timer1.seconds=parseInt(localStorage.getItem("timer1_seconds")||0),he.timer2.seconds=parseInt(localStorage.getItem("timer2_seconds")||0)});const _e=e=>{he[e].running?(clearInterval(he[e].intervalId),he[e].running=!1):(he[e].running=!0,he[e].intervalId=setInterval(()=>{he[e].seconds++,localStorage.setItem(`${e}_seconds`,he[e].seconds)},1e3))},xe=k({countdown1:{remaining:300,total:300,running:!1,intervalId:null},countdown2:{remaining:60,total:60,running:!1,intervalId:null}});I(()=>{const e=e=>{const t=localStorage.getItem(`${e}_config`);if(t){const a=JSON.parse(t);xe[e].remaining=a.remaining,xe[e].total=a.total}};e("countdown1"),e("countdown2")});const ke=_(!1),Ie=k({key:null,minutes:0,seconds:0}),Se=()=>{const e=Ie.key,t=60*Ie.minutes+Ie.seconds;xe[e].total=t,xe[e].remaining=t,xe[e].running&&(clearInterval(xe[e].intervalId),xe[e].running=!1),localStorage.setItem(`${e}_config`,JSON.stringify({remaining:t,total:t})),ke.value=!1},we=e=>{const t=e%60;return`${Math.floor(e/60).toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},Ce=e=>{new Audio("/audio/notification.mp3").play().catch(e=>{})};return S(()=>{Object.keys(he).forEach(e=>clearInterval(he[e].intervalId)),Object.keys(xe).forEach(e=>clearInterval(xe[e].intervalId))}),(_,x)=>(C(),w("div",T,[R("div",q,[R("div",Q,[j(o,{bordered:"",class:"rounded-borders bg-white shadow-sm"},{default:$(()=>[j(t,{header:"",class:"text-weight-bold text-uppercase text-grey-7 bg-grey-2 q-py-md"},{default:$(()=>[N(J(_.$t("rewardSys.tools","Tools")),1)]),_:1}),O((C(),V(n,{clickable:"",active:"random1"===ge.value,onClick:x[0]||(x[0]=e=>ge.value="random1"),"active-class":"bg-blue-1 text-primary"},{default:$(()=>[j(a,{avatar:""},{default:$(()=>[j(l,{name:"shuffle"})]),_:1}),j(a,null,{default:$(()=>x[18]||(x[18]=[N("Random List 1")])),_:1})]),_:1},8,["active"])),[[p]]),O((C(),V(n,{clickable:"",active:"random2"===ge.value,onClick:x[1]||(x[1]=e=>ge.value="random2"),"active-class":"bg-purple-1 text-purple"},{default:$(()=>[j(a,{avatar:""},{default:$(()=>[j(l,{name:"casino"})]),_:1}),j(a,null,{default:$(()=>x[19]||(x[19]=[N("Random List 2")])),_:1})]),_:1},8,["active"])),[[p]]),j(r),O((C(),V(n,{clickable:"",active:"timer1"===ge.value,onClick:x[2]||(x[2]=e=>ge.value="timer1"),"active-class":"bg-green-1 text-green"},{default:$(()=>[j(a,{avatar:""},{default:$(()=>[j(l,{name:"timer"})]),_:1}),j(a,null,{default:$(()=>x[20]||(x[20]=[N("Timer 1")])),_:1})]),_:1},8,["active"])),[[p]]),O((C(),V(n,{clickable:"",active:"timer2"===ge.value,onClick:x[3]||(x[3]=e=>ge.value="timer2"),"active-class":"bg-teal-1 text-teal"},{default:$(()=>[j(a,{avatar:""},{default:$(()=>[j(l,{name:"timelapse"})]),_:1}),j(a,null,{default:$(()=>x[21]||(x[21]=[N("Timer 2")])),_:1})]),_:1},8,["active"])),[[p]]),j(r),O((C(),V(n,{clickable:"",active:"countdown1"===ge.value,onClick:x[4]||(x[4]=e=>ge.value="countdown1"),"active-class":"bg-orange-1 text-orange"},{default:$(()=>[j(a,{avatar:""},{default:$(()=>[j(l,{name:"hourglass_empty"})]),_:1}),j(a,null,{default:$(()=>x[22]||(x[22]=[N("Countdown 1")])),_:1})]),_:1},8,["active"])),[[p]]),O((C(),V(n,{clickable:"",active:"countdown2"===ge.value,onClick:x[5]||(x[5]=e=>ge.value="countdown2"),"active-class":"bg-red-1 text-red"},{default:$(()=>[j(a,{avatar:""},{default:$(()=>[j(l,{name:"hourglass_bottom"})]),_:1}),j(a,null,{default:$(()=>x[23]||(x[23]=[N("Countdown 2")])),_:1})]),_:1},8,["active"])),[[p]])]),_:1})]),R("div",W,[j(v,{class:"shadow-sm border border-gray-200",style:{"min-height":"400px"}},{default:$(()=>[j(s,null,{default:$(()=>{return[ge.value.startsWith("random")?(C(),w("div",L,[R("div",A,[R("h2",E,[j(l,{name:"random1"===ge.value?"shuffle":"casino"},null,8,["name"]),N(" "+J("random1"===ge.value?"Random List 1":"Random List 2"),1)]),R("div",U,[j(i,{color:0===ye(ge.value)?"positive":"grey-3","text-color":0===ye(ge.value)?"white":"black"},{default:$(()=>[N(J(fe[ge.value].pickedIds.length)+" / "+J(e.students.length)+" Picked ",1)]),_:1},8,["color","text-color"]),ye(ge.value)>0?(C(),V(c,{key:0,label:"Pick Random",color:"primary",icon:"autorenew",onClick:x[6]||(x[6]=e=>(e=>{if(0===ve.students.length)return;const t=ve.students.filter(t=>!fe[e].pickedIds.includes(t.id));if(0===t.length)return;const a=t[Math.floor(Math.random()*t.length)];fe[e].current=a,fe[e].history.unshift(a),fe[e].pickedIds.push(a.id),localStorage.setItem(`${e}_history`,JSON.stringify(fe[e].history)),localStorage.setItem(`${e}_picked_ids`,JSON.stringify(fe[e].pickedIds))})(ge.value))})):(C(),V(c,{key:1,label:"Start New Round",color:"positive",icon:"refresh",onClick:x[7]||(x[7]=e=>be(ge.value)),class:"animate-pulse"}))])]),fe[ge.value].current?(C(),w("div",B,[R("div",D,[j(b,{color:"blue",floating:""},{default:$(()=>[N("Round Progress: "+J(Math.round(fe[ge.value].pickedIds.length/e.students.length*100))+"%",1)]),_:1})]),j(u,{size:"100px",class:"shadow-lg mb-4"},{default:$(()=>[R("img",{src:pe(fe[ge.value].current)},null,8,H)]),_:1}),R("div",F,J(fe[ge.value].current.name),1),x[24]||(x[24]=R("div",{class:"text-subtitle1 text-blue-600 mt-2"},"Congratulations!",-1))])):0===ye(ge.value)&&e.students.length>0?(C(),w("div",G,[j(l,{name:"check_circle",size:"4em",color:"positive"}),x[25]||(x[25]=R("div",{class:"text-h4 text-green-900 mt-2"},"All Students Picked!",-1)),x[26]||(x[26]=R("div",{class:"text-subtitle1 text-green-700"},"Turn has ended. Ready for a new round?",-1)),j(c,{label:"Reset Round",color:"positive",class:"mt-4",onClick:x[8]||(x[8]=e=>be(ge.value))})])):(C(),w("div",K,[j(l,{name:"help_outline",size:"4em",color:"grey-4"}),x[27]||(x[27]=R("div",{class:"text-grey-5 mt-2"},'Click "Pick Random" to select a student',-1))])),fe[ge.value].history.length>0?(C(),w("div",X,[R("div",Y,[x[28]||(x[28]=R("div",{class:"text-subtitle2 text-grey-7"},"Session History",-1)),j(c,{flat:"",dense:"",label:"Clear History",size:"sm",color:"negative",onClick:x[9]||(x[9]=e=>{return t=ge.value,fe[t].history=[],fe[t].current=null,void localStorage.removeItem(`${t}_history`);var t})})]),R("div",Z,[(C(!0),w(M,null,P(fe[ge.value].history,(e,t)=>(C(),V(i,{key:t,removable:"",onRemove:e=>((e,t)=>{fe[e].history.splice(t,1),localStorage.setItem(`${e}_history`,JSON.stringify(fe[e].history))})(ge.value,t)},{default:$(()=>[j(u,null,{default:$(()=>[R("img",{src:pe(e)},null,8,ee)]),_:2},1024),N(" "+J(e.name),1)]),_:2},1032,["onRemove"]))),128))])])):z("",!0)])):z("",!0),ge.value.startsWith("timer")?(C(),w("div",te,[R("div",ae,[R("h2",le,[j(l,{name:"timer1"===ge.value?"timer":"timelapse"},null,8,["name"]),N(" "+J("timer1"===ge.value?"Timer 1":"Timer 2"),1)])]),R("div",ne,[R("div",re,J(we(he[ge.value].seconds)),1),R("div",oe,[j(c,{color:he[ge.value].running?"warning":"positive",icon:he[ge.value].running?"pause":"play_arrow",label:he[ge.value].running?"Pause":"Start",size:"lg",class:"px-8",onClick:x[10]||(x[10]=e=>_e(ge.value))},null,8,["color","icon","label"]),j(c,{color:"grey",icon:"restart_alt",label:"Reset",size:"lg",outline:"",onClick:x[11]||(x[11]=e=>{return t=ge.value,he[t].running&&_e(t),he[t].seconds=0,void localStorage.setItem(`${t}_seconds`,0);var t})})])])])):z("",!0),ge.value.startsWith("countdown")?(C(),w("div",se,[R("div",ie,[R("h2",ce,[j(l,{name:"countdown1"===ge.value?"hourglass_empty":"hourglass_bottom"},null,8,["name"]),N(" "+J("countdown1"===ge.value?"Countdown 1":"Countdown 2"),1)]),j(c,{icon:"settings",flat:"",round:"",color:"grey",onClick:x[12]||(x[12]=e=>(e=>{Ie.key=e;const t=xe[e].total;Ie.minutes=Math.floor(t/60),Ie.seconds=t%60,ke.value=!0})(ge.value))},{default:$(()=>[j(d,null,{default:$(()=>x[29]||(x[29]=[N("Set Duration")])),_:1})]),_:1})]),R("div",ue,[j(h,{"show-value":"",class:"text-orange-8 q-ma-md",value:(t=ge.value,0===xe[t].total?0:xe[t].remaining/xe[t].total*100),size:"300px",thickness:.1,color:"orange","track-color":"orange-1","center-color":"white"},{default:$(()=>[R("div",de,J(we(xe[ge.value].remaining)),1)]),_:1},8,["value"]),R("div",me,[j(c,{color:xe[ge.value].running?"warning":"positive",icon:xe[ge.value].running?"pause":"play_arrow",label:xe[ge.value].running?"Pause":"Start",size:"lg",class:"px-8",onClick:x[13]||(x[13]=e=>(e=>{if(xe[e].running)clearInterval(xe[e].intervalId),xe[e].running=!1;else{if(xe[e].remaining<=0)return;xe[e].running=!0,xe[e].intervalId=setInterval(()=>{xe[e].remaining>0?(xe[e].remaining--,localStorage.setItem(`${e}_config`,JSON.stringify({remaining:xe[e].remaining,total:xe[e].total}))):(clearInterval(xe[e].intervalId),xe[e].running=!1,Ce())},1e3)}})(ge.value))},null,8,["color","icon","label"]),j(c,{color:"grey",icon:"restart_alt",label:"Reset",size:"lg",outline:"",onClick:x[14]||(x[14]=e=>(e=>{xe[e].running&&(clearInterval(xe[e].intervalId),xe[e].running=!1),xe[e].remaining=xe[e].total,localStorage.setItem(`${e}_config`,JSON.stringify({remaining:xe[e].remaining,total:xe[e].total}))})(ge.value))})])]),j(m,{modelValue:ke.value,"onUpdate:modelValue":x[17]||(x[17]=e=>ke.value=e)},{default:$(()=>[j(v,{style:{"min-width":"300px"}},{default:$(()=>[j(s,null,{default:$(()=>x[30]||(x[30]=[R("div",{class:"text-h6"},"Set Duration",-1)])),_:1}),j(s,null,{default:$(()=>[j(g,{modelValue:Ie.minutes,"onUpdate:modelValue":x[15]||(x[15]=e=>Ie.minutes=e),modelModifiers:{number:!0},type:"number",label:"Minutes",outlined:"",autofocus:""},null,8,["modelValue"]),j(g,{modelValue:Ie.seconds,"onUpdate:modelValue":x[16]||(x[16]=e=>Ie.seconds=e),modelModifiers:{number:!0},type:"number",label:"Seconds",outlined:"",class:"mt-2"},null,8,["modelValue"])]),_:1}),j(f,{align:"right"},{default:$(()=>[O(j(c,{flat:"",label:"Cancel",color:"primary"},null,512),[[y]]),j(c,{flat:"",label:"Set",color:"primary",onClick:Se})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):z("",!0)];var t}),_:1})]),_:1})])])]))}},[["__scopeId","data-v-247453f2"]]);export{ve as default};
