const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/TopLeaderboard-BAbm9YZt.js","assets/js/app-DraepSDZ.js","assets/js/vendor-BWKGNkNB.js","assets/js/offline-BzIlwqNM.js","assets/js/i18n-B0T1C7j3.js","assets/js/ui-B7TfxbV_.js","assets/css/app-QAOnovzD.css","assets/js/QSelect-B8X205mE.js","assets/js/rtl-Cr6c3OOr.js","assets/js/html2canvas.esm-Cq3pa7K9.js","assets/css/TopLeaderboard-Dw9a8_8K.css","assets/js/BehaviorIncidents-BLF36Ne3.js","assets/js/QBtnToggle-BX1j-GCf.js","assets/js/QBadge-VPRr201m.js","assets/js/QToolbar-CMohnsUl.js","assets/js/StudentCard-BRCojCUo.js","assets/js/AvatarManager-BvSCzy8q.js","assets/js/CameraCapture-B7WLPobJ.js","assets/js/QFile-D-jHblno.js","assets/js/use-file-rNbaHoao.js","assets/js/QImg-BYq7Ky76.js","assets/css/CameraCapture-BSPKVu_J.css","assets/css/AvatarManager-C1Pqt1hB.css","assets/css/BarcodeScanner-tn0RQdqM.css","assets/js/IncidentPrintReport-BitvtHxB.js","assets/css/IncidentPrintReport-BcWCgfP6.css","assets/js/StudentGrouping-Vz9_a_tY.js","assets/js/vuedraggable.umd-DshT_Vng.js","assets/js/index-SlSKjXnq.js","assets/css/StudentGrouping-CRYXuU7Q.css"])))=>i.map(i=>d[i]);
import{r as e,u as a,f as t,Q as l,p as s,b as o,t as n,d as r,i,j as d,k as u,c,aR as v,s as m,l as p,e as g,o as f,g as b,h as y,_ as h,G as x,aS as w,m as _}from"./app-DraepSDZ.js";import{Q as S}from"./QBtnToggle-BX1j-GCf.js";import{Q as k}from"./QBadge-VPRr201m.js";import{Q as $}from"./QTab-BTRoGWkY.js";import{Q as I}from"./QTabs-BgqCfsdX.js";import{Q as C}from"./QTabPanel-BcQ_0NuW.js";import{Q as j}from"./QTabPanels-Dk5dhPlu.js";import{Q as E}from"./QSpace-CZ9CnKBh.js";import{Q as A}from"./QSelect-B8X205mE.js";import{u as V}from"./i18n-B0T1C7j3.js";import{_ as z,f as T,o as U,k as P,M as D,a as N,af as F,N as L,J as R,b as q,R as B,I as O,O as M,K as Q,V as W,z as G,l as J,W as Y,F as H,Q as Z,S as K,y as X,U as ee,E as ae,ag as te,ah as le,aS as se,Y as oe}from"./vendor-BWKGNkNB.js";import ne from"./PointsDisplaySettings--9eeJhFF.js";import re from"./TimerRandomTools-D9uKt2gh.js";import ie from"./ClassroomHelper-_tZxzBui.js";import de from"./StudentCard-BRCojCUo.js";import ue from"./noise-DExYgyys.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-BIFIFpms.js";import"./use-render-cache-CmTcazfP.js";import"./QCircularProgress-CMiuS3ZY.js";import"./QTd-ZXd3AVz0.js";import"./QTable-lfCIUGXW.js";import"./QMarkupTable-B8BpHV8_.js";import"./QLinearProgress-CYD1l_xP.js";import"./use-fullscreen-WQ56vCgJ.js";import"./AvatarManager-BvSCzy8q.js";import"./CameraCapture-B7WLPobJ.js";import"./QFile-D-jHblno.js";import"./use-file-rNbaHoao.js";import"./QImg-BYq7Ky76.js";const ce="/api",ve={behaviors:`${ce}/behaviors`,studentBehaviors:`${ce}/student-behaviors`,pointActions:`${ce}/student-behaviors-point-actions`,leaderboard:`${ce}/leaderboard`,studentSummary:e=>`${ce}/student-behaviors/${e}/summary`,pointActionStatistics:e=>`${ce}/student-behaviors/${e}/statistics`,attendance:`${ce}/student-attendance`,attendanceBatch:`${ce}/student-attendance/batch`},me="reward_sys_offline_queue";function pe(){try{const e=localStorage.getItem(me);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading offline queue:",e),[]}}function ge(e){const a=pe();e.id=e.id||Date.now()+Math.random().toString(36).substr(2,9),e.timestamp=e.timestamp||Date.now(),e.status="pending",a.push(e),localStorage.setItem(me,JSON.stringify(a)),console.log("üì¶ Action added to offline queue:",e)}async function fe({classroomId:e,startDate:a,endDate:t,limit:l=10}){var s,o;try{const s=await z.get(ve.leaderboard,{params:{classroom_id:e,start_date:a,end_date:t,limit:Math.min(l,50)}});return{success:!0,data:Array.isArray(s.data)?s.data:[]}}catch(n){return console.error("Error fetching leaderboard:",n),{success:!1,error:(null==(o=null==(s=n.response)?void 0:s.data)?void 0:o.message)||"Failed to fetch leaderboard",data:[],details:n}}}const be={addPoint:async function(e,a,t=null,l="",s={}){var o,n;try{const o={student_behaviors_id:e,value:parseInt(a),reason_id:t?parseInt(t):null,note:l||null};if(!navigator.onLine&&!s.isSync)throw new Error("Network Error");return{success:!0,data:(await z.post(ve.pointActions,o)).data,message:`Point ${a>0?"added":"deducted"} successfully`}}catch(r){return s.isSync||"Network Error"!==r.message&&navigator.onLine?(console.error("Error adding point:",r),{success:!1,error:(null==(n=null==(o=r.response)?void 0:o.data)?void 0:n.message)||"Failed to add point",details:r}):(ge({type:"addPoint",payload:{studentBehaviorsId:e,value:a,reasonId:t,note:l},desc:`Point ${a>0?"+":""}${a}`}),{success:!0,data:{id:"temp_"+Date.now(),value:parseInt(a),created_at:(new Date).toISOString(),offline:!0},message:"Saved offline. Will sync when online.",offline:!0})}},cancelPoint:async function(e,a){var t,l;try{return{success:!0,data:(await z.post(`${ve.pointActions}/${e}/cancel`,{cancel_reason:a})).data,message:"Point action canceled successfully"}}catch(s){return console.error("Error canceling point:",s),{success:!1,error:(null==(l=null==(t=s.response)?void 0:t.data)?void 0:l.message)||"Failed to cancel point",details:s}}},restorePoint:async function(e){var a,t;try{return{success:!0,data:(await z.post(`${ve.pointActions}/${e}/restore`)).data,message:"Point action restored successfully"}}catch(l){return console.error("Error restoring point:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to restore point",details:l}}},deletePoint:async function(e){var a,t;try{return{success:!0,data:(await z.delete(`${ve.pointActions}/${e}`)).data,message:"Point action deleted successfully"}}catch(l){return console.error("Error deleting point:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to delete point",details:l}}},createStudentBehavior:async function(e){var a,t;try{const a={school_id:e.schoolId,student_behaviors_mains_id:e.studentBehaviorsMainsId,student_id:e.studentId,attend:e.attend||null,points_plus:e.pointsPlus||0,points_minus:e.pointsMinus||0,points_details:e.pointsDetails||"",notes:e.notes||null};return{success:!0,data:(await z.post(ve.studentBehaviors,a)).data,message:"Student behavior record created successfully"}}catch(l){return console.error("Error creating student behavior:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to create behavior record",details:l}}},getStudentSummary:async function(e){var a,t;try{return{success:!0,data:(await z.get(ve.studentSummary(e))).data}}catch(l){return console.error("Error fetching student summary:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch student summary",details:l}}},getPointActions:async function(e){var a,t;try{return{success:!0,data:(await z.get(ve.pointActions,{params:{student_behaviors_id:e}})).data}}catch(l){return console.error("Error fetching point actions:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch point actions",details:l}}},getPointStatistics:async function(e){var a,t;try{return{success:!0,data:(await z.get(`${ve.pointActions}/statistics/${e}`)).data}}catch(l){return console.error("Error fetching point statistics:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch statistics",details:l}}},fetchBehaviors:async function(){var e,a;try{const e=await z.get(ve.behaviors);return{success:!0,data:Array.isArray(e.data)?e.data:[]}}catch(t){return console.error("Error fetching behaviors:",t),{success:!1,error:(null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||"Failed to fetch behaviors",data:[],details:t}}},applyBehaviorToStudents:async function(e,a,t={}){var l,s,o,n,r;const i=t.isSync||!1;if(!navigator.onLine&&!i)return ge({type:"applyBehaviorToStudents",payload:{studentIds:e,behaviorId:a,options:t},desc:`Batch behavior apply to ${e.length} students`}),{success:!0,data:[],results:e.map(e=>({studentId:e,success:!0,offline:!0})),message:`Saved offline. ${e.length} updates pending.`,offline:!0};try{const n=[],r=[],u="object"==typeof a?a.id:a;if(console.log("üéØ applyBehaviorToStudents called with:",{studentCount:e.length,behaviorIdInput:a,actualBehaviorId:u,behaviorIdType:typeof a}),!u||isNaN(u))return console.error("‚ùå Invalid behavior ID:",a),{success:!1,error:"Invalid behavior ID provided"};for(const a of e){const e={student_id:a,behavior_id:u,date:t.date||(new Date).toISOString().split("T")[0],period_code:t.periodCode||null,points_mode:t.points_mode||"session",notes:t.notes||null};console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),console.log("üì§ Sending behavior application request"),console.log("   Student ID:",a),console.log("   Behavior ID:",u),console.log("   Payload:",JSON.stringify(e,null,2)),console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");try{const t=await z.post(`${ce}/student-behaviors/quick-create`,e);n.push({studentId:a,success:!0,data:t.data})}catch(d){"Network Error"!==d.message||i?(console.error("‚ùå FAILED - Error applying behavior to student:",a,d),r.push({studentId:a,success:!1,error:(null==(s=null==(l=d.response)?void 0:l.data)?void 0:s.message)||"Failed to apply behavior",fullError:null==(o=d.response)?void 0:o.data})):r.push({studentId:a,success:!1,error:"Network Error",fullError:d})}}return console.log("üéØ BATCH RESULT:",{totalRequests:e.length,successful:n.length,failed:r.length,successRate:`${Math.round(n.length/e.length*100)}%`}),{success:0===r.length,results:n,errors:r,message:`Applied to ${n.length}/${e.length} students`}}catch(u){return i||"Network Error"!==u.message&&navigator.onLine?(console.error("‚ùå OUTER ERROR - Exception in applyBehaviorToStudents:",u),{success:!1,error:(null==(r=null==(n=u.response)?void 0:n.data)?void 0:r.message)||"Failed to apply behavior",details:u}):(ge({type:"applyBehaviorToStudents",payload:{studentIds:e,behaviorId:a,options:t},desc:`Batch behavior apply to ${e.length} students`}),{success:!0,data:[],results:e.map(e=>({studentId:e,success:!0,offline:!0})),message:`Saved offline. ${e.length} updates pending.`,offline:!0})}},fetchLeaderboard:fe,getTopStudentsByPeriod:async function({classroomId:e,period:a="week",limit:t=5}){try{const l=new Date;let s;switch(a){case"week":default:s=new Date(l.getTime()-6048e5);break;case"month":s=new Date(l.getFullYear(),l.getMonth(),1);break;case"all":s=new Date("2020-01-01")}const o=e=>e.toISOString().split("T")[0];return fe({classroomId:e,startDate:o(s),endDate:o(l),limit:t})}catch(l){return console.error("Error getting top students:",l),{success:!1,error:"Failed to get top students",data:[],details:l}}},updateAttendance:async function(e,a,t={}){var l,s,o;try{const r={student_id:parseInt(e),attend:Boolean(a),date:t.date||(new Date).toISOString().split("T")[0],period_code:t.periodCode||null,classroom_id:t.classroomId||null};try{const e=await z.post(ve.attendance,r);return{success:!0,data:e.data,message:(null==(l=e.data)?void 0:l.message)||"Student marked as "+(a?"present":"absent")}}catch(n){return console.warn("Attendance API call failed, falling back to client-only update:",null==(s=null==n?void 0:n.response)?void 0:s.status),{success:!0,data:{studentId:parseInt(e),isPresent:Boolean(a),updatedAt:(new Date).toISOString()},message:`Student marked as ${a?"present":"absent"} (local)`,warning:(null==(o=n.response)?void 0:o.data)||n.message}}}catch(r){return console.error("Error updating attendance:",r),{success:!1,error:"Failed to update attendance",details:r}}},batchUpdateAttendance:async function(e,a={}){var t,l,s;try{if(!e||"object"!=typeof e)return{success:!1,error:"Invalid attendance data"};const n=Object.entries(e).map(([e,t])=>({student_id:parseInt(e),attend:Boolean(t),date:a.date||(new Date).toISOString().split("T")[0],period_code:a.periodCode||null,classroom_id:a.classroomId||null,updated_at:(new Date).toISOString()}));try{const e=await z.post(ve.attendanceBatch,{attendance:n});return{success:!0,data:e.data,message:(null==(t=e.data)?void 0:t.message)||`Updated attendance for ${n.length} students`}}catch(o){return console.warn("Batch attendance API call failed, falling back to local update:",null==(l=null==o?void 0:o.response)?void 0:l.status),{success:!0,data:n,message:`Updated attendance for ${n.length} students (local)`,warning:(null==(s=o.response)?void 0:s.data)||o.message}}}catch(n){return console.error("Error batch updating attendance:",n),{success:!1,error:"Failed to batch update attendance",details:n}}},getRecentActions:async function({classroomId:e,date:a,limit:t=10}){var l,s;try{const l=await z.get(`${ce}/student-behaviors/recent-actions`,{params:{classroom_id:e,date:a,limit:t}});return{success:!0,data:Array.isArray(l.data.data)?l.data.data:[]}}catch(o){return console.error("Error fetching recent actions:",o),{success:!1,error:(null==(s=null==(l=o.response)?void 0:l.data)?void 0:s.message)||"Failed to fetch recent actions",data:[]}}},undoAction:async function(e,a="Undone by teacher",t={}){var l,s;if("string"==typeof e&&e.startsWith("temp_"))return function(e){const a=pe().filter(a=>a.id!==e);localStorage.setItem(me,JSON.stringify(a))}(e.replace("temp_","")),{success:!0,message:"Offline action removed."};const o=t.isSync||!1;if(!navigator.onLine&&!o)return ge({type:"undoAction",payload:{actionId:e,reason:a},desc:`Undo action ${e}`}),{success:!0,message:"Undo saved offline.",offline:!0};try{const t=await z.post(`${ce}/student-behaviors/actions/${e}/cancel`,{cancel_reason:a});return{success:!0,data:t.data.data,message:t.data.message||"Action undone successfully"}}catch(n){return o||"Network Error"!==n.message&&navigator.onLine?(console.error("Error undoing action:",n),{success:!1,error:(null==(s=null==(l=n.response)?void 0:l.data)?void 0:s.message)||"Failed to undo action"}):(ge({type:"undoAction",payload:{actionId:e,reason:a},desc:`Undo action ${e}`}),{success:!0,message:"Undo saved offline.",offline:!0})}},formatPointValue:function(e){return e>0?`+${e} ‚≠ê`:e<0?`${e} ‚ö†Ô∏è`:"0"},getActionTypeLabel:function(e){return{plus:"Added",minus:"Deducted",cancel:"Canceled",revoke:"Revoked"}[e]||e},calculateTotalPoints:function(e,a=!1){return Array.isArray(e)?e.filter(e=>a||!e.canceled).reduce((e,a)=>e+(a.value||0),0):0},separatePoints:function(e){if(!Array.isArray(e))return{positive:0,negative:0};const a=e.filter(e=>!e.canceled);return{positive:a.filter(e=>e.value>0).reduce((e,a)=>e+a.value,0),negative:Math.abs(a.filter(e=>e.value<0).reduce((e,a)=>e+a.value,0))}},isActionEditable:function(e,a=24){try{const t=new Date(e);return(new Date-t)/36e5<a}catch(t){return!1}},getUserFriendlyErrorMessage:function(e){var a,t,l,s,o,n,r;return 401===(null==(a=e.response)?void 0:a.status)?"You are not authenticated. Please log in.":403===(null==(t=e.response)?void 0:t.status)?"You do not have permission to perform this action.":404===(null==(l=e.response)?void 0:l.status)?"The requested resource was not found.":422===(null==(s=e.response)?void 0:s.status)?"Invalid data provided. Please check your input.":500===(null==(o=e.response)?void 0:o.status)?"Server error. Please try again later.":"Network Error"===e.message?"Network error. Please check your connection.":(null==(r=null==(n=e.response)?void 0:n.data)?void 0:r.message)||"An unexpected error occurred."},retryWithBackoff:async function(e,a=3,t=1e3){let l;for(let o=0;o<a;o++)try{return await e()}catch(s){if(l=s,o<a-1){const e=t*Math.pow(2,o);await new Promise(a=>setTimeout(a,e))}}throw l}},ye=new Map;async function he(e){const a=Object.entries(e).map(([e,a])=>ye.has(e)?Promise.resolve():new Promise(t=>{const l=new Audio(a);l.addEventListener("canplaythrough",()=>{ye.set(e,l),t()},{once:!0}),l.addEventListener("error",()=>{console.warn(`Failed to preload sound "${e}"`),t()},{once:!0}),l.load()}));await Promise.all(a)}const xe={class:"bg-gradient-to-br from-gray-800 to-gray-900 h-full"},we={class:"text-3xl font-bold"},_e={class:"text-blue-100"},Se={class:"flex items-center justify-between bg-white p-4 rounded-lg border border-gray-200 shadow-sm"},ke={class:"flex items-center gap-4"},$e={class:"bg-blue-100 p-3 rounded-full text-blue-600"},Ie={class:"text-sm text-gray-500 font-medium"},Ce={class:"text-lg font-bold text-gray-800 flex items-center gap-2"},je={key:0},Ee={key:1,class:"text-gray-400 italic"},Ae={class:"text-blue-600 font-mono bg-blue-50 px-2 py-0.5 rounded text-base"},Ve={class:"text-xs text-gray-500 mt-1"},ze={key:0,class:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 rounded-lg border border-blue-200 shadow-sm"},Te={class:"flex items-center justify-between flex-wrap gap-3"},Ue={class:"flex items-center gap-2"},Pe={class:"text-sm font-bold text-gray-700"},De={class:"flex items-center gap-3 flex-wrap"},Ne={key:0,class:"text-xs text-gray-500 bg-white px-2 py-1 rounded border border-dashed border-gray-300"},Fe={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-blue-200"},Le={class:"flex flex-col"},Re={class:"text-xs text-gray-500"},qe={class:"text-lg font-bold text-blue-600"},Be={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-green-200"},Oe={class:"flex flex-col"},Me={class:"text-xs text-gray-500"},Qe={class:"text-lg font-bold text-green-600"},We={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-red-200"},Ge={class:"flex flex-col"},Je={class:"text-xs text-gray-500"},Ye={class:"text-lg font-bold text-red-600"},He={key:0,class:"mt-3 pt-3 border-t border-blue-200"},Ze={class:"text-xs font-semibold text-gray-600 mb-2 flex items-center gap-1"},Ke={class:"bg-white border border-red-200 rounded-lg p-2"},Xe={class:"flex flex-wrap gap-1.5"},ea={class:"sticky top-0 z-50 bg-white shadow-md border-b border-gray-200"},aa={class:"q-pa-sm flex justify-between items-center flex-nowrap gap-2"},ta={class:"flex items-center gap-2 flex-nowrap overflow-hidden"},la={class:"row no-wrap q-pa-md"},sa={key:0},oa={key:1,class:"column items-center",style:{"min-width":"180px"}},na={class:"column q-gutter-y-sm full-width"},ra={class:"q-py-sm"},ia={class:"flex items-center gap-1 mx-2"},da={class:"font-bold"},ua={class:"font-bold"},ca={class:"font-bold"},va={key:0,class:"flex items-center gap-1 overflow-hidden"},ma={class:"flex items-center ml-4 transition-all duration-300"},pa={key:0,class:"flex items-center text-gray-400 text-xs italic"},ga={key:1,class:"flex items-center gap-3 bg-gray-100 px-3 py-1 rounded-full border border-gray-200 shadow-sm animate-fade-in overflow-hidden"},fa=["src"],ba={class:"flex flex-col leading-none overflow-hidden"},ya={class:"text-sm font-bold text-gray-900 truncate max-w-[150px]"},ha={key:0,class:"text-xs text-blue-800 font-arabic font-bold mt-0.5 truncate max-w-[150px]"},xa={class:"flex items-center gap-2"},wa={style:{width:"420px","max-width":"90vw"}},_a={key:0,class:"bg-blue-50 p-2 border-b border-blue-100"},Sa={class:"text-xs font-bold text-blue-900 mb-1 flex justify-between items-center"},ka={class:"flex flex-wrap gap-1 max-h-[60px] overflow-y-auto custom-scrollbar"},$a=["src"],Ia={class:"max-w-[80px] ellipsis"},Ca={class:"row q-col-gutter-sm"},ja=["onClick"],Ea={class:"column items-center justify-center q-pa-xs bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md hover:border-blue-300 transition-all text-center h-full relative-position group hover:bg-blue-50",style:{"min-height":"80px"}},Aa={class:"text-[9px] font-bold text-gray-700 leading-tight flex items-center justify-center px-1 text-center h-[2.5em] overflow-hidden"},Va={class:"mt-1"},za={class:"bg-green-50 text-green-700 text-[9px] font-bold px-1.5 py-0.5 rounded border border-green-100"},Ta={class:"row q-col-gutter-sm"},Ua=["onClick"],Pa={class:"column items-center q-pa-sm bg-red-50 rounded-xl border border-red-100 shadow-sm hover:shadow-md hover:bg-red-100 transition-all text-center h-full relative-position"},Da={class:"text-caption text-weight-bold text-grey-9 ellipsis-2-lines leading-tight min-h-[2.5em] flex items-center justify-center"},Na={class:"absolute-top-right q-ma-xs"},Fa={key:0,class:"bg-orange-50 p-1 text-center border-b border-orange-100 text-xs text-orange-800 font-bold"},La={class:"space-y-4"},Ra={class:"flex justify-between items-center mb-4"},qa={class:"text-xl font-bold"},Ba={class:"flex gap-2"},Oa={class:"flex flex-wrap justify-center gap-6 p-4 bg-gray-400"},Ma={class:""},Qa={class:"mt-6"},Wa={class:"row items-center q-gutter-x-sm"},Ga={class:"text-h6"},Ja={key:0,class:"text-gray-500 italic text-center py-4"},Ya=["src"],Ha={key:1,class:"mb-4 overflow-x-auto whitespace-nowrap p-2 bg-white rounded-lg shadow-sm border border-gray-100 flex gap-2 custom-scrollbar items-center"},Za={key:0,class:"mb-3 p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200"},Ka={class:"flex items-center justify-between"},Xa={class:"font-bold text-indigo-900 flex items-center gap-2"},et={class:"flex gap-2"},at={class:"flex flex-wrap justify-center gap-6"},tt={class:"space-y-4"},lt={class:"mb-4"},st={class:"text-xl font-bold mb-2"},ot={class:"text-sm text-gray-600"},nt={class:"p-4 bg-red-50 rounded-lg border border-red-200"},rt={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},it={class:"mt-2 text-sm"},dt={class:"flex flex-wrap justify-center gap-6 p-4"},ut={class:"space-y-4"},ct={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},vt=["onClick"],mt={class:"flex items-start justify-between mb-3"},pt={class:"flex-1"},gt={class:"font-semibold text-lg"},ft={class:"text-xs text-gray-600"},bt={key:0,class:"text-xs text-red-600 mt-1"},yt={class:"space-y-2"},ht={class:"p-2 bg-green-100 rounded flex justify-between items-center"},xt={class:"text-sm font-bold text-green-900"},wt={class:"p-2 bg-red-100 rounded flex justify-between items-center"},_t={class:"text-sm font-bold text-red-900"},St={class:"p-2 bg-blue-100 rounded flex justify-between items-center"},kt={class:"text-lg font-bold text-blue-600"},$t={class:"space-y-4"},It={class:"flex justify-between items-center mb-4"},Ct={class:"text-xl font-bold"},jt={key:0,class:"text-center py-8"},Et={class:"text-gray-500 text-lg"},At={class:"flex items-start justify-between"},Vt={class:"flex-1"},zt={class:"flex items-center gap-2 mb-1"},Tt={class:"font-bold text-lg"},Ut={class:"text-2xl"},Pt={class:"text-sm text-gray-700"},Dt={class:"text-xs text-gray-500 mt-1"},Nt={key:0,class:"text-xs text-gray-600 mt-1 italic"},Ft={key:1,class:"text-xs text-red-600 mt-1"},Lt={class:"flex flex-col h-full gap-4"},Rt={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},qt={class:"space-y-6"},Bt={class:"flex justify-between items-center mb-6"},Ot={class:"text-2xl font-bold text-gray-800"},Mt={class:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200"},Qt={class:"flex items-center gap-3 mb-4"},Wt={class:"text-xl font-bold text-green-800"},Gt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Jt={class:"flex items-start justify-between mb-2"},Yt={class:"flex items-center gap-2"},Ht={class:"text-3xl"},Zt={class:"font-bold text-gray-800"},Kt={class:"text-xs text-gray-500"},Xt={class:"flex gap-1"},el={class:"flex items-center justify-between mt-3 pt-3 border-t border-green-100"},al={class:"text-lg font-bold text-green-600"},tl={key:0,class:"text-center py-8 text-gray-400"},ll={class:"bg-gradient-to-r from-red-50 to-rose-50 rounded-xl p-6 border border-red-200"},sl={class:"flex items-center gap-3 mb-4"},ol={class:"text-xl font-bold text-red-800"},nl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},rl={class:"flex items-start justify-between mb-2"},il={class:"flex items-center gap-2"},dl={class:"text-3xl"},ul={class:"font-bold text-gray-800"},cl={class:"text-xs text-gray-500"},vl={class:"flex gap-1"},ml={class:"flex items-center justify-between mt-3 pt-3 border-t border-red-100"},pl={class:"text-lg font-bold text-red-600"},gl={key:0,class:"text-center py-8 text-gray-400"},fl={class:"text-2xl font-semibold text-gray-600"},bl={class:"font-bold text-blue-900 flex items-center gap-2 text-base md:text-lg"},yl={class:"md:hidden"},hl={class:"flex-1 overflow-y-auto p-3 custom-scrollbar"},xl={key:0,class:"text-center py-4 text-gray-400 italic text-sm"},wl={key:1,class:"flex flex-col gap-2"},_l={class:"flex flex-col leading-tight overflow-hidden w-full"},Sl={class:"font-bold text-sm md:text-base truncate"},kl={class:"p-2 border-t border-blue-200 bg-white"},$l={class:"grid grid-cols-3 gap-2"},Il={class:"flex-1 flex flex-col bg-white order-1 md:order-2 h-full overflow-hidden"},Cl={key:0,class:"bg-white border-b border-gray-100 p-3 flex justify-center items-center"},jl={class:"flex items-center gap-2"},El={class:"text-lg font-bold text-gray-800"},Al={class:"text-base md:text-xl flex items-center gap-2"},Vl={class:"hidden xs:inline"},zl={class:"bg-white/60 p-1 rounded-full flex gap-1 shadow-sm border border-white/60 backdrop-blur-sm"},Tl={class:"flex flex-wrap gap-2 justify-center md:gap-3 pb-20 md:pb-0"},Ul=["onClick"],Pl={class:"font-bold text-sm md:text-base leading-tight text-gray-800 line-clamp-2 md:line-clamp-3 w-full"},Dl={class:"flex justify-between items-center"},Nl={class:"text-h6"},Fl=["src"],Ll={class:"text-h5 font-bold mb-1"},Rl={class:"text-h3 font-black my-2 flex items-center gap-2 animate-bounce"},ql={class:"text-4xl"},Bl={class:"text-subtitle1 opacity-90 font-medium bg-white/20 px-4 py-1 rounded-full"},Ol=e({__name:"reward_sys",props:{isDialog:{type:Boolean,default:!1},classroomId:{type:Number,default:null},subjectId:{type:Number,default:null},period:{type:Number,default:null},date:{type:String,default:null},week:{type:Number,default:null},initialTab:{type:String,default:"positive"}},setup(e){const ce=e,ve=se(()=>h(()=>import("./TopLeaderboard-BAbm9YZt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),me=se(()=>h(()=>import("./BehaviorIncidents-BLF36Ne3.js"),__vite__mapDeps([11,1,2,3,4,5,6,12,13,14,7,8,15,16,17,18,19,20,21,22,23,24,25]))),pe=se(()=>h(()=>import("./StudentGrouping-Vz9_a_tY.js"),__vite__mapDeps([26,1,2,3,4,5,6,27,28,29]))),ge={select:"/audio/click-234708.mp3",reward:"/audio/purchase-success-384963.mp3",penalty:"/audio/error-010-206498.mp3"},fe=T(null),Ol=T(!1);U(()=>{!function(e){"requestIdleCallback"in window?requestIdleCallback(()=>he(e),{timeout:2e3}):setTimeout(()=>he(e),1e3)}(ge);const e=localStorage.getItem("reward-system-bg-music");Ol.value="true"===e,fe.value&&(fe.value.volume=.1,Ol.value&&fe.value.play().catch(e=>console.log("Autoplay prevented:",e)))}),P(Ol,e=>{localStorage.setItem("reward-system-bg-music",e),fe.value&&(e?fe.value.play().catch(e=>console.log("Playback error:",e)):fe.value.pause())});const Ml=e=>{!async function(e,a){if(!a[e])return void console.warn(`Sound key "${e}" not found in soundFiles`);if(!ye.has(e)){const t=new Audio(a[e]);await new Promise((e,a)=>{t.addEventListener("canplaythrough",e,{once:!0}),t.addEventListener("error",a,{once:!0}),t.load()}).catch(a=>{console.warn(`Failed to load sound "${e}":`,a)}),ye.set(e,t)}const t=ye.get(e);t&&(t.currentTime=0,t.play().catch(e=>console.log("Sound play error:",e)))}(e,ge)},{t:Ql,locale:Wl}=V(),Gl=e=>e?"ar"===Wl.value&&e.name_ar?e.name_ar:e.name:"",Jl=D(),Yl=N(()=>{var e,a;const t=null==(a=null==(e=Jl.props.auth)?void 0:e.user)?void 0:a.school;return Array.isArray(t)&&t.length>0?t[0].logo_url:null}),Hl=N(()=>{const e=new Map;return ls.value.forEach(a=>{a.subject_id&&!e.has(a.subject_id)&&e.set(a.subject_id,{id:a.subject_id,name:a.subject_name,name_ar:a.subject_name_ar})}),Array.from(e.values())});N(()=>rs.value?ls.value.filter(e=>e.subject_id===rs.value):[]);const Zl=N(()=>{const e=ss.value.length;if(0===e)return{present:0,absent:0,absentList:[]};const a=ss.value.filter(e=>bs.value[e.id]).length;return{present:a,absent:e-a,absentList:ss.value.filter(e=>!bs.value[e.id])}}),Kl=()=>{const e=Zl.value.absentList.map(e=>"ar"===Wl.value&&e.name_ar?e.name_ar:e.name).join("\n");e&&navigator.clipboard.writeText(e).then(()=>{Xl.notify({message:Ql("rewardSys.session.copied"),color:"positive",icon:"content_copy",position:"top"})}).catch(e=>{console.error("Failed to copy: ",e)})};T("https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf");const Xl=a(),es=T(ce.initialTab||"positive"),as=T("positive");P(()=>ce.initialTab,e=>{e&&(es.value=e)});const ts=T("behavior_incidents");P(es,(e,a)=>{localStorage.setItem("reward-system-active-tab",e),e!==a&&(gs.value=[])});const ls=T([]),ss=T([]),os=T([]),ns=T(null),rs=T(null),is=T((new Date).toISOString().split("T")[0]),ds=T(1),us=T(1),cs=T(1),vs=T(1),ms=T(null),ps=T(null),gs=T([]),fs=T({}),bs=T({}),ys=T({}),hs=T([]);T([]);const xs=T(!1),ws=T(!1),_s=T(!1),Ss=T(!1),ks=T(!1),$s=T(null),Is=T(null),Cs=T({message:"",created:0,skipped:0}),js=T(!1),Es=T(!1),As=T(!1),Vs=T("positive"),zs=T(null),Ts=T("no_groups"),Us=T([]),Ps=T(!1),Ds=T(null),Ns=T(!1),Fs=T(localStorage.getItem("points-display-mode")||"overall"),Ls=T({}),Rs=T(localStorage.getItem("competition-start-time")||null),qs=T(localStorage.getItem("custom-date-from")||null),Bs=T(localStorage.getItem("custom-date-to")||null),Os=T(localStorage.getItem("leaderboard-mode")||"top5"),Ms=T("individual"),Qs=T("false"!==localStorage.getItem("reward-system-read-aloud"));P(Qs,e=>{localStorage.setItem("reward-system-read-aloud",e)});const Ws=T(!1),Gs=T(null),Js=T(!1),Ys=T({name:"",type:"positive",points:0,icon:""}),Hs=T(!1),Zs=T({student:null,behavior:null,points:0}),Ks=T(!1),Xs=T(null),eo=T(null);function ao(e){"attendance"!==es.value?"selection"!==Ms.value?(gs.value=[e],function(e){if(0===gs.value.length)return void Xl.notify({message:"Please select students first",color:"warning",position:"top"});Vs.value=e,zs.value=null,As.value=!0}("positive")):Vo(e):Ro(e)}P(rs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-subject-id",e.toString()),console.log(`üíæ Saved subject to localStorage: ${e}`))}),P(ns,e=>{null!==e&&(localStorage.setItem("reward-system-selected-classroom-id",e.toString()),console.log(`üíæ Saved classroom to localStorage: ${e}`))}),P(ds,e=>{null!==e&&(localStorage.setItem("reward-system-selected-semester",e.toString()),console.log(`üíæ Saved semester to localStorage: ${e}`))}),P(us,e=>{null!==e&&(localStorage.setItem("reward-system-selected-week",e.toString()),console.log(`üíæ Saved week to localStorage: ${e}`))}),P(cs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-day",e.toString()),console.log(`üíæ Saved day to localStorage: ${e}`))}),P(vs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-period-number",e.toString()),console.log(`üíæ Saved period number to localStorage: ${e}`))}),P(is,e=>{if(e){const a=new Date(e);cs.value=a.getDay()+1,console.log(`üìÖ Date changed to ${e}, Day updated to ${cs.value}`)}});const to=N(()=>`${ds.value}.${us.value}.${cs.value}.${vs.value}`);N(()=>{const e=ls.value.find(e=>e.classroom_id===ns.value);return e?e.classroom_name:Ql("rewardSys.session.unknownClass")}),N(()=>{const e=Hl.value.find(e=>e.subject_id===rs.value);return e?"ar"===Wl.value&&e.subject_name_ar?e.subject_name_ar:e.subject_name:""});const lo=N(()=>ss.value.filter(e=>bs.value[e.id]).length),so=N(()=>ss.value.filter(e=>!bs.value[e.id]).length),oo=T(!1),no=T("present"),ro=N(()=>"all"===no.value?ss.value:"selected"===no.value?ss.value.filter(e=>gs.value.includes(e.id)):ss.value.filter(e=>"present"===no.value?bs.value[e.id]:!bs.value[e.id]));function io(e){no.value=e,oo.value=!0}function uo(){const e=ro.value.map(e=>e.name).join("\n");navigator.clipboard.writeText(e).then(()=>{})}function co(e){if(!e||!e.avatar)return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>");const a=e.avatar;return a.startsWith("http")||a.startsWith("data:")||a.startsWith("/")?a:`/${a}`}const vo=T(JSON.parse(localStorage.getItem("behaviorUsage")||"{}"));N(()=>Object.keys(vo.value).sort((e,a)=>{const t=vo.value[e],l=vo.value[a];return t.count!==l.count?l.count-t.count:l.lastUsed-t.lastUsed}).map(e=>os.value.find(a=>a.id==e)).filter(e=>e&&("positive"===e.type||"reward"===e.type||(e.value||e.points||0)>0)).slice(0,5));const mo=N(()=>{console.log("üîç All behaviors:",os.value);const e=os.value.filter(e=>{if(e.type)return"positive"===e.type||"reward"===e.type;return(e.value||e.points||0)>0});return console.log("‚úÖ Positive behaviors:",e),e}),po=N(()=>{const e=os.value.filter(e=>{if(e.type)return"negative"===e.type||"penalty"===e.type;return(e.value||e.points||0)<0});return console.log("‚ö†Ô∏è Negative behaviors:",e),e}),go=N(()=>[{label:"No Groups",value:"no_groups",icon:"grid_view"},{label:"Name (A‚ÜíZ)",value:"name_asc",icon:"sort_by_alpha"},{label:"Name (Z‚ÜíA)",value:"name_desc",icon:"sort_by_alpha"},...Us.value.map(e=>({label:e.name,value:e.id,icon:"groups"}))]);N(()=>{const e=go.value.find(e=>e.value===Ts.value);return(null==e?void 0:e.icon)||"grid_view"});const fo=T(null),bo=N(()=>{const e=new Set;return ss.value.forEach(a=>{let t=a.firstName||a.name||"";t.length>=2&&e.add(t.substring(0,2).toUpperCase())}),Array.from(e).sort()});const yo=N(()=>{let e=ss.value;if(fo.value&&(e="__SELECTED__"===fo.value?ss.value.filter(e=>gs.value.includes(e.id)):"__UNSELECTED__"===fo.value?ss.value.filter(e=>!gs.value.includes(e.id)):ss.value.filter(e=>(e.firstName||e.name||"").toUpperCase().startsWith(fo.value))),"no_groups"===Ts.value)return[{name:null,students:e}];if("name_asc"===Ts.value){return[{name:null,students:[...e].sort((e,a)=>(e.firstName||"").localeCompare(a.firstName||""))}]}if("name_desc"===Ts.value){return[{name:null,students:[...e].sort((e,a)=>(a.firstName||"").localeCompare(e.firstName||""))}]}const a=Us.value.find(e=>e.id===Ts.value);if(!a)return[{name:null,students:e}];const t=a.groups.map(a=>({name:a.name,students:e.filter(e=>a.student_ids.includes(e.id))})).filter(e=>e.students.length>0),l=new Set(a.groups.flatMap(e=>e.student_ids)),s=e.filter(e=>!l.has(e.id));return s.length>0&&t.push({name:"Unassigned",students:s}),t});function ho(){const e=ss.value.filter(e=>bs.value[e.id]);gs.value=e.map(e=>e.id)}function xo(){const e=ss.value.filter(e=>bs.value[e.id]),a=new Set(gs.value),t=[];e.forEach(e=>{a.has(e.id)||t.push(e.id)}),gs.value=t}async function wo(){if(!zs.value)return;const e=os.value.find(e=>e.id===zs.value),a="individual"===Ms.value&&1===gs.value.length,t=a?ss.value.find(e=>e.id===gs.value[0]):null;if("positive"===Vs.value?(ms.value=zs.value,await async function(){await No(ms.value),ms.value=null}()):(ps.value=zs.value,await Do()),a&&t&&e){Zs.value={student:t,behavior:e,points:e.value||e.points||0};const a=e.value||e.points||0,l=`${a} points`;setTimeout(()=>{!function(e){if(!window.speechSynthesis||!Qs.value)return;window.speechSynthesis.cancel();const a=new SpeechSynthesisUtterance(e);a.rate=1,a.pitch=1,a.volume=1,window.speechSynthesis.speak(a)}(`${function(e){const a="ar"===Wl.value&&e.name_ar?e.name_ar:e.name;if(!a)return"Student";if("ar"!==Wl.value&&e.firstName)return`${e.firstName} ${e.secondName||""}`.trim();const t=a.trim().split(/\s+/).filter(e=>e.length>0);if(t.length>0)return`${t[0]} ${t.length>1?t[1]:""}`.trim();return a}(t)}. ${l}.`)},300),Hs.value=!0,setTimeout(()=>{Hs.value=!1},2500)}As.value=!1,zs.value=null}const _o=T(null);let So=null;function ko(e){So&&clearTimeout(So),_o.value=e}function $o(){So&&clearTimeout(So),So=setTimeout(()=>{_o.value=null},3e3)}async function Io(e){var a,t;const l=Us.value.findIndex(a=>a.id===e.id);l>=0?Us.value[l]=e:Us.value.push(e);try{const a=await z.post("/api/classroom-layouts/save",{classroom_id:ns.value,layouts:Us.value});if(!a.data.success)throw new Error(a.data.message||"Failed to save layout");Xl.notify({message:`Layout "${e.name}" saved successfully!`,color:"positive",position:"top",icon:"check_circle"}),Ts.value=e.id,Ps.value=!1,Ds.value=null}catch(s){if(console.error("Error saving layout:",s),Xl.notify({message:"Failed to save layout: "+((null==(t=null==(a=s.response)?void 0:a.data)?void 0:t.message)||s.message),color:"negative",position:"top",icon:"error"}),l>=0)Us.value.splice(l,1);else{const a=Us.value.findIndex(a=>a.id===e.id);a>=0&&Us.value.splice(a,1)}}}async function Co(e){var a,t;const l=Us.value.findIndex(a=>a.id===e);if(l<0)return;const s=Us.value[l];Us.value.splice(l,1),Ts.value===e&&(Ts.value="no_groups");try{const e=await z.post("/api/classroom-layouts/save",{classroom_id:ns.value,layouts:Us.value});if(!e.data.success)throw new Error(e.data.message||"Failed to delete layout");Xl.notify({message:`Layout "${s.name}" deleted successfully!`,color:"positive",position:"top",icon:"delete"})}catch(o){console.error("Error deleting layout:",o),Xl.notify({message:"Failed to delete layout: "+((null==(t=null==(a=o.response)?void 0:a.data)?void 0:t.message)||o.message),color:"negative",position:"top",icon:"error"}),Us.value.splice(l,0,s),"no_groups"===Ts.value&&(Ts.value=e)}}function jo(e){e?(Gs.value=e,Ys.value={name:e.name,type:e.type||(e.value>0?"positive":"negative"),points:e.value||e.points||0,icon:e.icon||""}):(Gs.value=null,Ys.value={name:"",type:"positive",points:0,icon:""}),Ws.value=!0}async function Eo(){var e,a;if(Ys.value.name&&Ys.value.type&&null!==Ys.value.points){Js.value=!0;try{const e={name:Ys.value.name,name_ar:Ys.value.name_ar||null,type:Ys.value.type,value:Ys.value.points,points:Ys.value.points,icon:Ys.value.icon||null,school_id:1,year_id:2};if(Gs.value){const a=await z.put(`/api/behaviors/${Gs.value.id}`,e),t=os.value.findIndex(e=>e.id===Gs.value.id);t>=0&&(os.value[t]=a.data),Xl.notify({message:"Behavior updated successfully!",color:"positive",icon:"check_circle"})}else{const a=await z.post("/api/behaviors",e);os.value.push(a.data),Xl.notify({message:"Behavior created successfully!",color:"positive",icon:"check_circle"})}Ws.value=!1,Gs.value=null}catch(t){console.error("Error saving behavior:",t),Xl.notify({message:"Failed to save behavior: "+((null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||t.message),color:"negative",icon:"error"})}finally{Js.value=!1}}else Xl.notify({message:"Please fill in all required fields",color:"warning",position:"top"})}function Ao(e){Xl.dialog({title:"Confirm Delete",message:`Are you sure you want to delete "${e.name}"? This action cannot be undone.`,cancel:!0,persistent:!0,color:"negative"}).onOk(()=>{!async function(e){var a,t;try{await z.delete(`/api/behaviors/${e.id}`);const a=os.value.findIndex(a=>a.id===e.id);a>=0&&os.value.splice(a,1),Xl.notify({message:"Behavior deleted successfully!",color:"positive",icon:"check_circle"})}catch(l){console.error("Error deleting behavior:",l),Xl.notify({message:"Failed to delete behavior: "+((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||l.message),color:"negative",icon:"error"})}}(e)})}function Vo(e){if(!bs.value[e])return void Xl.notify({message:"Cannot select absent students",color:"warning",position:"top",timeout:1e3});const a=gs.value.indexOf(e);-1===a?(gs.value.push(e),Ml("select")):gs.value.splice(a,1)}function zo(e,a){if(a){const a=e.filter(e=>bs.value[e.id]).map(e=>e.id),t=new Set(gs.value);a.forEach(e=>t.add(e)),gs.value=Array.from(t),Ml("select")}else{const a=new Set(e.map(e=>e.id));gs.value=gs.value.filter(e=>!a.has(e))}}function To(){gs.value=[]}async function Uo(e){if(!e)return ss.value=[],gs.value=[],void(Us.value=[]);try{ws.value=!0,ss.value=[],gs.value=[],Is.value=null,Cs.value={message:"",created:0,skipped:0},await async function(){if(ns.value)try{const e=await z.get("/api/classroom-layouts/load",{params:{classroom_id:ns.value}});e.data.success&&(Us.value=e.data.data||[])}catch(e){console.error("Error loading layouts:",e)}}()}catch(a){console.error("Failed to load classroom:",a),Xl.notify({message:"Failed to load classroom: "+a.message,color:"negative",position:"top"})}finally{ws.value=!1}}async function Po(){if(ns.value){ws.value=!0,Cs.value={message:"Initializing...",created:0,skipped:0};try{const e={classroom_id:ns.value,date:is.value,period_code:to.value,points_mode:"from_now"===Fs.value?"overall":Fs.value},a=await z.post("/api/student-behaviors/init-classroom",e);if(a&&a.data){const e=a.data;Is.value=e.student_behaviors_mains_id,Cs.value={message:`Session initialized (created ${e.created}, skipped ${e.skipped}, mode: ${e.points_mode})`,created:e.created,skipped:e.skipped};const t=e.student_behaviors||[],l=t.map(e=>e.student?{id:e.student.id,name:e.student.name||`Student ${e.student_id}`,name_ar:e.student.name_ar,firstName:e.student.first_name,secondName:e.student.second_name,lastName:e.student.last_name,avatar:e.student.avatar,behaviorRecordId:e.id}:null).filter(e=>null!==e);ss.value=l,gs.value=[];const s={};for(const a of t)bs.value[a.student_id]=void 0===a.attend||a.attend,s[a.student_id]={attend:void 0===a.attend||a.attend,points_plus:a.points_plus||0,points_minus:a.points_minus||0,academic_tracker:a.academic_tracker||{},behavior_tracker:a.behavior_tracker||[],logistics_tracker:a.logistics_tracker||{}};fs.value=s,Xl.notify({message:"Session initialized",color:"positive",position:"top"}),await Mo()}}catch(e){console.error("Failed to init classroom session:",e),Cs.value={message:"Initialization failed",created:0,skipped:0},Xl.notify({message:"Failed to init session: "+(e.message||"error"),color:"negative",position:"top"})}finally{ws.value=!1}}}async function Do(){await No(ps.value),ps.value=null}async function No(e){var a;if(gs.value.length&&e)try{_s.value=!0;const t=await be.applyBehaviorToStudents(gs.value,e,{date:is.value,periodCode:to.value,classroomId:ns.value,points_mode:"from_now"===Fs.value?"overall":Fs.value});if(t.results&&t.results.length>0){t.results.forEach(e=>{if(e.success&&e.data){const a=e.studentId,t=e.data;fs.value[a]||(fs.value[a]={points_plus:0,points_minus:0,attend:!0}),fs.value[a]&&(fs.value[a].points_plus=t.points_plus,fs.value[a].points_minus=t.points_minus,void 0!==t.attend&&(fs.value[a].attend=t.attend,bs.value[a]=t.attend))}});const a=os.value.find(a=>a.id===e);if(a){const e=a.value||a.points||0;e>0&&Ml("reward"),e<0&&Ml("penalty")}"individual"===Ms.value&&1===t.results.length||Xl.notify({message:`Applied behavior to ${t.results.length} students`+(t.errors&&t.errors.length?` (${t.errors.length} failed)`:""),color:t.errors&&t.errors.length?"warning":"positive",position:"top"}),await Mo(),gs.value=[]}if(t.errors&&t.errors.length>0)console.error("Partial or full failure:",t.errors),0===t.results.length&&Xl.notify({message:t.error||"Failed to apply behavior to selected students",color:"negative",position:"top"});else{const e=t.results.length;if(e>0&&hs.value.length>0){const l=hs.value.slice(0,e).map(e=>({actionId:e.id,studentId:e.student_id,offline:!1})),s=t.results.filter(e=>e.offline).map(e=>{var a;return{actionId:(null==(a=e.data)?void 0:a.id)||"temp_"+Date.now(),studentId:e.studentId,offline:!0}}),o=s.length>0?s:l;o.length>0&&(a={type:"point_action",actions:o,desc:1===e?"Last Action":`Group Action (${e})`},Fo.value.push(a),Fo.value.length>10&&Fo.value.shift())}}}catch(t){console.error("Error applying behavior:",t),Xl.notify({message:t.message||"Error applying behavior",color:"negative",position:"top"})}finally{_s.value=!1}}P(Fs,e=>{if("from_now"===e){const e={};for(const[a,t]of Object.entries(fs.value))e[a]={plus:t.points_plus||0,minus:t.points_minus||0};Ls.value=e}else Po()});const Fo=T([]);async function Lo(){if(0===Fo.value.length)return;const e=Fo.value.pop();Xl.loading.show({message:"Undoing..."});try{let a=0;for(const t of e.actions){(await be.undoAction(t.actionId)).success&&a++}a>0?(Xl.notify({message:"Undone successfully",color:"positive",icon:"undo",position:"top"}),Mo(),Po()):Xl.notify({message:"Failed to undo action",color:"warning",position:"top"})}catch(a){console.error("Undo failed",a),Xl.notify({message:"Undo failed",color:"negative",position:"top"})}finally{Xl.loading.hide()}}async function Ro(e,a){const t=void 0===bs.value[e]||bs.value[e],l=!t;if(!1===l){const a=fs.value[e];if(a&&(a.points_plus>0||a.points_minus>0))return void Xl.dialog({title:"Warning",message:`This student has ${a.points_plus} positive and ${a.points_minus} negative points for this session. Marking them absent will remove all their points for this session. Continue?`,cancel:!0,persistent:!0,ok:{label:"Yes, Mark Absent",color:"negative"},cancel:{label:"Cancel",color:"grey"}}).onOk(async()=>{await qo(e,l,t)})}await qo(e,l,t)}async function qo(e,a,t){bs.value[e]=a,ys.value[e]=!0,Ml("select");try{const t=await be.updateAttendance(e,a,{date:is.value,periodCode:to.value,classroomId:ns.value});if(!t.success)throw new Error(t.error||"Failed to update attendance");Xl.notify({message:t.message||"Attendance updated",color:"positive",position:"top"}),!1===a&&await Po()}catch(l){console.error("Failed to persist attendance for",e,l),bs.value[e]=t,Xl.notify({message:"Failed to update attendance. Reverted.",color:"negative",position:"top"})}finally{ys.value[e]=!1}}async function Bo(){Ss.value=!0;const e={};for(const t of ss.value)e[t.id]=!0,bs.value[t.id]=!0;try{(await be.batchUpdateAttendance(e,{date:is.value,periodCode:to.value,classroomId:ns.value})).success&&Xl.notify({message:"All students marked present",color:"positive",position:"top"})}catch(a){console.error("Failed to mark all present:",a),Xl.notify({message:"Failed to mark all present",color:"negative",position:"top"})}finally{Ss.value=!1}}async function Oo(){Ss.value=!0;const e={};for(const t of ss.value)e[t.id]=!1,bs.value[t.id]=!1;try{(await be.batchUpdateAttendance(e,{date:is.value,periodCode:to.value,classroomId:ns.value})).success&&Xl.notify({message:"All students marked absent",color:"warning",position:"top"})}catch(a){console.error("Failed to mark all absent:",a),Xl.notify({message:"Failed to mark all absent",color:"negative",position:"top"})}finally{Ss.value=!1}}async function Mo(){ks.value=!0;try{const e=await be.getRecentActions({classroomId:ns.value,date:is.value,limit:10});e.success?hs.value=e.data:console.error("Failed to load history:",e.error)}catch(e){console.error("Error loading history:",e)}finally{ks.value=!1}}function Qo(e){if(!e)return"";return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Wo(){localStorage.setItem("points-display-mode",Fs.value),Rs.value?localStorage.setItem("competition-start-time",Rs.value):localStorage.removeItem("competition-start-time"),qs.value&&localStorage.setItem("custom-date-from",qs.value),Bs.value&&localStorage.setItem("custom-date-to",Bs.value),localStorage.setItem("leaderboard-mode",Os.value),Ns.value=!1,ns.value&&Po(),Xl.notify({message:"Points display settings applied",color:"positive",position:"top",icon:"check_circle"})}function Go(){Fs.value="overall",Rs.value=null,qs.value=null,Bs.value=null,Os.value="top5",localStorage.removeItem("points-display-mode"),localStorage.removeItem("competition-start-time"),localStorage.removeItem("custom-date-from"),localStorage.removeItem("custom-date-to"),localStorage.removeItem("leaderboard-mode"),Ns.value=!1,ns.value&&Po(),Xl.notify({message:"Reset to normal view",color:"info",position:"top"})}async function Jo(e){console.log("Incident recorded:",e),await Po(),Xl.notify({message:"Behavior incident recorded (-1 point)",color:"warning",position:"top"})}return U(async()=>{var e,a;if(js.value)console.log("‚è≠Ô∏è Skipping re-initialization - component already initialized");else try{console.log("üöÄ Initializing reward system...");const l=await z.get("/my_classes_with_students");ls.value=l.data,console.log(`‚úÖ Loaded ${ls.value.length} classrooms`);let s=!1;if(ce.classroomId&&ce.subjectId){console.log("üéØ Props detected (dialog mode) - auto-initializing..."),ns.value=ce.classroomId,rs.value=ce.subjectId;try{const t=null==(a=null==(e=D().props.auth)?void 0:e.school)?void 0:a.active_semester_id;t?(ds.value=parseInt(t),console.log(`üè´ Active Semester from Inertia: ${ds.value}`)):ds.value=1}catch(t){console.warn("Could not fetch active semester, defaulting to 1",t),ds.value=1}ce.date?is.value=ce.date:is.value=(new Date).toISOString().split("T")[0];const l=new Date(is.value);cs.value=l.getDay()+1,ce.period&&(vs.value=ce.period),ce.week&&(us.value=ce.week,console.log(`üìÖ Props Week: ${ce.week}`)),s=!0,console.log(`üìö Props Subject: ${ce.subjectId}`),console.log(`üè´ Props Classroom: ${ce.classroomId}`),console.log(`üìÖ Props Date: ${is.value}`),console.log(`‚ö° Calc Day: ${cs.value}`),console.log(`üî¢ Props Period: ${ce.period}`)}else{const e=new URLSearchParams(window.location.search),a=e.get("classroom_id"),t=e.get("subject_id"),l=e.get("period"),o=e.get("date");if(a&&t)console.log("üîó URL parameters detected - auto-initializing..."),ns.value=parseInt(a),rs.value=parseInt(t),is.value=o||(new Date).toISOString().split("T")[0],l&&(vs.value=parseInt(l)),s=!0,console.log(`üìö URL Subject: ${t}`),console.log(`üè´ URL Classroom: ${a}`),console.log(`üìÖ URL Date: ${is.value}`),console.log(`üî¢ URL Period: ${l}`);else{const e=localStorage.getItem("reward-system-selected-subject-id"),a=localStorage.getItem("reward-system-selected-classroom-id");e&&Hl.value.some(a=>a.id===parseInt(e))?(rs.value=parseInt(e),console.log(`üìö Restored subject from localStorage: ${e}`)):Hl.value.length>0&&(rs.value=Hl.value[0].id,console.log(`üìö Auto-selected first subject: ${Hl.value[0].name}`)),a&&ls.value.some(e=>e.classroom_id===parseInt(a))&&(ns.value=parseInt(a),console.log(`üè´ Restored classroom from localStorage: ${a}`));const t=localStorage.getItem("reward-system-active-tab");t&&(es.value=t);const l=localStorage.getItem("reward-system-selected-semester"),s=localStorage.getItem("reward-system-selected-week"),o=localStorage.getItem("reward-system-selected-day"),n=localStorage.getItem("reward-system-selected-period-number");l&&(ds.value=parseInt(l),console.log(`üìÖ Restored semester from localStorage: ${l}`)),s&&(us.value=parseInt(s),console.log(`üìÖ Restored week from localStorage: ${s}`)),o&&(cs.value=parseInt(o),console.log(`üìÖ Restored day from localStorage: ${o}`)),n&&(vs.value=parseInt(n),console.log(`üìÖ Restored period number from localStorage: ${n}`))}}console.log(`üî¢ Active Period Code: ${ds.value}.${us.value}.${cs.value}.${vs.value}`);const o=await be.fetchBehaviors();o.success?(os.value=o.data,console.log(`‚úÖ Loaded ${os.value.length} behaviors`),console.log("üìã Behaviors data:",os.value),os.value=os.value.map(e=>({...e,value:e.value||e.points||0})),console.log("üìã Normalized behaviors:",os.value)):(console.error("‚ùå Failed to load behaviors:",o.error),Xl.notify({message:"Failed to load behaviors: "+o.error,color:"negative",position:"top"})),console.log("‚úÖ Reward system initialized"),js.value=!0,s&&ns.value&&(console.log("üöÄ Auto-initializing classroom session..."),await Uo(ns.value),await Po(),function(e,a=3e3){Xs.value=e,eo.value&&clearTimeout(eo.value),eo.value=setTimeout(()=>{Xs.value=null},a)}(ce.isDialog?"Session loaded!":"Session loaded from schedule!",3e3))}catch(l){console.error("‚ùå Failed to initialize reward system:",l),Xl.notify({message:"Failed to initialize reward system: "+l.message,color:"negative",position:"top"})}}),(a,h)=>{const V=F("Head");return R(),L(H,null,[q(V,{title:"Reward System"}),B("div",xe,[h[93]||(h[93]=B("div",{class:"p-1 scale-25"},null,-1)),e.isDialog?M("",!0):(R(),O(r,{key:0,class:"shadow-lg rounded-2xl overflow-hidden"},{default:Q(()=>[q(t,{class:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white flex justify-between items-center"},{default:Q(()=>[B("div",null,[B("h1",we,"üèÜ "+W(a.$t("rewardSys.behaviors.management")),1),B("p",_e,W(a.$t("rewardSys.behaviors.management")),1)]),q(S,{modelValue:G(Wl),"onUpdate:modelValue":h[0]||(h[0]=e=>J(Wl)?Wl.value=e:null),options:[{label:"üá¨üáß English",value:"en"},{label:"üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",value:"ar"}],flat:"",color:"white","text-color":"white","toggle-color":"white","toggle-text-color":"primary",unelevated:""},null,8,["modelValue"])]),_:1}),q(t,{class:"p-6 space-y-4"},{default:Q(()=>{var e;return[B("div",Se,[B("div",ke,[B("div",$e,[q(l,{name:"event_note",size:"md"})]),B("div",null,[B("div",Ie,W(a.$t("rewardSys.session.current")),1),B("div",Ce,[ns.value?(R(),L("span",je,W((null==(e=ls.value.find(e=>e.classroom_id===ns.value))?void 0:e.classroom_name)||a.$t("rewardSys.session.unknownClass")),1)):(R(),L("span",Ee,W(a.$t("rewardSys.session.noClassroom")),1)),h[59]||(h[59]=B("span",{class:"text-gray-300"},"|",-1)),B("span",Ae,W(to.value),1)]),B("div",Ve,W(new Date(is.value).toLocaleDateString())+" ‚Ä¢ Period "+W(vs.value),1)])])]),ns.value?(R(),L("div",ze,[B("div",Te,[B("div",Ue,[q(l,{name:"groups",class:"text-blue-600",size:"sm"}),B("span",Pe,W(a.$t("rewardSys.session.classroomSummary")),1)]),B("div",De,[q(s,{modelValue:Es.value,"onUpdate:modelValue":h[1]||(h[1]=e=>Es.value=e),icon:"edit",label:"Edit Avatars",dense:"",color:"secondary",size:"sm",class:"bg-white px-2 py-1 rounded-lg border border-gray-200"},null,8,["modelValue"]),Cs.value.message?(R(),L("div",Ne,W(Cs.value.message)+" ("+W(Cs.value.created)+") ",1)):M("",!0),B("div",Fe,[q(l,{name:"people",class:"text-blue-600",size:"sm"}),B("div",Le,[B("span",Re,W(a.$t("rewardSys.session.total")),1),B("span",qe,W(ss.value.length),1)])]),B("div",Be,[q(l,{name:"check_circle",class:"text-green-600",size:"sm"}),B("div",Oe,[B("span",Me,W(a.$t("rewardSys.session.present")),1),B("span",Qe,W(Zl.value.present),1)])]),B("div",We,[q(l,{name:"cancel",class:"text-red-600",size:"sm"}),B("div",Ge,[B("span",Je,W(a.$t("rewardSys.session.absent")),1),B("span",Ye,W(Zl.value.absent),1)])]),q(o,{dense:"",color:"primary",icon:"content_copy",label:a.$t("rewardSys.session.copyList"),onClick:Kl,disable:0===Zl.value.absent,size:"sm",class:"shadow-sm"},{default:Q(()=>[q(n,null,{default:Q(()=>[Y(W(a.$t("rewardSys.session.copyToClipboard")),1)]),_:1})]),_:1},8,["label","disable"])])]),Zl.value.absent>0?(R(),L("div",He,[B("div",Ze,[q(l,{name:"person_off",size:"xs",color:"red"}),B("span",null,W(a.$t("rewardSys.session.absentStudentsList")),1),q(k,{color:"red",label:Zl.value.absent,class:"ml-1"},null,8,["label"])]),B("div",Ke,[B("div",Xe,[(R(!0),L(H,null,Z(Zl.value.absentList,e=>(R(),O(x,{key:e.id,color:"red","text-color":"white",size:"sm",dense:"",icon:"person"},{default:Q(()=>[Y(W("ar"===G(Wl)&&e.name_ar?e.name_ar:e.name),1)]),_:2},1024))),128))])])])):M("",!0)])):M("",!0)]}),_:1})]),_:1})),B("audio",{ref_key:"bgMusic",ref:fe,loop:"",id:"bg-music"},h[60]||(h[60]=[B("source",{src:"/audio/background_music2.mp3",type:"audio/mpeg"},null,-1)]),512),ss.value.length?(R(),O(r,{key:1,class:"shadow-lg rounded-2xl"},{default:Q(()=>{var e,b,y,S,V,z,T,U,P,D,N;return[B("div",ea,[B("div",aa,[B("div",ta,[q(v,{color:"primary",icon:"menu",label:G(Xl).screen.gt.xs?"Menu":"",class:"shadow-sm glossy","content-class":"bg-white",dense:""},{default:Q(()=>[B("div",la,[B("div",{class:"column",style:K(G(Xl).screen.lt.sm?"min-width: 250px":"min-width: 220px")},[h[69]||(h[69]=B("div",{class:"text-subtitle1 text-weight-bold q-mb-sm text-grey-8"},"Navigation",-1)),q(i,{dense:""},{default:Q(()=>[X((R(),O(d,{clickable:"",onClick:h[2]||(h[2]=e=>es.value="positive"),active:"positive"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"add_circle"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.positivePoints")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[3]||(h[3]=e=>es.value="attendance"),active:"attendance"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"how_to_reg"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.attendance")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[4]||(h[4]=e=>es.value="history"),active:"history"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"cancel"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.history")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[5]||(h[5]=e=>es.value="classroom_helper"),active:"classroom_helper"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"assignment"})]),_:1}),q(u,null,{default:Q(()=>h[61]||(h[61]=[Y("Classroom Helper")])),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[6]||(h[6]=e=>es.value="timer_random"),active:"timer_random"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"timer"})]),_:1}),q(u,null,{default:Q(()=>h[62]||(h[62]=[Y("Timer & Random")])),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[7]||(h[7]=e=>{xs.value=!0,es.value="champions"}),active:"champions"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"emoji_events"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.champions")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[8]||(h[8]=e=>es.value="settings_reports"),active:"settings_reports"===es.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"settings_applications"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.settingsReports")),1)]),_:1})]),_:1},8,["active"])),[[w]])]),_:1}),q(c,{class:"q-my-md"}),h[70]||(h[70]=B("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Points Filter",-1)),q(i,{dense:""},{default:Q(()=>[X((R(),O(d,{clickable:"",onClick:h[9]||(h[9]=e=>Fs.value="overall"),active:"overall"===Fs.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"functions",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[63]||(h[63]=[Y("Overall (All Time)")])),_:1}),"overall"===Fs.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[10]||(h[10]=e=>Fs.value="all_subjects"),active:"all_subjects"===Fs.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"public",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[64]||(h[64]=[Y("Overall (All Subjects)")])),_:1}),"all_subjects"===Fs.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[11]||(h[11]=e=>Fs.value="session"),active:"session"===Fs.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"timer",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[65]||(h[65]=[Y("This Session")])),_:1}),"session"===Fs.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[12]||(h[12]=e=>Fs.value="competition"),active:"competition"===Fs.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"date_range",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[66]||(h[66]=[Y("Competition (Week)")])),_:1}),"competition"===Fs.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[13]||(h[13]=e=>Fs.value="from_now"),active:"from_now"===Fs.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"restart_alt",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[67]||(h[67]=[Y("From Now (Reset View)")])),_:1}),"from_now"===Fs.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]])]),_:1}),q(c,{class:"q-my-md"}),h[71]||(h[71]=B("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Layout",-1)),q(i,{dense:""},{default:Q(()=>[(R(!0),L(H,null,Z(go.value,e=>X((R(),O(d,{clickable:"",key:e.value,onClick:a=>Ts.value=e.value,active:Ts.value===e.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:e.icon,size:"xs"},null,8,["name"])]),_:2},1024),q(u,null,{default:Q(()=>[Y(W(e.label),1)]),_:2},1024),Ts.value===e.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:2},1032,["onClick","active"])),[[w]])),128)),q(c,{class:"q-my-xs"}),X((R(),O(d,{clickable:"",onClick:h[14]||(h[14]=e=>Ps.value=!0)},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"settings",size:"xs",class:"text-grey-7"})]),_:1}),q(u,{class:"text-grey-8"},{default:Q(()=>[Y(W(a.$t("rewardSys.manageGroups")),1)]),_:1})]),_:1})),[[w]])]),_:1}),G(Xl).screen.lt.sm?(R(),L("div",sa,[q(c,{class:"q-my-md"}),h[68]||(h[68]=B("div",{class:"text-subtitle1 text-weight-bold q-mb-md text-grey-8"},"Settings",-1)),q(s,{modelValue:Ol.value,"onUpdate:modelValue":h[15]||(h[15]=e=>Ol.value=e),"checked-icon":"music_note","unchecked-icon":"music_off",label:"Music On",color:"primary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Es.value,"onUpdate:modelValue":h[16]||(h[16]=e=>Es.value=e),icon:"edit",label:"Edit Avatars",color:"secondary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Qs.value,"onUpdate:modelValue":h[17]||(h[17]=e=>Qs.value=e),icon:"volume_up",label:"Read Aloud",color:"purple",dense:""},null,8,["modelValue"])])):M("",!0)],4),G(Xl).screen.gt.xs?(R(),O(c,{key:0,vertical:"",inset:"",class:"q-mx-lg"})):M("",!0),G(Xl).screen.gt.xs?(R(),L("div",oa,[h[72]||(h[72]=B("div",{class:"text-subtitle1 text-weight-bold q-mb-md text-grey-8"},"Settings",-1)),B("div",na,[q(s,{modelValue:Ol.value,"onUpdate:modelValue":h[18]||(h[18]=e=>Ol.value=e),"checked-icon":"music_note","unchecked-icon":"music_off",label:"Music On",color:"primary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Es.value,"onUpdate:modelValue":h[19]||(h[19]=e=>Es.value=e),icon:"edit",label:"Edit Avatars",color:"secondary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Qs.value,"onUpdate:modelValue":h[20]||(h[20]=e=>Qs.value=e),icon:"volume_up",label:"Read Aloud",color:"purple",dense:""},null,8,["modelValue"])]),q(c,{class:"q-my-md full-width"}),B("div",ra,[q(ue,{class:"scale-90 transform-origin-center"})])])):M("",!0)])]),_:1},8,["label"]),B("div",ia,[q(o,{rounded:"",dense:"","no-caps":"",color:"grey-3","text-color":"grey-9",class:"px-2 shadow-sm text-xs border border-gray-300",onClick:h[21]||(h[21]=e=>io("all"))},{default:Q(()=>[q(l,{name:"groups",size:"xs",class:"mr-1"}),B("span",da,W(ss.value.length),1)]),_:1}),q(o,{rounded:"",dense:"","no-caps":"",color:"positive",class:"px-2 shadow-sm text-xs",onClick:h[22]||(h[22]=e=>io("present"))},{default:Q(()=>[q(l,{name:"how_to_reg",class:"mr-1",size:"xs"}),B("span",ua,W(lo.value),1)]),_:1}),q(o,{rounded:"",dense:"","no-caps":"",color:"negative",class:"px-2 shadow-sm text-xs",onClick:h[23]||(h[23]=e=>io("absent"))},{default:Q(()=>[q(l,{name:"person_off",class:"mr-1",size:"xs"}),B("span",ca,W(so.value),1)]),_:1})]),"positive"!==es.value||G(Xl).screen.gt.xs?(R(),L("div",va,[q(k,{color:"blue-1","text-color":"blue-9",class:"q-py-xs q-px-sm text-subtitle2 whitespace-nowrap"},{default:Q(()=>[Y(W("positive"===es.value?a.$t("rewardSys.tabs.positivePoints"):"attendance"===es.value?a.$t("rewardSys.tabs.attendance"):"history"===es.value?a.$t("rewardSys.tabs.history"):"champions"===es.value?a.$t("rewardSys.tabs.champions"):"classroom_helper"===es.value?"Classroom Helper":"timer_random"===es.value?"Timer & Random":a.$t("rewardSys.tabs.settingsReports")),1)]),_:1})])):M("",!0),B("div",ma,[_o.value||0!==gs.value.length?(R(),L("div",ga,[_o.value||gs.value.length>0&&ss.value.find(e=>e.id===gs.value[gs.value.length-1])?(R(),L(H,{key:0},[q(m,{size:"24px"},{default:Q(()=>{var e;return[B("img",{src:(null==(e=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:e.avatar)||"data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>"),onError:h[24]||(h[24]=e=>{e.target.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>")})},null,40,fa)]}),_:1}),B("div",ba,[B("span",ya,W(null==(e=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:e.name),1),(null==(b=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:b.name_ar)?(R(),L("span",ha,W(null==(y=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:y.name_ar),1)):M("",!0)]),h[74]||(h[74]=B("div",{class:"h-4 w-px bg-gray-300 mx-1 flex-shrink-0"},null,-1)),B("div",{class:ee(["bg-white px-2 py-0.5 rounded text-xs font-mono font-bold border border-gray-200 flex-shrink-0",((null==(V=fs.value[null==(S=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:S.id])?void 0:V.points_plus)||0)-((null==(T=fs.value[null==(z=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:z.id])?void 0:T.points_minus)||0)>=0?"text-green-700":"text-red-700"])},W(((null==(P=fs.value[null==(U=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:U.id])?void 0:P.points_plus)||0)-((null==(N=fs.value[null==(D=_o.value||ss.value.find(e=>e.id===gs.value[gs.value.length-1]))?void 0:D.id])?void 0:N.points_minus)||0))+" Pts ",3)],64)):M("",!0)])):(R(),L("div",pa,[q(l,{name:"touch_app",size:"xs",class:"mr-1"}),h[73]||(h[73]=Y(" mouse on or active card "))]))])]),B("div",xa,[q(v,{color:"primary",icon:"stars",label:G(Xl).screen.gt.xs?"Give Feedback":"",disable:0===gs.value.length,class:"shadow-sm glossy","content-class":"rounded-xl",dense:""},{default:Q(()=>[B("div",wa,[gs.value.length>0?(R(),L("div",_a,[B("div",Sa,[B("span",null,"Giving to "+W(gs.value.length)+" student"+W(gs.value.length>1?"s":"")+":",1),B("span",{class:"text-gray-500 cursor-pointer hover:text-blue-700",onClick:To},"Clear")]),B("div",ka,[(R(!0),L(H,null,Z(gs.value,e=>(R(),O(x,{key:e,dense:"",removable:"",onRemove:a=>Vo(e),onMouseenter:a=>ko(ss.value.find(a=>a.id===e)),onMouseleave:$o,color:"white","text-color":"primary",class:"shadow-sm border border-blue-100 text-xs m-0"},{default:Q(()=>{var a;return[q(m,{size:"16px"},{default:Q(()=>[B("img",{src:co(ss.value.find(a=>a.id===e))},null,8,$a)]),_:2},1024),B("span",Ia,W(null==(a=ss.value.find(a=>a.id===e))?void 0:a.firstName),1)]}),_:2},1032,["onRemove","onMouseenter"]))),128))])])):M("",!0),q(I,{modelValue:as.value,"onUpdate:modelValue":h[25]||(h[25]=e=>as.value=e),class:"text-grey-7 bg-grey-1","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":"",dense:""},{default:Q(()=>[q($,{name:"positive",icon:"thumb_up",label:"Positive",class:"text-weight-bold"}),q($,{name:"needs_work",icon:"warning",label:"Needs Work",class:"text-weight-bold"})]),_:1},8,["modelValue"]),q(c),q(j,{modelValue:as.value,"onUpdate:modelValue":h[26]||(h[26]=e=>as.value=e),animated:"",class:"bg-white",style:{"max-height":"400px","overflow-y":"auto"}},{default:Q(()=>[q(C,{name:"positive",class:"q-pa-md"},{default:Q(()=>[B("div",Ca,[(R(!0),L(H,null,Z(mo.value,e=>(R(),L("div",{class:"col-3 cursor-pointer",key:e.id,onClick:a=>No(e.id)},[X((R(),L("div",Ea,[q(l,{name:e.icon||"star",size:"1.2em",class:"q-mb-xs text-orange-400"},null,8,["name"]),B("div",Aa,W(e.name),1),B("div",Va,[B("span",za,"+"+W(e.points||e.value),1)])])),[[w]])],8,ja))),128))])]),_:1}),q(C,{name:"needs_work",class:"q-pa-md"},{default:Q(()=>[B("div",Ta,[(R(!0),L(H,null,Z(po.value,e=>(R(),L("div",{class:"col-4 cursor-pointer",key:e.id,onClick:a=>No(e.id)},[X((R(),L("div",Pa,[q(l,{name:e.icon||"warning",size:"2em",class:"q-mb-xs text-red"},null,8,["name"]),B("div",Da,W(e.name),1),B("div",Na,[q(k,{color:"red-1","text-color":"red-9",class:"text-xs font-bold border border-red-200 shadow-sm rounded-full px-1.5"},{default:Q(()=>[Y(W(e.points||e.value),1)]),_:2},1024)])])),[[w]])],8,Ua))),128))])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["label","disable"])])])]),"positive"===es.value&&"session"!==Fs.value?(R(),L("div",Fa," Viewing: "+W("overall"===Fs.value?"Overall (All Time)":"all_subjects"===Fs.value?"Overall (All Subjects)":"from_now"===Fs.value?"From Now (Temporary)":"Competition (Week)"),1)):M("",!0),q(c),q(j,{modelValue:es.value,"onUpdate:modelValue":h[38]||(h[38]=e=>es.value=e),animated:""},{default:Q(()=>[q(C,{name:"attendance"},{default:Q(()=>[B("div",La,[B("div",Ra,[B("h3",qa,W(a.$t("rewardSys.attendance.manage")),1),B("div",Ba,[q(o,{color:"positive",label:a.$t("rewardSys.attendance.markAllPresent"),onClick:Bo,loading:Ss.value},null,8,["label","loading"]),q(o,{color:"warning",label:a.$t("rewardSys.attendance.markAllAbsent"),onClick:Oo,loading:Ss.value},null,8,["label","loading"])])]),B("div",Oa,[(R(!0),L(H,null,Z(ss.value,e=>{var a,t,l,s;return R(),O(de,{key:e.id,student:e,"disable-behavior":!bs.value[e.id],"allow-disabled-click":!0,"avatar-edit-enabled":Es.value,"student-summary":{positive:((null==(a=fs.value[e.id])?void 0:a.points_plus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].plus:0),negative:((null==(t=fs.value[e.id])?void 0:t.points_minus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].minus:0),total:((null==(l=fs.value[e.id])?void 0:l.points_plus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].plus:0)-(((null==(s=fs.value[e.id])?void 0:s.points_minus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].minus:0))},onSelect:a=>Ro(e.id),onPreview:ko,onLeave:$o},null,8,["student","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))])])]),_:1}),q(C,{name:"classroom_helper"},{default:Q(()=>[q(ie,{students:ss.value,"student-behaviors":fs.value,"student-attendance":bs.value,"period-info":{date:is.value,periodCode:to.value,classroomId:ns.value}},null,8,["students","student-behaviors","student-attendance","period-info"])]),_:1}),q(C,{name:"timer_random"},{default:Q(()=>[q(re,{students:ss.value},null,8,["students"])]),_:1}),q(C,{name:"positive"},{default:Q(()=>[B("div",Ma,[B("div",Qa,[(R(),O(ae,{to:"#dialog-header-actions"},[B("div",Wa,[q(v,{split:"",color:gs.value.length>0?"blue-6":"blue-1","text-color":gs.value.length>0?"white":"primary",icon:"checklist",label:gs.value.length>0?a.$t("rewardSys.selected")+": "+gs.value.length:"Select",dense:"",rounded:"",unelevated:"",class:"mr-2 transition-all duration-300","content-style":"border-radius: 12px",onClick:h[28]||(h[28]=e=>gs.value.length>0?io("selected"):ho())},{default:Q(()=>[q(i,{dense:"",style:{"min-width":"180px"}},{default:Q(()=>[X((R(),O(d,{clickable:"",onClick:h[27]||(h[27]=e=>io("selected"))},{default:Q(()=>[q(u,null,{default:Q(()=>[q(p,{header:"",class:"text-xs text-uppercase text-gray-500 font-bold bg-gray-50 border-b cursor-pointer hover:bg-gray-100 transition-colors"},{default:Q(()=>[Y(W(a.$t("rewardSys.selected"))+": "+W(gs.value.length),1)]),_:1})]),_:1})]),_:1})),[[w]]),X((R(),O(d,{clickable:"",onClick:uo,disable:0===gs.value.length},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"content_copy",color:"grey-8"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>h[75]||(h[75]=[Y("Copy Names")])),_:1})]),_:1})]),_:1},8,["disable"])),[[w]]),q(c),X((R(),O(d,{clickable:"",onClick:ho},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"check_box",color:"primary"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(a.$t("rewardSys.selection.all")),1)]),_:1})]),_:1})]),_:1})),[[w]]),X((R(),O(d,{clickable:"",onClick:xo},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"swap_vert",color:"orange"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(a.$t("rewardSys.selection.inv")),1)]),_:1})]),_:1})]),_:1})),[[w]]),q(c),X((R(),O(d,{clickable:"",onClick:To,disable:0===gs.value.length},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"clear",color:"negative"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(a.$t("rewardSys.selection.clear")),1)]),_:1})]),_:1})]),_:1},8,["disable"])),[[w]])]),_:1})]),_:1},8,["color","text-color","label"]),q(s,{modelValue:Ms.value,"onUpdate:modelValue":h[29]||(h[29]=e=>Ms.value=e),label:"individual"===Ms.value?"Individual":"Selection","true-value":"individual","false-value":"selection","checked-icon":"person","unchecked-icon":"checklist",color:"green-13","icon-color":"white",size:"sm",dense:"",class:"mr-2 text-white font-bold"},null,8,["modelValue","label"])])])),q(c,{vertical:"",inset:"",class:"mx-2"}),q(g,{modelValue:oo.value,"onUpdate:modelValue":h[30]||(h[30]=e=>oo.value=e)},{default:Q(()=>[q(r,{style:{"min-width":"350px"}},{default:Q(()=>[q(t,{class:"row items-center"},{default:Q(()=>[B("div",Ga,[Y(W("all"===no.value?"All Students":"present"===no.value?"Present Students":"selected"===no.value?"Selected Students":"Absent Students")+" ",1),q(k,{color:"all"===no.value?"grey-7":"present"===no.value?"positive":"selected"===no.value?"blue":"negative",class:"ml-2"},{default:Q(()=>[Y(W(ro.value.length),1)]),_:1},8,["color"])]),q(E),X(q(o,{icon:"close",flat:"",round:"",dense:""},null,512),[[w]])]),_:1}),q(t,{class:"q-pt-none",style:{"max-height":"50vh","overflow-y":"auto"}},{default:Q(()=>[0===ro.value.length?(R(),L("div",Ja," No students found. ")):(R(),O(i,{key:1,bordered:"",separator:"",class:"rounded-lg"},{default:Q(()=>[(R(!0),L(H,null,Z(ro.value,e=>(R(),O(d,{key:e.id},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(m,{size:"sm"},{default:Q(()=>[B("img",{src:co(e)},null,8,Ya)]),_:2},1024)]),_:2},1024),q(u,null,{default:Q(()=>[Y(W(e.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),q(f,{align:"right",class:"bg-gray-50"},{default:Q(()=>[X(q(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]]),q(o,{label:"Copy List",color:"primary",icon:"content_copy",onClick:uo,disable:0===ro.value.length},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Fo.value.length>0?(R(),O(o,{key:0,dense:"",rounded:"",color:"grey-8",icon:"undo",label:"Undo",onClick:Lo,class:"ml-2 shadow-sm",size:"sm"},{default:Q(()=>[q(n,null,{default:Q(()=>h[76]||(h[76]=[Y("Undo last action")])),_:1})]),_:1})):M("",!0),bo.value.length>0?(R(),L("div",Ha,[q(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"filter_alt_off",label:"ALL",color:null===fo.value?"grey-3":"grey-2","text-color":null===fo.value?"grey-8":"grey-6",class:ee(["px-4 font-bold",null===fo.value?"bg-gray-200":""]),onClick:h[31]||(h[31]=e=>fo.value=null)},null,8,["color","text-color","class"]),q(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"check_circle",color:"__SELECTED__"===fo.value?"primary":"grey-2","text-color":"__SELECTED__"===fo.value?"white":"grey-8",class:"px-3 font-bold",onClick:h[32]||(h[32]=e=>fo.value="__SELECTED__"===fo.value?null:"__SELECTED__")},{default:Q(()=>[q(n,null,{default:Q(()=>h[77]||(h[77]=[Y("Selected Only")])),_:1})]),_:1},8,["color","text-color"]),q(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"radio_button_unchecked",color:"__UNSELECTED__"===fo.value?"primary":"grey-2","text-color":"__UNSELECTED__"===fo.value?"white":"grey-8",class:"px-3 font-bold mr-2",onClick:h[33]||(h[33]=e=>fo.value="__UNSELECTED__"===fo.value?null:"__UNSELECTED__")},{default:Q(()=>[q(n,null,{default:Q(()=>h[78]||(h[78]=[Y("Not Selected")])),_:1})]),_:1},8,["color","text-color"]),(R(!0),L(H,null,Z(bo.value,e=>(R(),O(o,{key:e,unelevated:"",dense:"",round:"",size:"md",label:e,color:fo.value===e?"primary":"grey-1","text-color":fo.value===e?"white":"grey-7",onClick:a=>function(e){fo.value===e?fo.value=null:fo.value=e}(e),class:ee(["font-bold shadow-sm",fo.value===e?"shadow-md scale-110":"hover:bg-gray-200"])},null,8,["label","color","text-color","onClick","class"]))),128))])):M("",!0),(R(!0),L(H,null,Z(yo.value,(e,t)=>(R(),L("div",{key:t,class:"mb-6 bg-gray-400"},[e.name?(R(),L("div",Za,[B("div",Ka,[B("h4",Xa,[q(l,{name:"groups"}),Y(" "+W(e.name)+" ",1),q(k,{label:e.students.length,color:"indigo"},null,8,["label"])]),B("div",et,[q(o,{dense:"",size:"sm",color:"indigo",icon:"check_box",label:a.$t("rewardSys.selection.all"),onClick:a=>zo(e.students,!0),outline:""},null,8,["label","onClick"]),q(o,{dense:"",size:"sm",color:"grey",icon:"check_box_outline_blank",label:a.$t("rewardSys.selection.clear"),onClick:a=>zo(e.students,!1),outline:""},null,8,["label","onClick"])])])])):M("",!0),B("div",at,[(R(!0),L(H,null,Z(e.students,e=>{var a,t,l,s,o,n;return R(),O(de,{key:e.id,student:e,selected:gs.value.includes(e.id),"selected-id":gs.value.includes(e.id)?e.id:null,"disable-behavior":!bs.value[e.id],"is-absent":!bs.value[e.id],"allow-disabled-click":!1,"avatar-edit-enabled":Es.value,"overall-points":((null==(a=fs.value[e.id])?void 0:a.points_plus)||0)-((null==(t=fs.value[e.id])?void 0:t.points_minus)||0),"student-summary":{positive:((null==(l=fs.value[e.id])?void 0:l.points_plus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].plus:0),negative:((null==(s=fs.value[e.id])?void 0:s.points_minus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].minus:0),total:((null==(o=fs.value[e.id])?void 0:o.points_plus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].plus:0)-(((null==(n=fs.value[e.id])?void 0:n.points_minus)||0)-("from_now"===Fs.value&&Ls.value[e.id]?Ls.value[e.id].minus:0))},onSelect:a=>ao(e.id),onPreview:ko,onLeave:$o},null,8,["student","selected","selected-id","disable-behavior","is-absent","avatar-edit-enabled","overall-points","student-summary","onSelect"])}),128))])]))),128))])])]),_:1}),q(C,{name:"negative"},{default:Q(()=>[B("div",tt,[B("div",lt,[B("h3",st,W(a.$t("rewardSys.points.deduct")),1),B("p",ot,W(a.$t("rewardSys.points.selectStudentsNegative")),1)]),B("div",nt,[B("div",rt,[q(A,{modelValue:ps.value,"onUpdate:modelValue":h[34]||(h[34]=e=>ps.value=e),options:po.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:a.$t("rewardSys.points.selectNegativeBehavior"),"emit-value":"","map-options":""},{option:Q(e=>[q(d,te(le(e.itemProps)),{default:Q(()=>[q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(Gl(e.opt)),1)]),_:2},1024),q(p,{caption:""},{default:Q(()=>[Y(W(e.opt.value||e.opt.points||0)+" points",1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","placeholder"]),q(o,{color:"negative",icon:"remove_circle",label:a.$t("rewardSys.points.applyToSelected"),onClick:Do,disable:!gs.value.length||!ps.value,loading:_s.value},null,8,["label","disable","loading"])]),B("div",it,[h[79]||(h[79]=Y("Selected: ")),B("strong",null,W(gs.value.length),1),h[80]||(h[80]=Y(" students"))])]),B("div",dt,[(R(!0),L(H,null,Z(ss.value,e=>{var a,t,l,s;return R(),O(de,{key:e.id,student:e,selected:gs.value.includes(e.id),"selected-id":gs.value.includes(e.id)?e.id:null,"disable-behavior":!bs.value[e.id],"allow-disabled-click":!1,"avatar-edit-enabled":Es.value,"student-summary":{positive:(null==(a=fs.value[e.id])?void 0:a.points_plus)||0,negative:(null==(t=fs.value[e.id])?void 0:t.points_minus)||0,total:((null==(l=fs.value[e.id])?void 0:l.points_plus)||0)-((null==(s=fs.value[e.id])?void 0:s.points_minus)||0)},onSelect:a=>Vo(e.id)},null,8,["student","selected","selected-id","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))])])]),_:1}),q(C,{name:"old_card"},{default:Q(()=>[B("div",ut,[h[84]||(h[84]=B("h3",{class:"text-xl font-bold mb-4"},"Old Card View",-1)),B("div",ct,[(R(!0),L(H,null,Z(ss.value,e=>{var a,t,l,s;return R(),L("div",{key:e.id,class:ee(["p-4 border-2 rounded-lg transition",[bs.value[e.id]?gs.value.includes(e.id)?"bg-green-100 border-green-500 cursor-pointer":"bg-white border-gray-200 cursor-pointer":"bg-gray-100 border-gray-300 opacity-50 cursor-not-allowed"]]),onClick:a=>bs.value[e.id]&&Vo(e.id)},[B("div",mt,[B("div",pt,[B("p",gt,W(e.name),1),B("p",ft,"ID: "+W(e.id),1),bs.value[e.id]?M("",!0):(R(),L("p",bt,"‚ùå Absent"))]),q(_,{"model-value":gs.value.includes(e.id),"onUpdate:modelValue":a=>Vo(e.id),disable:!bs.value[e.id],color:"positive",size:"lg"},null,8,["model-value","onUpdate:modelValue","disable"])]),B("div",yt,[B("div",ht,[h[81]||(h[81]=B("span",{class:"text-xs font-semibold text-green-800"},"Positive",-1)),B("span",xt,"+"+W((null==(a=fs.value[e.id])?void 0:a.points_plus)||0)+" ‚≠ê",1)]),B("div",wt,[h[82]||(h[82]=B("span",{class:"text-xs font-semibold text-red-800"},"Negative",-1)),B("span",_t,"-"+W((null==(t=fs.value[e.id])?void 0:t.points_minus)||0)+" ‚ö†Ô∏è",1)]),B("div",St,[h[83]||(h[83]=B("span",{class:"text-xs font-semibold text-blue-800"},"Total",-1)),B("span",kt,W(((null==(l=fs.value[e.id])?void 0:l.points_plus)||0)-((null==(s=fs.value[e.id])?void 0:s.points_minus)||0)),1)])])],10,vt)}),128))])])]),_:1}),q(C,{name:"history"},{default:Q(()=>[B("div",$t,[B("div",It,[B("h3",Ct,W(a.$t("rewardSys.history.title")),1),q(o,{color:"primary",icon:"refresh",label:a.$t("rewardSys.history.refresh"),onClick:Mo,loading:ks.value},null,8,["label","loading"])]),hs.value.length?M("",!0):(R(),L("div",jt,[B("p",Et,W(a.$t("rewardSys.history.empty")),1)])),(R(!0),L(H,null,Z(hs.value,e=>{var t,l,s;return R(),L("div",{key:e.id,class:ee(["p-4 bg-white rounded-lg border-l-4",[e.canceled?"border-gray-400 opacity-60":e.value>0?"border-green-500":"border-red-500"]])},[B("div",At,[B("div",Vt,[B("div",zt,[B("span",Tt,W((null==(l=null==(t=e.student_behavior)?void 0:t.student)?void 0:l.name)||a.$t("rewardSys.history.unknown")),1),B("span",Ut,W(e.value>0?"‚≠ê":"‚ö†Ô∏è"),1)]),B("p",Pt,[B("strong",null,W(Gl(e.behavior)||a.$t("rewardSys.history.unknownBehavior")),1),B("span",{class:ee(e.value>0?"text-green-600":"text-red-600")}," ("+W(e.value>0?"+":"")+W(e.value)+" "+W(a.$t("rewardSys.points.title"))+") ",3)]),B("p",Dt,W(Qo(e.created_at))+" by "+W((null==(s=e.created_by)?void 0:s.name)||a.$t("rewardSys.history.unknown")),1),e.note?(R(),L("p",Nt,W(a.$t("rewardSys.history.note"))+" "+W(e.note),1)):M("",!0),e.canceled?(R(),L("p",Ft," ‚ùå "+W(a.$t("rewardSys.history.canceled"))+" "+W(e.cancel_reason)+" ("+W(Qo(e.canceled_at))+") ",1)):M("",!0)]),e.canceled?M("",!0):(R(),O(o,{key:0,color:"warning",icon:"undo",label:a.$t("rewardSys.history.undo"),size:"sm",onClick:a=>async function(e){$s.value=e;try{const a=await be.undoAction(e,"Undone by teacher");a.success?(Xl.notify({message:"Action undone successfully",color:"positive",position:"top"}),await Mo(),await Po()):Xl.notify({message:a.error||"Failed to undo action",color:"negative",position:"top"})}catch(a){console.error("Error undoing action:",a),Xl.notify({message:"Error undoing action",color:"negative",position:"top"})}finally{$s.value=null}}(e.id),loading:$s.value===e.id},null,8,["label","onClick","loading"]))])],2)}),128))])]),_:1}),q(C,{name:"settings_reports",class:"p-4"},{default:Q(()=>[B("div",Lt,[B("div",Rt,[q(I,{modelValue:ts.value,"onUpdate:modelValue":h[35]||(h[35]=e=>ts.value=e),align:"left",class:"text-gray-600 bg-gray-50 border-b border-gray-200","active-color":"primary","indicator-color":"primary",dense:""},{default:Q(()=>[q($,{name:"behavior_incidents",icon:"report_problem",label:a.$t("rewardSys.tabs.behaviorIncidents")},null,8,["label"]),q($,{name:"behaviors",icon:"settings",label:a.$t("rewardSys.tabs.behaviors")},null,8,["label"])]),_:1},8,["modelValue"]),q(j,{modelValue:ts.value,"onUpdate:modelValue":h[37]||(h[37]=e=>ts.value=e),animated:"",class:"bg-transparent"},{default:Q(()=>[q(C,{name:"behavior_incidents"},{default:Q(()=>[q(G(me),{students:ss.value,"classroom-id":ns.value,date:is.value,"period-code":to.value,onIncidentRecorded:Jo},null,8,["students","classroom-id","date","period-code"])]),_:1}),q(C,{name:"behaviors"},{default:Q(()=>[B("div",qt,[B("div",Bt,[B("h3",Ot,W(a.$t("rewardSys.behaviors.management")),1),q(o,{color:"primary",icon:"add",label:a.$t("rewardSys.behaviors.addNew"),onClick:h[36]||(h[36]=e=>jo(null)),size:"md",class:"shadow-md"},null,8,["label"])]),B("div",Mt,[B("div",Qt,[q(l,{name:"add_circle",size:"md",color:"positive"}),B("h4",Wt,W(a.$t("rewardSys.behaviors.positiveSection")),1),q(k,{label:mo.value.length,color:"positive"},null,8,["label"])]),B("div",Gt,[(R(!0),L(H,null,Z(mo.value,e=>(R(),L("div",{key:e.id,class:"bg-white rounded-lg p-4 shadow-sm border border-green-100 hover:shadow-md transition-all"},[B("div",Jt,[B("div",Yt,[B("div",Ht,W(e.icon||"‚≠ê"),1),B("div",null,[B("h5",Zt,W(Gl(e)),1),B("p",Kt,"ID: "+W(e.id),1)])]),B("div",Xt,[q(o,{flat:"",round:"",dense:"",icon:"edit",color:"primary",size:"sm",onClick:a=>jo(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[85]||(h[85]=[Y("Edit")])),_:1})]),_:2},1032,["onClick"]),q(o,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"sm",onClick:a=>Ao(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[86]||(h[86]=[Y("Delete")])),_:1})]),_:2},1032,["onClick"])])]),B("div",el,[h[87]||(h[87]=B("span",{class:"text-sm text-gray-600"},"Points:",-1)),B("span",al,"+"+W(e.value||e.points||0),1)])]))),128))]),0===mo.value.length?(R(),L("div",tl,[q(l,{name:"sentiment_neutral",size:"3rem",class:"mb-2"}),B("p",null,W(a.$t("rewardSys.behaviors.noPositive")),1)])):M("",!0)]),B("div",ll,[B("div",sl,[q(l,{name:"remove_circle",size:"md",color:"negative"}),B("h4",ol,W(a.$t("rewardSys.behaviors.negativeSection")),1),q(k,{label:po.value.length,color:"negative"},null,8,["label"])]),B("div",nl,[(R(!0),L(H,null,Z(po.value,e=>(R(),L("div",{key:e.id,class:"bg-white rounded-lg p-4 shadow-sm border border-red-100 hover:shadow-md transition-all"},[B("div",rl,[B("div",il,[B("div",dl,W(e.icon||"‚ö†Ô∏è"),1),B("div",null,[B("h5",ul,W(Gl(e)),1),B("p",cl,"ID: "+W(e.id),1)])]),B("div",vl,[q(o,{flat:"",round:"",dense:"",icon:"edit",color:"primary",size:"sm",onClick:a=>jo(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[88]||(h[88]=[Y("Edit")])),_:1})]),_:2},1032,["onClick"]),q(o,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"sm",onClick:a=>Ao(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[89]||(h[89]=[Y("Delete")])),_:1})]),_:2},1032,["onClick"])])]),B("div",ml,[h[90]||(h[90]=B("span",{class:"text-sm text-gray-600"},"Points:",-1)),B("span",pl,W(e.value||e.points||0),1)])]))),128))]),0===po.value.length?(R(),L("div",gl,[q(l,{name:"sentiment_neutral",size:"3rem",class:"mb-2"}),B("p",null,W(a.$t("rewardSys.behaviors.noNegative")),1)])):M("",!0)])])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1},8,["modelValue"])]}),_:1})):M("",!0),ss.value.length?M("",!0):(R(),O(r,{key:2,class:"shadow-lg rounded-2xl"},{default:Q(()=>[q(t,{class:"text-center py-12"},{default:Q(()=>[B("p",fl,"üìö "+W(a.$t("rewardSys.messages.selectClassroom")),1)]),_:1})]),_:1})),q(g,{modelValue:xs.value,"onUpdate:modelValue":h[39]||(h[39]=e=>xs.value=e),maximized:""},{default:Q(()=>[q(r,null,{default:Q(()=>[q(f,{align:"right"},{default:Q(()=>[X(q(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]])]),_:1}),q(t,{class:"p-0"},{default:Q(()=>[q(G(ve),{students:ss.value,"student-behaviors":fs.value,"period-code":to.value,date:is.value,"school-logo":Yl.value},null,8,["students","student-behaviors","period-code","date","school-logo"])]),_:1}),q(f,{align:"right"},{default:Q(()=>[X(q(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),q(g,{modelValue:As.value,"onUpdate:modelValue":h[43]||(h[43]=e=>As.value=e),"full-width":"",maxWidth:"1200px"},{default:Q(()=>[q(r,{class:"flex flex-col md:flex-row h-[90vh] md:h-[80vh] overflow-hidden"},{default:Q(()=>{var e;return[q(t,{class:ee(["w-full md:w-1/4 bg-blue-50 border-r border-blue-100 flex flex-col p-0 order-2 md:order-1 transition-all",{"h-16 overflow-hidden md:h-auto":G(Xl).screen.lt.md&&!Ks.value}])},{default:Q(()=>[B("div",{class:"p-3 border-b border-blue-200 bg-blue-100/50 flex justify-between items-center cursor-pointer md:cursor-default",onClick:h[40]||(h[40]=e=>G(Xl).screen.lt.md?Ks.value=!Ks.value:null)},[B("h4",bl,[q(l,{name:"checklist"}),Y(" "+W(a.$t("rewardSys.selected"))+" ("+W(gs.value.length)+") ",1)]),B("div",yl,[q(l,{name:Ks.value?"expand_less":"expand_more",color:"primary"},null,8,["name"])])]),X(B("div",hl,[0===gs.value.length?(R(),L("div",xl,W(a.$t("rewardSys.messages.clickToSelect")),1)):(R(),L("div",wl,[(R(!0),L(H,null,Z(gs.value,e=>(R(),O(x,{key:e,removable:"",onRemove:a=>Vo(e),color:"white","text-color":"primary",class:"shadow-sm border border-blue-100 m-0 w-full"},{default:Q(()=>{var a;return[q(m,{icon:"person",color:"primary","text-color":"white","font-size":"12px"}),B("div",_l,[B("span",Sl,W(null==(a=ss.value.find(a=>a.id===e))?void 0:a.firstName),1)])]}),_:2},1032,["onRemove"]))),128))]))],512),[[oe,!G(Xl).screen.lt.md||Ks.value]]),X(B("div",kl,[B("div",$l,[q(o,{flat:"",dense:"",color:"primary",label:"All",size:"sm",onClick:ho,class:"bg-blue-50"}),q(o,{flat:"",dense:"",color:"primary",label:"Inv",size:"sm",onClick:xo,class:"bg-blue-50"}),q(o,{flat:"",dense:"",color:"negative",label:"Clear",size:"sm",onClick:To,class:"bg-red-50"})])],512),[[oe,!G(Xl).screen.lt.md||Ks.value]])]),_:1},8,["class"]),B("div",Il,[1===gs.value.length?(R(),L("div",Cl,[B("div",jl,[B("div",El,W(null==(e=ss.value.find(e=>e.id===gs.value[0]))?void 0:e.name),1)])])):M("",!0),q(t,{class:ee(["positive"===Vs.value?"bg-green-50 border-b border-green-100":"bg-red-50 border-b border-red-100","flex flex-wrap justify-between items-center py-2 px-3 gap-2 shrink-0"])},{default:Q(()=>[B("div",{class:ee(["font-bold flex items-center gap-2 transition-colors duration-300","positive"===Vs.value?"text-green-800":"text-red-800"])},[B("span",Al,[q(l,{name:"positive"===Vs.value?"emoji_events":"warning",size:"sm"},null,8,["name"]),B("span",Vl,W("positive"===Vs.value?a.$t("rewardSys.points.positiveTitle"):a.$t("rewardSys.points.negativeTitle")),1)])],2),B("div",zl,[q(o,{unelevated:"",rounded:"",dense:"",color:"positive"===Vs.value?"positive":"transparent","text-color":"positive"===Vs.value?"white":"grey-7",class:"px-3 md:px-4 transition-all duration-300 text-xs md:text-sm",onClick:h[41]||(h[41]=e=>Vs.value="positive")},{default:Q(()=>[q(l,{name:"thumb_up",size:"xs",class:"mr-1"}),h[91]||(h[91]=B("span",{class:"hidden sm:inline"},"Pos",-1))]),_:1},8,["color","text-color"]),q(o,{unelevated:"",rounded:"",dense:"",color:"negative"===Vs.value?"negative":"transparent","text-color":"negative"===Vs.value?"white":"grey-7",class:"px-3 md:px-4 transition-all duration-300 text-xs md:text-sm",onClick:h[42]||(h[42]=e=>Vs.value="negative")},{default:Q(()=>[q(l,{name:"thumb_down",size:"xs",class:"mr-1"}),h[92]||(h[92]=B("span",{class:"hidden sm:inline"},"Neg",-1))]),_:1},8,["color","text-color"])])]),_:1},8,["class"]),q(t,{class:"flex-1 overflow-y-auto p-2 md:p-4 custom-scrollbar bg-gray-50/50"},{default:Q(()=>[B("div",Tl,[(R(!0),L(H,null,Z("positive"===Vs.value?mo.value:po.value,e=>(R(),L("div",{key:e.id,class:"cursor-pointer transition-all duration-200 relative group touch-manipulation w-24",onClick:a=>zs.value=e.id},[B("div",{class:ee(["h-full p-2 md:p-3 rounded-xl border flex flex-col items-center text-center gap-1 md:gap-2 active:scale-95 transition-transform bg-white shadow-sm",[zs.value===e.id?"positive"===Vs.value?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-red-500 bg-red-50 ring-2 ring-red-200":"border-gray-200 hover:border-gray-300 hover:shadow-md"]])},[B("div",{class:ee(["text-2xl md:text-3xl p-2 rounded-full mb-0 md:mb-1","positive"===Vs.value?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},W(e.icon||("positive"===Vs.value?"‚≠ê":"‚ö†Ô∏è")),3),B("div",Pl,W(Gl(e)),1),B("div",{class:ee(["text-sm md:text-lg font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full mt-auto","positive"===Vs.value?"bg-green-200 text-green-900":"bg-red-200 text-red-900"])},W("positive"===Vs.value?"+":"")+W(e.value||e.points||0),3),zs.value===e.id?(R(),L("div",{key:0,class:ee(["absolute top-1 right-1 md:top-2 md:right-2 text-lg md:text-xl drop-shadow-sm","positive"===Vs.value?"text-green-600":"text-red-600"])},[q(l,{name:"check_circle"})],2)):M("",!0)],2)],8,Ul))),128))])]),_:1}),q(f,{align:"right",class:"p-4 border-t border-gray-100 bg-gray-50 gap-3"},{default:Q(()=>[X(q(o,{flat:"",label:a.$t("rewardSys.tabs.cancel"),color:"grey-7",size:"lg",class:"font-bold"},null,8,["label"]),[[w]]),q(o,{color:"positive"===Vs.value?"positive":"negative",label:"positive"===Vs.value?a.$t("rewardSys.points.applyPositive"):a.$t("rewardSys.points.applyNegative"),icon:"positive"===Vs.value?"check_circle":"warning",onClick:wo,disable:!zs.value,loading:_s.value,size:"lg",class:"px-8 font-bold shadow-md",push:""},null,8,["color","label","icon","disable","loading"])]),_:1})])]}),_:1})]),_:1},8,["modelValue"]),q(g,{modelValue:Ws.value,"onUpdate:modelValue":h[49]||(h[49]=e=>Ws.value=e),persistent:""},{default:Q(()=>[q(r,{class:"min-w-[500px]"},{default:Q(()=>[q(t,{class:"bg-primary text-white"},{default:Q(()=>[B("div",Dl,[B("div",Nl,W(Gs.value?a.$t("rewardSys.behaviors.edit"):a.$t("rewardSys.behaviors.create")),1),Gs.value&&!Gs.value.teacher_id?(R(),O(k,{key:0,color:"blue",label:"üîí "+a.$t("rewardSys.behaviors.schoolDefault")},null,8,["label"])):M("",!0)])]),_:1}),q(t,{class:"q-pt-md space-y-4"},{default:Q(()=>[Gs.value&&!Gs.value.teacher_id?(R(),O(b,{key:0,class:"bg-blue-50 text-blue-900",rounded:"",dense:""},{avatar:Q(()=>[q(l,{name:"info",color:"blue"})]),default:Q(()=>[Y(" "+W(a.$t("rewardSys.behaviors.readOnlyWarning")),1)]),_:1})):M("",!0),q(y,{modelValue:Ys.value.name,"onUpdate:modelValue":h[44]||(h[44]=e=>Ys.value.name=e),label:"üá¨üáß "+a.$t("rewardSys.behaviors.form.nameEn")+" *",outlined:"",dense:"",rules:[e=>!!e||"Name is required"],readonly:Gs.value&&!Gs.value.teacher_id},{prepend:Q(()=>[q(l,{name:"translate"})]),_:1},8,["modelValue","label","rules","readonly"]),q(y,{modelValue:Ys.value.name_ar,"onUpdate:modelValue":h[45]||(h[45]=e=>Ys.value.name_ar=e),label:"üá∏üá¶ "+a.$t("rewardSys.behaviors.form.nameAr"),outlined:"",dense:"",dir:"rtl",readonly:Gs.value&&!Gs.value.teacher_id},{prepend:Q(()=>[q(l,{name:"translate"})]),_:1},8,["modelValue","label","readonly"]),q(A,{modelValue:Ys.value.type,"onUpdate:modelValue":h[46]||(h[46]=e=>Ys.value.type=e),options:[{label:a.$t("rewardSys.behaviors.form.types.positive"),value:"positive"},{label:a.$t("rewardSys.behaviors.form.types.negative"),value:"negative"}],label:a.$t("rewardSys.behaviors.form.type")+" *",outlined:"",dense:"","emit-value":"","map-options":"",rules:[e=>!!e||"Type is required"],readonly:Gs.value&&!Gs.value.teacher_id},null,8,["modelValue","options","label","rules","readonly"]),q(y,{modelValue:Ys.value.points,"onUpdate:modelValue":h[47]||(h[47]=e=>Ys.value.points=e),modelModifiers:{number:!0},label:a.$t("rewardSys.behaviors.form.points")+" *",type:"number",outlined:"",dense:"",rules:[e=>null!==e&&""!==e||"Points are required"],hint:"positive"===Ys.value.type?"Positive number (e.g., 5)":"Negative number (e.g., -3)",readonly:Gs.value&&!Gs.value.teacher_id},null,8,["modelValue","label","rules","hint","readonly"]),q(y,{modelValue:Ys.value.icon,"onUpdate:modelValue":h[48]||(h[48]=e=>Ys.value.icon=e),label:a.$t("rewardSys.behaviors.form.icon"),outlined:"",dense:"",hint:"Optional emoji, e.g., ‚≠ê üéâ ‚ö†Ô∏è üö´",readonly:Gs.value&&!Gs.value.teacher_id},null,8,["modelValue","label","readonly"])]),_:1}),q(f,{align:"right",class:"q-px-md q-pb-md"},{default:Q(()=>[X(q(o,{flat:"",label:a.$t("rewardSys.tabs.cancel")},null,8,["label"]),[[w]]),!Gs.value||Gs.value.teacher_id?(R(),O(o,{key:0,color:"primary",label:Gs.value?a.$t("common.update"):a.$t("common.create"),onClick:Eo,loading:Js.value},null,8,["label","loading"])):M("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),q(g,{modelValue:Ps.value,"onUpdate:modelValue":h[51]||(h[51]=e=>Ps.value=e),maximized:""},{default:Q(()=>[q(G(pe),{students:ss.value,"saved-layouts":Us.value,"editing-layout":Ds.value,onSave:Io,onDelete:Co,onClose:h[50]||(h[50]=e=>Ps.value=!1)},null,8,["students","saved-layouts","editing-layout"])]),_:1},8,["modelValue"]),q(g,{modelValue:Ns.value,"onUpdate:modelValue":h[57]||(h[57]=e=>Ns.value=e)},{default:Q(()=>[q(ne,{mode:Fs.value,"competition-start-time":Rs.value,"date-from":qs.value,"date-to":Bs.value,"leaderboard-mode":Os.value,"onUpdate:mode":h[52]||(h[52]=e=>Fs.value=e),"onUpdate:competitionStartTime":h[53]||(h[53]=e=>Rs.value=e),"onUpdate:dateFrom":h[54]||(h[54]=e=>qs.value=e),"onUpdate:dateTo":h[55]||(h[55]=e=>Bs.value=e),"onUpdate:leaderboardMode":h[56]||(h[56]=e=>Os.value=e),onApply:Wo,onReset:Go},null,8,["mode","competition-start-time","date-from","date-to","leaderboard-mode"])]),_:1},8,["modelValue"]),q(g,{modelValue:Hs.value,"onUpdate:modelValue":h[58]||(h[58]=e=>Hs.value=e),position:"top"},{default:Q(()=>[q(r,{style:{"min-width":"350px","border-radius":"20px"},class:"q-ma-md bg-deep-purple-8 text-white shadow-2xl"},{default:Q(()=>[q(t,{class:"column items-center text-center q-pa-lg"},{default:Q(()=>{var e,a;return[q(m,{size:"80px",class:"q-mb-md shadow-lg border-4 border-white"},{default:Q(()=>[Zs.value.student&&Zs.value.student.avatar?(R(),L("img",{key:0,src:co(Zs.value.student)},null,8,Fl)):(R(),O(l,{key:1,name:"person"}))]),_:1}),B("div",Ll,W(null==(e=Zs.value.student)?void 0:e.name),1),B("div",Rl,[B("span",{class:ee(Zs.value.points>0?"text-green-300":"text-red-300")},W(Zs.value.points>0?"+":"")+W(Zs.value.points),3),B("span",ql,W((null==(a=Zs.value.behavior)?void 0:a.icon)||"‚≠ê"),1)]),B("div",Bl,W(Gl(Zs.value.behavior)),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])])],64)}}},[["__scopeId","data-v-d9520804"]]);export{Ol as default};
