import{c as e,r as a,u as l,d as t,e as o,Q as r,f as s,g as n,h as u,i,j as d,k as m,l as c,m as p,n as v,b as y}from"./app-BXm70mdJ.js";import{Q as f}from"./QSpace-Bu8V-QDa.js";import{Q as b}from"./QStepperNavigation-d60Xs3zk.js";import{Q as g,a as _}from"./QStepper-9iCkKHrv.js";import{f as h,H as k,I as w,J as x,b as C,M as V,O as I,U as j,L as q,Q as A,V as S,F as N,S as P,Z as O}from"./vendor-DNM7Y6Xn.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";import"./use-panel-D2HepUiw.js";import"./use-render-cache-CmTcazfP.js";function Q(l){return void 0!==navigator.clipboard?navigator.clipboard.writeText(l):new Promise((t,o)=>{const r=function(l){const t=document.createElement("textarea");t.value=l,t.contentEditable="true",t.style.position="fixed";const o=()=>{};e(o),document.body.appendChild(t),t.focus(),t.select();const r=document.execCommand("copy");return t.remove(),a(o),r}(l);r?t(!0):o(r)})}const E={class:"text-caption",style:{"white-space":"pre-wrap","max-height":"200px","overflow-y":"auto"}},J={class:"q-mt-md"},B={class:"text-body2"},M={key:0,class:"q-mt-sm"},U={class:"q-mb-none"},D={key:0,class:"text-caption"},R={__name:"BulkImportDialog",props:{modelValue:Boolean},emits:["update:modelValue","imported"],setup(e,{emit:a}){const R=a,F=l(),G=h(1),T=h(!1),$=h(!1),L=h(!1),z=h(""),H=h(""),Z=h(""),K=h([]),W=h(!0),X=h(null),Y=async()=>{var e,a;try{T.value=!0,await O.get("/sanctum/csrf-cookie");const e=await O.get("/api/admin/menus/helpers/ai-prompt");z.value=e.data.prompt,await Q(z.value),F.notify({type:"positive",message:"AI prompt copied to clipboard!"})}catch(l){console.error("Error generating AI prompt:",l),F.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to generate AI prompt"})}finally{T.value=!1}},ee=()=>{try{$.value=!0,Z.value="";const e=JSON.parse(H.value);if(!Array.isArray(e))return void(Z.value="JSON must be an array of menu objects");K.value=e,G.value=3}catch(e){Z.value=`Invalid JSON: ${e.message}`}finally{$.value=!1}},ae=async()=>{var e,a;try{L.value=!0,await O.get("/sanctum/csrf-cookie");const e=await O.post("/api/admin/menus/bulk-import",{menus:K.value,dry_run:W.value});X.value=e.data,F.notify({type:e.data.error_count>0?"warning":"positive",message:e.data.message}),W.value||0!==e.data.error_count||(R("imported"),setTimeout(()=>le(),2e3))}catch(l){console.error("Error importing menus:",l),F.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to import menus"})}finally{L.value=!1}},le=()=>{G.value=1,H.value="",Z.value="",K.value=[],X.value=null,R("update:modelValue",!1)};return(a,l)=>(w(),k(y,{"model-value":e.modelValue,"onUpdate:modelValue":l[6]||(l[6]=e=>a.$emit("update:modelValue",e)),persistent:""},{default:x(()=>[C(v,{style:{"min-width":"700px","max-width":"900px"}},{default:x(()=>[C(t,{class:"row items-center q-pb-none"},{default:x(()=>[C(o,{name:"upload_file",color:"secondary",size:"md",class:"q-mr-sm"}),l[7]||(l[7]=V("div",{class:"text-h6"},"Bulk Import Menus",-1)),C(f),C(r,{icon:"close",flat:"",round:"",dense:"",onClick:le})]),_:1}),C(t,null,{default:x(()=>[C(g,{modelValue:G.value,"onUpdate:modelValue":l[5]||(l[5]=e=>G.value=e),vertical:"",color:"primary",animated:""},{default:x(()=>[C(_,{name:1,title:"Generate AI Prompt",icon:"smart_toy",done:G.value>1},{default:x(()=>[l[9]||(l[9]=V("div",{class:"text-body2 q-mb-md"}," Click the button below to generate a prompt that you can copy and paste to an AI assistant (ChatGPT, Claude, etc.) to generate menu JSON. ",-1)),C(r,{color:"purple",icon:"content_copy",label:"Generate & Copy AI Prompt",onClick:Y,loading:T.value},null,8,["loading"]),z.value?(w(),k(s,{key:0,class:"bg-grey-2 q-mt-md",rounded:""},{avatar:x(()=>[C(o,{name:"info",color:"primary"})]),default:x(()=>[l[8]||(l[8]=V("div",{class:"text-subtitle2 q-mb-sm"},"AI Prompt (Copied to Clipboard)",-1)),V("pre",E,j(z.value),1)]),_:1})):I("",!0),C(b,null,{default:x(()=>[C(r,{color:"primary",label:"Next",onClick:l[0]||(l[0]=e=>G.value=2)})]),_:1})]),_:1},8,["done"]),C(_,{name:2,title:"Paste JSON",icon:"code",done:G.value>2},{default:x(()=>[l[10]||(l[10]=V("div",{class:"text-body2 q-mb-md"}," Paste the JSON generated by the AI assistant below: ",-1)),C(n,{modelValue:H.value,"onUpdate:modelValue":l[1]||(l[1]=e=>H.value=e),type:"textarea",outlined:"",rows:"15",placeholder:'[{"label": "Menu Label", "route": "route.name", ...}]',error:!!Z.value,"error-message":Z.value},null,8,["modelValue","error","error-message"]),C(b,null,{default:x(()=>[C(r,{flat:"",color:"grey-7",label:"Back",onClick:l[2]||(l[2]=e=>G.value=1),class:"q-mr-sm"}),C(r,{color:"primary",label:"Validate",onClick:ee,loading:$.value},null,8,["loading"])]),_:1})]),_:1},8,["done"]),C(_,{name:3,title:"Preview & Import",icon:"preview"},{default:x(()=>[l[11]||(l[11]=V("div",{class:"text-body2 q-mb-md"}," Preview the menus that will be created: ",-1)),C(u,{bordered:"",separator:""},{default:x(()=>[(w(!0),q(N,null,A(K.value,(e,a)=>(w(),k(i,{key:a},{default:x(()=>[C(d,{avatar:""},{default:x(()=>[C(o,{name:e.icon||"folder"},null,8,["name"])]),_:2},1024),C(d,null,{default:x(()=>[C(m,null,{default:x(()=>[S(j(e.label),1)]),_:2},1024),C(m,{caption:""},{default:x(()=>[S(" Module: "+j(e.module)+" | Route: "+j(e.route||"None"),1)]),_:2},1024),e.children&&e.children.length>0?(w(),k(m,{key:0,caption:""},{default:x(()=>[S(" Children: "+j(e.children.length),1)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),V("div",J,[C(c,{modelValue:W.value,"onUpdate:modelValue":l[3]||(l[3]=e=>W.value=e),label:"Dry run (preview only, don't save)"},null,8,["modelValue"])]),C(b,null,{default:x(()=>[C(r,{flat:"",color:"grey-7",label:"Back",onClick:l[4]||(l[4]=e=>G.value=2),class:"q-mr-sm"}),C(r,{color:"primary",label:W.value?"Run Dry Run":"Import Menus",onClick:ae,loading:L.value},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),X.value?(w(),k(s,{key:0,class:P([X.value.error_count>0?"bg-warning":"bg-positive","text-white q-mt-md"]),rounded:""},{avatar:x(()=>[C(o,{name:X.value.error_count>0?"warning":"check_circle"},null,8,["name"])]),default:x(()=>[l[13]||(l[13]=V("div",{class:"text-subtitle2"},"Import Results",-1)),V("div",B," Success: "+j(X.value.success_count)+" | Errors: "+j(X.value.error_count),1),X.value.results.errors.length>0?(w(),q("div",M,[l[12]||(l[12]=V("div",{class:"text-subtitle2"},"Errors:",-1)),V("ul",U,[(w(!0),q(N,null,A(X.value.results.errors.slice(0,5),(e,a)=>{var l;return w(),q("li",{key:a},j((null==(l=e.data)?void 0:l.label)||`Item ${e.index}`)+": "+j(Object.values(e.errors).flat().join(", ")),1)}),128))]),X.value.results.errors.length>5?(w(),q("div",D," ... and "+j(X.value.results.errors.length-5)+" more errors ",1)):I("",!0)])):I("",!0)]),_:1},8,["class"])):I("",!0)]),_:1}),C(p,{align:"right"},{default:x(()=>[C(r,{flat:"",label:"Close",color:"grey-7",onClick:le})]),_:1})]),_:1})]),_:1},8,["model-value"]))}};export{R as default};
