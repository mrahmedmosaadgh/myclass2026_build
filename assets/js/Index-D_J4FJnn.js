import{u as e,d as l,D as t,Q as a,g as o,e as n,q as r,n as u,o as i,m as s,b as c}from"./app-BXm70mdJ.js";import{Q as d}from"./QSelect-CnZtzPIC.js";import{Q as m}from"./QTd-BIxMTYzb.js";import{Q as f}from"./QTable-rnEofRem.js";import{Q as v}from"./QForm-DyZk5PSh.js";import{a0 as p,u as b,f as y,r as _,a as h,L as j,I as g,b as S,y as V,a3 as N,J as x,M as k,U as w,V as C,F as q,_ as T}from"./vendor-DNM7Y6Xn.js";import{e as O}from"./exportHelper-DgqGG-tE.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";import"./rtl-Cr6c3OOr.js";import"./QMarkupTable-Dmg3C5Wm.js";import"./QLinearProgress-Cix0cchl.js";import"./use-fullscreen-FlxrEg_V.js";import"./xlsx-cMC2LkxH.js";var Q,U,I,A,$,E,M,F,P,D,L,z,W,B,H,J,K,R,G,X,Y,Z,ee,le,te,ae,oe,ne;function re(){if(U)return Q;return U=1,Q=function(e){var l=typeof e;return null!=e&&("object"==l||"function"==l)}}function ue(){if(A)return I;A=1;var e="object"==typeof p&&p&&p.Object===Object&&p;return I=e}function ie(){if(E)return $;E=1;var e=ue(),l="object"==typeof self&&self&&self.Object===Object&&self,t=e||l||Function("return this")();return $=t}function se(){if(F)return M;F=1;var e=ie();return M=function(){return e.Date.now()}}function ce(){if(D)return P;D=1;var e=/\s/;return P=function(l){for(var t=l.length;t--&&e.test(l.charAt(t)););return t}}function de(){if(z)return L;z=1;var e=ce(),l=/^\s+/;return L=function(t){return t?t.slice(0,e(t)+1).replace(l,""):t}}function me(){if(B)return W;B=1;var e=ie().Symbol;return W=e}function fe(){if(J)return H;J=1;var e=me(),l=Object.prototype,t=l.hasOwnProperty,a=l.toString,o=e?e.toStringTag:void 0;return H=function(e){var l=t.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch(i){}var u=a.call(e);return r&&(l?e[o]=n:delete e[o]),u}}function ve(){if(R)return K;R=1;var e=Object.prototype.toString;return K=function(l){return e.call(l)}}function pe(){if(X)return G;X=1;var e=me(),l=fe(),t=ve(),a=e?e.toStringTag:void 0;return G=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?l(e):t(e)}}function be(){if(Z)return Y;return Z=1,Y=function(e){return null!=e&&"object"==typeof e}}function ye(){if(le)return ee;le=1;var e=pe(),l=be();return ee=function(t){return"symbol"==typeof t||l(t)&&"[object Symbol]"==e(t)}}function _e(){if(ae)return te;ae=1;var e=de(),l=re(),t=ye(),a=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,n=/^0o[0-7]+$/i,r=parseInt;return te=function(u){if("number"==typeof u)return u;if(t(u))return NaN;if(l(u)){var i="function"==typeof u.valueOf?u.valueOf():u;u=l(i)?i+"":i}if("string"!=typeof u)return 0===u?u:+u;u=e(u);var s=o.test(u);return s||n.test(u)?r(u.slice(2),s?2:8):a.test(u)?NaN:+u}}function he(){if(ne)return oe;ne=1;var e=re(),l=se(),t=_e(),a=Math.max,o=Math.min;return oe=function(n,r,u){var i,s,c,d,m,f,v=0,p=!1,b=!1,y=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function _(e){var l=i,t=s;return i=s=void 0,v=e,d=n.apply(t,l)}function h(e){var l=e-f;return void 0===f||l>=r||l<0||b&&e-v>=c}function j(){var e=l();if(h(e))return g(e);m=setTimeout(j,function(e){var l=r-(e-f);return b?o(l,c-(e-v)):l}(e))}function g(e){return m=void 0,y&&i?_(e):(i=s=void 0,d)}function S(){var e=l(),t=h(e);if(i=arguments,s=this,f=e,t){if(void 0===m)return function(e){return v=e,m=setTimeout(j,r),p?_(e):d}(f);if(b)return clearTimeout(m),m=setTimeout(j,r),_(f)}return void 0===m&&(m=setTimeout(j,r)),d}return r=t(r)||0,e(u)&&(p=!!u.leading,c=(b="maxWait"in u)?a(t(u.maxWait)||0,r):c,y="trailing"in u?!!u.trailing:y),S.cancel=function(){void 0!==m&&clearTimeout(m),v=0,i=f=s=m=void 0},S.flush=function(){return void 0===m?d:g(l())},S},oe}const je=b(he()),ge={class:"row q-col-gutter-md q-mt-sm"},Se={class:"col-12 col-md-6"},Ve={class:"col-12 col-md-6"},Ne={class:"text-h6"},xe="Subjects Management",ke="/admin/subject",we={__name:"Index",props:{records:Object,schools:Array},setup(p){const b=p,Q=e(),U=y(!1),I=y(!1),A=y(null),$=y(!1),E=y(null),M=_({name:"",nour_name:"",school_id:null,active:!0,description:"",notes:""}),F=y({search:"",school_id:null,status:null}),P=h(()=>{var e;return(null==(e=b.records)?void 0:e.data)||[]});h(()=>{var e;return(null==(e=b.records)?void 0:e.current_page)||1});const D=h(()=>{var e;return(null==(e=b.records)?void 0:e.per_page)||10}),L=h(()=>[...b.schools.map(e=>({value:e.id,label:e.name}))]),z=[{name:"name",label:"Name",field:"name",align:"left"},{name:"nour_name",label:"Nour Name",field:"nour_name"},{name:"school",label:"School",field:e=>{var l;return null==(l=e.school)?void 0:l.name}},{name:"active",label:"Status",field:"active",format:e=>e?"Active":"Inactive"},{name:"actions",label:"Actions",field:"actions",align:"right"}],W=()=>{$.value=!0,T.get("/admin/subject",{...F.value,preserveState:!0,preserveScroll:!0,only:["records"]})},B=je(W,300),H=()=>{M.name="",M.nour_name="",M.school_id=null,M.active=!0,M.description="",M.notes=""},J=(e=null)=>{A.value=e,e?(M.name=e.name,M.nour_name=e.nour_name,M.school_id=e.school_id,M.active=e.active,M.description=e.description||"",M.notes=e.notes||""):H(),U.value=!0},K=()=>{U.value=!1,A.value=null,H()},R=()=>{E.value&&T.delete(`${ke}/${E.value.id}`,{onSuccess:()=>{Q.notify({type:"positive",message:"Subject deleted successfully"}),I.value=!1,E.value=null},onError:()=>{Q.notify({type:"negative",message:"Failed to delete subject"})}})},G=()=>{var e;const l=null==(e=A.value)?void 0:e.id,t=l?`${ke}/${l}`:ke;T[l?"put":"post"](t,M,{onSuccess:()=>{Q.notify({type:"positive",message:`Subject ${l?"updated":"created"} successfully`}),K()},onError:e=>{Object.values(e).forEach(e=>{Q.notify({type:"negative",message:e})})}})},X=()=>{Q.dialog({title:"Import Subjects",message:"Import functionality coming soon!"})},Y=()=>{O({items:P.value,columns:[{key:"name",label:"Name"},{key:"nour_name",label:"Nour Name"},{key:"school.name",label:"School"},{key:"active",label:"Status"}],fileName:"subjects",sheetName:"Subjects"})};return(e,p)=>(g(),j(q,null,[S(V(N),{title:xe}),S(u,{flat:"",class:"q-pa-md"},{default:x(()=>[S(l,null,{default:x(()=>[k("div",{class:"text-h5 text-weight-bold"},w(xe))]),_:1}),S(l,null,{default:x(()=>[S(t,{spread:""},{default:x(()=>[S(a,{color:"primary",label:"Add Subject",icon:"add",onClick:J}),S(a,{color:"secondary",label:"Import",icon:"upload_file",onClick:X}),S(a,{color:"info",label:"Export",icon:"download",onClick:Y})]),_:1})]),_:1}),S(l,null,{default:x(()=>[S(o,{modelValue:F.value.search,"onUpdate:modelValue":p[0]||(p[0]=e=>F.value.search=e),label:"Search Subjects",clearable:"",onInput:V(B)},{prepend:x(()=>[S(n,{name:"search"})]),_:1},8,["modelValue","onInput"]),k("div",ge,[k("div",Se,[S(d,{modelValue:F.value.school_id,"onUpdate:modelValue":[p[1]||(p[1]=e=>F.value.school_id=e),W],options:L.value,label:"Filter by School","option-value":"value","option-label":"label","emit-value":"","map-options":"",clearable:""},null,8,["modelValue","options"])]),k("div",Ve,[S(d,{modelValue:F.value.status,"onUpdate:modelValue":[p[2]||(p[2]=e=>F.value.status=e),W],options:[{label:"Active",value:!0},{label:"Inactive",value:!1}],label:"Filter by Status","emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])])])]),_:1}),S(l,null,{default:x(()=>[S(f,{rows:P.value,columns:z,loading:$.value,"row-key":"id",pagination:{rowsPerPage:D.value}},{"body-cell-actions":x(e=>[S(m,{props:e},{default:x(()=>[S(t,{flat:""},{default:x(()=>[S(a,{icon:"edit",color:"primary",size:"sm",onClick:l=>J(e.row),class:"q-mr-xs"},null,8,["onClick"]),S(a,{icon:"delete",color:"negative",size:"sm",onClick:l=>{return t=e.row,E.value=t,void(I.value=!0);var t},class:"q-mr-xs"},null,8,["onClick"]),S(a,{icon:"description",color:"info",size:"sm",onClick:l=>{return t=e.row,void T.get(route("admin.subject.lesson-plan-templates",t.id));var t},class:"q-mr-xs"},{default:x(()=>[S(r,null,{default:x(()=>p[10]||(p[10]=[C("Manage Lesson Plan Templates")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),_:1}),S(c,{modelValue:U.value,"onUpdate:modelValue":p[7]||(p[7]=e=>U.value=e),persistent:""},{default:x(()=>[S(u,{style:{"min-width":"500px"}},{default:x(()=>[S(l,null,{default:x(()=>[k("div",Ne,w(A.value?"Edit":"Add")+" Subject",1)]),_:1}),S(l,null,{default:x(()=>[S(v,{onSubmit:G,class:"q-gutter-md"},{default:x(()=>[S(o,{modelValue:M.name,"onUpdate:modelValue":p[3]||(p[3]=e=>M.name=e),label:"Name",rules:[e=>!!e||"Name is required"],required:""},null,8,["modelValue","rules"]),S(o,{modelValue:M.nour_name,"onUpdate:modelValue":p[4]||(p[4]=e=>M.nour_name=e),label:"Nour Name",rules:[e=>!!e||"Nour Name is required"],required:""},null,8,["modelValue","rules"]),S(d,{modelValue:M.school_id,"onUpdate:modelValue":p[5]||(p[5]=e=>M.school_id=e),options:L.value,label:"School","option-value":"value","option-label":"label","emit-value":"","map-options":"",rules:[e=>!!e||"School is required"],required:""},null,8,["modelValue","options","rules"]),S(i,{modelValue:M.active,"onUpdate:modelValue":p[6]||(p[6]=e=>M.active=e),label:"Active"},null,8,["modelValue"]),S(s,{align:"right"},{default:x(()=>[S(a,{flat:"",label:"Cancel",color:"primary",onClick:K}),S(a,{label:"Save",type:"submit",color:"primary"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),S(c,{modelValue:I.value,"onUpdate:modelValue":p[9]||(p[9]=e=>I.value=e),persistent:""},{default:x(()=>[S(u,null,{default:x(()=>[S(l,null,{default:x(()=>p[11]||(p[11]=[k("div",{class:"text-h6"},"Delete Subject",-1)])),_:1}),S(l,null,{default:x(()=>p[12]||(p[12]=[C(" Are you sure you want to delete this subject? This action cannot be undone. ")])),_:1}),S(s,{align:"right"},{default:x(()=>[S(a,{flat:"",label:"Cancel",color:"primary",onClick:p[8]||(p[8]=e=>I.value=!1)}),S(a,{label:"Delete",color:"negative",onClick:R})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{we as default};
