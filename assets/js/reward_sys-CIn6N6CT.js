const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/TopLeaderboard-DdLlFtU_.js","assets/js/app-DlLesFGi.js","assets/js/vendor-BWKGNkNB.js","assets/js/offline-BzIlwqNM.js","assets/js/i18n-B0T1C7j3.js","assets/js/ui-B7TfxbV_.js","assets/css/app-Bdf3_1pW.css","assets/js/QSelect-BTh0khse.js","assets/js/rtl-Cr6c3OOr.js","assets/js/html2canvas.esm-Cq3pa7K9.js","assets/css/TopLeaderboard-Dw9a8_8K.css","assets/js/BehaviorIncidents-B4F6mpJF.js","assets/js/QBtnToggle-iboNob1y.js","assets/js/QBadge-IdEcTs8C.js","assets/js/QToolbar-CJXOhUim.js","assets/js/StudentCard-CbFaRqLr.js","assets/js/AvatarManager-DLzJfNWg.js","assets/js/CameraCapture-Dpv7Dqyp.js","assets/js/QFile-Cve4lAri.js","assets/js/use-file-DHXgO9tP.js","assets/js/QImg-BzYsb9cL.js","assets/css/CameraCapture-BSPKVu_J.css","assets/css/AvatarManager-C1Pqt1hB.css","assets/css/BarcodeScanner-tn0RQdqM.css","assets/js/IncidentPrintReport-D3Rszsm1.js","assets/css/IncidentPrintReport-BcWCgfP6.css","assets/js/StudentGrouping-BNa5Sd6u.js","assets/js/vuedraggable.umd-DshT_Vng.js","assets/js/index-SlSKjXnq.js","assets/css/StudentGrouping-CRYXuU7Q.css"])))=>i.map(i=>d[i]);
import{r as e,u as a,f as t,Q as l,p as s,b as o,t as n,d as r,i,j as d,k as u,c,aR as v,s as m,l as p,e as g,o as f,g as b,h as y,_ as h,G as x,aS as w,m as _}from"./app-DlLesFGi.js";import{Q as S}from"./QBtnToggle-iboNob1y.js";import{Q as k}from"./QBadge-IdEcTs8C.js";import{Q as $}from"./QTab-CYxYFXBq.js";import{Q as I}from"./QTabs-BClcf-CB.js";import{Q as C}from"./QTabPanel-DXa1fEFB.js";import{Q as j}from"./QTabPanels-CTgZWG49.js";import{Q as E}from"./QSpace-BK_PGLKv.js";import{Q as V}from"./QSelect-BTh0khse.js";import A from"./QuizMode-BeI1yfls.js";import{u as z}from"./i18n-B0T1C7j3.js";import{_ as T,f as U,o as P,k as D,M as N,a as F,af as L,N as R,J as q,b as B,R as O,I as M,O as Q,K as W,V as G,z as Y,l as J,W as H,F as K,Q as Z,S as X,y as ee,U as ae,E as te,ag as le,ah as se,aS as oe,Y as ne}from"./vendor-BWKGNkNB.js";import re from"./PointsDisplaySettings-DPPzcAOY.js";import ie from"./TimerRandomTools-DNUzQwdo.js";import de from"./ClassroomHelper-C1qKyV5s.js";import ue from"./StudentCard-CbFaRqLr.js";import ce from"./noise-WU7qH7c7.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-BqxRbB7W.js";import"./use-render-cache-CmTcazfP.js";import"./QuizNumpad-BoO7KE-q.js";import"./QCircularProgress-DK0g-hyO.js";import"./QTd-BU_S4ffH.js";import"./QTable-BIAJAIui.js";import"./QMarkupTable-CzIo4GGA.js";import"./QLinearProgress-CX6G9yBK.js";import"./use-fullscreen-BQHoXYBI.js";import"./AvatarManager-DLzJfNWg.js";import"./CameraCapture-Dpv7Dqyp.js";import"./QFile-Cve4lAri.js";import"./use-file-DHXgO9tP.js";import"./QImg-BzYsb9cL.js";const ve="/api",me={behaviors:`${ve}/behaviors`,studentBehaviors:`${ve}/student-behaviors`,pointActions:`${ve}/student-behaviors-point-actions`,leaderboard:`${ve}/leaderboard`,studentSummary:e=>`${ve}/student-behaviors/${e}/summary`,pointActionStatistics:e=>`${ve}/student-behaviors/${e}/statistics`,attendance:`${ve}/student-attendance`,attendanceBatch:`${ve}/student-attendance/batch`},pe="reward_sys_offline_queue";function ge(){try{const e=localStorage.getItem(pe);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading offline queue:",e),[]}}function fe(e){const a=ge();e.id=e.id||Date.now()+Math.random().toString(36).substr(2,9),e.timestamp=e.timestamp||Date.now(),e.status="pending",a.push(e),localStorage.setItem(pe,JSON.stringify(a)),console.log("üì¶ Action added to offline queue:",e)}async function be({classroomId:e,startDate:a,endDate:t,limit:l=10}){var s,o;try{const s=await T.get(me.leaderboard,{params:{classroom_id:e,start_date:a,end_date:t,limit:Math.min(l,50)}});return{success:!0,data:Array.isArray(s.data)?s.data:[]}}catch(n){return console.error("Error fetching leaderboard:",n),{success:!1,error:(null==(o=null==(s=n.response)?void 0:s.data)?void 0:o.message)||"Failed to fetch leaderboard",data:[],details:n}}}const ye={addPoint:async function(e,a,t=null,l="",s={}){var o,n;try{const o={student_behaviors_id:e,value:parseInt(a),reason_id:t?parseInt(t):null,note:l||null};if(!navigator.onLine&&!s.isSync)throw new Error("Network Error");return{success:!0,data:(await T.post(me.pointActions,o)).data,message:`Point ${a>0?"added":"deducted"} successfully`}}catch(r){return s.isSync||"Network Error"!==r.message&&navigator.onLine?(console.error("Error adding point:",r),{success:!1,error:(null==(n=null==(o=r.response)?void 0:o.data)?void 0:n.message)||"Failed to add point",details:r}):(fe({type:"addPoint",payload:{studentBehaviorsId:e,value:a,reasonId:t,note:l},desc:`Point ${a>0?"+":""}${a}`}),{success:!0,data:{id:"temp_"+Date.now(),value:parseInt(a),created_at:(new Date).toISOString(),offline:!0},message:"Saved offline. Will sync when online.",offline:!0})}},cancelPoint:async function(e,a){var t,l;try{return{success:!0,data:(await T.post(`${me.pointActions}/${e}/cancel`,{cancel_reason:a})).data,message:"Point action canceled successfully"}}catch(s){return console.error("Error canceling point:",s),{success:!1,error:(null==(l=null==(t=s.response)?void 0:t.data)?void 0:l.message)||"Failed to cancel point",details:s}}},restorePoint:async function(e){var a,t;try{return{success:!0,data:(await T.post(`${me.pointActions}/${e}/restore`)).data,message:"Point action restored successfully"}}catch(l){return console.error("Error restoring point:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to restore point",details:l}}},deletePoint:async function(e){var a,t;try{return{success:!0,data:(await T.delete(`${me.pointActions}/${e}`)).data,message:"Point action deleted successfully"}}catch(l){return console.error("Error deleting point:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to delete point",details:l}}},createStudentBehavior:async function(e){var a,t;try{const a={school_id:e.schoolId,student_behaviors_mains_id:e.studentBehaviorsMainsId,student_id:e.studentId,attend:e.attend||null,points_plus:e.pointsPlus||0,points_minus:e.pointsMinus||0,points_details:e.pointsDetails||"",notes:e.notes||null};return{success:!0,data:(await T.post(me.studentBehaviors,a)).data,message:"Student behavior record created successfully"}}catch(l){return console.error("Error creating student behavior:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to create behavior record",details:l}}},getStudentSummary:async function(e){var a,t;try{return{success:!0,data:(await T.get(me.studentSummary(e))).data}}catch(l){return console.error("Error fetching student summary:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch student summary",details:l}}},getPointActions:async function(e){var a,t;try{return{success:!0,data:(await T.get(me.pointActions,{params:{student_behaviors_id:e}})).data}}catch(l){return console.error("Error fetching point actions:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch point actions",details:l}}},getPointStatistics:async function(e){var a,t;try{return{success:!0,data:(await T.get(`${me.pointActions}/statistics/${e}`)).data}}catch(l){return console.error("Error fetching point statistics:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch statistics",details:l}}},fetchBehaviors:async function(){var e,a;try{const e=await T.get(me.behaviors);return{success:!0,data:Array.isArray(e.data)?e.data:[]}}catch(t){return console.error("Error fetching behaviors:",t),{success:!1,error:(null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||"Failed to fetch behaviors",data:[],details:t}}},applyBehaviorToStudents:async function(e,a,t={}){var l,s,o,n,r;const i=t.isSync||!1;if(!navigator.onLine&&!i)return fe({type:"applyBehaviorToStudents",payload:{studentIds:e,behaviorId:a,options:t},desc:`Batch behavior apply to ${e.length} students`}),{success:!0,data:[],results:e.map(e=>({studentId:e,success:!0,offline:!0})),message:`Saved offline. ${e.length} updates pending.`,offline:!0};try{const n=[],r=[],u="object"==typeof a?a.id:a;if(console.log("üéØ applyBehaviorToStudents called with:",{studentCount:e.length,behaviorIdInput:a,actualBehaviorId:u,behaviorIdType:typeof a}),!u||isNaN(u))return console.error("‚ùå Invalid behavior ID:",a),{success:!1,error:"Invalid behavior ID provided"};for(const a of e){const e={student_id:a,behavior_id:u,date:t.date||(new Date).toISOString().split("T")[0],period_code:t.periodCode||null,points_mode:t.points_mode||"session",notes:t.notes||null,custom_points:t.customPoints||null};console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),console.log("üì§ Sending behavior application request"),console.log("   Student ID:",a),console.log("   Behavior ID:",u),console.log("   Payload:",JSON.stringify(e,null,2)),console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");try{const t=await T.post(`${ve}/student-behaviors/quick-create`,e);n.push({studentId:a,success:!0,data:t.data})}catch(d){"Network Error"!==d.message||i?(console.error("‚ùå FAILED - Error applying behavior to student:",a,d),r.push({studentId:a,success:!1,error:(null==(s=null==(l=d.response)?void 0:l.data)?void 0:s.message)||"Failed to apply behavior",fullError:null==(o=d.response)?void 0:o.data})):r.push({studentId:a,success:!1,error:"Network Error",fullError:d})}}return console.log("üéØ BATCH RESULT:",{totalRequests:e.length,successful:n.length,failed:r.length,successRate:`${Math.round(n.length/e.length*100)}%`}),{success:0===r.length,results:n,errors:r,message:`Applied to ${n.length}/${e.length} students`}}catch(u){return i||"Network Error"!==u.message&&navigator.onLine?(console.error("‚ùå OUTER ERROR - Exception in applyBehaviorToStudents:",u),{success:!1,error:(null==(r=null==(n=u.response)?void 0:n.data)?void 0:r.message)||"Failed to apply behavior",details:u}):(fe({type:"applyBehaviorToStudents",payload:{studentIds:e,behaviorId:a,options:t},desc:`Batch behavior apply to ${e.length} students`}),{success:!0,data:[],results:e.map(e=>({studentId:e,success:!0,offline:!0})),message:`Saved offline. ${e.length} updates pending.`,offline:!0})}},fetchLeaderboard:be,getTopStudentsByPeriod:async function({classroomId:e,period:a="week",limit:t=5}){try{const l=new Date;let s;switch(a){case"week":default:s=new Date(l.getTime()-6048e5);break;case"month":s=new Date(l.getFullYear(),l.getMonth(),1);break;case"all":s=new Date("2020-01-01")}const o=e=>e.toISOString().split("T")[0];return be({classroomId:e,startDate:o(s),endDate:o(l),limit:t})}catch(l){return console.error("Error getting top students:",l),{success:!1,error:"Failed to get top students",data:[],details:l}}},updateAttendance:async function(e,a,t={}){var l,s,o;try{const r={student_id:parseInt(e),attend:Boolean(a),date:t.date||(new Date).toISOString().split("T")[0],period_code:t.periodCode||null,classroom_id:t.classroomId||null};try{const e=await T.post(me.attendance,r);return{success:!0,data:e.data,message:(null==(l=e.data)?void 0:l.message)||"Student marked as "+(a?"present":"absent")}}catch(n){return console.warn("Attendance API call failed, falling back to client-only update:",null==(s=null==n?void 0:n.response)?void 0:s.status),{success:!0,data:{studentId:parseInt(e),isPresent:Boolean(a),updatedAt:(new Date).toISOString()},message:`Student marked as ${a?"present":"absent"} (local)`,warning:(null==(o=n.response)?void 0:o.data)||n.message}}}catch(r){return console.error("Error updating attendance:",r),{success:!1,error:"Failed to update attendance",details:r}}},batchUpdateAttendance:async function(e,a={}){var t,l,s;try{if(!e||"object"!=typeof e)return{success:!1,error:"Invalid attendance data"};const n=Object.entries(e).map(([e,t])=>({student_id:parseInt(e),attend:Boolean(t),date:a.date||(new Date).toISOString().split("T")[0],period_code:a.periodCode||null,classroom_id:a.classroomId||null,updated_at:(new Date).toISOString()}));try{const e=await T.post(me.attendanceBatch,{attendance:n});return{success:!0,data:e.data,message:(null==(t=e.data)?void 0:t.message)||`Updated attendance for ${n.length} students`}}catch(o){return console.warn("Batch attendance API call failed, falling back to local update:",null==(l=null==o?void 0:o.response)?void 0:l.status),{success:!0,data:n,message:`Updated attendance for ${n.length} students (local)`,warning:(null==(s=o.response)?void 0:s.data)||o.message}}}catch(n){return console.error("Error batch updating attendance:",n),{success:!1,error:"Failed to batch update attendance",details:n}}},getRecentActions:async function({classroomId:e,date:a,limit:t=10}){var l,s;try{const l=await T.get(`${ve}/student-behaviors/recent-actions`,{params:{classroom_id:e,date:a,limit:t}});return{success:!0,data:Array.isArray(l.data.data)?l.data.data:[]}}catch(o){return console.error("Error fetching recent actions:",o),{success:!1,error:(null==(s=null==(l=o.response)?void 0:l.data)?void 0:s.message)||"Failed to fetch recent actions",data:[]}}},undoAction:async function(e,a="Undone by teacher",t={}){var l,s;if("string"==typeof e&&e.startsWith("temp_"))return function(e){const a=ge().filter(a=>a.id!==e);localStorage.setItem(pe,JSON.stringify(a))}(e.replace("temp_","")),{success:!0,message:"Offline action removed."};const o=t.isSync||!1;if(!navigator.onLine&&!o)return fe({type:"undoAction",payload:{actionId:e,reason:a},desc:`Undo action ${e}`}),{success:!0,message:"Undo saved offline.",offline:!0};try{const t=await T.post(`${ve}/student-behaviors/actions/${e}/cancel`,{cancel_reason:a});return{success:!0,data:t.data.data,message:t.data.message||"Action undone successfully"}}catch(n){return o||"Network Error"!==n.message&&navigator.onLine?(console.error("Error undoing action:",n),{success:!1,error:(null==(s=null==(l=n.response)?void 0:l.data)?void 0:s.message)||"Failed to undo action"}):(fe({type:"undoAction",payload:{actionId:e,reason:a},desc:`Undo action ${e}`}),{success:!0,message:"Undo saved offline.",offline:!0})}},formatPointValue:function(e){return e>0?`+${e} ‚≠ê`:e<0?`${e} ‚ö†Ô∏è`:"0"},getActionTypeLabel:function(e){return{plus:"Added",minus:"Deducted",cancel:"Canceled",revoke:"Revoked"}[e]||e},calculateTotalPoints:function(e,a=!1){return Array.isArray(e)?e.filter(e=>a||!e.canceled).reduce((e,a)=>e+(a.value||0),0):0},separatePoints:function(e){if(!Array.isArray(e))return{positive:0,negative:0};const a=e.filter(e=>!e.canceled);return{positive:a.filter(e=>e.value>0).reduce((e,a)=>e+a.value,0),negative:Math.abs(a.filter(e=>e.value<0).reduce((e,a)=>e+a.value,0))}},isActionEditable:function(e,a=24){try{const t=new Date(e);return(new Date-t)/36e5<a}catch(t){return!1}},getUserFriendlyErrorMessage:function(e){var a,t,l,s,o,n,r;return 401===(null==(a=e.response)?void 0:a.status)?"You are not authenticated. Please log in.":403===(null==(t=e.response)?void 0:t.status)?"You do not have permission to perform this action.":404===(null==(l=e.response)?void 0:l.status)?"The requested resource was not found.":422===(null==(s=e.response)?void 0:s.status)?"Invalid data provided. Please check your input.":500===(null==(o=e.response)?void 0:o.status)?"Server error. Please try again later.":"Network Error"===e.message?"Network error. Please check your connection.":(null==(r=null==(n=e.response)?void 0:n.data)?void 0:r.message)||"An unexpected error occurred."},retryWithBackoff:async function(e,a=3,t=1e3){let l;for(let o=0;o<a;o++)try{return await e()}catch(s){if(l=s,o<a-1){const e=t*Math.pow(2,o);await new Promise(a=>setTimeout(a,e))}}throw l}},he=new Map;async function xe(e){const a=Object.entries(e).map(([e,a])=>he.has(e)?Promise.resolve():new Promise(t=>{const l=new Audio(a);l.addEventListener("canplaythrough",()=>{he.set(e,l),t()},{once:!0}),l.addEventListener("error",()=>{console.warn(`Failed to preload sound "${e}"`),t()},{once:!0}),l.load()}));await Promise.all(a)}const we={class:"bg-gradient-to-br from-gray-800 to-gray-900 h-full"},_e={class:"text-3xl font-bold"},Se={class:"text-blue-100"},ke={class:"flex items-center justify-between bg-white p-4 rounded-lg border border-gray-200 shadow-sm"},$e={class:"flex items-center gap-4"},Ie={class:"bg-blue-100 p-3 rounded-full text-blue-600"},Ce={class:"text-sm text-gray-500 font-medium"},je={class:"text-lg font-bold text-gray-800 flex items-center gap-2"},Ee={key:0},Ve={key:1,class:"text-gray-400 italic"},Ae={class:"text-blue-600 font-mono bg-blue-50 px-2 py-0.5 rounded text-base"},ze={class:"text-xs text-gray-500 mt-1"},Te={key:0,class:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 rounded-lg border border-blue-200 shadow-sm"},Ue={class:"flex items-center justify-between flex-wrap gap-3"},Pe={class:"flex items-center gap-2"},De={class:"text-sm font-bold text-gray-700"},Ne={class:"flex items-center gap-3 flex-wrap"},Fe={key:0,class:"text-xs text-gray-500 bg-white px-2 py-1 rounded border border-dashed border-gray-300"},Le={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-blue-200"},Re={class:"flex flex-col"},qe={class:"text-xs text-gray-500"},Be={class:"text-lg font-bold text-blue-600"},Oe={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-green-200"},Me={class:"flex flex-col"},Qe={class:"text-xs text-gray-500"},We={class:"text-lg font-bold text-green-600"},Ge={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-red-200"},Ye={class:"flex flex-col"},Je={class:"text-xs text-gray-500"},He={class:"text-lg font-bold text-red-600"},Ke={key:0,class:"mt-3 pt-3 border-t border-blue-200"},Ze={class:"text-xs font-semibold text-gray-600 mb-2 flex items-center gap-1"},Xe={class:"bg-white border border-red-200 rounded-lg p-2"},ea={class:"flex flex-wrap gap-1.5"},aa={class:"sticky top-0 z-50 bg-white shadow-md border-b border-gray-200"},ta={class:"q-pa-sm flex justify-between items-center flex-nowrap gap-2"},la={class:"flex items-center gap-2 flex-nowrap overflow-hidden"},sa={class:"row no-wrap q-pa-md"},oa={key:0},na={key:1,class:"column items-center",style:{"min-width":"180px"}},ra={class:"column q-gutter-y-sm full-width"},ia={class:"q-py-sm"},da={class:"flex items-center gap-1 mx-2"},ua={class:"font-bold"},ca={class:"font-bold"},va={class:"font-bold"},ma={key:0,class:"flex items-center gap-1 overflow-hidden"},pa={class:"flex items-center ml-4 transition-all duration-300"},ga={key:0,class:"flex items-center text-gray-400 text-xs italic"},fa={key:1,class:"flex items-center gap-3 bg-gray-100 px-3 py-1 rounded-full border border-gray-200 shadow-sm animate-fade-in overflow-hidden"},ba=["src"],ya={class:"flex flex-col leading-none overflow-hidden"},ha={class:"text-sm font-bold text-gray-900 truncate max-w-[150px]"},xa={key:0,class:"text-xs text-blue-800 font-arabic font-bold mt-0.5 truncate max-w-[150px]"},wa={class:"flex items-center gap-2"},_a={style:{width:"420px","max-width":"90vw"}},Sa={key:0,class:"bg-blue-50 p-2 border-b border-blue-100"},ka={class:"text-xs font-bold text-blue-900 mb-1 flex justify-between items-center"},$a={class:"flex flex-wrap gap-1 max-h-[60px] overflow-y-auto custom-scrollbar"},Ia=["src"],Ca={class:"max-w-[80px] ellipsis"},ja={class:"row q-col-gutter-sm"},Ea=["onClick"],Va={class:"column items-center justify-center q-pa-xs bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md hover:border-blue-300 transition-all text-center h-full relative-position group hover:bg-blue-50",style:{"min-height":"80px"}},Aa={class:"text-[9px] font-bold text-gray-700 leading-tight flex items-center justify-center px-1 text-center h-[2.5em] overflow-hidden"},za={class:"mt-1"},Ta={class:"bg-green-50 text-green-700 text-[9px] font-bold px-1.5 py-0.5 rounded border border-green-100"},Ua={class:"row q-col-gutter-sm"},Pa=["onClick"],Da={class:"column items-center q-pa-sm bg-red-50 rounded-xl border border-red-100 shadow-sm hover:shadow-md hover:bg-red-100 transition-all text-center h-full relative-position"},Na={class:"text-caption text-weight-bold text-grey-9 ellipsis-2-lines leading-tight min-h-[2.5em] flex items-center justify-center"},Fa={class:"absolute-top-right q-ma-xs"},La={key:0,class:"bg-orange-50 p-1 text-center border-b border-orange-100 text-xs text-orange-800 font-bold"},Ra={class:"space-y-4"},qa={class:"flex justify-between items-center mb-4"},Ba={class:"text-xl font-bold"},Oa={class:"flex gap-2"},Ma={class:"flex flex-wrap justify-center gap-6 p-4 bg-gray-400"},Qa={class:""},Wa={class:"mt-6"},Ga={class:"row items-center q-gutter-x-sm"},Ya={class:"text-h6"},Ja={key:0,class:"text-gray-500 italic text-center py-4"},Ha=["src"],Ka={key:1,class:"mb-4 overflow-x-auto whitespace-nowrap p-2 bg-white rounded-lg shadow-sm border border-gray-100 flex gap-2 custom-scrollbar items-center"},Za={key:0,class:"mb-3 p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200"},Xa={class:"flex items-center justify-between"},et={class:"font-bold text-indigo-900 flex items-center gap-2"},at={class:"flex gap-2"},tt={class:"flex flex-wrap justify-center gap-6"},lt={class:"space-y-4"},st={class:"mb-4"},ot={class:"text-xl font-bold mb-2"},nt={class:"text-sm text-gray-600"},rt={class:"p-4 bg-red-50 rounded-lg border border-red-200"},it={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},dt={class:"mt-2 text-sm"},ut={class:"flex flex-wrap justify-center gap-6 p-4"},ct={class:"space-y-4"},vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},mt=["onClick"],pt={class:"flex items-start justify-between mb-3"},gt={class:"flex-1"},ft={class:"font-semibold text-lg"},bt={class:"text-xs text-gray-600"},yt={key:0,class:"text-xs text-red-600 mt-1"},ht={class:"space-y-2"},xt={class:"p-2 bg-green-100 rounded flex justify-between items-center"},wt={class:"text-sm font-bold text-green-900"},_t={class:"p-2 bg-red-100 rounded flex justify-between items-center"},St={class:"text-sm font-bold text-red-900"},kt={class:"p-2 bg-blue-100 rounded flex justify-between items-center"},$t={class:"text-lg font-bold text-blue-600"},It={class:"space-y-4"},Ct={class:"flex justify-between items-center mb-4"},jt={class:"text-xl font-bold"},Et={key:0,class:"text-center py-8"},Vt={class:"text-gray-500 text-lg"},At={class:"flex items-start justify-between"},zt={class:"flex-1"},Tt={class:"flex items-center gap-2 mb-1"},Ut={class:"font-bold text-lg"},Pt={class:"text-2xl"},Dt={class:"text-sm text-gray-700"},Nt={class:"text-xs text-gray-500 mt-1"},Ft={key:0,class:"text-xs text-gray-600 mt-1 italic"},Lt={key:1,class:"text-xs text-red-600 mt-1"},Rt={class:"flex flex-col h-full gap-4"},qt={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Bt={class:"space-y-6"},Ot={class:"flex justify-between items-center mb-6"},Mt={class:"text-2xl font-bold text-gray-800"},Qt={class:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200"},Wt={class:"flex items-center gap-3 mb-4"},Gt={class:"text-xl font-bold text-green-800"},Yt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Jt={class:"flex items-start justify-between mb-2"},Ht={class:"flex items-center gap-2"},Kt={class:"text-3xl"},Zt={class:"font-bold text-gray-800"},Xt={class:"text-xs text-gray-500"},el={class:"flex gap-1"},al={class:"flex items-center justify-between mt-3 pt-3 border-t border-green-100"},tl={class:"text-lg font-bold text-green-600"},ll={key:0,class:"text-center py-8 text-gray-400"},sl={class:"bg-gradient-to-r from-red-50 to-rose-50 rounded-xl p-6 border border-red-200"},ol={class:"flex items-center gap-3 mb-4"},nl={class:"text-xl font-bold text-red-800"},rl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},il={class:"flex items-start justify-between mb-2"},dl={class:"flex items-center gap-2"},ul={class:"text-3xl"},cl={class:"font-bold text-gray-800"},vl={class:"text-xs text-gray-500"},ml={class:"flex gap-1"},pl={class:"flex items-center justify-between mt-3 pt-3 border-t border-red-100"},gl={class:"text-lg font-bold text-red-600"},fl={key:0,class:"text-center py-8 text-gray-400"},bl={class:"text-2xl font-semibold text-gray-600"},yl={class:"font-bold text-blue-900 flex items-center gap-2 text-base md:text-lg"},hl={class:"md:hidden"},xl={class:"flex-1 overflow-y-auto p-3 custom-scrollbar"},wl={key:0,class:"text-center py-4 text-gray-400 italic text-sm"},_l={key:1,class:"flex flex-col gap-2"},Sl={class:"flex flex-col leading-tight overflow-hidden w-full"},kl={class:"font-bold text-sm md:text-base truncate"},$l={class:"p-2 border-t border-blue-200 bg-white"},Il={class:"grid grid-cols-3 gap-2"},Cl={class:"flex-1 flex flex-col bg-white order-1 md:order-2 h-full overflow-hidden"},jl={key:0,class:"bg-white border-b border-gray-100 p-3 flex justify-center items-center"},El={class:"flex items-center gap-2"},Vl={class:"text-lg font-bold text-gray-800"},Al={class:"text-base md:text-xl flex items-center gap-2"},zl={class:"hidden xs:inline"},Tl={class:"bg-white/60 p-1 rounded-full flex gap-1 shadow-sm border border-white/60 backdrop-blur-sm"},Ul={class:"flex flex-wrap gap-2 justify-center md:gap-3 pb-20 md:pb-0"},Pl=["onClick"],Dl={class:"font-bold text-sm md:text-base leading-tight text-gray-800 line-clamp-2 md:line-clamp-3 w-full"},Nl={class:"flex justify-between items-center"},Fl={class:"text-h6"},Ll=["src"],Rl={class:"text-h5 font-bold mb-1"},ql={class:"text-h3 font-black my-2 flex items-center gap-2 animate-bounce"},Bl={class:"text-4xl"},Ol={class:"text-subtitle1 opacity-90 font-medium bg-white/20 px-4 py-1 rounded-full"},Ml=e({__name:"reward_sys",props:{isDialog:{type:Boolean,default:!1},classroomId:{type:Number,default:null},subjectId:{type:Number,default:null},period:{type:Number,default:null},date:{type:String,default:null},week:{type:Number,default:null},initialTab:{type:String,default:"positive"}},setup(e){const ve=e,me=oe(()=>h(()=>import("./TopLeaderboard-DdLlFtU_.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),pe=oe(()=>h(()=>import("./BehaviorIncidents-B4F6mpJF.js"),__vite__mapDeps([11,1,2,3,4,5,6,12,13,14,7,8,15,16,17,18,19,20,21,22,23,24,25]))),ge=oe(()=>h(()=>import("./StudentGrouping-BNa5Sd6u.js"),__vite__mapDeps([26,1,2,3,4,5,6,27,28,29]))),fe={select:"/audio/click-234708.mp3",reward:"/audio/purchase-success-384963.mp3",penalty:"/audio/error-010-206498.mp3"},be=U(null),Ml=U(!1);P(()=>{!function(e){"requestIdleCallback"in window?requestIdleCallback(()=>xe(e),{timeout:2e3}):setTimeout(()=>xe(e),1e3)}(fe);const e=localStorage.getItem("reward-system-bg-music");Ml.value="true"===e,be.value&&(be.value.volume=.1,Ml.value&&be.value.play().catch(e=>console.log("Autoplay prevented:",e)))}),D(Ml,e=>{localStorage.setItem("reward-system-bg-music",e),be.value&&(e?be.value.play().catch(e=>console.log("Playback error:",e)):be.value.pause())});const Ql=e=>{!async function(e,a){if(!a[e])return void console.warn(`Sound key "${e}" not found in soundFiles`);if(!he.has(e)){const t=new Audio(a[e]);await new Promise((e,a)=>{t.addEventListener("canplaythrough",e,{once:!0}),t.addEventListener("error",a,{once:!0}),t.load()}).catch(a=>{console.warn(`Failed to load sound "${e}":`,a)}),he.set(e,t)}const t=he.get(e);t&&(t.currentTime=0,t.play().catch(e=>console.log("Sound play error:",e)))}(e,fe)},{t:Wl,locale:Gl}=z(),Yl=e=>e?"ar"===Gl.value&&e.name_ar?e.name_ar:e.name:"",Jl=N(),Hl=F(()=>{var e,a;const t=null==(a=null==(e=Jl.props.auth)?void 0:e.user)?void 0:a.school;return Array.isArray(t)&&t.length>0?t[0].logo_url:null}),Kl=F(()=>{const e=new Map;return ss.value.forEach(a=>{a.subject_id&&!e.has(a.subject_id)&&e.set(a.subject_id,{id:a.subject_id,name:a.subject_name,name_ar:a.subject_name_ar})}),Array.from(e.values())});F(()=>is.value?ss.value.filter(e=>e.subject_id===is.value):[]);const Zl=F(()=>{const e=os.value.length;if(0===e)return{present:0,absent:0,absentList:[]};const a=os.value.filter(e=>ys.value[e.id]).length;return{present:a,absent:e-a,absentList:os.value.filter(e=>!ys.value[e.id])}}),Xl=()=>{const e=Zl.value.absentList.map(e=>"ar"===Gl.value&&e.name_ar?e.name_ar:e.name).join("\n");e&&navigator.clipboard.writeText(e).then(()=>{es.notify({message:Wl("rewardSys.session.copied"),color:"positive",icon:"content_copy",position:"top"})}).catch(e=>{console.error("Failed to copy: ",e)})};U("https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf");const es=a(),as=U(ve.initialTab||"positive"),ts=U("positive");D(()=>ve.initialTab,e=>{e&&(as.value=e)});const ls=U("behavior_incidents");D(as,(e,a)=>{localStorage.setItem("reward-system-active-tab",e),e!==a&&(fs.value=[])});const ss=U([]),os=U([]),ns=U([]),rs=U(null),is=U(null),ds=U((new Date).toISOString().split("T")[0]),us=U(1),cs=U(1),vs=U(1),ms=U(1),ps=U(null),gs=U(null),fs=U([]),bs=U({}),ys=U({}),hs=U({}),xs=U([]);U([]);const ws=U(!1),_s=U(!1),Ss=U(!1),ks=U(!1),$s=U(!1),Is=U(null),Cs=U(null),js=U({message:"",created:0,skipped:0}),Es=U(!1),Vs=U(!1),As=U(!1),zs=U("positive"),Ts=U(null),Us=U("no_groups"),Ps=U([]),Ds=U(!1),Ns=U(null),Fs=U(!1),Ls=U(localStorage.getItem("points-display-mode")||"overall"),Rs=U({}),qs=U(localStorage.getItem("competition-start-time")||null),Bs=U(localStorage.getItem("custom-date-from")||null),Os=U(localStorage.getItem("custom-date-to")||null),Ms=U(localStorage.getItem("leaderboard-mode")||"top5"),Qs=U("individual"),Ws=U("false"!==localStorage.getItem("reward-system-read-aloud"));D(Ws,e=>{localStorage.setItem("reward-system-read-aloud",e)});const Gs=U(!1),Ys=U(null),Js=U(!1),Hs=U({name:"",type:"positive",points:0,icon:""}),Ks=U(!1),Zs=U({student:null,behavior:null,points:0}),Xs=U(!1),eo=U(null),ao=U(null);function to(e){"attendance"!==as.value?"selection"!==Qs.value?(fs.value=[e],function(e){if(0===fs.value.length)return void es.notify({message:"Please select students first",color:"warning",position:"top"});zs.value=e,Ts.value=null,As.value=!0}("positive")):zo(e):qo(e)}D(is,e=>{null!==e&&(localStorage.setItem("reward-system-selected-subject-id",e.toString()),console.log(`üíæ Saved subject to localStorage: ${e}`))}),D(rs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-classroom-id",e.toString()),console.log(`üíæ Saved classroom to localStorage: ${e}`))}),D(us,e=>{null!==e&&(localStorage.setItem("reward-system-selected-semester",e.toString()),console.log(`üíæ Saved semester to localStorage: ${e}`))}),D(cs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-week",e.toString()),console.log(`üíæ Saved week to localStorage: ${e}`))}),D(vs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-day",e.toString()),console.log(`üíæ Saved day to localStorage: ${e}`))}),D(ms,e=>{null!==e&&(localStorage.setItem("reward-system-selected-period-number",e.toString()),console.log(`üíæ Saved period number to localStorage: ${e}`))}),D(ds,e=>{if(e){const a=new Date(e);vs.value=a.getDay()+1,console.log(`üìÖ Date changed to ${e}, Day updated to ${vs.value}`)}});const lo=F(()=>`${us.value}.${cs.value}.${vs.value}.${ms.value}`);F(()=>{const e=ss.value.find(e=>e.classroom_id===rs.value);return e?e.classroom_name:Wl("rewardSys.session.unknownClass")}),F(()=>{const e=Kl.value.find(e=>e.subject_id===is.value);return e?"ar"===Gl.value&&e.subject_name_ar?e.subject_name_ar:e.subject_name:""});const so=F(()=>os.value.filter(e=>ys.value[e.id]).length),oo=F(()=>os.value.filter(e=>!ys.value[e.id]).length),no=U(!1),ro=U("present"),io=F(()=>"all"===ro.value?os.value:"selected"===ro.value?os.value.filter(e=>fs.value.includes(e.id)):os.value.filter(e=>"present"===ro.value?ys.value[e.id]:!ys.value[e.id]));function uo(e){ro.value=e,no.value=!0}function co(){const e=io.value.map(e=>e.name).join("\n");navigator.clipboard.writeText(e).then(()=>{})}function vo(e){if(!e||!e.avatar)return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>");const a=e.avatar;return a.startsWith("http")||a.startsWith("data:")||a.startsWith("/")?a:`/${a}`}const mo=U(JSON.parse(localStorage.getItem("behaviorUsage")||"{}"));F(()=>Object.keys(mo.value).sort((e,a)=>{const t=mo.value[e],l=mo.value[a];return t.count!==l.count?l.count-t.count:l.lastUsed-t.lastUsed}).map(e=>ns.value.find(a=>a.id==e)).filter(e=>e&&("positive"===e.type||"reward"===e.type||(e.value||e.points||0)>0)).slice(0,5));const po=F(()=>{console.log("üîç All behaviors:",ns.value);const e=ns.value.filter(e=>{if(e.type)return"positive"===e.type||"reward"===e.type;return(e.value||e.points||0)>0});return console.log("‚úÖ Positive behaviors:",e),e}),go=F(()=>{const e=ns.value.filter(e=>{if(e.type)return"negative"===e.type||"penalty"===e.type;return(e.value||e.points||0)<0});return console.log("‚ö†Ô∏è Negative behaviors:",e),e}),fo=F(()=>[{label:"No Groups",value:"no_groups",icon:"grid_view"},{label:"Name (A‚ÜíZ)",value:"name_asc",icon:"sort_by_alpha"},{label:"Name (Z‚ÜíA)",value:"name_desc",icon:"sort_by_alpha"},...Ps.value.map(e=>({label:e.name,value:e.id,icon:"groups"}))]);F(()=>{const e=fo.value.find(e=>e.value===Us.value);return(null==e?void 0:e.icon)||"grid_view"});const bo=U(null),yo=F(()=>{const e=new Set;return os.value.forEach(a=>{let t=a.firstName||a.name||"";t.length>=2&&e.add(t.substring(0,2).toUpperCase())}),Array.from(e).sort()});const ho=F(()=>{let e=os.value;if(bo.value&&(e="__SELECTED__"===bo.value?os.value.filter(e=>fs.value.includes(e.id)):"__UNSELECTED__"===bo.value?os.value.filter(e=>!fs.value.includes(e.id)):os.value.filter(e=>(e.firstName||e.name||"").toUpperCase().startsWith(bo.value))),"no_groups"===Us.value)return[{name:null,students:e}];if("name_asc"===Us.value){return[{name:null,students:[...e].sort((e,a)=>(e.firstName||"").localeCompare(a.firstName||""))}]}if("name_desc"===Us.value){return[{name:null,students:[...e].sort((e,a)=>(a.firstName||"").localeCompare(e.firstName||""))}]}const a=Ps.value.find(e=>e.id===Us.value);if(!a)return[{name:null,students:e}];const t=a.groups.map(a=>({name:a.name,students:e.filter(e=>a.student_ids.includes(e.id))})).filter(e=>e.students.length>0),l=new Set(a.groups.flatMap(e=>e.student_ids)),s=e.filter(e=>!l.has(e.id));return s.length>0&&t.push({name:"Unassigned",students:s}),t});function xo(){const e=os.value.filter(e=>ys.value[e.id]);fs.value=e.map(e=>e.id)}function wo(){const e=os.value.filter(e=>ys.value[e.id]),a=new Set(fs.value),t=[];e.forEach(e=>{a.has(e.id)||t.push(e.id)}),fs.value=t}async function _o(){if(!Ts.value)return;const e=ns.value.find(e=>e.id===Ts.value),a="individual"===Qs.value&&1===fs.value.length,t=a?os.value.find(e=>e.id===fs.value[0]):null;if("positive"===zs.value?(ps.value=Ts.value,await async function(){await Fo(ps.value),ps.value=null}()):(gs.value=Ts.value,await No()),a&&t&&e){Zs.value={student:t,behavior:e,points:e.value||e.points||0};const a=e.value||e.points||0,l=`${a} points`;setTimeout(()=>{!function(e){if(!window.speechSynthesis||!Ws.value)return;window.speechSynthesis.cancel();const a=new SpeechSynthesisUtterance(e);a.rate=1,a.pitch=1,a.volume=1,window.speechSynthesis.speak(a)}(`${function(e){const a="ar"===Gl.value&&e.name_ar?e.name_ar:e.name;if(!a)return"Student";if("ar"!==Gl.value&&e.firstName)return`${e.firstName} ${e.secondName||""}`.trim();const t=a.trim().split(/\s+/).filter(e=>e.length>0);if(t.length>0)return`${t[0]} ${t.length>1?t[1]:""}`.trim();return a}(t)}. ${l}.`)},300),Ks.value=!0,setTimeout(()=>{Ks.value=!1},2500)}As.value=!1,Ts.value=null}const So=U(null);let ko=null;function $o(e){ko&&clearTimeout(ko),So.value=e}function Io(){ko&&clearTimeout(ko),ko=setTimeout(()=>{So.value=null},3e3)}async function Co(e){var a,t;const l=Ps.value.findIndex(a=>a.id===e.id);l>=0?Ps.value[l]=e:Ps.value.push(e);try{const a=await T.post("/api/classroom-layouts/save",{classroom_id:rs.value,layouts:Ps.value});if(!a.data.success)throw new Error(a.data.message||"Failed to save layout");es.notify({message:`Layout "${e.name}" saved successfully!`,color:"positive",position:"top",icon:"check_circle"}),Us.value=e.id,Ds.value=!1,Ns.value=null}catch(s){if(console.error("Error saving layout:",s),es.notify({message:"Failed to save layout: "+((null==(t=null==(a=s.response)?void 0:a.data)?void 0:t.message)||s.message),color:"negative",position:"top",icon:"error"}),l>=0)Ps.value.splice(l,1);else{const a=Ps.value.findIndex(a=>a.id===e.id);a>=0&&Ps.value.splice(a,1)}}}async function jo(e){var a,t;const l=Ps.value.findIndex(a=>a.id===e);if(l<0)return;const s=Ps.value[l];Ps.value.splice(l,1),Us.value===e&&(Us.value="no_groups");try{const e=await T.post("/api/classroom-layouts/save",{classroom_id:rs.value,layouts:Ps.value});if(!e.data.success)throw new Error(e.data.message||"Failed to delete layout");es.notify({message:`Layout "${s.name}" deleted successfully!`,color:"positive",position:"top",icon:"delete"})}catch(o){console.error("Error deleting layout:",o),es.notify({message:"Failed to delete layout: "+((null==(t=null==(a=o.response)?void 0:a.data)?void 0:t.message)||o.message),color:"negative",position:"top",icon:"error"}),Ps.value.splice(l,0,s),"no_groups"===Us.value&&(Us.value=e)}}function Eo(e){e?(Ys.value=e,Hs.value={name:e.name,type:e.type||(e.value>0?"positive":"negative"),points:e.value||e.points||0,icon:e.icon||""}):(Ys.value=null,Hs.value={name:"",type:"positive",points:0,icon:""}),Gs.value=!0}async function Vo(){var e,a;if(Hs.value.name&&Hs.value.type&&null!==Hs.value.points){Js.value=!0;try{const e={name:Hs.value.name,name_ar:Hs.value.name_ar||null,type:Hs.value.type,value:Hs.value.points,points:Hs.value.points,icon:Hs.value.icon||null,school_id:1,year_id:2};if(Ys.value){const a=await T.put(`/api/behaviors/${Ys.value.id}`,e),t=ns.value.findIndex(e=>e.id===Ys.value.id);t>=0&&(ns.value[t]=a.data),es.notify({message:"Behavior updated successfully!",color:"positive",icon:"check_circle"})}else{const a=await T.post("/api/behaviors",e);ns.value.push(a.data),es.notify({message:"Behavior created successfully!",color:"positive",icon:"check_circle"})}Gs.value=!1,Ys.value=null}catch(t){console.error("Error saving behavior:",t),es.notify({message:"Failed to save behavior: "+((null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||t.message),color:"negative",icon:"error"})}finally{Js.value=!1}}else es.notify({message:"Please fill in all required fields",color:"warning",position:"top"})}function Ao(e){es.dialog({title:"Confirm Delete",message:`Are you sure you want to delete "${e.name}"? This action cannot be undone.`,cancel:!0,persistent:!0,color:"negative"}).onOk(()=>{!async function(e){var a,t;try{await T.delete(`/api/behaviors/${e.id}`);const a=ns.value.findIndex(a=>a.id===e.id);a>=0&&ns.value.splice(a,1),es.notify({message:"Behavior deleted successfully!",color:"positive",icon:"check_circle"})}catch(l){console.error("Error deleting behavior:",l),es.notify({message:"Failed to delete behavior: "+((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||l.message),color:"negative",icon:"error"})}}(e)})}function zo(e){if(!ys.value[e])return void es.notify({message:"Cannot select absent students",color:"warning",position:"top",timeout:1e3});const a=fs.value.indexOf(e);-1===a?(fs.value.push(e),Ql("select")):fs.value.splice(a,1)}function To(e,a){if(a){const a=e.filter(e=>ys.value[e.id]).map(e=>e.id),t=new Set(fs.value);a.forEach(e=>t.add(e)),fs.value=Array.from(t),Ql("select")}else{const a=new Set(e.map(e=>e.id));fs.value=fs.value.filter(e=>!a.has(e))}}function Uo(){fs.value=[]}async function Po(e){if(!e)return os.value=[],fs.value=[],void(Ps.value=[]);try{_s.value=!0,os.value=[],fs.value=[],Cs.value=null,js.value={message:"",created:0,skipped:0},await async function(){if(rs.value)try{const e=await T.get("/api/classroom-layouts/load",{params:{classroom_id:rs.value}});e.data.success&&(Ps.value=e.data.data||[])}catch(e){console.error("Error loading layouts:",e)}}()}catch(a){console.error("Failed to load classroom:",a),es.notify({message:"Failed to load classroom: "+a.message,color:"negative",position:"top"})}finally{_s.value=!1}}async function Do(){if(rs.value){_s.value=!0,js.value={message:"Initializing...",created:0,skipped:0};try{const e={classroom_id:rs.value,date:ds.value,period_code:lo.value,points_mode:"from_now"===Ls.value?"overall":Ls.value},a=await T.post("/api/student-behaviors/init-classroom",e);if(a&&a.data){const e=a.data;Cs.value=e.student_behaviors_mains_id,js.value={message:`Session initialized (created ${e.created}, skipped ${e.skipped}, mode: ${e.points_mode})`,created:e.created,skipped:e.skipped};const t=e.student_behaviors||[],l=t.map(e=>e.student?{id:e.student.id,name:e.student.name||`Student ${e.student_id}`,name_ar:e.student.name_ar,firstName:e.student.first_name,secondName:e.student.second_name,lastName:e.student.last_name,avatar:e.student.avatar,behaviorRecordId:e.id}:null).filter(e=>null!==e);os.value=l,fs.value=[];const s={};for(const a of t)ys.value[a.student_id]=void 0===a.attend||a.attend,s[a.student_id]={attend:void 0===a.attend||a.attend,points_plus:a.points_plus||0,points_minus:a.points_minus||0,academic_tracker:a.academic_tracker||{},behavior_tracker:a.behavior_tracker||[],logistics_tracker:a.logistics_tracker||{}};bs.value=s,es.notify({message:"Session initialized",color:"positive",position:"top"}),await Qo()}}catch(e){console.error("Failed to init classroom session:",e),js.value={message:"Initialization failed",created:0,skipped:0},es.notify({message:"Failed to init session: "+(e.message||"error"),color:"negative",position:"top"})}finally{_s.value=!1}}}async function No(){await Fo(gs.value),gs.value=null}async function Fo(e){var a;if(fs.value.length&&e)try{Ss.value=!0;const t=await ye.applyBehaviorToStudents(fs.value,e,{date:ds.value,periodCode:lo.value,classroomId:rs.value,points_mode:"from_now"===Ls.value?"overall":Ls.value});if(t.results&&t.results.length>0){t.results.forEach(e=>{if(e.success&&e.data){const a=e.studentId,t=e.data;bs.value[a]||(bs.value[a]={points_plus:0,points_minus:0,attend:!0}),bs.value[a]&&(bs.value[a].points_plus=t.points_plus,bs.value[a].points_minus=t.points_minus,void 0!==t.attend&&(bs.value[a].attend=t.attend,ys.value[a]=t.attend))}});const a=ns.value.find(a=>a.id===e);if(a){const e=a.value||a.points||0;e>0&&Ql("reward"),e<0&&Ql("penalty")}"individual"===Qs.value&&1===t.results.length||es.notify({message:`Applied behavior to ${t.results.length} students`+(t.errors&&t.errors.length?` (${t.errors.length} failed)`:""),color:t.errors&&t.errors.length?"warning":"positive",position:"top"}),await Qo(),fs.value=[]}if(t.errors&&t.errors.length>0)console.error("Partial or full failure:",t.errors),0===t.results.length&&es.notify({message:t.error||"Failed to apply behavior to selected students",color:"negative",position:"top"});else{const e=t.results.length;if(e>0&&xs.value.length>0){const l=xs.value.slice(0,e).map(e=>({actionId:e.id,studentId:e.student_id,offline:!1})),s=t.results.filter(e=>e.offline).map(e=>{var a;return{actionId:(null==(a=e.data)?void 0:a.id)||"temp_"+Date.now(),studentId:e.studentId,offline:!0}}),o=s.length>0?s:l;o.length>0&&(a={type:"point_action",actions:o,desc:1===e?"Last Action":`Group Action (${e})`},Lo.value.push(a),Lo.value.length>10&&Lo.value.shift())}}}catch(t){console.error("Error applying behavior:",t),es.notify({message:t.message||"Error applying behavior",color:"negative",position:"top"})}finally{Ss.value=!1}}D(Ls,e=>{if("from_now"===e){const e={};for(const[a,t]of Object.entries(bs.value))e[a]={plus:t.points_plus||0,minus:t.points_minus||0};Rs.value=e}else Do()});const Lo=U([]);async function Ro(){if(0===Lo.value.length)return;const e=Lo.value.pop();es.loading.show({message:"Undoing..."});try{let a=0;for(const t of e.actions){(await ye.undoAction(t.actionId)).success&&a++}a>0?(es.notify({message:"Undone successfully",color:"positive",icon:"undo",position:"top"}),Qo(),Do()):es.notify({message:"Failed to undo action",color:"warning",position:"top"})}catch(a){console.error("Undo failed",a),es.notify({message:"Undo failed",color:"negative",position:"top"})}finally{es.loading.hide()}}async function qo(e,a){const t=void 0===ys.value[e]||ys.value[e],l=!t;if(!1===l){const a=bs.value[e];if(a&&(a.points_plus>0||a.points_minus>0))return void es.dialog({title:"Warning",message:`This student has ${a.points_plus} positive and ${a.points_minus} negative points for this session. Marking them absent will remove all their points for this session. Continue?`,cancel:!0,persistent:!0,ok:{label:"Yes, Mark Absent",color:"negative"},cancel:{label:"Cancel",color:"grey"}}).onOk(async()=>{await Bo(e,l,t)})}await Bo(e,l,t)}async function Bo(e,a,t){ys.value[e]=a,hs.value[e]=!0,Ql("select");try{const t=await ye.updateAttendance(e,a,{date:ds.value,periodCode:lo.value,classroomId:rs.value});if(!t.success)throw new Error(t.error||"Failed to update attendance");es.notify({message:t.message||"Attendance updated",color:"positive",position:"top"}),!1===a&&await Do()}catch(l){console.error("Failed to persist attendance for",e,l),ys.value[e]=t,es.notify({message:"Failed to update attendance. Reverted.",color:"negative",position:"top"})}finally{hs.value[e]=!1}}async function Oo(){ks.value=!0;const e={};for(const t of os.value)e[t.id]=!0,ys.value[t.id]=!0;try{(await ye.batchUpdateAttendance(e,{date:ds.value,periodCode:lo.value,classroomId:rs.value})).success&&es.notify({message:"All students marked present",color:"positive",position:"top"})}catch(a){console.error("Failed to mark all present:",a),es.notify({message:"Failed to mark all present",color:"negative",position:"top"})}finally{ks.value=!1}}async function Mo(){ks.value=!0;const e={};for(const t of os.value)e[t.id]=!1,ys.value[t.id]=!1;try{(await ye.batchUpdateAttendance(e,{date:ds.value,periodCode:lo.value,classroomId:rs.value})).success&&es.notify({message:"All students marked absent",color:"warning",position:"top"})}catch(a){console.error("Failed to mark all absent:",a),es.notify({message:"Failed to mark all absent",color:"negative",position:"top"})}finally{ks.value=!1}}async function Qo(){$s.value=!0;try{const e=await ye.getRecentActions({classroomId:rs.value,date:ds.value,limit:10});e.success?xs.value=e.data:console.error("Failed to load history:",e.error)}catch(e){console.error("Error loading history:",e)}finally{$s.value=!1}}function Wo(e){if(!e)return"";return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Go(){localStorage.setItem("points-display-mode",Ls.value),qs.value?localStorage.setItem("competition-start-time",qs.value):localStorage.removeItem("competition-start-time"),Bs.value&&localStorage.setItem("custom-date-from",Bs.value),Os.value&&localStorage.setItem("custom-date-to",Os.value),localStorage.setItem("leaderboard-mode",Ms.value),Fs.value=!1,rs.value&&Do(),es.notify({message:"Points display settings applied",color:"positive",position:"top",icon:"check_circle"})}function Yo(){Ls.value="overall",qs.value=null,Bs.value=null,Os.value=null,Ms.value="top5",localStorage.removeItem("points-display-mode"),localStorage.removeItem("competition-start-time"),localStorage.removeItem("custom-date-from"),localStorage.removeItem("custom-date-to"),localStorage.removeItem("leaderboard-mode"),Fs.value=!1,rs.value&&Do(),es.notify({message:"Reset to normal view",color:"info",position:"top"})}async function Jo(e){console.log("Incident recorded:",e),await Do(),es.notify({message:"Behavior incident recorded (-1 point)",color:"warning",position:"top"})}P(async()=>{var e,a;if(Es.value)console.log("‚è≠Ô∏è Skipping re-initialization - component already initialized");else try{console.log("üöÄ Initializing reward system...");const l=await T.get("/my_classes_with_students");ss.value=l.data,console.log(`‚úÖ Loaded ${ss.value.length} classrooms`);let s=!1;if(ve.classroomId&&ve.subjectId){console.log("üéØ Props detected (dialog mode) - auto-initializing..."),rs.value=ve.classroomId,is.value=ve.subjectId;try{const t=null==(a=null==(e=N().props.auth)?void 0:e.school)?void 0:a.active_semester_id;t?(us.value=parseInt(t),console.log(`üè´ Active Semester from Inertia: ${us.value}`)):us.value=1}catch(t){console.warn("Could not fetch active semester, defaulting to 1",t),us.value=1}ve.date?ds.value=ve.date:ds.value=(new Date).toISOString().split("T")[0];const l=new Date(ds.value);vs.value=l.getDay()+1,ve.period&&(ms.value=ve.period),ve.week&&(cs.value=ve.week,console.log(`üìÖ Props Week: ${ve.week}`)),s=!0,console.log(`üìö Props Subject: ${ve.subjectId}`),console.log(`üè´ Props Classroom: ${ve.classroomId}`),console.log(`üìÖ Props Date: ${ds.value}`),console.log(`‚ö° Calc Day: ${vs.value}`),console.log(`üî¢ Props Period: ${ve.period}`)}else{const e=new URLSearchParams(window.location.search),a=e.get("classroom_id"),t=e.get("subject_id"),l=e.get("period"),o=e.get("date");if(a&&t)console.log("üîó URL parameters detected - auto-initializing..."),rs.value=parseInt(a),is.value=parseInt(t),ds.value=o||(new Date).toISOString().split("T")[0],l&&(ms.value=parseInt(l)),s=!0,console.log(`üìö URL Subject: ${t}`),console.log(`üè´ URL Classroom: ${a}`),console.log(`üìÖ URL Date: ${ds.value}`),console.log(`üî¢ URL Period: ${l}`);else{const e=localStorage.getItem("reward-system-selected-subject-id"),a=localStorage.getItem("reward-system-selected-classroom-id");e&&Kl.value.some(a=>a.id===parseInt(e))?(is.value=parseInt(e),console.log(`üìö Restored subject from localStorage: ${e}`)):Kl.value.length>0&&(is.value=Kl.value[0].id,console.log(`üìö Auto-selected first subject: ${Kl.value[0].name}`)),a&&ss.value.some(e=>e.classroom_id===parseInt(a))&&(rs.value=parseInt(a),console.log(`üè´ Restored classroom from localStorage: ${a}`));const t=localStorage.getItem("reward-system-active-tab");t&&(as.value=t);const l=localStorage.getItem("reward-system-selected-semester"),s=localStorage.getItem("reward-system-selected-week"),o=localStorage.getItem("reward-system-selected-day"),n=localStorage.getItem("reward-system-selected-period-number");l&&(us.value=parseInt(l),console.log(`üìÖ Restored semester from localStorage: ${l}`)),s&&(cs.value=parseInt(s),console.log(`üìÖ Restored week from localStorage: ${s}`)),o&&(vs.value=parseInt(o),console.log(`üìÖ Restored day from localStorage: ${o}`)),n&&(ms.value=parseInt(n),console.log(`üìÖ Restored period number from localStorage: ${n}`))}}console.log(`üî¢ Active Period Code: ${us.value}.${cs.value}.${vs.value}.${ms.value}`);const o=await ye.fetchBehaviors();o.success?(ns.value=o.data,console.log(`‚úÖ Loaded ${ns.value.length} behaviors`),console.log("üìã Behaviors data:",ns.value),ns.value=ns.value.map(e=>({...e,value:e.value||e.points||0})),console.log("üìã Normalized behaviors:",ns.value)):(console.error("‚ùå Failed to load behaviors:",o.error),es.notify({message:"Failed to load behaviors: "+o.error,color:"negative",position:"top"})),console.log("‚úÖ Reward system initialized"),Es.value=!0,s&&rs.value&&(console.log("üöÄ Auto-initializing classroom session..."),await Po(rs.value),await Do(),function(e,a=3e3){eo.value=e,ao.value&&clearTimeout(ao.value),ao.value=setTimeout(()=>{eo.value=null},a)}(ve.isDialog?"Session loaded!":"Session loaded from schedule!",3e3))}catch(l){console.error("‚ùå Failed to initialize reward system:",l),es.notify({message:"Failed to initialize reward system: "+l.message,color:"negative",position:"top"})}});const Ho=U(!1),Ko=()=>{Ho.value=!0,Ls.value="from_now"},Zo=async({studentId:e,points:a,behaviorName:t,behaviorId:l})=>{let s=l,o=a>=0;if(s||(o&&po.value.length?s=po.value[0].id:!o&&go.value.length?s=go.value[0].id:ns.value.length&&(s=ns.value[0].id)),s){bs.value[e]||(bs.value[e]={points_plus:0,points_minus:0,attend:!0}),o?bs.value[e].points_plus+=Math.abs(a):bs.value[e].points_minus+=Math.abs(a);try{await ye.applyBehaviorToStudents([e],s,{date:ds.value,periodCode:lo.value,classroomId:rs.value,points_mode:"session",customPoints:Math.abs(a),notes:t})}catch(n){console.error(n)}}else es.notify({message:"No behaviors configured.",color:"negative"})};return(a,h)=>{const z=L("Head");return q(),R(K,null,[B(z,{title:"Reward System"}),O("div",we,[h[95]||(h[95]=O("div",{class:"p-1 scale-25"},null,-1)),e.isDialog?Q("",!0):(q(),M(r,{key:0,class:"shadow-lg rounded-2xl overflow-hidden"},{default:W(()=>[B(t,{class:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white flex justify-between items-center"},{default:W(()=>[O("div",null,[O("h1",_e,"üèÜ "+G(a.$t("rewardSys.behaviors.management")),1),O("p",Se,G(a.$t("rewardSys.behaviors.management")),1)]),B(S,{modelValue:Y(Gl),"onUpdate:modelValue":h[0]||(h[0]=e=>J(Gl)?Gl.value=e:null),options:[{label:"üá¨üáß English",value:"en"},{label:"üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",value:"ar"}],flat:"",color:"white","text-color":"white","toggle-color":"white","toggle-text-color":"primary",unelevated:""},null,8,["modelValue"])]),_:1}),B(t,{class:"p-6 space-y-4"},{default:W(()=>{var e;return[O("div",ke,[O("div",$e,[O("div",Ie,[B(l,{name:"event_note",size:"md"})]),O("div",null,[O("div",Ce,G(a.$t("rewardSys.session.current")),1),O("div",je,[rs.value?(q(),R("span",Ee,G((null==(e=ss.value.find(e=>e.classroom_id===rs.value))?void 0:e.classroom_name)||a.$t("rewardSys.session.unknownClass")),1)):(q(),R("span",Ve,G(a.$t("rewardSys.session.noClassroom")),1)),h[60]||(h[60]=O("span",{class:"text-gray-300"},"|",-1)),O("span",Ae,G(lo.value),1)]),O("div",ze,G(new Date(ds.value).toLocaleDateString())+" ‚Ä¢ Period "+G(ms.value),1)])])]),rs.value?(q(),R("div",Te,[O("div",Ue,[O("div",Pe,[B(l,{name:"groups",class:"text-blue-600",size:"sm"}),O("span",De,G(a.$t("rewardSys.session.classroomSummary")),1)]),O("div",Ne,[B(s,{modelValue:Vs.value,"onUpdate:modelValue":h[1]||(h[1]=e=>Vs.value=e),icon:"edit",label:"Edit Avatars",dense:"",color:"secondary",size:"sm",class:"bg-white px-2 py-1 rounded-lg border border-gray-200"},null,8,["modelValue"]),js.value.message?(q(),R("div",Fe,G(js.value.message)+" ("+G(js.value.created)+") ",1)):Q("",!0),O("div",Le,[B(l,{name:"people",class:"text-blue-600",size:"sm"}),O("div",Re,[O("span",qe,G(a.$t("rewardSys.session.total")),1),O("span",Be,G(os.value.length),1)])]),O("div",Oe,[B(l,{name:"check_circle",class:"text-green-600",size:"sm"}),O("div",Me,[O("span",Qe,G(a.$t("rewardSys.session.present")),1),O("span",We,G(Zl.value.present),1)])]),O("div",Ge,[B(l,{name:"cancel",class:"text-red-600",size:"sm"}),O("div",Ye,[O("span",Je,G(a.$t("rewardSys.session.absent")),1),O("span",He,G(Zl.value.absent),1)])]),B(o,{dense:"",color:"primary",icon:"content_copy",label:a.$t("rewardSys.session.copyList"),onClick:Xl,disable:0===Zl.value.absent,size:"sm",class:"shadow-sm"},{default:W(()=>[B(n,null,{default:W(()=>[H(G(a.$t("rewardSys.session.copyToClipboard")),1)]),_:1})]),_:1},8,["label","disable"])])]),Zl.value.absent>0?(q(),R("div",Ke,[O("div",Ze,[B(l,{name:"person_off",size:"xs",color:"red"}),O("span",null,G(a.$t("rewardSys.session.absentStudentsList")),1),B(k,{color:"red",label:Zl.value.absent,class:"ml-1"},null,8,["label"])]),O("div",Xe,[O("div",ea,[(q(!0),R(K,null,Z(Zl.value.absentList,e=>(q(),M(x,{key:e.id,color:"red","text-color":"white",size:"sm",dense:"",icon:"person"},{default:W(()=>[H(G("ar"===Y(Gl)&&e.name_ar?e.name_ar:e.name),1)]),_:2},1024))),128))])])])):Q("",!0)])):Q("",!0)]}),_:1})]),_:1})),O("audio",{ref_key:"bgMusic",ref:be,loop:"",id:"bg-music"},h[61]||(h[61]=[O("source",{src:"/audio/background_music2.mp3",type:"audio/mpeg"},null,-1)]),512),os.value.length?(q(),M(r,{key:1,class:"shadow-lg rounded-2xl"},{default:W(()=>{var e,b,y,S,A,z,T,U,P,D,N;return[O("div",aa,[O("div",ta,[O("div",la,[B(v,{color:"primary",icon:"menu",label:Y(es).screen.gt.xs?"Menu":"",class:"shadow-sm glossy","content-class":"bg-white",dense:""},{default:W(()=>[O("div",sa,[O("div",{class:"column",style:X(Y(es).screen.lt.sm?"min-width: 250px":"min-width: 220px")},[h[70]||(h[70]=O("div",{class:"text-subtitle1 text-weight-bold q-mb-sm text-grey-8"},"Navigation",-1)),B(i,{dense:""},{default:W(()=>[ee((q(),M(d,{clickable:"",onClick:h[2]||(h[2]=e=>as.value="positive"),active:"positive"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"add_circle"})]),_:1}),B(u,null,{default:W(()=>[H(G(a.$t("rewardSys.tabs.positivePoints")),1)]),_:1})]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[3]||(h[3]=e=>as.value="attendance"),active:"attendance"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"how_to_reg"})]),_:1}),B(u,null,{default:W(()=>[H(G(a.$t("rewardSys.tabs.attendance")),1)]),_:1})]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[4]||(h[4]=e=>as.value="history"),active:"history"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"cancel"})]),_:1}),B(u,null,{default:W(()=>[H(G(a.$t("rewardSys.tabs.history")),1)]),_:1})]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[5]||(h[5]=e=>as.value="classroom_helper"),active:"classroom_helper"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"assignment"})]),_:1}),B(u,null,{default:W(()=>h[62]||(h[62]=[H("Classroom Helper")])),_:1})]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[6]||(h[6]=e=>as.value="timer_random"),active:"timer_random"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"timer"})]),_:1}),B(u,null,{default:W(()=>h[63]||(h[63]=[H("Timer & Random")])),_:1})]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[7]||(h[7]=e=>{ws.value=!0,as.value="champions"}),active:"champions"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"emoji_events"})]),_:1}),B(u,null,{default:W(()=>[H(G(a.$t("rewardSys.tabs.champions")),1)]),_:1})]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[8]||(h[8]=e=>as.value="settings_reports"),active:"settings_reports"===as.value,"active-class":"bg-blue-50 text-primary"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"settings_applications"})]),_:1}),B(u,null,{default:W(()=>[H(G(a.$t("rewardSys.tabs.settingsReports")),1)]),_:1})]),_:1},8,["active"])),[[w]])]),_:1}),B(c,{class:"q-my-md"}),h[71]||(h[71]=O("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Points Filter",-1)),B(i,{dense:""},{default:W(()=>[ee((q(),M(d,{clickable:"",onClick:h[9]||(h[9]=e=>Ls.value="overall"),active:"overall"===Ls.value,"active-class":"text-orange-9 text-weight-bold"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"functions",size:"xs"})]),_:1}),B(u,null,{default:W(()=>h[64]||(h[64]=[H("Overall (All Time)")])),_:1}),"overall"===Ls.value?(q(),M(u,{key:0,side:""},{default:W(()=>[B(l,{name:"check",size:"xs",color:"orange"})]),_:1})):Q("",!0)]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[10]||(h[10]=e=>Ls.value="all_subjects"),active:"all_subjects"===Ls.value,"active-class":"text-orange-9 text-weight-bold"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"public",size:"xs"})]),_:1}),B(u,null,{default:W(()=>h[65]||(h[65]=[H("Overall (All Subjects)")])),_:1}),"all_subjects"===Ls.value?(q(),M(u,{key:0,side:""},{default:W(()=>[B(l,{name:"check",size:"xs",color:"orange"})]),_:1})):Q("",!0)]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[11]||(h[11]=e=>Ls.value="session"),active:"session"===Ls.value,"active-class":"text-orange-9 text-weight-bold"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"timer",size:"xs"})]),_:1}),B(u,null,{default:W(()=>h[66]||(h[66]=[H("This Session")])),_:1}),"session"===Ls.value?(q(),M(u,{key:0,side:""},{default:W(()=>[B(l,{name:"check",size:"xs",color:"orange"})]),_:1})):Q("",!0)]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[12]||(h[12]=e=>Ls.value="competition"),active:"competition"===Ls.value,"active-class":"text-orange-9 text-weight-bold"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"date_range",size:"xs"})]),_:1}),B(u,null,{default:W(()=>h[67]||(h[67]=[H("Competition (Week)")])),_:1}),"competition"===Ls.value?(q(),M(u,{key:0,side:""},{default:W(()=>[B(l,{name:"check",size:"xs",color:"orange"})]),_:1})):Q("",!0)]),_:1},8,["active"])),[[w]]),ee((q(),M(d,{clickable:"",onClick:h[13]||(h[13]=e=>Ls.value="from_now"),active:"from_now"===Ls.value,"active-class":"text-orange-9 text-weight-bold"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"restart_alt",size:"xs"})]),_:1}),B(u,null,{default:W(()=>h[68]||(h[68]=[H("From Now (Reset View)")])),_:1}),"from_now"===Ls.value?(q(),M(u,{key:0,side:""},{default:W(()=>[B(l,{name:"check",size:"xs",color:"orange"})]),_:1})):Q("",!0)]),_:1},8,["active"])),[[w]])]),_:1}),B(c,{class:"q-my-md"}),h[72]||(h[72]=O("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Layout",-1)),B(i,{dense:""},{default:W(()=>[(q(!0),R(K,null,Z(fo.value,e=>ee((q(),M(d,{clickable:"",key:e.value,onClick:a=>Us.value=e.value,active:Us.value===e.value,"active-class":"text-orange-9 text-weight-bold"},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:e.icon,size:"xs"},null,8,["name"])]),_:2},1024),B(u,null,{default:W(()=>[H(G(e.label),1)]),_:2},1024),Us.value===e.value?(q(),M(u,{key:0,side:""},{default:W(()=>[B(l,{name:"check",size:"xs",color:"orange"})]),_:1})):Q("",!0)]),_:2},1032,["onClick","active"])),[[w]])),128)),B(c,{class:"q-my-xs"}),ee((q(),M(d,{clickable:"",onClick:h[14]||(h[14]=e=>Ds.value=!0)},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"settings",size:"xs",class:"text-grey-7"})]),_:1}),B(u,{class:"text-grey-8"},{default:W(()=>[H(G(a.$t("rewardSys.manageGroups")),1)]),_:1})]),_:1})),[[w]])]),_:1}),Y(es).screen.lt.sm?(q(),R("div",oa,[B(c,{class:"q-my-md"}),h[69]||(h[69]=O("div",{class:"text-subtitle1 text-weight-bold q-mb-md text-grey-8"},"Settings",-1)),B(s,{modelValue:Ml.value,"onUpdate:modelValue":h[15]||(h[15]=e=>Ml.value=e),"checked-icon":"music_note","unchecked-icon":"music_off",label:"Music On",color:"primary",dense:""},null,8,["modelValue"]),B(s,{modelValue:Vs.value,"onUpdate:modelValue":h[16]||(h[16]=e=>Vs.value=e),icon:"edit",label:"Edit Avatars",color:"secondary",dense:""},null,8,["modelValue"]),B(s,{modelValue:Ws.value,"onUpdate:modelValue":h[17]||(h[17]=e=>Ws.value=e),icon:"volume_up",label:"Read Aloud",color:"purple",dense:""},null,8,["modelValue"])])):Q("",!0)],4),Y(es).screen.gt.xs?(q(),M(c,{key:0,vertical:"",inset:"",class:"q-mx-lg"})):Q("",!0),Y(es).screen.gt.xs?(q(),R("div",na,[h[73]||(h[73]=O("div",{class:"text-subtitle1 text-weight-bold q-mb-md text-grey-8"},"Settings",-1)),O("div",ra,[B(s,{modelValue:Ml.value,"onUpdate:modelValue":h[18]||(h[18]=e=>Ml.value=e),"checked-icon":"music_note","unchecked-icon":"music_off",label:"Music On",color:"primary",dense:""},null,8,["modelValue"]),B(s,{modelValue:Vs.value,"onUpdate:modelValue":h[19]||(h[19]=e=>Vs.value=e),icon:"edit",label:"Edit Avatars",color:"secondary",dense:""},null,8,["modelValue"]),B(s,{modelValue:Ws.value,"onUpdate:modelValue":h[20]||(h[20]=e=>Ws.value=e),icon:"volume_up",label:"Read Aloud",color:"purple",dense:""},null,8,["modelValue"])]),B(c,{class:"q-my-md full-width"}),O("div",ia,[B(ce,{class:"scale-90 transform-origin-center"})])])):Q("",!0)])]),_:1},8,["label"]),O("div",da,[B(o,{rounded:"",dense:"","no-caps":"",color:"grey-3","text-color":"grey-9",class:"px-2 shadow-sm text-xs border border-gray-300",onClick:h[21]||(h[21]=e=>uo("all"))},{default:W(()=>[B(l,{name:"groups",size:"xs",class:"mr-1"}),O("span",ua,G(os.value.length),1)]),_:1}),B(o,{rounded:"",dense:"","no-caps":"",color:"positive",class:"px-2 shadow-sm text-xs",onClick:h[22]||(h[22]=e=>uo("present"))},{default:W(()=>[B(l,{name:"how_to_reg",class:"mr-1",size:"xs"}),O("span",ca,G(so.value),1)]),_:1}),B(o,{rounded:"",dense:"","no-caps":"",color:"negative",class:"px-2 shadow-sm text-xs",onClick:h[23]||(h[23]=e=>uo("absent"))},{default:W(()=>[B(l,{name:"person_off",class:"mr-1",size:"xs"}),O("span",va,G(oo.value),1)]),_:1})]),"positive"!==as.value||Y(es).screen.gt.xs?(q(),R("div",ma,[B(k,{color:"blue-1","text-color":"blue-9",class:"q-py-xs q-px-sm text-subtitle2 whitespace-nowrap"},{default:W(()=>[H(G("positive"===as.value?a.$t("rewardSys.tabs.positivePoints"):"attendance"===as.value?a.$t("rewardSys.tabs.attendance"):"history"===as.value?a.$t("rewardSys.tabs.history"):"champions"===as.value?a.$t("rewardSys.tabs.champions"):"classroom_helper"===as.value?"Classroom Helper":"timer_random"===as.value?"Timer & Random":a.$t("rewardSys.tabs.settingsReports")),1)]),_:1})])):Q("",!0),O("div",pa,[So.value||0!==fs.value.length?(q(),R("div",fa,[So.value||fs.value.length>0&&os.value.find(e=>e.id===fs.value[fs.value.length-1])?(q(),R(K,{key:0},[B(m,{size:"24px"},{default:W(()=>{var e;return[O("img",{src:(null==(e=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:e.avatar)||"data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>"),onError:h[24]||(h[24]=e=>{e.target.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>")})},null,40,ba)]}),_:1}),O("div",ya,[O("span",ha,G(null==(e=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:e.name),1),(null==(b=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:b.name_ar)?(q(),R("span",xa,G(null==(y=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:y.name_ar),1)):Q("",!0)]),h[75]||(h[75]=O("div",{class:"h-4 w-px bg-gray-300 mx-1 flex-shrink-0"},null,-1)),O("div",{class:ae(["bg-white px-2 py-0.5 rounded text-xs font-mono font-bold border border-gray-200 flex-shrink-0",((null==(A=bs.value[null==(S=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:S.id])?void 0:A.points_plus)||0)-((null==(T=bs.value[null==(z=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:z.id])?void 0:T.points_minus)||0)>=0?"text-green-700":"text-red-700"])},G(((null==(P=bs.value[null==(U=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:U.id])?void 0:P.points_plus)||0)-((null==(N=bs.value[null==(D=So.value||os.value.find(e=>e.id===fs.value[fs.value.length-1]))?void 0:D.id])?void 0:N.points_minus)||0))+" Pts ",3)],64)):Q("",!0)])):(q(),R("div",ga,[B(l,{name:"touch_app",size:"xs",class:"mr-1"}),h[74]||(h[74]=H(" mouse on or active card "))]))])]),O("div",wa,[B(v,{color:"primary",icon:"stars",label:Y(es).screen.gt.xs?"Give Feedback":"",disable:0===fs.value.length,class:"shadow-sm glossy","content-class":"rounded-xl",dense:""},{default:W(()=>[O("div",_a,[fs.value.length>0?(q(),R("div",Sa,[O("div",ka,[O("span",null,"Giving to "+G(fs.value.length)+" student"+G(fs.value.length>1?"s":"")+":",1),O("span",{class:"text-gray-500 cursor-pointer hover:text-blue-700",onClick:Uo},"Clear")]),O("div",$a,[(q(!0),R(K,null,Z(fs.value,e=>(q(),M(x,{key:e,dense:"",removable:"",onRemove:a=>zo(e),onMouseenter:a=>$o(os.value.find(a=>a.id===e)),onMouseleave:Io,color:"white","text-color":"primary",class:"shadow-sm border border-blue-100 text-xs m-0"},{default:W(()=>{var a;return[B(m,{size:"16px"},{default:W(()=>[O("img",{src:vo(os.value.find(a=>a.id===e))},null,8,Ia)]),_:2},1024),O("span",Ca,G(null==(a=os.value.find(a=>a.id===e))?void 0:a.firstName),1)]}),_:2},1032,["onRemove","onMouseenter"]))),128))])])):Q("",!0),B(I,{modelValue:ts.value,"onUpdate:modelValue":h[25]||(h[25]=e=>ts.value=e),class:"text-grey-7 bg-grey-1","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":"",dense:""},{default:W(()=>[B($,{name:"positive",icon:"thumb_up",label:"Positive",class:"text-weight-bold"}),B($,{name:"needs_work",icon:"warning",label:"Needs Work",class:"text-weight-bold"})]),_:1},8,["modelValue"]),B(c),B(j,{modelValue:ts.value,"onUpdate:modelValue":h[26]||(h[26]=e=>ts.value=e),animated:"",class:"bg-white",style:{"max-height":"400px","overflow-y":"auto"}},{default:W(()=>[B(C,{name:"positive",class:"q-pa-md"},{default:W(()=>[O("div",ja,[(q(!0),R(K,null,Z(po.value,e=>(q(),R("div",{class:"col-3 cursor-pointer",key:e.id,onClick:a=>Fo(e.id)},[ee((q(),R("div",Va,[B(l,{name:e.icon||"star",size:"1.2em",class:"q-mb-xs text-orange-400"},null,8,["name"]),O("div",Aa,G(e.name),1),O("div",za,[O("span",Ta,"+"+G(e.points||e.value),1)])])),[[w]])],8,Ea))),128))])]),_:1}),B(C,{name:"needs_work",class:"q-pa-md"},{default:W(()=>[O("div",Ua,[(q(!0),R(K,null,Z(go.value,e=>(q(),R("div",{class:"col-4 cursor-pointer",key:e.id,onClick:a=>Fo(e.id)},[ee((q(),R("div",Da,[B(l,{name:e.icon||"warning",size:"2em",class:"q-mb-xs text-red"},null,8,["name"]),O("div",Na,G(e.name),1),O("div",Fa,[B(k,{color:"red-1","text-color":"red-9",class:"text-xs font-bold border border-red-200 shadow-sm rounded-full px-1.5"},{default:W(()=>[H(G(e.points||e.value),1)]),_:2},1024)])])),[[w]])],8,Pa))),128))])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["label","disable"]),B(o,{round:"",dense:"",color:"purple",icon:"quiz",class:"ml-2 shadow-sm glossy",onClick:Ko},{default:W(()=>[B(n,null,{default:W(()=>h[76]||(h[76]=[H("Start Quiz Mode")])),_:1})]),_:1})])])]),"positive"===as.value&&"session"!==Ls.value?(q(),R("div",La," Viewing: "+G("overall"===Ls.value?"Overall (All Time)":"all_subjects"===Ls.value?"Overall (All Subjects)":"from_now"===Ls.value?"From Now (Temporary)":"Competition (Week)"),1)):Q("",!0),B(c),B(j,{modelValue:as.value,"onUpdate:modelValue":h[38]||(h[38]=e=>as.value=e),animated:""},{default:W(()=>[B(C,{name:"attendance"},{default:W(()=>[O("div",Ra,[O("div",qa,[O("h3",Ba,G(a.$t("rewardSys.attendance.manage")),1),O("div",Oa,[B(o,{color:"positive",label:a.$t("rewardSys.attendance.markAllPresent"),onClick:Oo,loading:ks.value},null,8,["label","loading"]),B(o,{color:"warning",label:a.$t("rewardSys.attendance.markAllAbsent"),onClick:Mo,loading:ks.value},null,8,["label","loading"])])]),O("div",Ma,[(q(!0),R(K,null,Z(os.value,e=>{var a,t,l,s;return q(),M(ue,{key:e.id,student:e,"disable-behavior":!ys.value[e.id],"allow-disabled-click":!0,"avatar-edit-enabled":Vs.value,"student-summary":{positive:((null==(a=bs.value[e.id])?void 0:a.points_plus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].plus:0),negative:((null==(t=bs.value[e.id])?void 0:t.points_minus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].minus:0),total:((null==(l=bs.value[e.id])?void 0:l.points_plus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].plus:0)-(((null==(s=bs.value[e.id])?void 0:s.points_minus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].minus:0))},onSelect:a=>qo(e.id),onPreview:$o,onLeave:Io},null,8,["student","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))])])]),_:1}),B(C,{name:"classroom_helper"},{default:W(()=>[B(de,{students:os.value,"student-behaviors":bs.value,"student-attendance":ys.value,"period-info":{date:ds.value,periodCode:lo.value,classroomId:rs.value}},null,8,["students","student-behaviors","student-attendance","period-info"])]),_:1}),B(C,{name:"timer_random"},{default:W(()=>[B(ie,{students:os.value},null,8,["students"])]),_:1}),B(C,{name:"positive"},{default:W(()=>[O("div",Qa,[O("div",Wa,[(q(),M(te,{to:"#dialog-header-actions"},[O("div",Ga,[B(v,{split:"",color:fs.value.length>0?"blue-6":"blue-1","text-color":fs.value.length>0?"white":"primary",icon:"checklist",label:fs.value.length>0?a.$t("rewardSys.selected")+": "+fs.value.length:"Select",dense:"",rounded:"",unelevated:"",class:"mr-2 transition-all duration-300","content-style":"border-radius: 12px",onClick:h[28]||(h[28]=e=>fs.value.length>0?uo("selected"):xo())},{default:W(()=>[B(i,{dense:"",style:{"min-width":"180px"}},{default:W(()=>[ee((q(),M(d,{clickable:"",onClick:h[27]||(h[27]=e=>uo("selected"))},{default:W(()=>[B(u,null,{default:W(()=>[B(p,{header:"",class:"text-xs text-uppercase text-gray-500 font-bold bg-gray-50 border-b cursor-pointer hover:bg-gray-100 transition-colors"},{default:W(()=>[H(G(a.$t("rewardSys.selected"))+": "+G(fs.value.length),1)]),_:1})]),_:1})]),_:1})),[[w]]),ee((q(),M(d,{clickable:"",onClick:co,disable:0===fs.value.length},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"content_copy",color:"grey-8"})]),_:1}),B(u,null,{default:W(()=>[B(p,null,{default:W(()=>h[77]||(h[77]=[H("Copy Names")])),_:1})]),_:1})]),_:1},8,["disable"])),[[w]]),B(c),ee((q(),M(d,{clickable:"",onClick:xo},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"check_box",color:"primary"})]),_:1}),B(u,null,{default:W(()=>[B(p,null,{default:W(()=>[H(G(a.$t("rewardSys.selection.all")),1)]),_:1})]),_:1})]),_:1})),[[w]]),ee((q(),M(d,{clickable:"",onClick:wo},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"swap_vert",color:"orange"})]),_:1}),B(u,null,{default:W(()=>[B(p,null,{default:W(()=>[H(G(a.$t("rewardSys.selection.inv")),1)]),_:1})]),_:1})]),_:1})),[[w]]),B(c),ee((q(),M(d,{clickable:"",onClick:Uo,disable:0===fs.value.length},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(l,{name:"clear",color:"negative"})]),_:1}),B(u,null,{default:W(()=>[B(p,null,{default:W(()=>[H(G(a.$t("rewardSys.selection.clear")),1)]),_:1})]),_:1})]),_:1},8,["disable"])),[[w]])]),_:1})]),_:1},8,["color","text-color","label"]),B(s,{modelValue:Qs.value,"onUpdate:modelValue":h[29]||(h[29]=e=>Qs.value=e),label:"individual"===Qs.value?"Individual":"Selection","true-value":"individual","false-value":"selection","checked-icon":"person","unchecked-icon":"checklist",color:"green-13","icon-color":"white",size:"sm",dense:"",class:"mr-2 text-white font-bold"},null,8,["modelValue","label"])])])),B(c,{vertical:"",inset:"",class:"mx-2"}),B(g,{modelValue:no.value,"onUpdate:modelValue":h[30]||(h[30]=e=>no.value=e)},{default:W(()=>[B(r,{style:{"min-width":"350px"}},{default:W(()=>[B(t,{class:"row items-center"},{default:W(()=>[O("div",Ya,[H(G("all"===ro.value?"All Students":"present"===ro.value?"Present Students":"selected"===ro.value?"Selected Students":"Absent Students")+" ",1),B(k,{color:"all"===ro.value?"grey-7":"present"===ro.value?"positive":"selected"===ro.value?"blue":"negative",class:"ml-2"},{default:W(()=>[H(G(io.value.length),1)]),_:1},8,["color"])]),B(E),ee(B(o,{icon:"close",flat:"",round:"",dense:""},null,512),[[w]])]),_:1}),B(t,{class:"q-pt-none",style:{"max-height":"50vh","overflow-y":"auto"}},{default:W(()=>[0===io.value.length?(q(),R("div",Ja," No students found. ")):(q(),M(i,{key:1,bordered:"",separator:"",class:"rounded-lg"},{default:W(()=>[(q(!0),R(K,null,Z(io.value,e=>(q(),M(d,{key:e.id},{default:W(()=>[B(u,{avatar:""},{default:W(()=>[B(m,{size:"sm"},{default:W(()=>[O("img",{src:vo(e)},null,8,Ha)]),_:2},1024)]),_:2},1024),B(u,null,{default:W(()=>[H(G(e.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),B(f,{align:"right",class:"bg-gray-50"},{default:W(()=>[ee(B(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]]),B(o,{label:"Copy List",color:"primary",icon:"content_copy",onClick:co,disable:0===io.value.length},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Lo.value.length>0?(q(),M(o,{key:0,dense:"",rounded:"",color:"grey-8",icon:"undo",label:"Undo",onClick:Ro,class:"ml-2 shadow-sm",size:"sm"},{default:W(()=>[B(n,null,{default:W(()=>h[78]||(h[78]=[H("Undo last action")])),_:1})]),_:1})):Q("",!0),yo.value.length>0?(q(),R("div",Ka,[B(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"filter_alt_off",label:"ALL",color:null===bo.value?"grey-3":"grey-2","text-color":null===bo.value?"grey-8":"grey-6",class:ae(["px-4 font-bold",null===bo.value?"bg-gray-200":""]),onClick:h[31]||(h[31]=e=>bo.value=null)},null,8,["color","text-color","class"]),B(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"check_circle",color:"__SELECTED__"===bo.value?"primary":"grey-2","text-color":"__SELECTED__"===bo.value?"white":"grey-8",class:"px-3 font-bold",onClick:h[32]||(h[32]=e=>bo.value="__SELECTED__"===bo.value?null:"__SELECTED__")},{default:W(()=>[B(n,null,{default:W(()=>h[79]||(h[79]=[H("Selected Only")])),_:1})]),_:1},8,["color","text-color"]),B(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"radio_button_unchecked",color:"__UNSELECTED__"===bo.value?"primary":"grey-2","text-color":"__UNSELECTED__"===bo.value?"white":"grey-8",class:"px-3 font-bold mr-2",onClick:h[33]||(h[33]=e=>bo.value="__UNSELECTED__"===bo.value?null:"__UNSELECTED__")},{default:W(()=>[B(n,null,{default:W(()=>h[80]||(h[80]=[H("Not Selected")])),_:1})]),_:1},8,["color","text-color"]),(q(!0),R(K,null,Z(yo.value,e=>(q(),M(o,{key:e,unelevated:"",dense:"",round:"",size:"md",label:e,color:bo.value===e?"primary":"grey-1","text-color":bo.value===e?"white":"grey-7",onClick:a=>function(e){bo.value===e?bo.value=null:bo.value=e}(e),class:ae(["font-bold shadow-sm",bo.value===e?"shadow-md scale-110":"hover:bg-gray-200"])},null,8,["label","color","text-color","onClick","class"]))),128))])):Q("",!0),(q(!0),R(K,null,Z(ho.value,(e,t)=>(q(),R("div",{key:t,class:"mb-6 bg-gray-400"},[e.name?(q(),R("div",Za,[O("div",Xa,[O("h4",et,[B(l,{name:"groups"}),H(" "+G(e.name)+" ",1),B(k,{label:e.students.length,color:"indigo"},null,8,["label"])]),O("div",at,[B(o,{dense:"",size:"sm",color:"indigo",icon:"check_box",label:a.$t("rewardSys.selection.all"),onClick:a=>To(e.students,!0),outline:""},null,8,["label","onClick"]),B(o,{dense:"",size:"sm",color:"grey",icon:"check_box_outline_blank",label:a.$t("rewardSys.selection.clear"),onClick:a=>To(e.students,!1),outline:""},null,8,["label","onClick"])])])])):Q("",!0),O("div",tt,[(q(!0),R(K,null,Z(e.students,e=>{var a,t,l,s,o,n;return q(),M(ue,{key:e.id,student:e,selected:fs.value.includes(e.id),"selected-id":fs.value.includes(e.id)?e.id:null,"disable-behavior":!ys.value[e.id],"is-absent":!ys.value[e.id],"allow-disabled-click":!1,"avatar-edit-enabled":Vs.value,"overall-points":((null==(a=bs.value[e.id])?void 0:a.points_plus)||0)-((null==(t=bs.value[e.id])?void 0:t.points_minus)||0),"student-summary":{positive:((null==(l=bs.value[e.id])?void 0:l.points_plus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].plus:0),negative:((null==(s=bs.value[e.id])?void 0:s.points_minus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].minus:0),total:((null==(o=bs.value[e.id])?void 0:o.points_plus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].plus:0)-(((null==(n=bs.value[e.id])?void 0:n.points_minus)||0)-("from_now"===Ls.value&&Rs.value[e.id]?Rs.value[e.id].minus:0))},onSelect:a=>to(e.id),onPreview:$o,onLeave:Io},null,8,["student","selected","selected-id","disable-behavior","is-absent","avatar-edit-enabled","overall-points","student-summary","onSelect"])}),128))])]))),128))])])]),_:1}),B(C,{name:"negative"},{default:W(()=>[O("div",lt,[O("div",st,[O("h3",ot,G(a.$t("rewardSys.points.deduct")),1),O("p",nt,G(a.$t("rewardSys.points.selectStudentsNegative")),1)]),O("div",rt,[O("div",it,[B(V,{modelValue:gs.value,"onUpdate:modelValue":h[34]||(h[34]=e=>gs.value=e),options:go.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:a.$t("rewardSys.points.selectNegativeBehavior"),"emit-value":"","map-options":""},{option:W(e=>[B(d,le(se(e.itemProps)),{default:W(()=>[B(u,null,{default:W(()=>[B(p,null,{default:W(()=>[H(G(Yl(e.opt)),1)]),_:2},1024),B(p,{caption:""},{default:W(()=>[H(G(e.opt.value||e.opt.points||0)+" points",1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","placeholder"]),B(o,{color:"negative",icon:"remove_circle",label:a.$t("rewardSys.points.applyToSelected"),onClick:No,disable:!fs.value.length||!gs.value,loading:Ss.value},null,8,["label","disable","loading"])]),O("div",dt,[h[81]||(h[81]=H("Selected: ")),O("strong",null,G(fs.value.length),1),h[82]||(h[82]=H(" students"))])]),O("div",ut,[(q(!0),R(K,null,Z(os.value,e=>{var a,t,l,s;return q(),M(ue,{key:e.id,student:e,selected:fs.value.includes(e.id),"selected-id":fs.value.includes(e.id)?e.id:null,"disable-behavior":!ys.value[e.id],"allow-disabled-click":!1,"avatar-edit-enabled":Vs.value,"student-summary":{positive:(null==(a=bs.value[e.id])?void 0:a.points_plus)||0,negative:(null==(t=bs.value[e.id])?void 0:t.points_minus)||0,total:((null==(l=bs.value[e.id])?void 0:l.points_plus)||0)-((null==(s=bs.value[e.id])?void 0:s.points_minus)||0)},onSelect:a=>zo(e.id)},null,8,["student","selected","selected-id","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))])])]),_:1}),B(C,{name:"old_card"},{default:W(()=>[O("div",ct,[h[86]||(h[86]=O("h3",{class:"text-xl font-bold mb-4"},"Old Card View",-1)),O("div",vt,[(q(!0),R(K,null,Z(os.value,e=>{var a,t,l,s;return q(),R("div",{key:e.id,class:ae(["p-4 border-2 rounded-lg transition",[ys.value[e.id]?fs.value.includes(e.id)?"bg-green-100 border-green-500 cursor-pointer":"bg-white border-gray-200 cursor-pointer":"bg-gray-100 border-gray-300 opacity-50 cursor-not-allowed"]]),onClick:a=>ys.value[e.id]&&zo(e.id)},[O("div",pt,[O("div",gt,[O("p",ft,G(e.name),1),O("p",bt,"ID: "+G(e.id),1),ys.value[e.id]?Q("",!0):(q(),R("p",yt,"‚ùå Absent"))]),B(_,{"model-value":fs.value.includes(e.id),"onUpdate:modelValue":a=>zo(e.id),disable:!ys.value[e.id],color:"positive",size:"lg"},null,8,["model-value","onUpdate:modelValue","disable"])]),O("div",ht,[O("div",xt,[h[83]||(h[83]=O("span",{class:"text-xs font-semibold text-green-800"},"Positive",-1)),O("span",wt,"+"+G((null==(a=bs.value[e.id])?void 0:a.points_plus)||0)+" ‚≠ê",1)]),O("div",_t,[h[84]||(h[84]=O("span",{class:"text-xs font-semibold text-red-800"},"Negative",-1)),O("span",St,"-"+G((null==(t=bs.value[e.id])?void 0:t.points_minus)||0)+" ‚ö†Ô∏è",1)]),O("div",kt,[h[85]||(h[85]=O("span",{class:"text-xs font-semibold text-blue-800"},"Total",-1)),O("span",$t,G(((null==(l=bs.value[e.id])?void 0:l.points_plus)||0)-((null==(s=bs.value[e.id])?void 0:s.points_minus)||0)),1)])])],10,mt)}),128))])])]),_:1}),B(C,{name:"history"},{default:W(()=>[O("div",It,[O("div",Ct,[O("h3",jt,G(a.$t("rewardSys.history.title")),1),B(o,{color:"primary",icon:"refresh",label:a.$t("rewardSys.history.refresh"),onClick:Qo,loading:$s.value},null,8,["label","loading"])]),xs.value.length?Q("",!0):(q(),R("div",Et,[O("p",Vt,G(a.$t("rewardSys.history.empty")),1)])),(q(!0),R(K,null,Z(xs.value,e=>{var t,l,s;return q(),R("div",{key:e.id,class:ae(["p-4 bg-white rounded-lg border-l-4",[e.canceled?"border-gray-400 opacity-60":e.value>0?"border-green-500":"border-red-500"]])},[O("div",At,[O("div",zt,[O("div",Tt,[O("span",Ut,G((null==(l=null==(t=e.student_behavior)?void 0:t.student)?void 0:l.name)||a.$t("rewardSys.history.unknown")),1),O("span",Pt,G(e.value>0?"‚≠ê":"‚ö†Ô∏è"),1)]),O("p",Dt,[O("strong",null,G(Yl(e.behavior)||a.$t("rewardSys.history.unknownBehavior")),1),O("span",{class:ae(e.value>0?"text-green-600":"text-red-600")}," ("+G(e.value>0?"+":"")+G(e.value)+" "+G(a.$t("rewardSys.points.title"))+") ",3)]),O("p",Nt,G(Wo(e.created_at))+" by "+G((null==(s=e.created_by)?void 0:s.name)||a.$t("rewardSys.history.unknown")),1),e.note?(q(),R("p",Ft,G(a.$t("rewardSys.history.note"))+" "+G(e.note),1)):Q("",!0),e.canceled?(q(),R("p",Lt," ‚ùå "+G(a.$t("rewardSys.history.canceled"))+" "+G(e.cancel_reason)+" ("+G(Wo(e.canceled_at))+") ",1)):Q("",!0)]),e.canceled?Q("",!0):(q(),M(o,{key:0,color:"warning",icon:"undo",label:a.$t("rewardSys.history.undo"),size:"sm",onClick:a=>async function(e){Is.value=e;try{const a=await ye.undoAction(e,"Undone by teacher");a.success?(es.notify({message:"Action undone successfully",color:"positive",position:"top"}),await Qo(),await Do()):es.notify({message:a.error||"Failed to undo action",color:"negative",position:"top"})}catch(a){console.error("Error undoing action:",a),es.notify({message:"Error undoing action",color:"negative",position:"top"})}finally{Is.value=null}}(e.id),loading:Is.value===e.id},null,8,["label","onClick","loading"]))])],2)}),128))])]),_:1}),B(C,{name:"settings_reports",class:"p-4"},{default:W(()=>[O("div",Rt,[O("div",qt,[B(I,{modelValue:ls.value,"onUpdate:modelValue":h[35]||(h[35]=e=>ls.value=e),align:"left",class:"text-gray-600 bg-gray-50 border-b border-gray-200","active-color":"primary","indicator-color":"primary",dense:""},{default:W(()=>[B($,{name:"behavior_incidents",icon:"report_problem",label:a.$t("rewardSys.tabs.behaviorIncidents")},null,8,["label"]),B($,{name:"behaviors",icon:"settings",label:a.$t("rewardSys.tabs.behaviors")},null,8,["label"])]),_:1},8,["modelValue"]),B(j,{modelValue:ls.value,"onUpdate:modelValue":h[37]||(h[37]=e=>ls.value=e),animated:"",class:"bg-transparent"},{default:W(()=>[B(C,{name:"behavior_incidents"},{default:W(()=>[B(Y(pe),{students:os.value,"classroom-id":rs.value,date:ds.value,"period-code":lo.value,onIncidentRecorded:Jo},null,8,["students","classroom-id","date","period-code"])]),_:1}),B(C,{name:"behaviors"},{default:W(()=>[O("div",Bt,[O("div",Ot,[O("h3",Mt,G(a.$t("rewardSys.behaviors.management")),1),B(o,{color:"primary",icon:"add",label:a.$t("rewardSys.behaviors.addNew"),onClick:h[36]||(h[36]=e=>Eo(null)),size:"md",class:"shadow-md"},null,8,["label"])]),O("div",Qt,[O("div",Wt,[B(l,{name:"add_circle",size:"md",color:"positive"}),O("h4",Gt,G(a.$t("rewardSys.behaviors.positiveSection")),1),B(k,{label:po.value.length,color:"positive"},null,8,["label"])]),O("div",Yt,[(q(!0),R(K,null,Z(po.value,e=>(q(),R("div",{key:e.id,class:"bg-white rounded-lg p-4 shadow-sm border border-green-100 hover:shadow-md transition-all"},[O("div",Jt,[O("div",Ht,[O("div",Kt,G(e.icon||"‚≠ê"),1),O("div",null,[O("h5",Zt,G(Yl(e)),1),O("p",Xt,"ID: "+G(e.id),1)])]),O("div",el,[B(o,{flat:"",round:"",dense:"",icon:"edit",color:"primary",size:"sm",onClick:a=>Eo(e)},{default:W(()=>[B(n,null,{default:W(()=>h[87]||(h[87]=[H("Edit")])),_:1})]),_:2},1032,["onClick"]),B(o,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"sm",onClick:a=>Ao(e)},{default:W(()=>[B(n,null,{default:W(()=>h[88]||(h[88]=[H("Delete")])),_:1})]),_:2},1032,["onClick"])])]),O("div",al,[h[89]||(h[89]=O("span",{class:"text-sm text-gray-600"},"Points:",-1)),O("span",tl,"+"+G(e.value||e.points||0),1)])]))),128))]),0===po.value.length?(q(),R("div",ll,[B(l,{name:"sentiment_neutral",size:"3rem",class:"mb-2"}),O("p",null,G(a.$t("rewardSys.behaviors.noPositive")),1)])):Q("",!0)]),O("div",sl,[O("div",ol,[B(l,{name:"remove_circle",size:"md",color:"negative"}),O("h4",nl,G(a.$t("rewardSys.behaviors.negativeSection")),1),B(k,{label:go.value.length,color:"negative"},null,8,["label"])]),O("div",rl,[(q(!0),R(K,null,Z(go.value,e=>(q(),R("div",{key:e.id,class:"bg-white rounded-lg p-4 shadow-sm border border-red-100 hover:shadow-md transition-all"},[O("div",il,[O("div",dl,[O("div",ul,G(e.icon||"‚ö†Ô∏è"),1),O("div",null,[O("h5",cl,G(Yl(e)),1),O("p",vl,"ID: "+G(e.id),1)])]),O("div",ml,[B(o,{flat:"",round:"",dense:"",icon:"edit",color:"primary",size:"sm",onClick:a=>Eo(e)},{default:W(()=>[B(n,null,{default:W(()=>h[90]||(h[90]=[H("Edit")])),_:1})]),_:2},1032,["onClick"]),B(o,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"sm",onClick:a=>Ao(e)},{default:W(()=>[B(n,null,{default:W(()=>h[91]||(h[91]=[H("Delete")])),_:1})]),_:2},1032,["onClick"])])]),O("div",pl,[h[92]||(h[92]=O("span",{class:"text-sm text-gray-600"},"Points:",-1)),O("span",gl,G(e.value||e.points||0),1)])]))),128))]),0===go.value.length?(q(),R("div",fl,[B(l,{name:"sentiment_neutral",size:"3rem",class:"mb-2"}),O("p",null,G(a.$t("rewardSys.behaviors.noNegative")),1)])):Q("",!0)])])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1},8,["modelValue"])]}),_:1})):Q("",!0),os.value.length?Q("",!0):(q(),M(r,{key:2,class:"shadow-lg rounded-2xl"},{default:W(()=>[B(t,{class:"text-center py-12"},{default:W(()=>[O("p",bl,"üìö "+G(a.$t("rewardSys.messages.selectClassroom")),1)]),_:1})]),_:1})),B(g,{modelValue:ws.value,"onUpdate:modelValue":h[39]||(h[39]=e=>ws.value=e),maximized:""},{default:W(()=>[B(r,null,{default:W(()=>[B(f,{align:"right"},{default:W(()=>[ee(B(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]])]),_:1}),B(t,{class:"p-0"},{default:W(()=>[B(Y(me),{students:os.value,"student-behaviors":bs.value,"period-code":lo.value,date:ds.value,"school-logo":Hl.value},null,8,["students","student-behaviors","period-code","date","school-logo"])]),_:1}),B(f,{align:"right"},{default:W(()=>[ee(B(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),B(g,{modelValue:As.value,"onUpdate:modelValue":h[43]||(h[43]=e=>As.value=e),"full-width":"",maxWidth:"1200px"},{default:W(()=>[B(r,{class:"flex flex-col md:flex-row h-[90vh] md:h-[80vh] overflow-hidden"},{default:W(()=>{var e;return[B(t,{class:ae(["w-full md:w-1/4 bg-blue-50 border-r border-blue-100 flex flex-col p-0 order-2 md:order-1 transition-all",{"h-16 overflow-hidden md:h-auto":Y(es).screen.lt.md&&!Xs.value}])},{default:W(()=>[O("div",{class:"p-3 border-b border-blue-200 bg-blue-100/50 flex justify-between items-center cursor-pointer md:cursor-default",onClick:h[40]||(h[40]=e=>Y(es).screen.lt.md?Xs.value=!Xs.value:null)},[O("h4",yl,[B(l,{name:"checklist"}),H(" "+G(a.$t("rewardSys.selected"))+" ("+G(fs.value.length)+") ",1)]),O("div",hl,[B(l,{name:Xs.value?"expand_less":"expand_more",color:"primary"},null,8,["name"])])]),ee(O("div",xl,[0===fs.value.length?(q(),R("div",wl,G(a.$t("rewardSys.messages.clickToSelect")),1)):(q(),R("div",_l,[(q(!0),R(K,null,Z(fs.value,e=>(q(),M(x,{key:e,removable:"",onRemove:a=>zo(e),color:"white","text-color":"primary",class:"shadow-sm border border-blue-100 m-0 w-full"},{default:W(()=>{var a;return[B(m,{icon:"person",color:"primary","text-color":"white","font-size":"12px"}),O("div",Sl,[O("span",kl,G(null==(a=os.value.find(a=>a.id===e))?void 0:a.firstName),1)])]}),_:2},1032,["onRemove"]))),128))]))],512),[[ne,!Y(es).screen.lt.md||Xs.value]]),ee(O("div",$l,[O("div",Il,[B(o,{flat:"",dense:"",color:"primary",label:"All",size:"sm",onClick:xo,class:"bg-blue-50"}),B(o,{flat:"",dense:"",color:"primary",label:"Inv",size:"sm",onClick:wo,class:"bg-blue-50"}),B(o,{flat:"",dense:"",color:"negative",label:"Clear",size:"sm",onClick:Uo,class:"bg-red-50"})])],512),[[ne,!Y(es).screen.lt.md||Xs.value]])]),_:1},8,["class"]),O("div",Cl,[1===fs.value.length?(q(),R("div",jl,[O("div",El,[O("div",Vl,G(null==(e=os.value.find(e=>e.id===fs.value[0]))?void 0:e.name),1)])])):Q("",!0),B(t,{class:ae(["positive"===zs.value?"bg-green-50 border-b border-green-100":"bg-red-50 border-b border-red-100","flex flex-wrap justify-between items-center py-2 px-3 gap-2 shrink-0"])},{default:W(()=>[O("div",{class:ae(["font-bold flex items-center gap-2 transition-colors duration-300","positive"===zs.value?"text-green-800":"text-red-800"])},[O("span",Al,[B(l,{name:"positive"===zs.value?"emoji_events":"warning",size:"sm"},null,8,["name"]),O("span",zl,G("positive"===zs.value?a.$t("rewardSys.points.positiveTitle"):a.$t("rewardSys.points.negativeTitle")),1)])],2),O("div",Tl,[B(o,{unelevated:"",rounded:"",dense:"",color:"positive"===zs.value?"positive":"transparent","text-color":"positive"===zs.value?"white":"grey-7",class:"px-3 md:px-4 transition-all duration-300 text-xs md:text-sm",onClick:h[41]||(h[41]=e=>zs.value="positive")},{default:W(()=>[B(l,{name:"thumb_up",size:"xs",class:"mr-1"}),h[93]||(h[93]=O("span",{class:"hidden sm:inline"},"Pos",-1))]),_:1},8,["color","text-color"]),B(o,{unelevated:"",rounded:"",dense:"",color:"negative"===zs.value?"negative":"transparent","text-color":"negative"===zs.value?"white":"grey-7",class:"px-3 md:px-4 transition-all duration-300 text-xs md:text-sm",onClick:h[42]||(h[42]=e=>zs.value="negative")},{default:W(()=>[B(l,{name:"thumb_down",size:"xs",class:"mr-1"}),h[94]||(h[94]=O("span",{class:"hidden sm:inline"},"Neg",-1))]),_:1},8,["color","text-color"])])]),_:1},8,["class"]),B(t,{class:"flex-1 overflow-y-auto p-2 md:p-4 custom-scrollbar bg-gray-50/50"},{default:W(()=>[O("div",Ul,[(q(!0),R(K,null,Z("positive"===zs.value?po.value:go.value,e=>(q(),R("div",{key:e.id,class:"cursor-pointer transition-all duration-200 relative group touch-manipulation w-24",onClick:a=>Ts.value=e.id},[O("div",{class:ae(["h-full p-2 md:p-3 rounded-xl border flex flex-col items-center text-center gap-1 md:gap-2 active:scale-95 transition-transform bg-white shadow-sm",[Ts.value===e.id?"positive"===zs.value?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-red-500 bg-red-50 ring-2 ring-red-200":"border-gray-200 hover:border-gray-300 hover:shadow-md"]])},[O("div",{class:ae(["text-2xl md:text-3xl p-2 rounded-full mb-0 md:mb-1","positive"===zs.value?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},G(e.icon||("positive"===zs.value?"‚≠ê":"‚ö†Ô∏è")),3),O("div",Dl,G(Yl(e)),1),O("div",{class:ae(["text-sm md:text-lg font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full mt-auto","positive"===zs.value?"bg-green-200 text-green-900":"bg-red-200 text-red-900"])},G("positive"===zs.value?"+":"")+G(e.value||e.points||0),3),Ts.value===e.id?(q(),R("div",{key:0,class:ae(["absolute top-1 right-1 md:top-2 md:right-2 text-lg md:text-xl drop-shadow-sm","positive"===zs.value?"text-green-600":"text-red-600"])},[B(l,{name:"check_circle"})],2)):Q("",!0)],2)],8,Pl))),128))])]),_:1}),B(f,{align:"right",class:"p-4 border-t border-gray-100 bg-gray-50 gap-3"},{default:W(()=>[ee(B(o,{flat:"",label:a.$t("rewardSys.tabs.cancel"),color:"grey-7",size:"lg",class:"font-bold"},null,8,["label"]),[[w]]),B(o,{color:"positive"===zs.value?"positive":"negative",label:"positive"===zs.value?a.$t("rewardSys.points.applyPositive"):a.$t("rewardSys.points.applyNegative"),icon:"positive"===zs.value?"check_circle":"warning",onClick:_o,disable:!Ts.value,loading:Ss.value,size:"lg",class:"px-8 font-bold shadow-md",push:""},null,8,["color","label","icon","disable","loading"])]),_:1})])]}),_:1})]),_:1},8,["modelValue"]),B(g,{modelValue:Gs.value,"onUpdate:modelValue":h[49]||(h[49]=e=>Gs.value=e),persistent:""},{default:W(()=>[B(r,{class:"min-w-[500px]"},{default:W(()=>[B(t,{class:"bg-primary text-white"},{default:W(()=>[O("div",Nl,[O("div",Fl,G(Ys.value?a.$t("rewardSys.behaviors.edit"):a.$t("rewardSys.behaviors.create")),1),Ys.value&&!Ys.value.teacher_id?(q(),M(k,{key:0,color:"blue",label:"üîí "+a.$t("rewardSys.behaviors.schoolDefault")},null,8,["label"])):Q("",!0)])]),_:1}),B(t,{class:"q-pt-md space-y-4"},{default:W(()=>[Ys.value&&!Ys.value.teacher_id?(q(),M(b,{key:0,class:"bg-blue-50 text-blue-900",rounded:"",dense:""},{avatar:W(()=>[B(l,{name:"info",color:"blue"})]),default:W(()=>[H(" "+G(a.$t("rewardSys.behaviors.readOnlyWarning")),1)]),_:1})):Q("",!0),B(y,{modelValue:Hs.value.name,"onUpdate:modelValue":h[44]||(h[44]=e=>Hs.value.name=e),label:"üá¨üáß "+a.$t("rewardSys.behaviors.form.nameEn")+" *",outlined:"",dense:"",rules:[e=>!!e||"Name is required"],readonly:Ys.value&&!Ys.value.teacher_id},{prepend:W(()=>[B(l,{name:"translate"})]),_:1},8,["modelValue","label","rules","readonly"]),B(y,{modelValue:Hs.value.name_ar,"onUpdate:modelValue":h[45]||(h[45]=e=>Hs.value.name_ar=e),label:"üá∏üá¶ "+a.$t("rewardSys.behaviors.form.nameAr"),outlined:"",dense:"",dir:"rtl",readonly:Ys.value&&!Ys.value.teacher_id},{prepend:W(()=>[B(l,{name:"translate"})]),_:1},8,["modelValue","label","readonly"]),B(V,{modelValue:Hs.value.type,"onUpdate:modelValue":h[46]||(h[46]=e=>Hs.value.type=e),options:[{label:a.$t("rewardSys.behaviors.form.types.positive"),value:"positive"},{label:a.$t("rewardSys.behaviors.form.types.negative"),value:"negative"}],label:a.$t("rewardSys.behaviors.form.type")+" *",outlined:"",dense:"","emit-value":"","map-options":"",rules:[e=>!!e||"Type is required"],readonly:Ys.value&&!Ys.value.teacher_id},null,8,["modelValue","options","label","rules","readonly"]),B(y,{modelValue:Hs.value.points,"onUpdate:modelValue":h[47]||(h[47]=e=>Hs.value.points=e),modelModifiers:{number:!0},label:a.$t("rewardSys.behaviors.form.points")+" *",type:"number",outlined:"",dense:"",rules:[e=>null!==e&&""!==e||"Points are required"],hint:"positive"===Hs.value.type?"Positive number (e.g., 5)":"Negative number (e.g., -3)",readonly:Ys.value&&!Ys.value.teacher_id},null,8,["modelValue","label","rules","hint","readonly"]),B(y,{modelValue:Hs.value.icon,"onUpdate:modelValue":h[48]||(h[48]=e=>Hs.value.icon=e),label:a.$t("rewardSys.behaviors.form.icon"),outlined:"",dense:"",hint:"Optional emoji, e.g., ‚≠ê üéâ ‚ö†Ô∏è üö´",readonly:Ys.value&&!Ys.value.teacher_id},null,8,["modelValue","label","readonly"])]),_:1}),B(f,{align:"right",class:"q-px-md q-pb-md"},{default:W(()=>[ee(B(o,{flat:"",label:a.$t("rewardSys.tabs.cancel")},null,8,["label"]),[[w]]),!Ys.value||Ys.value.teacher_id?(q(),M(o,{key:0,color:"primary",label:Ys.value?a.$t("common.update"):a.$t("common.create"),onClick:Vo,loading:Js.value},null,8,["label","loading"])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),B(g,{modelValue:Ds.value,"onUpdate:modelValue":h[51]||(h[51]=e=>Ds.value=e),maximized:""},{default:W(()=>[B(Y(ge),{students:os.value,"saved-layouts":Ps.value,"editing-layout":Ns.value,onSave:Co,onDelete:jo,onClose:h[50]||(h[50]=e=>Ds.value=!1)},null,8,["students","saved-layouts","editing-layout"])]),_:1},8,["modelValue"]),B(g,{modelValue:Fs.value,"onUpdate:modelValue":h[57]||(h[57]=e=>Fs.value=e)},{default:W(()=>[B(re,{mode:Ls.value,"competition-start-time":qs.value,"date-from":Bs.value,"date-to":Os.value,"leaderboard-mode":Ms.value,"onUpdate:mode":h[52]||(h[52]=e=>Ls.value=e),"onUpdate:competitionStartTime":h[53]||(h[53]=e=>qs.value=e),"onUpdate:dateFrom":h[54]||(h[54]=e=>Bs.value=e),"onUpdate:dateTo":h[55]||(h[55]=e=>Os.value=e),"onUpdate:leaderboardMode":h[56]||(h[56]=e=>Ms.value=e),onApply:Go,onReset:Yo},null,8,["mode","competition-start-time","date-from","date-to","leaderboard-mode"])]),_:1},8,["modelValue"]),B(g,{modelValue:Ks.value,"onUpdate:modelValue":h[58]||(h[58]=e=>Ks.value=e),position:"top"},{default:W(()=>[B(r,{style:{"min-width":"350px","border-radius":"20px"},class:"q-ma-md bg-deep-purple-8 text-white shadow-2xl"},{default:W(()=>[B(t,{class:"column items-center text-center q-pa-lg"},{default:W(()=>{var e,a;return[B(m,{size:"80px",class:"q-mb-md shadow-lg border-4 border-white"},{default:W(()=>[Zs.value.student&&Zs.value.student.avatar?(q(),R("img",{key:0,src:vo(Zs.value.student)},null,8,Ll)):(q(),M(l,{key:1,name:"person"}))]),_:1}),O("div",Rl,G(null==(e=Zs.value.student)?void 0:e.name),1),O("div",ql,[O("span",{class:ae(Zs.value.points>0?"text-green-300":"text-red-300")},G(Zs.value.points>0?"+":"")+G(Zs.value.points),3),O("span",Bl,G((null==(a=Zs.value.behavior)?void 0:a.icon)||"‚≠ê"),1)]),O("div",Ol,G(Yl(Zs.value.behavior)),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),B(A,{modelValue:Ho.value,"onUpdate:modelValue":h[59]||(h[59]=e=>Ho.value=e),students:os.value,behaviors:ns.value,onUpdatePoints:Zo},null,8,["modelValue","students","behaviors"])])],64)}}},[["__scopeId","data-v-dcd298bb"]]);export{Ml as default};
