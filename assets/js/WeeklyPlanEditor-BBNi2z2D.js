import{d as e,e as l,Q as a,C as o,a as s,g as t,m as n,q as d,n as u,b as i,aD as r}from"./app-DXXarK7I.js";import{Q as c}from"./QSpace-B3qNlK-o.js";import{Q as m}from"./QEditor-Djr0kwzB.js";import{a as v,f as p,k as h,H as b,I as f,J as w,b as y,M as g,V as _,x,U as V,R as k,Z as q}from"./vendor-EI0FRBVb.js";import j from"./StatusBadge-B5P-Qe1x.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./use-fullscreen-DIOkwRkq.js";const C={class:"text-h6"},S={class:"row q-gutter-sm items-center"},Q={class:"row q-gutter-sm text-caption"},U={class:"row q-gutter-lg"},W={class:"col-12 col-md-6"},z={class:"text-subtitle1 text-weight-bold q-mb-sm"},E={class:"col-12 col-md-6"},H={class:"text-subtitle1 text-weight-bold q-mb-sm"},B={class:"col-12"},P={class:"text-subtitle1 text-weight-bold q-mb-sm"},T={__name:"WeeklyPlanEditor",props:{modelValue:{type:Boolean,default:!1},plan:{type:Object,default:null},saving:{type:Boolean,default:!1}},emits:["update:modelValue","submit"],setup(T,{emit:D}){const M=T,A=D,I=v({get:()=>M.modelValue,set:e=>A("update:modelValue",e)}),J=[["bold","italic","underline"],["unordered","ordered"],["link"],["undo","redo"]],N=["","Sunday","Monday","Tuesday","Wednesday","Thursday"],O=v(()=>{var e,l;return N[null==(l=null==(e=M.plan)?void 0:e.schedule)?void 0:l.day_number]||"Day"}),R=v(()=>{var e,l,a,o,s,t,n;return(null==(o=null==(a=null==(l=null==(e=M.plan)?void 0:e.schedule)?void 0:l.cst)?void 0:a.subject)?void 0:o.name)||(null==(n=null==(t=null==(s=M.plan)?void 0:s.schedule)?void 0:t.cst)?void 0:n.subject_name)||"Subject"}),Z=v(()=>{var e,l,a,o,s,t,n;return(null==(o=null==(a=null==(l=null==(e=M.plan)?void 0:e.schedule)?void 0:l.cst)?void 0:a.classroom)?void 0:o.name)||(null==(n=null==(t=null==(s=M.plan)?void 0:s.schedule)?void 0:t.cst)?void 0:n.classroom_name)||"Classroom"}),F=v(()=>{var e,l,a,o,s,t;return{backgroundColor:(null==(a=null==(l=null==(e=M.plan)?void 0:e.schedule)?void 0:l.cst)?void 0:a.c_bg)||"#e0e0e0",color:(null==(t=null==(s=null==(o=M.plan)?void 0:o.schedule)?void 0:s.cst)?void 0:t.c_text)||"#333"}}),G=v(()=>{var e,l;const a=!!(null==(e=K.value.cw)?void 0:e.trim()),o=!!(null==(l=K.value.hw)?void 0:l.trim());return a||o?a&&o?"completed":"partial":"empty"}),K=p({cw:"",hw:"",notes:""});h(()=>M.plan,e=>{K.value=e?{cw:e.cw||"",hw:e.hw||"",notes:e.notes||""}:{cw:"",hw:"",notes:""}},{immediate:!0}),h(I,e=>{e||(K.value={cw:"",hw:"",notes:""})});const L=()=>{var e;A("submit",{...K.value,id:null==(e=M.plan)?void 0:e.id})},X=p(!1),Y=async()=>{var e;if(null==(e=M.plan)?void 0:e.id){X.value=!0;try{const e=await q.post(route("weekly-system.api.sync",M.plan.id));e.data.success&&(A("submit",{...M.plan,...e.data.data,...K.value}),A("submit",{...e.data.data,...K.value}))}catch(l){console.error("Sync failed",l)}finally{X.value=!1}}};return(v,p)=>(f(),b(i,{modelValue:I.value,"onUpdate:modelValue":p[3]||(p[3]=e=>I.value=e),persistent:"",maximized:""},{default:w(()=>[y(u,null,{default:w(()=>[y(e,{class:"row items-center q-pb-none"},{default:w(()=>[g("div",C,[y(l,{name:"edit_note",class:"q-mr-sm",color:"primary"}),p[4]||(p[4]=_(" Edit Weekly Plan "))]),y(c),g("div",S,[y(j,{status:G.value},null,8,["status"]),x(y(a,{icon:"close",flat:"",round:"",dense:""},null,512),[[r]])])]),_:1}),y(e,{class:"q-pt-sm"},{default:w(()=>[g("div",Q,[y(o,{dense:"",icon:"calendar_today",size:"sm"},{default:w(()=>{var e;return[_(" Week "+V(null==(e=T.plan)?void 0:e.week_number),1)]}),_:1}),y(o,{dense:"",icon:"schedule",size:"sm"},{default:w(()=>{var e,l;return[_(V(O.value)+" - Period "+V(null==(l=null==(e=T.plan)?void 0:e.schedule)?void 0:l.period_number),1)]}),_:1}),y(o,{dense:"",icon:"menu_book",size:"sm",style:k(F.value)},{default:w(()=>[_(V(R.value),1)]),_:1},8,["style"]),y(o,{dense:"",icon:"meeting_room",size:"sm"},{default:w(()=>[_(V(Z.value),1)]),_:1})])]),_:1}),y(s),y(e,{class:"q-pa-md"},{default:w(()=>[g("div",U,[g("div",W,[g("div",z,[y(l,{name:"school",class:"q-mr-xs",color:"blue"}),p[5]||(p[5]=_(" Classwork (CW) "))]),y(m,{modelValue:K.value.cw,"onUpdate:modelValue":p[0]||(p[0]=e=>K.value.cw=e),"min-height":"200px",toolbar:J,placeholder:"Enter classwork content..."},null,8,["modelValue"])]),g("div",E,[g("div",H,[y(l,{name:"home_work",class:"q-mr-xs",color:"orange"}),p[6]||(p[6]=_(" Homework (HW) "))]),y(m,{modelValue:K.value.hw,"onUpdate:modelValue":p[1]||(p[1]=e=>K.value.hw=e),"min-height":"200px",toolbar:J,placeholder:"Enter homework content..."},null,8,["modelValue"])]),g("div",B,[g("div",P,[y(l,{name:"note",class:"q-mr-xs",color:"grey"}),p[7]||(p[7]=_(" Notes "))]),y(t,{modelValue:K.value.notes,"onUpdate:modelValue":p[2]||(p[2]=e=>K.value.notes=e),type:"textarea",outlined:"",rows:"3",placeholder:"Additional notes..."},null,8,["modelValue"])])])]),_:1}),y(s),y(n,{align:"right",class:"q-pa-md"},{default:w(()=>[y(a,{flat:"",icon:"sync",label:"Sync Schedule",color:"secondary",loading:X.value,onClick:Y},{default:w(()=>[y(d,null,{default:w(()=>p[8]||(p[8]=[_("Update assigned teacher/schedule info")])),_:1})]),_:1},8,["loading"]),y(c),x(y(a,{flat:"",label:"Cancel",color:"grey"},null,512),[[r]]),y(a,{label:"Save Changes",color:"primary",icon:"save",loading:T.saving,onClick:L},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}};export{T as default};
