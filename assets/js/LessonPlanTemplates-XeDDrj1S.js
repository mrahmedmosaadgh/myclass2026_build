import{p as e,u as l,d as a,n as t,Q as s,C as o,q as n,e as i,aD as r,g as d,a as u,b as c,A as m,m as p}from"./app-BXm70mdJ.js";import{a as v,Q as y}from"./QTable-rnEofRem.js";import{Q as b}from"./QTr-CHmCMIZo.js";import{Q as f}from"./QTd-BIxMTYzb.js";import{Q as k}from"./QSpace-Bu8V-QDa.js";import{Q as g}from"./QSelect-CnZtzPIC.js";import{Q as x}from"./QForm-DyZk5PSh.js";import{Q as h}from"./QDate-D499kdaX.js";import{Z as w,f as _,L as j,I as V,b as q,M as T,y as C,a3 as Q,J as A,O as U,U as N,H as P,V as D,$ as O,F as z,Q as F,x as S}from"./vendor-DNM7Y6Xn.js";import{d as I}from"./vuedraggable.umd-BqRLJd4h.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";import"./QMarkupTable-Dmg3C5Wm.js";import"./QLinearProgress-Cix0cchl.js";import"./use-fullscreen-FlxrEg_V.js";import"./rtl-Cr6c3OOr.js";import"./use-render-cache-CmTcazfP.js";import"./use-datetime-BlHPRpqw.js";import"./date-Dajz2muc.js";import"./index-CUaaxLlN.js";const L={class:"lesson-plan-templates"},E={class:"q-pa-md"},M={class:"row q-col-gutter-md"},$={class:"col-12"},J={class:"text-h5"},K={key:0,class:"text-subtitle2"},R={key:1,class:"q-mt-sm"},W={class:"col-12"},B={class:"row q-gutter-sm justify-end"},G={key:1,class:"q-pa-xl text-center empty-state"},H={class:"text-h6"},X={class:"row q-col-gutter-md"},Y={class:"col-12 col-md-6"},Z={class:"template-field-item"},ee={class:"row q-col-gutter-sm"},le={class:"col-12 col-sm-4"},ae={class:"col-12 col-sm-4"},te={class:"col-12 col-sm-3"},se={class:"col-12 col-sm-1 flex items-center justify-between"},oe={key:0,class:"row q-col-gutter-sm q-mt-xs"},ne={class:"col-12"},ie={class:"q-mt-md"},re={class:"row q-gutter-sm justify-end q-mt-lg"},de={key:0,class:"col-12 col-md-6"},ue={class:"text-h5"},ce={key:0,class:"text-caption q-mb-md"},me={class:"field-number"},pe={class:"text-h6"},ve={class:"text-h5"},ye={key:0,class:"text-caption q-mb-md"},be=e({__name:"LessonPlanTemplates",props:{subject:Object,templates:{type:Array,default:()=>[]}},setup(e){var be;w.defaults.headers.common["X-CSRF-TOKEN"]=null==(be=document.querySelector('meta[name="csrf-token"]'))?void 0:be.getAttribute("content"),w.defaults.withCredentials=!0;const fe=e,ke=l(),ge=_(Array.isArray(fe.templates)?fe.templates:[]),xe=_(!1),he=_(null),we=_(!1),_e=_(!1),je=_(!1),Ve=_(!1),qe=_(!1),Te=_(null),Ce=_(!1),Qe=_(null),Ae=_([]),Ue=[{label:"Text",value:"text"},{label:"Textarea",value:"textarea"},{label:"Select",value:"select"},{label:"Number",value:"number"},{label:"Date",value:"date"}],Ne=[{name:"name",label:"Template Name",field:"name",align:"left",sortable:!0},{name:"description",label:"Description",field:"description"},{name:"fields",label:"Fields",field:e=>Object.keys(e.structure||{}).length,align:"center"},{name:"actions",label:"Actions",field:"actions",align:"right"}],Pe=_({name:"",description:""}),De=()=>{Pe.value={name:"",description:""},Ae.value=[],xe.value=!1,he.value=null,Ce.value=!1},Oe=(e=null)=>{if(De(),null!==e){const l=ge.value[e];Pe.value={name:l.name,description:l.description||""},Ae.value=Object.entries(l.structure||{}).map(([e,l])=>({key:e,type:l.type||"text",label:l.label||e,options:l.options||""})),xe.value=!0,he.value=e}else Ae.value=[{key:"objectives",type:"textarea",label:"Learning Objectives"},{key:"materials",type:"textarea",label:"Materials Needed"},{key:"warmup",type:"textarea",label:"Warm-Up Activity"},{key:"instruction",type:"textarea",label:"Direct Instruction"},{key:"activity",type:"textarea",label:"Guided Practice"},{key:"independent",type:"textarea",label:"Independent Work"},{key:"assessment",type:"textarea",label:"Assessment"},{key:"reflection",type:"textarea",label:"Student Reflection"}];Ve.value=!0},ze=()=>{Ae.value.push({key:"",type:"text",label:"",options:""})},Fe=e=>{Qe.value=ge.value[e],qe.value=!0},Se=async()=>{if(Pe.value.name){for(const e of Ae.value)if(!e.key)return void ke.notify({color:"negative",message:"All fields must have a name",icon:"error"});we.value=!0;try{const e={};for(const a of Ae.value)e[a.key]={type:a.type,label:a.label},"select"===a.type&&a.options&&(e[a.key].options=a.options);const l={name:Pe.value.name,description:Pe.value.description,structure:e};xe.value?ge.value[he.value]=l:ge.value.push(l),await Le(),Ve.value=!1,De(),ke.notify({color:"positive",message:xe.value?"Template updated successfully":"Template added successfully",icon:"check_circle"})}catch(e){console.error("Error submitting form:",e),ke.notify({color:"negative",message:"An error occurred. Please try again.",icon:"error"})}finally{we.value=!1}}else ke.notify({color:"negative",message:"Template name is required",icon:"error"})},Ie=async()=>{if(null!==Te.value){_e.value=!0;try{ge.value.splice(Te.value,1),await Le(),ke.notify({color:"positive",message:"Template deleted successfully",icon:"check_circle"})}catch(e){console.error("Error deleting template:",e),ke.notify({color:"negative",message:"An error occurred while deleting the template",icon:"error"})}finally{_e.value=!1,Te.value=null}}},Le=async()=>{try{const e=`/admin/subject/${fe.subject.id}/lesson-plan-templates`;return(await w.patch(e,{lesson_plan_templates:JSON.stringify(ge.value)})).data}catch(e){throw console.error("Error saving templates:",e),e}};return(l,w)=>(V(),j("div",L,[q(C(Q),{title:`Lesson Plan Templates - ${e.subject.name}`},null,8,["title"]),T("div",E,[T("div",M,[T("div",$,[q(t,{class:"subject-info"},{default:A(()=>[q(a,null,{default:A(()=>[T("div",J,N(e.subject.name),1),e.subject.school?(V(),j("div",K,N(e.subject.school.name),1)):U("",!0),e.subject.description?(V(),j("div",R,N(e.subject.description),1)):U("",!0)]),_:1})]),_:1})]),T("div",W,[q(t,null,{default:A(()=>[q(a,{class:"row items-center justify-between q-pb-none"},{default:A(()=>[w[10]||(w[10]=T("div",null,[T("div",{class:"text-h6"},"Lesson Plan Templates"),T("div",{class:"text-subtitle2"},"Manage templates for this subject")],-1)),q(s,{color:"primary",icon:"add",label:"Add Template",onClick:w[0]||(w[0]=e=>Oe()),class:"q-px-md",unelevated:"",rounded:""})]),_:1}),q(a,null,{default:A(()=>[ge.value.length>0?(V(),P(y,{key:0,rows:ge.value,columns:Ne,"row-key":"name",pagination:{rowsPerPage:10},flat:"",bordered:"",class:"template-table"},{header:A(e=>[q(b,{props:e},{default:A(()=>[(V(!0),j(z,null,F(e.cols,l=>(V(),P(v,{key:l.name,props:e,class:"text-primary"},{default:A(()=>[D(N(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:A(e=>[q(b,{props:e,class:"cursor-pointer template-row",onClick:l=>Fe(e.rowIndex)},{default:A(()=>[q(f,{key:"name",props:e,class:"text-weight-medium"},{default:A(()=>[D(N(e.row.name),1)]),_:2},1032,["props"]),q(f,{key:"description",props:e,class:"text-grey-8"},{default:A(()=>[D(N(e.row.description||"No description"),1)]),_:2},1032,["props"]),q(f,{key:"fields",props:e,class:"text-center"},{default:A(()=>[q(o,{size:"sm",color:"primary","text-color":"white",outline:""},{default:A(()=>[D(N(Object.keys(e.row.structure||{}).length)+" fields ",1)]),_:2},1024)]),_:2},1032,["props"]),q(f,{key:"actions",props:e,"auto-width":"",onClick:w[1]||(w[1]=O(()=>{},["stop"]))},{default:A(()=>[T("div",B,[q(s,{flat:"",round:"",color:"primary",icon:"edit",size:"sm",onClick:l=>Oe(e.rowIndex)},{default:A(()=>[q(n,null,{default:A(()=>w[11]||(w[11]=[D("Edit Template")])),_:1})]),_:2},1032,["onClick"]),q(s,{flat:"",round:"",color:"info",icon:"visibility",size:"sm",onClick:l=>Fe(e.rowIndex)},{default:A(()=>[q(n,null,{default:A(()=>w[12]||(w[12]=[D("Preview Template")])),_:1})]),_:2},1032,["onClick"]),q(s,{flat:"",round:"",color:"negative",icon:"delete",size:"sm",onClick:l=>{return a=e.rowIndex,Te.value=a,void(je.value=!0);var a}},{default:A(()=>[q(n,null,{default:A(()=>w[13]||(w[13]=[D("Delete Template")])),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows"])):U("",!0),0===ge.value.length?(V(),j("div",G,[q(i,{name:"description",size:"64px",color:"primary",class:"q-mb-md"}),w[14]||(w[14]=T("div",{class:"text-h6 text-grey-8"},"No Templates Yet",-1)),w[15]||(w[15]=T("div",{class:"text-body1 q-mb-md text-grey-7"},"Create your first lesson plan template to get started",-1)),q(s,{color:"primary",icon:"add",label:"Create Template",onClick:w[2]||(w[2]=e=>Oe()),class:"q-px-md",unelevated:"",rounded:""})])):U("",!0)]),_:1})]),_:1})])])]),q(c,{modelValue:Ve.value,"onUpdate:modelValue":w[7]||(w[7]=e=>Ve.value=e),persistent:"",maximized:""},{default:A(()=>[q(t,null,{default:A(()=>[q(a,{class:"row items-center q-pb-none"},{default:A(()=>[T("div",H,N(xe.value?"Edit Template":"Add New Template"),1),q(k),S(q(s,{icon:"close",flat:"",round:"",dense:""},null,512),[[r]])]),_:1}),q(a,{class:"q-pt-none"},{default:A(()=>[T("div",X,[T("div",Y,[q(x,{onSubmit:Se,class:"q-gutter-md"},{default:A(()=>[q(d,{modelValue:Pe.value.name,"onUpdate:modelValue":w[3]||(w[3]=e=>Pe.value.name=e),label:"Template Name",rules:[e=>!!e||"Name is required"],outlined:""},null,8,["modelValue","rules"]),q(d,{modelValue:Pe.value.description,"onUpdate:modelValue":w[4]||(w[4]=e=>Pe.value.description=e),label:"Description",type:"textarea",outlined:""},null,8,["modelValue"]),w[16]||(w[16]=T("div",{class:"text-h6 q-mt-md"},"Template Fields",-1)),w[17]||(w[17]=T("div",{class:"text-caption q-mb-md"},"Add fields to your lesson plan template. Drag to reorder.",-1)),q(C(I),{modelValue:Ae.value,"onUpdate:modelValue":w[5]||(w[5]=e=>Ae.value=e),"item-key":"index",handle:".drag-handle","ghost-class":"ghost",class:"q-gutter-y-md"},{item:A(({element:e,index:l})=>[T("div",Z,[T("div",ee,[T("div",le,[q(d,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,label:"Field Name",outlined:"",dense:"",rules:[e=>!!e||"Field name is required"]},null,8,["modelValue","onUpdate:modelValue","rules"])]),T("div",ae,[q(g,{modelValue:e.type,"onUpdate:modelValue":l=>e.type=l,options:Ue,label:"Field Type",outlined:"",dense:"","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue"])]),T("div",te,[q(d,{modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,label:"Display Label",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),T("div",se,[q(s,{flat:"",round:"",color:"primary",icon:"drag_indicator",size:"sm",class:"drag-handle cursor-move"}),q(s,{flat:"",round:"",color:"negative",icon:"delete",onClick:e=>(e=>{Ae.value.splice(e,1)})(l),size:"sm"},null,8,["onClick"])])]),"select"===e.type?(V(),j("div",oe,[T("div",ne,[q(d,{modelValue:e.options,"onUpdate:modelValue":l=>e.options=l,label:"Options (comma separated)",outlined:"",dense:"",hint:"Enter options separated by commas"},null,8,["modelValue","onUpdate:modelValue"])])])):U("",!0)])]),_:1},8,["modelValue"]),T("div",ie,[q(s,{color:"primary",outline:"",icon:"add",label:"Add Field",onClick:ze})]),T("div",re,[S(q(s,{label:"Cancel",color:"grey",outline:""},null,512),[[r]]),q(s,{label:"Preview",color:"info",onClick:w[6]||(w[6]=e=>Ce.value=!0),outline:""}),q(s,{label:xe.value?"Update Template":"Save Template",type:"submit",color:"primary",loading:we.value},null,8,["label","loading"])])]),_:1})]),Ce.value?(V(),j("div",de,[q(t,{flat:"",bordered:""},{default:A(()=>[q(a,null,{default:A(()=>w[18]||(w[18]=[T("div",{class:"text-h6"},"Template Preview",-1),T("div",{class:"text-subtitle2"},"This is how your template will look",-1)])),_:1}),q(u),q(a,null,{default:A(()=>[T("div",ue,N(Pe.value.name),1),Pe.value.description?(V(),j("div",ce,N(Pe.value.description),1)):U("",!0),(V(!0),j(z,null,F(Ae.value,(e,l)=>(V(),j("div",{key:l,class:"q-mb-md preview-field"},[T("div",me,N(l+1),1),"text"===e.type?(V(),P(d,{key:0,outlined:"",label:e.label||e.key,readonly:""},null,8,["label"])):"textarea"===e.type?(V(),P(d,{key:1,type:"textarea",outlined:"",label:e.label||e.key,readonly:""},null,8,["label"])):"select"===e.type?(V(),P(g,{key:2,outlined:"",label:e.label||e.key,options:e.options?e.options.split(",").map(e=>e.trim()):[],readonly:""},null,8,["label","options"])):"number"===e.type?(V(),P(d,{key:3,type:"number",outlined:"",label:e.label||e.key,readonly:""},null,8,["label"])):"date"===e.type?(V(),P(h,{key:4,outlined:"",label:e.label||e.key,readonly:"",flat:"",bordered:""},null,8,["label"])):U("",!0)]))),128))]),_:1})]),_:1})])):U("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),q(c,{modelValue:qe.value,"onUpdate:modelValue":w[8]||(w[8]=e=>qe.value=e),maximized:""},{default:A(()=>[q(t,null,{default:A(()=>[q(a,{class:"row items-center"},{default:A(()=>[T("div",pe,"Template Preview: "+N(Qe.value?Qe.value.name:""),1),q(k),S(q(s,{icon:"close",flat:"",round:"",dense:""},null,512),[[r]])]),_:1}),Qe.value?(V(),P(a,{key:0},{default:A(()=>[T("div",ve,N(Qe.value.name),1),Qe.value.description?(V(),j("div",ye,N(Qe.value.description),1)):U("",!0),(V(!0),j(z,null,F(Qe.value.structure,(e,l)=>(V(),j("div",{key:l,class:"q-mb-md"},["text"===e.type?(V(),P(d,{key:0,outlined:"",label:e.label||l,readonly:""},null,8,["label"])):"textarea"===e.type?(V(),P(d,{key:1,type:"textarea",outlined:"",label:e.label||l,readonly:""},null,8,["label"])):"select"===e.type?(V(),P(g,{key:2,outlined:"",label:e.label||l,options:e.options?e.options.split(",").map(e=>e.trim()):[],readonly:""},null,8,["label","options"])):"number"===e.type?(V(),P(d,{key:3,type:"number",outlined:"",label:e.label||l,readonly:""},null,8,["label"])):"date"===e.type?(V(),P(h,{key:4,outlined:"",label:e.label||l,readonly:"",flat:"",bordered:""},null,8,["label"])):U("",!0)]))),128))]),_:1})):U("",!0)]),_:1})]),_:1},8,["modelValue"]),q(c,{modelValue:je.value,"onUpdate:modelValue":w[9]||(w[9]=e=>je.value=e),persistent:""},{default:A(()=>[q(t,null,{default:A(()=>[q(a,{class:"row items-center"},{default:A(()=>[q(m,{icon:"warning",color:"negative","text-color":"white"}),w[19]||(w[19]=T("span",{class:"q-ml-sm"},"Are you sure you want to delete this template?",-1))]),_:1}),q(p,{align:"right"},{default:A(()=>[S(q(s,{flat:"",label:"Cancel",color:"primary"},null,512),[[r]]),S(q(s,{flat:"",label:"Delete",color:"negative",onClick:Ie,loading:_e.value},null,8,["loading"]),[[r]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-99173608"]]);export{be as default};
