import{Q as e}from"./QSpace-CfcdpSpD.js";import{Q as l,c as a,f as o,h as u,i as t,d as n,n as i,l as r,m as s}from"./app-BB4Fw2oM.js";import{Q as d}from"./QSelect-BImwntZk.js";import{Q as m}from"./QForm-zhfWFjRn.js";import{f as p,r as c,a as f,o as v,_,I as b,J as g,K as V,b as y,N as h,V as F,W as j,Q as w}from"./vendor-DuKqz2x4.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./rtl-Cr6c3OOr.js";const k={class:"text-h6"},C={class:"q-gutter-sm"},U={__name:"MenuForm",props:{menu:{type:Object,default:null},modules:{type:Array,required:!0}},emits:["save","cancel"],setup(U,{emit:q}){const L=U,M=q,Q=p(!1),x=p(!1),S=p(!1),N=p(!1),O=p([]),$=p([]),A=p([]),I=p([]),P=p([]),D=c({label:"",module:"",parent_id:null,route:null,permission:null,icon:"",order:0,is_active:!0,is_feature_flag:!1,feature_flag_key:null}),K=f(()=>L.modules.map(e=>({label:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),value:e}))),R=f(()=>A.value.map(e=>({label:`${e.label} (${e.module})`,value:e.id})));v(async()=>{await Promise.all([E(),J(),T()]),L.menu&&Object.assign(D,{label:L.menu.label,module:L.menu.module,parent_id:L.menu.parent_id,route:L.menu.route,permission:L.menu.permission,icon:L.menu.icon,order:L.menu.order,is_active:L.menu.is_active,is_feature_flag:L.menu.is_feature_flag||!1,feature_flag_key:L.menu.feature_flag_key})});const E=async()=>{try{x.value=!0;const e=await _.get("/api/admin/menus/helpers/routes");O.value=e.data.map(e=>e.name),I.value=O.value}catch(e){console.error("Failed to load routes:",e)}finally{x.value=!1}},J=async()=>{try{S.value=!0;const e=await _.get("/api/admin/menus/helpers/permissions");$.value=e.data.map(e=>e.name),P.value=$.value}catch(e){console.error("Failed to load permissions:",e)}finally{S.value=!1}},T=async()=>{try{N.value=!0;const e=L.menu?{exclude_id:L.menu.id}:{},l=await _.get("/api/admin/menus/helpers/parents",{params:e});A.value=l.data}catch(e){console.error("Failed to load parents:",e)}finally{N.value=!1}},W=(e,l)=>{l(()=>{const l=e.toLowerCase();I.value=O.value.filter(e=>e.toLowerCase().includes(l))})},z=(e,l)=>{l(()=>{const l=e.toLowerCase();P.value=$.value.filter(e=>e.toLowerCase().includes(l))})},B=()=>{Q.value=!0,M("save",{...D}),Q.value=!1};return(p,c)=>(g(),b(s,{style:{"min-width":"600px","max-width":"800px"}},{default:V(()=>[y(a,{class:"row items-center q-pb-none"},{default:V(()=>[h("div",k,F(U.menu?"Edit Menu":"Create Menu"),1),y(e),y(l,{icon:"close",flat:"",round:"",dense:"",onClick:c[0]||(c[0]=e=>p.$emit("cancel"))})]),_:1}),y(a,null,{default:V(()=>[y(m,{onSubmit:B,class:"q-gutter-md"},{default:V(()=>[y(o,{modelValue:D.label,"onUpdate:modelValue":c[1]||(c[1]=e=>D.label=e),label:"Menu Label *",hint:"Display name for the menu item",rules:[e=>!!e||"Label is required"],outlined:""},null,8,["modelValue","rules"]),y(d,{modelValue:D.module,"onUpdate:modelValue":c[2]||(c[2]=e=>D.module=e),options:K.value,label:"Module *",hint:"Feature grouping for this menu",rules:[e=>!!e||"Module is required"],outlined:"","emit-value":"","map-options":""},null,8,["modelValue","options","rules"]),y(d,{modelValue:D.parent_id,"onUpdate:modelValue":c[3]||(c[3]=e=>D.parent_id=e),options:R.value,label:"Parent Menu",hint:"Leave empty for root level menu",outlined:"",clearable:"","emit-value":"","map-options":"",loading:N.value},null,8,["modelValue","options","loading"]),y(d,{modelValue:D.route,"onUpdate:modelValue":c[4]||(c[4]=e=>D.route=e),options:I.value,label:"Route",hint:"Named Laravel route (optional for parent menus)",outlined:"",clearable:"","use-input":"","input-debounce":"300",onFilter:W,loading:x.value},{"no-option":V(()=>[y(u,null,{default:V(()=>[y(t,{class:"text-grey"},{default:V(()=>c[12]||(c[12]=[j(" No routes found ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","loading"]),y(d,{modelValue:D.permission,"onUpdate:modelValue":c[5]||(c[5]=e=>D.permission=e),options:P.value,label:"Permission",hint:"Spatie permission required to see this menu",outlined:"",clearable:"","use-input":"","input-debounce":"300",onFilter:z,loading:S.value},null,8,["modelValue","options","loading"]),y(o,{modelValue:D.icon,"onUpdate:modelValue":c[6]||(c[6]=e=>D.icon=e),label:"Icon",hint:"Icon name (e.g., 'home', 'settings')",outlined:""},{prepend:V(()=>[y(n,{name:D.icon||"help_outline"},null,8,["name"])]),_:1},8,["modelValue"]),y(o,{modelValue:D.order,"onUpdate:modelValue":c[7]||(c[7]=e=>D.order=e),modelModifiers:{number:!0},type:"number",label:"Order",hint:"Display order (lower numbers appear first)",outlined:"",rules:[e=>e>=0||"Order must be 0 or greater"]},null,8,["modelValue","rules"]),y(i,{modelValue:D.is_active,"onUpdate:modelValue":c[8]||(c[8]=e=>D.is_active=e),label:"Active",color:"positive"},null,8,["modelValue"]),h("div",C,[y(i,{modelValue:D.is_feature_flag,"onUpdate:modelValue":c[9]||(c[9]=e=>D.is_feature_flag=e),label:"Feature Flag",color:"purple"},null,8,["modelValue"]),D.is_feature_flag?(g(),b(o,{key:0,modelValue:D.feature_flag_key,"onUpdate:modelValue":c[10]||(c[10]=e=>D.feature_flag_key=e),label:"Feature Flag Key *",hint:"Configuration key for feature flag",rules:[e=>!D.is_feature_flag||!!e||"Feature flag key is required"],outlined:""},null,8,["modelValue","rules"])):w("",!0)])]),_:1})]),_:1}),y(r,{align:"right"},{default:V(()=>[y(l,{flat:"",label:"Cancel",color:"grey-7",onClick:c[11]||(c[11]=e=>p.$emit("cancel"))}),y(l,{unelevated:"",label:"Save",color:"primary",onClick:B,loading:Q.value},null,8,["loading"])]),_:1})]),_:1}))}};export{U as default};
