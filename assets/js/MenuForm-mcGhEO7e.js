import{Q as e}from"./QSpace-Cq53gbnC.js";import{b as l,f as a,h as o,Q as s,c as t,j as u,k as n,p as i,q as r,o as d,d as m}from"./app-NYt77MEb.js";import{Q as c}from"./QSelect-BfJwO5J-.js";import{Q as p}from"./QForm-CzIe14r9.js";import{f as v,r as f,a as _,o as b,_ as g,I as y,J as V,K as h,b as q,R as w,V as x,W as j,N as F,O as U}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";const C={class:"text-h6"},k={class:"row q-col-gutter-md"},L={class:"col-12 col-md-6"},M={class:"col-12 col-md-6"},Q={class:"row q-col-gutter-md"},S={class:"col-12 col-md-6"},A={class:"col-12 col-md-6"},O={class:"row q-col-gutter-md"},R={class:"col-12 col-md-6"},$={class:"col-12 col-md-6"},I={class:"row items-center q-gutter-md"},K={class:"col-auto"},P={class:"col"},E={class:"bg-grey-1 q-pa-sm rounded-borders"},N={class:"row items-center"},z={key:0,class:"q-mt-sm"},B={__name:"MenuForm",props:{menu:{type:Object,default:null},modules:{type:Array,required:!0}},emits:["save","cancel"],setup(B,{emit:D}){const G=B,H=D,J=v(!1),W=v(!1),T=v(!1),X=v(!1),Y=v([]),Z=v([]),ee=v([]),le=v([]),ae=v([]),oe=f({label:"",label_ar:"",module:"",parent_id:null,route:null,permission:null,icon:"",order:0,is_active:!0,is_feature_flag:!1,feature_flag_key:null}),se=_(()=>G.modules.map(e=>({label:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),value:e}))),te=_(()=>ee.value.map(e=>({label:`${e.label} (${e.module})`,value:e.id})));b(async()=>{await Promise.all([ue(),ne(),ie()]),G.menu&&Object.assign(oe,{label:G.menu.label,label_ar:G.menu.label_ar,module:G.menu.module,parent_id:G.menu.parent_id,route:G.menu.route,permission:G.menu.permission,icon:G.menu.icon,order:G.menu.order,is_active:G.menu.is_active,is_feature_flag:G.menu.is_feature_flag||!1,feature_flag_key:G.menu.feature_flag_key})});const ue=async()=>{try{W.value=!0;const e=await g.get("/api/admin/menus/helpers/routes");Y.value=e.data.map(e=>e.name),le.value=Y.value}catch(e){console.error("Failed to load routes:",e)}finally{W.value=!1}},ne=async()=>{try{T.value=!0;const e=await g.get("/api/admin/menus/helpers/permissions");Z.value=e.data.map(e=>e.name),ae.value=Z.value}catch(e){console.error("Failed to load permissions:",e)}finally{T.value=!1}},ie=async()=>{try{X.value=!0;const e=G.menu?{exclude_id:G.menu.id}:{},l=await g.get("/api/admin/menus/helpers/parents",{params:e});ee.value=l.data}catch(e){console.error("Failed to load parents:",e)}finally{X.value=!1}},re=(e,l)=>{l(()=>{const l=e.toLowerCase();le.value=Y.value.filter(e=>e.toLowerCase().includes(l))})},de=(e,l)=>{l(()=>{const l=e.toLowerCase();ae.value=Z.value.filter(e=>e.toLowerCase().includes(l))})},me=()=>{J.value=!0,H("save",{...oe}),J.value=!1};return(v,f)=>(V(),y(m,{style:{"min-width":"600px","max-width":"800px"}},{default:h(()=>[q(a,{class:"row items-center q-pb-none"},{default:h(()=>[w("div",C,x(B.menu?"Edit Menu":"Create Menu"),1),q(e),q(l,{icon:"close",flat:"",round:"",dense:"",onClick:f[0]||(f[0]=e=>v.$emit("cancel"))})]),_:1}),q(a,null,{default:h(()=>[q(p,{onSubmit:me,class:"q-gutter-md"},{default:h(()=>[f[14]||(f[14]=w("div",{class:"text-subtitle2 text-primary q-mb-sm"},"General Information",-1)),w("div",k,[w("div",L,[q(o,{modelValue:oe.label,"onUpdate:modelValue":f[1]||(f[1]=e=>oe.label=e),label:"Menu Label *",hint:"Display name",rules:[e=>!!e||"Label is required"],outlined:"",dense:""},null,8,["modelValue","rules"])]),w("div",M,[q(o,{modelValue:oe.label_ar,"onUpdate:modelValue":f[2]||(f[2]=e=>oe.label_ar=e),label:"Label (Arabic)",hint:"Arabic display name",outlined:"",dir:"rtl",dense:""},null,8,["modelValue"])])]),w("div",Q,[w("div",S,[q(c,{modelValue:oe.module,"onUpdate:modelValue":f[3]||(f[3]=e=>oe.module=e),options:se.value,label:"Module *",hint:"Feature grouping",rules:[e=>!!e||"Module is required"],outlined:"",dense:"","emit-value":"","map-options":""},null,8,["modelValue","options","rules"])]),w("div",A,[q(o,{modelValue:oe.icon,"onUpdate:modelValue":f[4]||(f[4]=e=>oe.icon=e),label:"Icon",hint:"Material icon name",outlined:"",dense:""},{prepend:h(()=>[q(s,{name:oe.icon||"help_outline"},null,8,["name"])]),_:1},8,["modelValue"])])]),q(t,{class:"q-my-sm"}),f[15]||(f[15]=w("div",{class:"text-subtitle2 text-primary q-mb-sm"},"Hierarchy & Routing",-1)),q(c,{modelValue:oe.parent_id,"onUpdate:modelValue":f[5]||(f[5]=e=>oe.parent_id=e),options:te.value,label:"Parent Menu",hint:"Leave empty for root level menu",outlined:"",dense:"",clearable:"","emit-value":"","map-options":"",loading:X.value},null,8,["modelValue","options","loading"]),w("div",O,[w("div",R,[q(c,{modelValue:oe.route,"onUpdate:modelValue":f[6]||(f[6]=e=>oe.route=e),options:le.value,label:"Route",hint:"Laravel named route",outlined:"",dense:"",clearable:"","use-input":"","input-debounce":"300",onFilter:re,loading:W.value},{"no-option":h(()=>[q(u,null,{default:h(()=>[q(n,{class:"text-grey"},{default:h(()=>f[13]||(f[13]=[j("No routes found")])),_:1})]),_:1})]),_:1},8,["modelValue","options","loading"])]),w("div",$,[q(c,{modelValue:oe.permission,"onUpdate:modelValue":f[7]||(f[7]=e=>oe.permission=e),options:ae.value,label:"Permission",hint:"Required permission",outlined:"",dense:"",clearable:"","use-input":"","input-debounce":"300",onFilter:de,loading:T.value},null,8,["modelValue","options","loading"])])]),q(t,{class:"q-my-sm"}),f[16]||(f[16]=w("div",{class:"text-subtitle2 text-primary q-mb-sm"},"Settings",-1)),w("div",I,[w("div",K,[q(o,{modelValue:oe.order,"onUpdate:modelValue":f[8]||(f[8]=e=>oe.order=e),modelModifiers:{number:!0},type:"number",label:"Sort Order",outlined:"",dense:"",style:{width:"120px"},rules:[e=>e>=0||"Order >= 0"]},null,8,["modelValue","rules"])]),w("div",P,[q(i,{modelValue:oe.is_active,"onUpdate:modelValue":f[9]||(f[9]=e=>oe.is_active=e),label:"Active Status",color:"positive"},null,8,["modelValue"])])]),w("div",E,[w("div",N,[q(i,{modelValue:oe.is_feature_flag,"onUpdate:modelValue":f[10]||(f[10]=e=>oe.is_feature_flag=e),label:"Enable Functionality Flag",color:"purple",size:"sm"},null,8,["modelValue"])]),q(r,null,{default:h(()=>[oe.is_feature_flag?(V(),F("div",z,[q(o,{modelValue:oe.feature_flag_key,"onUpdate:modelValue":f[11]||(f[11]=e=>oe.feature_flag_key=e),label:"Feature Flag Key *",dense:"",outlined:"",rules:[e=>!oe.is_feature_flag||!!e||"Key required"]},null,8,["modelValue","rules"])])):U("",!0)]),_:1})])]),_:1})]),_:1}),q(d,{align:"right"},{default:h(()=>[q(l,{flat:"",label:"Cancel",color:"grey-7",onClick:f[12]||(f[12]=e=>v.$emit("cancel"))}),q(l,{unelevated:"",label:"Save",color:"primary",onClick:me,loading:J.value},null,8,["loading"])]),_:1})]),_:1}))}};export{B as default};
