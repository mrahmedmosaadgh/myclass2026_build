import{_ as e}from"./SecondaryButton-VyNp8kIv.js";import{_ as t}from"./PrimaryButton-BUJknf5C.js";import{M as a}from"./Modal-C39m6DkP.js";import{r as l,u as s}from"./xlsx-cMC2LkxH.js";import{f as r,a as o,L as i,I as n,M as d,b as u,J as c,U as p,O as m,K as y,V as f,F as v,Q as x,S as b}from"./vendor-DNM7Y6Xn.js";import"./app-BXm70mdJ.js";import"./offline-BzIlwqNM.js";import"./i18n-CBOKL2HS.js";import"./ui-BP0GJNn5.js";const g={class:"p-6"},h={class:"flex justify-between items-center mb-4"},w={class:"text-lg font-medium text-gray-900"},k={class:"text-sm text-gray-500"},j={key:0,class:"overflow-x-auto mb-4"},_={class:"min-w-full divide-y divide-gray-200"},C={class:"bg-gray-50"},I={class:"bg-white divide-y divide-gray-200"},S={key:0,class:"text-xs text-red-500"},T={class:"flex justify-end"},A={__name:"ImportExcel",props:{buttonText:{type:String,default:"Import Excel"},previewTitle:{type:String,default:"Import Preview"},columns:{type:Array,default:()=>[]},validator:{type:Function,default:null}},emits:["data"],setup(A,{emit:B}){const E=A,F=B,M=r(null),P=r(!1),R=r(!1),O=r([]),U=o(()=>O.value.some(e=>Object.keys(e.errors||{}).length>0)),$=async e=>{const t=e.target.files[0];if(t){P.value=!0;try{const e=await J(t);O.value=E.validator?e.map(e=>E.validator(e)):e,R.value=!0}catch(a){console.error("Error reading file:",a)}finally{P.value=!1,e.target.value=""}}},J=e=>new Promise((t,a)=>{const r=new FileReader;r.onload=e=>{try{const a=new Uint8Array(e.target.result),r=l(a,{type:"array"}),o=r.Sheets[r.SheetNames[0]],i=s.sheet_to_json(o);t(i.map(e=>({data:e,errors:{}})))}catch(r){a(r)}},r.onerror=a,r.readAsArrayBuffer(e)}),K=()=>{F("data",O.value),L()},L=()=>{R.value=!1,O.value=[]};return(l,s)=>(n(),i("div",null,[d("input",{type:"file",ref_key:"fileInput",ref:M,class:"hidden",accept:".xlsx,.xls",onChange:$},null,544),u(e,{onClick:s[0]||(s[0]=e=>l.$refs.fileInput.click()),disabled:P.value,class:"relative"},{default:c(()=>[d("span",null,p(A.buttonText),1)]),_:1},8,["disabled"]),u(a,{show:R.value,onClose:L,maxWidth:"4xl"},{default:c(()=>[d("div",g,[d("div",h,[d("h3",w,p(A.previewTitle),1),d("div",k," Total Records: "+p(O.value.length),1)]),R.value?(n(),i("div",j,[y(l.$slots,"preview",{data:O.value},()=>[d("table",_,[d("thead",C,[d("tr",null,[(n(!0),i(v,null,x(A.columns,(e,t)=>(n(),i("th",{key:t,class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},p(e.label),1))),128))])]),d("tbody",I,[(n(!0),i(v,null,x(O.value,(e,t)=>(n(),i("tr",{key:t},[(n(!0),i(v,null,x(A.columns,(t,a)=>{var l,s;return n(),i("td",{key:a,class:b(["px-6 py-4 whitespace-nowrap text-sm",(null==(l=e.errors)?void 0:l[t.key])?"text-red-600":"text-gray-900"])},[f(p(e.data[t.key])+" ",1),(null==(s=e.errors)?void 0:s[t.key])?(n(),i("p",S,p(e.errors[t.key]),1)):m("",!0)],2)}),128))]))),128))])])])])):m("",!0),d("div",T,[u(e,{onClick:L,class:"mr-2"},{default:c(()=>s[1]||(s[1]=[f(" Cancel ")])),_:1}),u(t,{onClick:K,disabled:U.value},{default:c(()=>s[2]||(s[2]=[f(" Confirm Import ")])),_:1},8,["disabled"])])])]),_:3},8,["show"])]))}};export{A as default};
