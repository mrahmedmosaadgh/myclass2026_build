import{Q as t}from"./QSpace-BD6HDuXW.js";import{Q as e}from"./QSelect-DvJQhHwY.js";import{r as a,u as l,f as s,g as i,Q as o,d as r,G as n,c as d,b as c,t as u,o as m,aS as p,e as v}from"./app-BxJhpxku.js";import{Q as x}from"./QBar-p1H6y_GZ.js";import{r as _,f as g,af as y,N as b,J as f,b as h,R as w,K as k,I as q,W as j,F as A,Q as C,O as z,V as S,y as E,z as V,$ as Q}from"./vendor-BWKGNkNB.js";import{s as M}from"./i18n-B0T1C7j3.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";const N={class:"q-pa-md"},R={class:"row items-center"},P={class:"row items-start q-gutter-sm"},U={class:"col"},F={class:"text-h6"},D={key:0,class:"text-caption text-grey-7 q-mt-xs"},L={class:"row q-gutter-md"},O={class:"col-12 col-sm-6 col-md-3"},T={class:"col-12 col-sm-6 col-md-3"},B={class:"col-12 col-sm-6 col-md-2"},H={class:"text-body2"},I={class:"col-12 col-sm-6 col-md-2"},Y={class:"text-body2"},G={key:0,class:"col-12 col-sm-6 col-md-2"},J={class:"text-body2"},K={class:"row q-gutter-md"},W={key:0,class:"col"},$={class:"text-body2"},X={key:1,class:"col"},Z={class:"text-body2"},tt={class:"row items-start q-gutter-md"},et={class:"col"},at={class:"q-mb-sm"},lt={key:0,class:"q-mt-md"},st={class:"row q-col-gutter-xs"},it={class:"col-3"},ot={class:"text-subtitle1 text-purple-10 text-weight-bolder q-my-none",style:{"line-height":"1.1"}},rt={key:0,class:"text-caption text-purple-5"},nt={class:"col-3"},dt={class:"text-caption text-amber-10 text-weight-bold row justify-center items-center",style:{"font-size":"0.7rem"}},ct={class:"text-subtitle1 text-amber-10 text-weight-bolder q-my-none",style:{"line-height":"1.1"}},ut={class:"text-caption",style:{"font-size":"0.7rem"}},mt={class:"text-amber-9 text-weight-bold",style:{"font-size":"9px"}},pt={class:"col-3"},vt={class:"text-subtitle1 text-blue-10 text-weight-bolder q-my-none",style:{"line-height":"1.1"}},xt={class:"text-caption",style:{"font-size":"0.7rem"}},_t={class:"text-blue-8 text-weight-bold",style:{"font-size":"9px"}},gt={class:"col-3"},yt={class:"text-subtitle1 text-teal-10 text-weight-bold q-my-none",style:{"line-height":"1.1"}},bt={class:"text-caption",style:{"font-size":"0.7rem"}},ft={class:"text-teal-8",style:{"font-size":"8px","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},ht={key:1,class:"text-caption text-grey-6"},wt={class:"col-auto"},kt={class:"text-caption text-grey-7"},qt={key:0},jt=["src"],At=a({__name:"QuStudentExamList",props:{exams:Array,subjects:Array,filters:Object},setup(a){var At;const Ct=l(),zt=_({subject_id:(null==(At=a.filters)?void 0:At.subject_id)||null}),St=g(!1),Et=g(null),Vt=()=>{Q.get(M("qu-student.exams.index"),zt,{preserveState:!0,preserveScroll:!0})},Qt=t=>{var e;return t.is_available&&(null===t.remaining_attempts||t.remaining_attempts>0)&&!(null==(e=t.attempt_stats)?void 0:e.has_in_progress)},Mt=t=>t.is_available?null!==t.remaining_attempts&&t.remaining_attempts<=0?"No Attempts Remaining":"Not Available":"upcoming"===t.status?"Not Yet Available":"ended"===t.status?"Exam Ended":"Not Available",Nt=()=>{Q.post(M("qu-student.exams.start",Et.value.id),{},{onSuccess:()=>{St.value=!1},onError:t=>{Ct.notify({type:"negative",message:t.message||"Failed to start exam",icon:"error"})}})},Rt=g(!1),Pt=g(null),Ut=t=>t?t.charAt(0).toUpperCase()+t.slice(1):"",Ft=t=>{if(!t)return"";return new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})};return(l,_)=>{const g=y("Head");return f(),b(A,null,[h(g,{title:"Available Exams"}),w("div",N,[h(r,null,{default:k(()=>[h(s,null,{default:k(()=>[w("div",R,[_[3]||(_[3]=w("div",{class:"text-h5"},"Available Exams",-1)),h(t),h(e,{modelValue:zt.subject_id,"onUpdate:modelValue":[_[0]||(_[0]=t=>zt.subject_id=t),Vt],options:a.subjects,"option-value":"id","option-label":"name",label:"Filter by Subject",clearable:"","emit-value":"","map-options":"",style:{"min-width":"200px"}},null,8,["modelValue","options"])])]),_:1}),0===a.exams.length?(f(),q(s,{key:0},{default:k(()=>[h(i,{class:"bg-grey-2"},{avatar:k(()=>[h(o,{name:"info",color:"primary"})]),default:k(()=>[_[4]||(_[4]=j(" No exams available at this time. "))]),_:1})]),_:1})):(f(),q(s,{key:1,class:"q-gutter-md"},{default:k(()=>[(f(!0),b(A,null,C(a.exams,t=>(f(),q(r,{key:t.id,bordered:"",class:"exam-card"},{default:k(()=>[h(s,null,{default:k(()=>{return[w("div",P,[w("div",U,[w("div",F,S(t.title),1),t.description?(f(),b("div",D,S(t.description),1)):z("",!0)]),h(n,{color:(e=t.status,{draft:"grey",upcoming:"blue",active:"green",ended:"orange"}[e]||"grey"),"text-color":"white"},{default:k(()=>[j(S(Ut(t.status)),1)]),_:2},1032,["color"])])];var e}),_:2},1024),h(d),h(s,null,{default:k(()=>{return[w("div",L,[w("div",O,[_[5]||(_[5]=w("div",{class:"text-caption text-grey-7"},"Subject",-1)),h(n,{dense:"",color:"primary","text-color":"white"},{default:k(()=>{var e;return[j(S(null==(e=t.subject)?void 0:e.name),1)]}),_:2},1024)]),w("div",T,[_[6]||(_[6]=w("div",{class:"text-caption text-grey-7"},"Type",-1)),h(n,{dense:"",color:(e=t.exam_type,{practice:"cyan",quiz:"purple",midterm:"orange",final:"red",survey:"teal"}[e]||"grey"),"text-color":"white"},{default:k(()=>[j(S(Ut(t.exam_type)),1)]),_:2},1032,["color"])]),w("div",B,[_[7]||(_[7]=w("div",{class:"text-caption text-grey-7"},"Duration",-1)),w("div",H,S(t.duration_minutes)+" min",1)]),w("div",I,[_[8]||(_[8]=w("div",{class:"text-caption text-grey-7"},"Total Marks",-1)),w("div",Y,S(t.total_marks),1)]),t.passing_score?(f(),b("div",G,[_[9]||(_[9]=w("div",{class:"text-caption text-grey-7"},"Passing Score",-1)),w("div",J,S(t.passing_score),1)])):z("",!0)])];var e}),_:2},1024),t.start_date||t.end_date?(f(),q(s,{key:0},{default:k(()=>[w("div",K,[t.start_date?(f(),b("div",W,[_[10]||(_[10]=w("div",{class:"text-caption text-grey-7"},"Available From",-1)),w("div",$,S(Ft(t.start_date)),1)])):z("",!0),t.end_date?(f(),b("div",X,[_[11]||(_[11]=w("div",{class:"text-caption text-grey-7"},"Available Until",-1)),w("div",Z,S(Ft(t.end_date)),1)])):z("",!0)])]),_:2},1024)):z("",!0),h(d),h(s,null,{default:k(()=>{var e,a,l,s,i,d;return[w("div",tt,[w("div",et,[_[18]||(_[18]=w("div",{class:"text-subtitle2 q-mb-sm"},"Attempt History",-1)),w("div",at,[h(n,{dense:"",color:"primary","text-color":"white",icon:"assignment"},{default:k(()=>{var e;return[j(S((null==(e=t.attempt_stats)?void 0:e.completed_attempts)||0)+" / "+S(t.max_attempts||"âˆž")+" Completed ",1)]}),_:2},1024),null!==t.remaining_attempts&&t.remaining_attempts>0?(f(),q(n,{key:0,dense:"",color:"green","text-color":"white",icon:"check_circle"},{default:k(()=>[j(S(t.remaining_attempts)+" Remaining ",1)]),_:2},1024)):0===t.remaining_attempts?(f(),q(n,{key:1,dense:"",color:"orange","text-color":"white",icon:"block"},{default:k(()=>_[12]||(_[12]=[j(" No Attempts Left ")])),_:1})):z("",!0)]),(null==(e=t.attempt_stats)?void 0:e.completed_attempts)>0?(f(),b("div",lt,[w("div",st,[w("div",it,[h(r,{flat:"",class:"bg-purple-1 text-center q-pa-xs rounded-borders h-full"},{default:k(()=>[_[13]||(_[13]=w("div",{class:"text-caption text-purple-9 text-weight-bold",style:{"font-size":"0.7rem"}},"Runs",-1)),w("div",ot,[j(S(t.attempt_stats.completed_attempts)+" ",1),t.max_attempts?(f(),b("span",rt,"/"+S(t.max_attempts),1)):z("",!0)])]),_:2},1024)]),w("div",nt,[h(r,{flat:"",class:"bg-amber-1 text-center q-pa-xs rounded-borders h-full"},{default:k(()=>[w("div",dt,[h(o,{name:"emoji_events",size:"12px",class:"q-mr-xs"}),_[14]||(_[14]=j(" Best "))]),w("div",ct,[j(S(Math.round(t.attempt_stats.best_score||0))+" ",1),w("span",ut,"/"+S(t.total_marks),1)]),w("div",mt,S(Math.round(t.attempt_stats.best_score/t.total_marks*100))+"% ",1)]),_:2},1024)]),w("div",pt,[h(r,{flat:"",class:"bg-blue-1 text-center q-pa-xs rounded-borders h-full"},{default:k(()=>[_[15]||(_[15]=w("div",{class:"text-caption text-blue-9 text-weight-bold",style:{"font-size":"0.7rem"}},"Avg",-1)),w("div",vt,[j(S(Math.round(t.attempt_stats.average_score||0))+" ",1),w("span",xt,"/"+S(t.total_marks),1)]),w("div",_t,S(Math.round(t.attempt_stats.average_score/t.total_marks*100))+"% ",1)]),_:2},1024)]),w("div",gt,[h(r,{flat:"",class:"bg-teal-1 text-center q-pa-xs rounded-borders h-full"},{default:k(()=>[_[16]||(_[16]=w("div",{class:"text-caption text-teal-9 text-weight-bold",style:{"font-size":"0.7rem"}},"Last",-1)),w("div",yt,[j(S(Math.round(t.attempt_stats.last_score||0))+" ",1),w("span",bt,"/"+S(t.total_marks),1)]),w("div",ft,S(Ft(t.attempt_stats.last_attempt_date).split(",")[0]),1)]),_:2},1024)])])])):(f(),b("div",ht,[h(o,{name:"info",size:"xs",class:"q-mr-xs"}),_[17]||(_[17]=j(" No completed attempts yet "))]))]),w("div",wt,[(null==(a=t.attempt_stats)?void 0:a.has_in_progress)?(f(),q(c,{key:0,color:"orange",label:"Resume Exam",icon:"play_arrow",onClick:e=>(t=>{Q.visit(M("qu-student.exams.take",{quExam:t.id,quAttempt:t.attempt_stats.in_progress_attempt_id}))})(t)},null,8,["onClick"])):Qt(t)?(f(),q(c,{key:1,color:"primary",label:"Start Exam",icon:"play_arrow",onClick:e=>(t=>{Et.value=t,St.value=!0})(t)},null,8,["onClick"])):z("",!0),(null==(l=t.attempt_stats)?void 0:l.completed_attempts)>0?(f(),q(c,{key:2,flat:"",color:"info",label:"View Results",icon:"assessment",onClick:e=>(t=>{var e;const a=null==(e=t.attempt_stats)?void 0:e.last_attempt_id;a&&Q.visit(M("qu-student.exams.results",{quExam:t.id,quAttempt:a}))})(t)},null,8,["onClick"])):z("",!0),(null==(s=t.settings)?void 0:s.allow_print)?(f(),q(c,{key:3,flat:"",color:"secondary",label:"Print",icon:"print",onClick:e=>(t=>{window.open(M("qu-student.exams.print",t.id),"_blank","width=800,height=600")})(t)},{default:k(()=>[h(u,null,{default:k(()=>_[19]||(_[19]=[j("Open print view in new window")])),_:1})]),_:2},1032,["onClick"])):z("",!0),(null==(i=t.settings)?void 0:i.allow_print)?(f(),q(c,{key:4,flat:"",color:"indigo",label:"Preview",icon:"visibility",onClick:e=>(t=>{Pt.value=t,Rt.value=!0})(t)},{default:k(()=>[h(u,null,{default:k(()=>_[20]||(_[20]=[j("Preview and print in dialog")])),_:1})]),_:2},1032,["onClick"])):z("",!0),Qt(t)||(null==(d=t.attempt_stats)?void 0:d.has_in_progress)?z("",!0):(f(),q(c,{key:5,disable:"",color:"grey",label:Mt(t)},null,8,["label"]))])])]}),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),h(v,{modelValue:St.value,"onUpdate:modelValue":_[1]||(_[1]=t=>St.value=t)},{default:k(()=>[h(r,{style:{"min-width":"400px"}},{default:k(()=>[h(s,null,{default:k(()=>_[21]||(_[21]=[w("div",{class:"text-h6"},"Start Exam",-1)])),_:1}),h(s,null,{default:k(()=>{var t,e,a,l,s;return[w("p",null,[_[22]||(_[22]=j("You are about to start: ")),w("strong",null,S(null==(t=Et.value)?void 0:t.title),1)]),w("p",kt,[j(" Duration: "+S(null==(e=Et.value)?void 0:e.duration_minutes)+" minutes",1),_[23]||(_[23]=w("br",null,null,-1)),j(" Total Marks: "+S(null==(a=Et.value)?void 0:a.total_marks),1),_[24]||(_[24]=w("br",null,null,-1)),(null==(l=Et.value)?void 0:l.max_attempts)?(f(),b("span",qt," Remaining Attempts: "+S(null==(s=Et.value)?void 0:s.remaining_attempts),1)):z("",!0)]),h(i,{class:"bg-orange-1 text-orange-9 q-mt-md"},{avatar:k(()=>[h(o,{name:"warning",color:"orange"})]),default:k(()=>[_[25]||(_[25]=j(" Once started, the timer will begin immediately. Make sure you have enough time to complete the exam. "))]),_:1})]}),_:1}),h(m,{align:"right"},{default:k(()=>[E(h(c,{flat:"",label:"Cancel",color:"primary"},null,512),[[p]]),h(c,{label:"Start Exam",color:"primary",onClick:Nt})]),_:1})]),_:1})]),_:1},8,["modelValue"]),h(v,{modelValue:Rt.value,"onUpdate:modelValue":_[2]||(_[2]=t=>Rt.value=t),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:k(()=>[h(r,{class:"bg-white text-black"},{default:k(()=>[h(x,{class:"bg-primary text-white"},{default:k(()=>{var e;return[h(o,{name:"print"}),w("div",null,"Print Preview: "+S(null==(e=Pt.value)?void 0:e.title),1),h(t),E((f(),q(c,{dense:"",flat:"",icon:"close"},{default:k(()=>[h(u,null,{default:k(()=>_[26]||(_[26]=[j("Close")])),_:1})]),_:1})),[[p]])]}),_:1}),h(s,{class:"q-pa-none",style:{height:"calc(100vh - 50px)"}},{default:k(()=>{var t;return[Pt.value?(f(),b("iframe",{key:0,id:"printFrame",src:V(M)("qu-student.exams.print",null==(t=Pt.value)?void 0:t.id),style:{width:"100%",height:"100%",border:"none"}},null,8,jt)):z("",!0)]}),_:1})]),_:1})]),_:1},8,["modelValue"])])],64)}}},[["__scopeId","data-v-d718bc2d"]]);export{At as default};
