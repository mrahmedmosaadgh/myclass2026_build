import{Q as e}from"./QSpace-CfcdpSpD.js";import{o as t,u as a,p as l,Q as s,c as o,m as r,f as i,d,aP as c,C as n,b as u}from"./app-BB4Fw2oM.js";import{Q as m}from"./QBadge-BkpTfeZ_.js";import{Q as p}from"./QTd-By_JVJWe.js";import{Q as f}from"./QTable-_oeeTwa9.js";import{Q as v,a as g}from"./QToolbar-C7aOZqau.js";import{Q as x}from"./QSpinnerDots-L0wFsY2y.js";import{f as b,a as _,M as y,J as h,b as w,N as Q,z as j,a4 as q,K as A,W as S,V as k,I as P,Q as E,y as T,F as D,_ as V}from"./vendor-DuKqz2x4.js";import{s as z}from"./i18n-DE5KxGn8.js";import{u as C,E as M,i as L,a as R,b as B,c as O,d as F,e as G,f as I}from"./install-Doq8KMM5.js";import"./offline-BzIlwqNM.js";import"./ui-BITzTqrO.js";import"./QMarkupTable-DlrrqBMs.js";import"./QSelect-BImwntZk.js";import"./rtl-Cr6c3OOr.js";import"./QLinearProgress-BvcJ9Hu7.js";import"./use-fullscreen-DtPjMCV2.js";const N={class:"q-pa-md"},U={class:"row items-center q-mb-md"},J={class:"row q-col-gutter-md q-mb-lg"},K={class:"col-12 col-sm-6 col-md-3"},W={class:"text-h4 text-weight-bold"},H={class:"col-12 col-sm-6 col-md-3"},X={class:"text-h4 text-weight-bold"},Y={class:"col-12 col-sm-6 col-md-3"},Z={class:"text-h4 text-weight-bold"},$={class:"col-12 col-sm-6 col-md-3"},ee={class:"text-h4 text-weight-bold"},te={class:"text-caption q-ml-xs text-grey"},ae={class:"row justify-center q-py-xl"},le={class:"row q-col-gutter-md q-mb-lg"},se={class:"col-6 col-md-3"},oe={class:"text-h5 text-weight-bold"},re={class:"col-6 col-md-3"},ie={class:"text-h5 text-weight-bold text-primary"},de={class:"col-6 col-md-3"},ce={class:"text-h5 text-weight-bold text-indigo"},ne={class:"col-6 col-md-3"},ue={class:"text-h5 text-weight-bold text-green"},me={class:"row q-col-gutter-md"},pe={class:"col-12 col-md-6"},fe={class:"col-12 col-md-6"},ve={class:"q-mt-md"},ge={style:{"max-width":"400px","white-space":"normal",overflow:"hidden","text-overflow":"ellipsis"}},xe=t({__name:"QuAnalyticsDashboard",props:{exams:Array},setup(t){C([L,R,B,O,F,G,I]);const xe=t,be=a(),_e=b(""),ye=b(!1),he=b(null),we=b(!1),Qe=b(null),je=_(()=>xe.exams.reduce((e,t)=>e+t.attempts_count,0)),qe=_(()=>xe.exams.reduce((e,t)=>e+t.pending_grading,0)),Ae=_(()=>{const e=xe.exams.filter(e=>e.completed_attempts>0);if(0===e.length)return 0;const t=e.reduce((e,t)=>e+t.average_score/t.total_marks*100,0);return Math.round(t/e.length)}),Se=[{name:"title",required:!0,label:"Exam Title",align:"left",field:"title",sortable:!0},{name:"created_at",label:"Date",field:"created_at",sortable:!0},{name:"completed_attempts",label:"Attempts",field:"completed_attempts",sortable:!0},{name:"average_score",label:"Avg Score",field:"average_score",sortable:!0},{name:"pending_grading",label:"Pending Grading",field:"pending_grading",sortable:!0,classes:e=>e.pending_grading>0?"text-negative text-weight-bold":""},{name:"actions",label:"Actions",field:"actions",align:"right"}],ke=[{name:"text",label:"Question",field:"text",align:"left"},{name:"type",label:"Type",field:"type",align:"left"},{name:"bloom_level",label:"Bloom Level",field:"bloom_level",align:"left",sortable:!0},{name:"difficulty_label",label:"Difficulty",field:"difficulty_label",align:"left",sortable:!0}],Pe=(e,t)=>{const a=e/t*100;return a>=80?"green":a>=60?"blue":a>=40?"orange":"red"},Ee=()=>{be.notify({type:"info",message:"Export coming soon"})},Te=_(()=>{if(!Qe.value)return{};const e=Qe.value.score_distribution;return{tooltip:{trigger:"axis"},xAxis:{type:"category",data:Object.keys(e),name:"Score Range"},yAxis:{type:"value",name:"Students"},series:[{data:Object.values(e),type:"bar",color:"#3f51b5"}]}}),De=_(()=>{if(!Qe.value)return{};const e=Qe.value.bloom_stats;return{tooltip:{trigger:"axis"},xAxis:{type:"category",data:e.map(e=>e.level),axisLabel:{interval:0,rotate:30}},yAxis:{type:"value",name:"Avg Score %",max:100},series:[{data:e.map(e=>e.avg_percentage),type:"bar",color:"#ff9800",label:{show:!0,position:"top",formatter:"{c}%"}}]}});return(a,b)=>(h(),y(D,null,[w(j(q),{title:"Exam Analytics"}),Q("div",N,[Q("div",U,[b[3]||(b[3]=Q("div",{class:"text-h5"},"Exam Analytics",-1)),w(e),w(s,{color:"secondary",icon:"table_chart",label:"Export All",disable:"",outline:""},{default:A(()=>[w(l,null,{default:A(()=>b[2]||(b[2]=[S("Coming Soon")])),_:1})]),_:1})]),Q("div",J,[Q("div",K,[w(r,{class:"bg-primary text-white"},{default:A(()=>[w(o,null,{default:A(()=>[b[4]||(b[4]=Q("div",{class:"text-subtitle2"},"Total Exams",-1)),Q("div",W,k(t.exams.length),1)]),_:1})]),_:1})]),Q("div",H,[w(r,{class:"bg-teal text-white"},{default:A(()=>[w(o,null,{default:A(()=>[b[5]||(b[5]=Q("div",{class:"text-subtitle2"},"Total Attempts",-1)),Q("div",X,k(je.value),1)]),_:1})]),_:1})]),Q("div",Y,[w(r,{class:"bg-orange text-white"},{default:A(()=>[w(o,null,{default:A(()=>[b[6]||(b[6]=Q("div",{class:"text-subtitle2"},"Pending Grading",-1)),Q("div",Z,k(qe.value),1)]),_:1})]),_:1})]),Q("div",$,[w(r,{class:"bg-indigo text-white"},{default:A(()=>[w(o,null,{default:A(()=>[b[7]||(b[7]=Q("div",{class:"text-subtitle2"},"Avg Score",-1)),Q("div",ee,k(Ae.value)+"%",1)]),_:1})]),_:1})])]),w(r,null,{default:A(()=>[w(f,{title:"Exam Performance",rows:t.exams,columns:Se,"row-key":"id",filter:_e.value,pagination:{rowsPerPage:10}},{"top-right":A(()=>[w(i,{borderless:"",dense:"",debounce:"300",modelValue:_e.value,"onUpdate:modelValue":b[0]||(b[0]=e=>_e.value=e),placeholder:"Search"},{append:A(()=>[w(d,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-average_score":A(e=>[w(p,{props:e},{default:A(()=>[w(m,{color:Pe(e.value,e.row.total_marks)},{default:A(()=>[S(k(e.value)+" / "+k(e.row.total_marks),1)]),_:2},1032,["color"]),Q("span",te," ("+k(Math.round(e.value/e.row.total_marks*100))+"%) ",1)]),_:2},1032,["props"])]),"body-cell-actions":A(e=>[w(p,{props:e,align:"right"},{default:A(()=>[w(s,{flat:"",round:"",color:"primary",icon:"analytics",onClick:t=>(async e=>{he.value=e,ye.value=!0,we.value=!0,Qe.value=null;try{const t=await V.get(z("qu-analytics.exam",e.id));Qe.value=t.data}catch(t){console.error(t),be.notify({type:"negative",message:"Failed to load analytics data"})}finally{we.value=!1}})(e.row)},{default:A(()=>[w(l,null,{default:A(()=>b[8]||(b[8]=[S("View Detailed Analytics")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","filter"])]),_:1}),w(u,{modelValue:ye.value,"onUpdate:modelValue":b[1]||(b[1]=e=>ye.value=e),maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:A(()=>[w(r,{class:"bg-grey-1"},{default:A(()=>[w(v,{class:"bg-primary text-white"},{default:A(()=>[T(w(s,{flat:"",round:"",dense:"",icon:"close"},null,512),[[c]]),w(g,null,{default:A(()=>{var e;return[S(" Analytics: "+k(null==(e=he.value)?void 0:e.title),1)]}),_:1}),w(s,{flat:"",icon:"download",label:"Export Report",onClick:Ee,disable:""})]),_:1}),we.value?(h(),P(o,{key:0,class:"q-pa-md"},{default:A(()=>[Q("div",ae,[w(x,{color:"primary",size:"3em"}),b[9]||(b[9]=Q("div",{class:"text-grey q-mt-md"},"Loading analytics data...",-1))])]),_:1})):Qe.value?(h(),P(o,{key:1,class:"q-pa-md"},{default:A(()=>[Q("div",le,[Q("div",se,[w(r,{flat:"",bordered:"",class:"text-center q-pa-sm"},{default:A(()=>[b[10]||(b[10]=Q("div",{class:"text-caption text-grey"},"Attempts",-1)),Q("div",oe,k(Qe.value.overview.total_attempts),1)]),_:1})]),Q("div",re,[w(r,{flat:"",bordered:"",class:"text-center q-pa-sm"},{default:A(()=>[b[11]||(b[11]=Q("div",{class:"text-caption text-grey"},"Average Score",-1)),Q("div",ie,k(Qe.value.overview.avg_score),1)]),_:1})]),Q("div",de,[w(r,{flat:"",bordered:"",class:"text-center q-pa-sm"},{default:A(()=>[b[12]||(b[12]=Q("div",{class:"text-caption text-grey"},"Median Score",-1)),Q("div",ce,k(Qe.value.overview.median_score),1)]),_:1})]),Q("div",ne,[w(r,{flat:"",bordered:"",class:"text-center q-pa-sm"},{default:A(()=>[b[13]||(b[13]=Q("div",{class:"text-caption text-grey"},"Pass Rate",-1)),Q("div",ue,k(Qe.value.overview.pass_rate)+"%",1)]),_:1})])]),Q("div",me,[Q("div",pe,[w(r,{flat:"",bordered:"",class:"full-height"},{default:A(()=>[w(o,null,{default:A(()=>b[14]||(b[14]=[Q("div",{class:"text-h6"},"Score Distribution",-1)])),_:1}),w(o,{style:{height:"300px"}},{default:A(()=>[w(j(M),{class:"chart",option:Te.value,autoresize:""},null,8,["option"])]),_:1})]),_:1})]),Q("div",fe,[w(r,{flat:"",bordered:"",class:"full-height"},{default:A(()=>[w(o,null,{default:A(()=>b[15]||(b[15]=[Q("div",{class:"text-h6"},"Bloom's Taxonomy Performance",-1)])),_:1}),w(o,{style:{height:"300px"}},{default:A(()=>[w(j(M),{class:"chart",option:De.value,autoresize:""},null,8,["option"])]),_:1})]),_:1})])]),Q("div",ve,[w(r,{flat:"",bordered:""},{default:A(()=>[w(o,null,{default:A(()=>b[16]||(b[16]=[Q("div",{class:"text-h6"},"Question Difficulty Analysis",-1)])),_:1}),w(f,{rows:Qe.value.question_stats,columns:ke,"row-key":"id",pagination:{rowsPerPage:10},dense:""},{"body-cell-difficulty_label":A(e=>[w(p,{props:e},{default:A(()=>{return[w(n,{dense:"",color:(t=e.row.percentage_correct,t>=80?"green":t>=50?"orange":"red"),"text-color":"white"},{default:A(()=>[S(k(e.value)+" ("+k(e.row.percentage_correct)+"%) ",1)]),_:2},1032,["color"])];var t}),_:2},1032,["props"])]),"body-cell-text":A(e=>[w(p,{props:e},{default:A(()=>[Q("div",ge,k(e.value),1)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})])]),_:1})):E("",!0)]),_:1})]),_:1},8,["modelValue"])])],64))}},[["__scopeId","data-v-c8321de5"]]);export{xe as default};
