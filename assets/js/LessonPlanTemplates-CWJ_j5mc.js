import{r as e,u as l,f as a,d as t,b as s,G as o,t as n,Q as i,aS as r,h as d,c as u,e as c,s as m,o as p}from"./app-CCwy2VVq.js";import{a as v,Q as y}from"./QTable-CLyjuksl.js";import{Q as b}from"./QTr-DIyrHSxO.js";import{Q as f}from"./QTd-C7BujuXw.js";import{Q as k}from"./QSpace-B14M_epf.js";import{Q as g}from"./QSelect-DZElG_R-.js";import{Q as x}from"./QForm-C5vfISjA.js";import{Q as h}from"./QDate-BEBuUBSV.js";import{_,f as w,N as j,J as V,b as q,R as T,z as C,a4 as Q,K as U,O as A,V as N,I as P,W as S,a0 as z,F as D,Q as F,y as O}from"./vendor-BWKGNkNB.js";import{d as E}from"./vuedraggable.umd-DshT_Vng.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./QMarkupTable-BdH3AZt5.js";import"./QLinearProgress--xrLPDag.js";import"./use-fullscreen-CGCy_LR0.js";import"./rtl-Cr6c3OOr.js";import"./use-render-cache-CmTcazfP.js";import"./use-datetime-9sLoSloQ.js";import"./date-suPbXNFw.js";import"./index-SlSKjXnq.js";const I={class:"lesson-plan-templates"},L={class:"q-pa-md"},W={class:"row q-col-gutter-md"},M={class:"col-12"},R={class:"text-h5"},G={key:0,class:"text-subtitle2"},J={key:1,class:"q-mt-sm"},K={class:"col-12"},$={class:"row q-gutter-sm justify-end"},X={key:1,class:"q-pa-xl text-center empty-state"},Y={class:"text-h6"},B={class:"row q-col-gutter-md"},H={class:"col-12 col-md-6"},Z={class:"template-field-item"},ee={class:"row q-col-gutter-sm"},le={class:"col-12 col-sm-4"},ae={class:"col-12 col-sm-4"},te={class:"col-12 col-sm-3"},se={class:"col-12 col-sm-1 flex items-center justify-between"},oe={key:0,class:"row q-col-gutter-sm q-mt-xs"},ne={class:"col-12"},ie={class:"q-mt-md"},re={class:"row q-gutter-sm justify-end q-mt-lg"},de={key:0,class:"col-12 col-md-6"},ue={class:"text-h5"},ce={key:0,class:"text-caption q-mb-md"},me={class:"field-number"},pe={class:"text-h6"},ve={class:"text-h5"},ye={key:0,class:"text-caption q-mb-md"},be=e({__name:"LessonPlanTemplates",props:{subject:Object,templates:{type:Array,default:()=>[]}},setup(e){var be;_.defaults.headers.common["X-CSRF-TOKEN"]=null==(be=document.querySelector('meta[name="csrf-token"]'))?void 0:be.getAttribute("content"),_.defaults.withCredentials=!0;const fe=e,ke=l(),ge=w(Array.isArray(fe.templates)?fe.templates:[]),xe=w(!1),he=w(null),_e=w(!1),we=w(!1),je=w(!1),Ve=w(!1),qe=w(!1),Te=w(null),Ce=w(!1),Qe=w(null),Ue=w([]),Ae=[{label:"Text",value:"text"},{label:"Textarea",value:"textarea"},{label:"Select",value:"select"},{label:"Number",value:"number"},{label:"Date",value:"date"}],Ne=[{name:"name",label:"Template Name",field:"name",align:"left",sortable:!0},{name:"description",label:"Description",field:"description"},{name:"fields",label:"Fields",field:e=>Object.keys(e.structure||{}).length,align:"center"},{name:"actions",label:"Actions",field:"actions",align:"right"}],Pe=w({name:"",description:""}),Se=()=>{Pe.value={name:"",description:""},Ue.value=[],xe.value=!1,he.value=null,Ce.value=!1},ze=(e=null)=>{if(Se(),null!==e){const l=ge.value[e];Pe.value={name:l.name,description:l.description||""},Ue.value=Object.entries(l.structure||{}).map(([e,l])=>({key:e,type:l.type||"text",label:l.label||e,options:l.options||""})),xe.value=!0,he.value=e}else Ue.value=[{key:"objectives",type:"textarea",label:"Learning Objectives"},{key:"materials",type:"textarea",label:"Materials Needed"},{key:"warmup",type:"textarea",label:"Warm-Up Activity"},{key:"instruction",type:"textarea",label:"Direct Instruction"},{key:"activity",type:"textarea",label:"Guided Practice"},{key:"independent",type:"textarea",label:"Independent Work"},{key:"assessment",type:"textarea",label:"Assessment"},{key:"reflection",type:"textarea",label:"Student Reflection"}];Ve.value=!0},De=()=>{Ue.value.push({key:"",type:"text",label:"",options:""})},Fe=e=>{Qe.value=ge.value[e],qe.value=!0},Oe=async()=>{if(Pe.value.name){for(const e of Ue.value)if(!e.key)return void ke.notify({color:"negative",message:"All fields must have a name",icon:"error"});_e.value=!0;try{const e={};for(const a of Ue.value)e[a.key]={type:a.type,label:a.label},"select"===a.type&&a.options&&(e[a.key].options=a.options);const l={name:Pe.value.name,description:Pe.value.description,structure:e};xe.value?ge.value[he.value]=l:ge.value.push(l),await Ie(),Ve.value=!1,Se(),ke.notify({color:"positive",message:xe.value?"Template updated successfully":"Template added successfully",icon:"check_circle"})}catch(e){console.error("Error submitting form:",e),ke.notify({color:"negative",message:"An error occurred. Please try again.",icon:"error"})}finally{_e.value=!1}}else ke.notify({color:"negative",message:"Template name is required",icon:"error"})},Ee=async()=>{if(null!==Te.value){we.value=!0;try{ge.value.splice(Te.value,1),await Ie(),ke.notify({color:"positive",message:"Template deleted successfully",icon:"check_circle"})}catch(e){console.error("Error deleting template:",e),ke.notify({color:"negative",message:"An error occurred while deleting the template",icon:"error"})}finally{we.value=!1,Te.value=null}}},Ie=async()=>{try{const e=`/admin/subject/${fe.subject.id}/lesson-plan-templates`;return(await _.patch(e,{lesson_plan_templates:JSON.stringify(ge.value)})).data}catch(e){throw console.error("Error saving templates:",e),e}};return(l,_)=>(V(),j("div",I,[q(C(Q),{title:`Lesson Plan Templates - ${e.subject.name}`},null,8,["title"]),T("div",L,[T("div",W,[T("div",M,[q(t,{class:"subject-info"},{default:U(()=>[q(a,null,{default:U(()=>[T("div",R,N(e.subject.name),1),e.subject.school?(V(),j("div",G,N(e.subject.school.name),1)):A("",!0),e.subject.description?(V(),j("div",J,N(e.subject.description),1)):A("",!0)]),_:1})]),_:1})]),T("div",K,[q(t,null,{default:U(()=>[q(a,{class:"row items-center justify-between q-pb-none"},{default:U(()=>[_[10]||(_[10]=T("div",null,[T("div",{class:"text-h6"},"Lesson Plan Templates"),T("div",{class:"text-subtitle2"},"Manage templates for this subject")],-1)),q(s,{color:"primary",icon:"add",label:"Add Template",onClick:_[0]||(_[0]=e=>ze()),class:"q-px-md",unelevated:"",rounded:""})]),_:1}),q(a,null,{default:U(()=>[ge.value.length>0?(V(),P(y,{key:0,rows:ge.value,columns:Ne,"row-key":"name",pagination:{rowsPerPage:10},flat:"",bordered:"",class:"template-table"},{header:U(e=>[q(b,{props:e},{default:U(()=>[(V(!0),j(D,null,F(e.cols,l=>(V(),P(v,{key:l.name,props:e,class:"text-primary"},{default:U(()=>[S(N(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),body:U(e=>[q(b,{props:e,class:"cursor-pointer template-row",onClick:l=>Fe(e.rowIndex)},{default:U(()=>[q(f,{key:"name",props:e,class:"text-weight-medium"},{default:U(()=>[S(N(e.row.name),1)]),_:2},1032,["props"]),q(f,{key:"description",props:e,class:"text-grey-8"},{default:U(()=>[S(N(e.row.description||"No description"),1)]),_:2},1032,["props"]),q(f,{key:"fields",props:e,class:"text-center"},{default:U(()=>[q(o,{size:"sm",color:"primary","text-color":"white",outline:""},{default:U(()=>[S(N(Object.keys(e.row.structure||{}).length)+" fields ",1)]),_:2},1024)]),_:2},1032,["props"]),q(f,{key:"actions",props:e,"auto-width":"",onClick:_[1]||(_[1]=z(()=>{},["stop"]))},{default:U(()=>[T("div",$,[q(s,{flat:"",round:"",color:"primary",icon:"edit",size:"sm",onClick:l=>ze(e.rowIndex)},{default:U(()=>[q(n,null,{default:U(()=>_[11]||(_[11]=[S("Edit Template")])),_:1})]),_:2},1032,["onClick"]),q(s,{flat:"",round:"",color:"info",icon:"visibility",size:"sm",onClick:l=>Fe(e.rowIndex)},{default:U(()=>[q(n,null,{default:U(()=>_[12]||(_[12]=[S("Preview Template")])),_:1})]),_:2},1032,["onClick"]),q(s,{flat:"",round:"",color:"negative",icon:"delete",size:"sm",onClick:l=>{return a=e.rowIndex,Te.value=a,void(je.value=!0);var a}},{default:U(()=>[q(n,null,{default:U(()=>_[13]||(_[13]=[S("Delete Template")])),_:1})]),_:2},1032,["onClick"])])]),_:2},1032,["props"])]),_:2},1032,["props","onClick"])]),_:1},8,["rows"])):A("",!0),0===ge.value.length?(V(),j("div",X,[q(i,{name:"description",size:"64px",color:"primary",class:"q-mb-md"}),_[14]||(_[14]=T("div",{class:"text-h6 text-grey-8"},"No Templates Yet",-1)),_[15]||(_[15]=T("div",{class:"text-body1 q-mb-md text-grey-7"},"Create your first lesson plan template to get started",-1)),q(s,{color:"primary",icon:"add",label:"Create Template",onClick:_[2]||(_[2]=e=>ze()),class:"q-px-md",unelevated:"",rounded:""})])):A("",!0)]),_:1})]),_:1})])])]),q(c,{modelValue:Ve.value,"onUpdate:modelValue":_[7]||(_[7]=e=>Ve.value=e),persistent:"",maximized:""},{default:U(()=>[q(t,null,{default:U(()=>[q(a,{class:"row items-center q-pb-none"},{default:U(()=>[T("div",Y,N(xe.value?"Edit Template":"Add New Template"),1),q(k),O(q(s,{icon:"close",flat:"",round:"",dense:""},null,512),[[r]])]),_:1}),q(a,{class:"q-pt-none"},{default:U(()=>[T("div",B,[T("div",H,[q(x,{onSubmit:Oe,class:"q-gutter-md"},{default:U(()=>[q(d,{modelValue:Pe.value.name,"onUpdate:modelValue":_[3]||(_[3]=e=>Pe.value.name=e),label:"Template Name",rules:[e=>!!e||"Name is required"],outlined:""},null,8,["modelValue","rules"]),q(d,{modelValue:Pe.value.description,"onUpdate:modelValue":_[4]||(_[4]=e=>Pe.value.description=e),label:"Description",type:"textarea",outlined:""},null,8,["modelValue"]),_[16]||(_[16]=T("div",{class:"text-h6 q-mt-md"},"Template Fields",-1)),_[17]||(_[17]=T("div",{class:"text-caption q-mb-md"},"Add fields to your lesson plan template. Drag to reorder.",-1)),q(C(E),{modelValue:Ue.value,"onUpdate:modelValue":_[5]||(_[5]=e=>Ue.value=e),"item-key":"index",handle:".drag-handle","ghost-class":"ghost",class:"q-gutter-y-md"},{item:U(({element:e,index:l})=>[T("div",Z,[T("div",ee,[T("div",le,[q(d,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,label:"Field Name",outlined:"",dense:"",rules:[e=>!!e||"Field name is required"]},null,8,["modelValue","onUpdate:modelValue","rules"])]),T("div",ae,[q(g,{modelValue:e.type,"onUpdate:modelValue":l=>e.type=l,options:Ae,label:"Field Type",outlined:"",dense:"","emit-value":"","map-options":""},null,8,["modelValue","onUpdate:modelValue"])]),T("div",te,[q(d,{modelValue:e.label,"onUpdate:modelValue":l=>e.label=l,label:"Display Label",outlined:"",dense:""},null,8,["modelValue","onUpdate:modelValue"])]),T("div",se,[q(s,{flat:"",round:"",color:"primary",icon:"drag_indicator",size:"sm",class:"drag-handle cursor-move"}),q(s,{flat:"",round:"",color:"negative",icon:"delete",onClick:e=>(e=>{Ue.value.splice(e,1)})(l),size:"sm"},null,8,["onClick"])])]),"select"===e.type?(V(),j("div",oe,[T("div",ne,[q(d,{modelValue:e.options,"onUpdate:modelValue":l=>e.options=l,label:"Options (comma separated)",outlined:"",dense:"",hint:"Enter options separated by commas"},null,8,["modelValue","onUpdate:modelValue"])])])):A("",!0)])]),_:1},8,["modelValue"]),T("div",ie,[q(s,{color:"primary",outline:"",icon:"add",label:"Add Field",onClick:De})]),T("div",re,[O(q(s,{label:"Cancel",color:"grey",outline:""},null,512),[[r]]),q(s,{label:"Preview",color:"info",onClick:_[6]||(_[6]=e=>Ce.value=!0),outline:""}),q(s,{label:xe.value?"Update Template":"Save Template",type:"submit",color:"primary",loading:_e.value},null,8,["label","loading"])])]),_:1})]),Ce.value?(V(),j("div",de,[q(t,{flat:"",bordered:""},{default:U(()=>[q(a,null,{default:U(()=>_[18]||(_[18]=[T("div",{class:"text-h6"},"Template Preview",-1),T("div",{class:"text-subtitle2"},"This is how your template will look",-1)])),_:1}),q(u),q(a,null,{default:U(()=>[T("div",ue,N(Pe.value.name),1),Pe.value.description?(V(),j("div",ce,N(Pe.value.description),1)):A("",!0),(V(!0),j(D,null,F(Ue.value,(e,l)=>(V(),j("div",{key:l,class:"q-mb-md preview-field"},[T("div",me,N(l+1),1),"text"===e.type?(V(),P(d,{key:0,outlined:"",label:e.label||e.key,readonly:""},null,8,["label"])):"textarea"===e.type?(V(),P(d,{key:1,type:"textarea",outlined:"",label:e.label||e.key,readonly:""},null,8,["label"])):"select"===e.type?(V(),P(g,{key:2,outlined:"",label:e.label||e.key,options:e.options?e.options.split(",").map(e=>e.trim()):[],readonly:""},null,8,["label","options"])):"number"===e.type?(V(),P(d,{key:3,type:"number",outlined:"",label:e.label||e.key,readonly:""},null,8,["label"])):"date"===e.type?(V(),P(h,{key:4,outlined:"",label:e.label||e.key,readonly:"",flat:"",bordered:""},null,8,["label"])):A("",!0)]))),128))]),_:1})]),_:1})])):A("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),q(c,{modelValue:qe.value,"onUpdate:modelValue":_[8]||(_[8]=e=>qe.value=e),maximized:""},{default:U(()=>[q(t,null,{default:U(()=>[q(a,{class:"row items-center"},{default:U(()=>[T("div",pe,"Template Preview: "+N(Qe.value?Qe.value.name:""),1),q(k),O(q(s,{icon:"close",flat:"",round:"",dense:""},null,512),[[r]])]),_:1}),Qe.value?(V(),P(a,{key:0},{default:U(()=>[T("div",ve,N(Qe.value.name),1),Qe.value.description?(V(),j("div",ye,N(Qe.value.description),1)):A("",!0),(V(!0),j(D,null,F(Qe.value.structure,(e,l)=>(V(),j("div",{key:l,class:"q-mb-md"},["text"===e.type?(V(),P(d,{key:0,outlined:"",label:e.label||l,readonly:""},null,8,["label"])):"textarea"===e.type?(V(),P(d,{key:1,type:"textarea",outlined:"",label:e.label||l,readonly:""},null,8,["label"])):"select"===e.type?(V(),P(g,{key:2,outlined:"",label:e.label||l,options:e.options?e.options.split(",").map(e=>e.trim()):[],readonly:""},null,8,["label","options"])):"number"===e.type?(V(),P(d,{key:3,type:"number",outlined:"",label:e.label||l,readonly:""},null,8,["label"])):"date"===e.type?(V(),P(h,{key:4,outlined:"",label:e.label||l,readonly:"",flat:"",bordered:""},null,8,["label"])):A("",!0)]))),128))]),_:1})):A("",!0)]),_:1})]),_:1},8,["modelValue"]),q(c,{modelValue:je.value,"onUpdate:modelValue":_[9]||(_[9]=e=>je.value=e),persistent:""},{default:U(()=>[q(t,null,{default:U(()=>[q(a,{class:"row items-center"},{default:U(()=>[q(m,{icon:"warning",color:"negative","text-color":"white"}),_[19]||(_[19]=T("span",{class:"q-ml-sm"},"Are you sure you want to delete this template?",-1))]),_:1}),q(p,{align:"right"},{default:U(()=>[O(q(s,{flat:"",label:"Cancel",color:"primary"},null,512),[[r]]),O(q(s,{flat:"",label:"Delete",color:"negative",onClick:Ee,loading:we.value},null,8,["loading"]),[[r]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-99173608"]]);export{be as default};
