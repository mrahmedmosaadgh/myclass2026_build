import{r as e,u as l,Q as a,h as t,j as s,k as o,l as u,m as i,p as n,b as d,d as r,t as m,f as c,e as p,s as v,o as f,aS as b}from"./app-4gpSDtVV.js";import{Q as h}from"./QSelect-Dgk9Cshp.js";import{Q as y}from"./QBadge-6oS4ziQU.js";import{Q as w,a as g}from"./QToolbar-zCmX5d_Y.js";import{Q as _}from"./QSpace-BaiVAeLS.js";import{a as j,f as V,N as k,J as x,b as S,R as q,z as C,a4 as U,y as P,W as T,V as D,I as Q,K as I,ag as A,ah as z,O,Y as W,F as R}from"./vendor-BWKGNkNB.js";import F from"./TimetableGrid-BfZPhVDv.js";import $ from"./reward_sys-C85jX4_M.js";import{u as B}from"./i18n-B0T1C7j3.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./TimetableCell-BP-o1f52.js";import"./QBtnToggle-Bt3oZt1M.js";import"./QTab-CqyOuMp5.js";import"./QTabs-C8SafNXA.js";import"./QTabPanel-B7R9UqSU.js";import"./use-panel-BBaQ5jFM.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-BOmHgprU.js";import"./PointsDisplaySettings-Bh3mVNiL.js";import"./StudentCard-DkUkh4J4.js";import"./AvatarManager-Dw1gWsDQ.js";import"./CameraCapture-Do7ufowr.js";import"./noise-BMTu058a.js";const N={class:"q-pa-md teacher-schedule-view"},J={class:"row items-center q-mb-lg justify-between print-hide"},K={class:"col-auto"},M={class:"q-ma-none text-weight-bold"},Y={class:"col-auto row q-gutter-sm print-hide"},G={class:"row q-gutter-sm items-center bg-amber-1 q-pa-sm rounded-borders q-mr-md"},E={class:"row q-gutter-sm"},H={class:"print-only text-center q-mb-lg"},L={key:0,class:"text-subtitle2 bg-white text-primary px-2 py-0.5 rounded shadow-sm opacity-90"},X={class:"w-full h-full"},Z={class:"fixed-bottom-right q-ma-md",style:{bottom:"20px",right:"20px","z-index":"9999",position:"fixed"}},ee={class:"q-ml-sm"},le=e({__name:"TeacherScheduleView",props:{teacher:{type:Object,required:!0},schedules:{type:Array,default:()=>[]},subjects:{type:Array,default:()=>[]},classrooms:{type:Array,default:()=>[]},readonly:{type:Boolean,default:!0}},setup(e){const le=e,{t:ae}=B(),te=j(()=>`${le.teacher.name} - Schedule`),se=V([]),oe=V([]),ue=V([]),ie=V(!0),ne=V(localStorage.getItem("teacher-schedule-selected-date")||(new Date).toISOString().split("T")[0]),de=V(parseInt(localStorage.getItem("teacher-schedule-selected-week"))||null),re=Array.from({length:17},(e,l)=>({label:`Week ${l+1}`,value:l+1})),me=j(()=>ne.value&&de.value),ce=()=>{ne.value&&localStorage.setItem("teacher-schedule-selected-date",ne.value),de.value&&localStorage.setItem("teacher-schedule-selected-week",de.value.toString())},pe=[{label:ae("weeklyPlans.fullDays.1"),value:1},{label:ae("weeklyPlans.fullDays.2"),value:2},{label:ae("weeklyPlans.fullDays.3"),value:3},{label:ae("weeklyPlans.fullDays.4"),value:4},{label:ae("weeklyPlans.fullDays.5"),value:5},{label:ae("weeklyPlans.fullDays.6"),value:6},{label:ae("weeklyPlans.fullDays.7"),value:7}],ve=j(()=>ue.value.length>0?ue.value:[1,2,3,4,5,6,7]),fe=()=>{window.print()},be=V(!1),he=V(null),ye=V(!1),we=V(!1),ge=V(!1),_e=V(!1),je=V(null),Ve=l(),ke=e=>{if(!ne.value||!de.value)return void Ve.notify({message:"Please select both Date and Week before opening the Reward System",color:"warning",position:"top",icon:"warning",timeout:3e3});const l={...e,date:ne.value,week:de.value};if(he.value)return he.value.classroomId===l.classroomId&&he.value.period===l.period&&he.value.date===l.date?(be.value=!0,void(we.value=!1)):(je.value=l,void(_e.value=!0));xe(l)},xe=e=>{he.value=e,ye.value=!0,be.value=!0,we.value=!1},Se=()=>{we.value=!0,Ve.notify({icon:"stars",color:"amber",textColor:"black",message:"Session minimized. Click the floating button to restore.",position:"bottom-right",timeout:2500})},qe=()=>{we.value=!1,be.value=!0},Ce=()=>{ge.value=!0},Ue=()=>{be.value=!1,we.value=!1,he.value=null,ye.value=!1},Pe=()=>{he.value=null,setTimeout(()=>{xe(je.value),je.value=null},100)},Te=e=>{var l,a,t,s,o,u;if(!e)return"";return`${(null==(t=null==(a=null==(l=e.schedule)?void 0:l.cst)?void 0:a.classroom)?void 0:t.name)||"Classroom"} - ${(null==(u=null==(o=null==(s=e.schedule)?void 0:s.cst)?void 0:o.subject)?void 0:u.name)||"Subject"} (P${e.period})`};return(l,j)=>(x(),k(R,null,[S(C(U),{title:te.value},null,8,["title"]),q("div",N,[q("div",J,[q("div",K,[q("h4",M,[S(a,{name:"school",class:"q-mr-sm",color:"primary"}),T(" "+D(e.teacher.name),1)]),j[9]||(j[9]=q("div",{class:"text-h6 text-grey-7 q-mt-sm"}," Teacher Schedule ",-1))]),q("div",Y,[q("div",G,[S(a,{name:"event",color:"amber-8",size:"sm"}),S(t,{modelValue:ne.value,"onUpdate:modelValue":[j[0]||(j[0]=e=>ne.value=e),ce],type:"date",dense:"",outlined:"",label:"Select Date",style:{"min-width":"150px"},"bg-color":"white"},{prepend:I(()=>[S(a,{name:"event"})]),_:1},8,["modelValue"]),S(h,{modelValue:de.value,"onUpdate:modelValue":[j[1]||(j[1]=e=>de.value=e),ce],options:C(re),dense:"",outlined:"",label:"Select Week",style:{"min-width":"120px"},"bg-color":"white","emit-value":"","map-options":""},{prepend:I(()=>[S(a,{name:"calendar_view_week"})]),_:1},8,["modelValue","options"]),me.value?(x(),Q(y,{key:1,color:"positive",class:"q-ml-sm"},{default:I(()=>j[11]||(j[11]=[T(" Ready ")])),_:1})):(x(),Q(y,{key:0,color:"warning",class:"q-ml-sm"},{default:I(()=>j[10]||(j[10]=[T(" Select Date & Week ")])),_:1}))]),q("div",E,[S(h,{modelValue:se.value,"onUpdate:modelValue":j[2]||(j[2]=e=>se.value=e),options:e.subjects,"option-value":"id","option-label":"name",multiple:"",dense:"",outlined:"",label:"Filter Subjects",style:{"min-width":"180px"},"emit-value":"","map-options":""},{option:I(({itemProps:e,opt:l,selected:a,toggleOption:t})=>[S(s,A(z(e)),{default:I(()=>[S(o,null,{default:I(()=>[S(u,null,{default:I(()=>[T(D(l.name),1)]),_:2},1024)]),_:2},1024),S(o,{side:""},{default:I(()=>[S(i,{"model-value":a,"onUpdate:modelValue":e=>t(l)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),S(h,{modelValue:oe.value,"onUpdate:modelValue":j[3]||(j[3]=e=>oe.value=e),options:e.classrooms,"option-value":"id","option-label":"name",multiple:"",dense:"",outlined:"",label:"Filter Classrooms",style:{"min-width":"180px"},"emit-value":"","map-options":""},{option:I(({itemProps:e,opt:l,selected:a,toggleOption:t})=>[S(s,A(z(e)),{default:I(()=>[S(o,null,{default:I(()=>[S(u,null,{default:I(()=>[T(D(l.name),1)]),_:2},1024)]),_:2},1024),S(o,{side:""},{default:I(()=>[S(i,{"model-value":a,"onUpdate:modelValue":e=>t(l)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),S(h,{modelValue:ue.value,"onUpdate:modelValue":j[4]||(j[4]=e=>ue.value=e),options:pe,multiple:"",dense:"",outlined:"",label:"Filter Days",style:{"min-width":"150px"},"emit-value":"","map-options":""},{option:I(({itemProps:e,opt:l,selected:a,toggleOption:t})=>[S(s,A(z(e)),{default:I(()=>[S(o,null,{default:I(()=>[S(u,null,{default:I(()=>[T(D(l.label),1)]),_:2},1024)]),_:2},1024),S(o,{side:""},{default:I(()=>[S(i,{"model-value":a,"onUpdate:modelValue":e=>t(l)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue"]),S(n,{modelValue:ie.value,"onUpdate:modelValue":j[5]||(j[5]=e=>ie.value=e),label:"Full Names",dense:"",color:"primary"},null,8,["modelValue"])]),S(d,{color:"primary",icon:"print",label:"Print",outline:"",onClick:fe})])]),q("div",H,[q("h3",null,D(e.teacher.name)+" - Schedule",1),j[12]||(j[12]=q("p",null,"Weekly Assignments",-1))]),S(r,{flat:"",bordered:""},{default:I(()=>[S(F,{schedules:e.schedules,readonly:!0,"show-classroom":!0,"hide-teacher":!0,"visible-days":ve.value,"filter-subject-ids":se.value,"filter-classroom-ids":oe.value,"show-full-name":ie.value,class:"teacher-grid",onOpenReward:ke,"reward-system-disabled":!me.value},null,8,["schedules","visible-days","filter-subject-ids","filter-classroom-ids","show-full-name","reward-system-disabled"])]),_:1}),S(p,{modelValue:be.value,"onUpdate:modelValue":j[6]||(j[6]=e=>be.value=e),maximized:"",seamless:we.value,"no-backdrop-dismiss":!0,"transition-show":"slide-up","transition-hide":"slide-down",persistent:!0},{default:I(()=>[P(S(r,{class:"flex flex-col"},{default:I(()=>[S(w,{class:"bg-primary text-white shadow-2"},{default:I(()=>[S(d,{flat:"",round:"",dense:"",icon:"stars",class:"q-mr-sm"}),S(g,{class:"flex items-center gap-2"},{default:I(()=>[j[13]||(j[13]=q("span",{class:"text-weight-bold"},"Reward System",-1)),he.value?(x(),k("span",L,D(Te(he.value)),1)):O("",!0)]),_:1}),S(_),j[15]||(j[15]=q("div",{id:"dialog-header-actions",class:"row items-center q-mr-sm"},null,-1)),S(d,{flat:"",round:"",dense:"",icon:"remove",onClick:Se},{default:I(()=>[S(m,null,{default:I(()=>j[14]||(j[14]=[T("Minimize (Keep Session Active)")])),_:1})]),_:1}),S(d,{flat:"",round:"",dense:"",icon:"close",onClick:Ce})]),_:1}),S(c,{class:"flex-1 overflow-auto q-pa-none bg-blue-50"},{default:I(()=>{var e,l,a,t,s,o;return[P(q("div",X,[ye.value?(x(),Q($,{key:0,"classroom-id":(null==(e=he.value)?void 0:e.classroomId)||0,"subject-id":(null==(l=he.value)?void 0:l.subjectId)||0,period:(null==(a=he.value)?void 0:a.period)||0,date:(null==(t=he.value)?void 0:t.date)||"",week:(null==(s=he.value)?void 0:s.week)||0,"initial-tab":"string"==typeof(null==(o=he.value)?void 0:o.initialTab)?he.value.initialTab:"positive","is-dialog":!0},null,8,["classroom-id","subject-id","period","date","week","initial-tab"])):O("",!0)],512),[[W,he.value]])]}),_:1})]),_:1},512),[[W,!we.value]])]),_:1},8,["modelValue","seamless"]),P(q("div",Z,[S(d,{fab:"",color:"amber","text-color":"black",icon:"stars",class:"shadow-10",onClick:qe},{default:I(()=>[S(m,{anchor:"center left",self:"center right"},{default:I(()=>[T(" Restore Session: "+D(Te(he.value)),1)]),_:1}),S(y,{color:"red",floating:""},{default:I(()=>j[16]||(j[16]=[T("Active")])),_:1})]),_:1})],512),[[W,he.value&&we.value]]),S(p,{modelValue:ge.value,"onUpdate:modelValue":j[7]||(j[7]=e=>ge.value=e),persistent:""},{default:I(()=>[S(r,null,{default:I(()=>[S(c,{class:"row items-center"},{default:I(()=>[S(v,{icon:"warning",color:"warning","text-color":"white"}),j[17]||(j[17]=q("span",{class:"q-ml-sm"},"Are you sure you want to close the current session? Unsaved changes might be lost.",-1))]),_:1}),S(f,{align:"right"},{default:I(()=>[P(S(d,{flat:"",label:"Cancel",color:"primary"},null,512),[[b]]),P(S(d,{flat:"",label:"Close Session",color:"negative",onClick:Ue},null,512),[[b]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),S(p,{modelValue:_e.value,"onUpdate:modelValue":j[8]||(j[8]=e=>_e.value=e),persistent:""},{default:I(()=>[S(r,null,{default:I(()=>[S(c,{class:"row items-center"},{default:I(()=>[S(v,{icon:"swap_horiz",color:"primary","text-color":"white"}),q("span",ee,[j[18]||(j[18]=T(" You have an active session for ")),q("strong",null,D(Te(he.value)),1),j[19]||(j[19]=T(". ")),j[20]||(j[20]=q("br",null,null,-1)),j[21]||(j[21]=T(" Do you want to end it and start a new one for ")),q("strong",null,D(Te(je.value)),1),j[22]||(j[22]=T("? "))])]),_:1}),S(f,{align:"right"},{default:I(()=>[P(S(d,{flat:"",label:"Cancel",color:"primary"},null,512),[[b]]),P(S(d,{flat:"",label:"Switch Session",color:"primary",onClick:Pe},null,512),[[b]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])],64))}},[["__scopeId","data-v-25a86fde"]]);export{le as default};
