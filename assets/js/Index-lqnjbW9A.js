import{f as e,a,I as l,J as r,K as t,R as s,b as n,N as o,V as i,W as d,$ as u}from"./vendor-BWKGNkNB.js";import{_ as m}from"./AppLayout-B3PyevP7.js";import{_ as c}from"./PrimaryButton-DVJXOzHH.js";import{_ as v}from"./SecondaryButton-WaufSYeJ.js";import{_ as b}from"./FormModal-D-SJokll.js";import{_ as p}from"./ImportExcel-C527xRdy.js";import{utils as y,writeFile as f}from"./xlsx-BHXqx-YI.js";import{F as x}from"./FullCalendar-ISXlziOq.js";import{r as k}from"./app-BxJhpxku.js";import"./Modal-DM1yMaqp.js";import"./QSpinnerDots-DZPL0uRa.js";import"./QSpace-BD6HDuXW.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const g={class:"py-12"},w={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},_={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},h={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"},E={class:"flex flex-wrap gap-2"},C={key:0,class:"flex justify-center items-center py-12"},j={key:1,class:"calendar-container"},q="Calendar Management",D="/admin/calendar",F=k({__name:"Index",props:{records:Object,options:Object},setup(k){const F=k,S=e(!1),A=e(null),B=e(!1),I=e(null),N=a(()=>{var e;return(null==(e=F.records)?void 0:e.data)||[]}),O=[{name:"date",label:"Date",type:"date",required:!0},{name:"week",label:"Week",type:"number",required:!0},{name:"day",label:"Day",type:"text",required:!0},{name:"day_number",label:"Day Number",type:"select",required:!0,options:[{value:1,label:"Sunday"},{value:2,label:"Monday"},{value:3,label:"Tuesday"},{value:4,label:"Wednesday"},{value:5,label:"Thursday"},{value:6,label:"Friday"},{value:7,label:"Saturday"}]},{name:"week_number",label:"Week Number",type:"number",required:!0},{name:"semester_number",label:"Semester Number",type:"number",required:!0},{name:"academic_year_id",label:"Academic Year",type:"select",required:!0,options:a(()=>{var e,a;return(null==(a=null==(e=F.options)?void 0:e.academicYears)?void 0:a.map(e=>({value:e.id,label:e.name})))||[]})},{name:"school_id",label:"School",type:"select",required:!0,options:a(()=>{var e,a;return(null==(a=null==(e=F.options)?void 0:e.schools)?void 0:a.map(e=>({value:e.id,label:e.name})))||[]})},{name:"status",label:"Status",type:"select",required:!0,options:[{value:1,label:"Active"},{value:0,label:"Day Off"},{value:2,label:"Activity"},{value:3,label:"Test"},{value:4,label:"Final Exam"}]},{name:"event",label:"Event",type:"text"},{name:"event_academic",label:"Academic Event",type:"text"},{name:"vacation",label:"Vacation",type:"number"}],T=[{key:"date",label:"Date",required:!0},{key:"academic_year",label:"Academic Year (ID or Name)",required:!0},{key:"school",label:"School (ID or Name)",required:!0},{key:"week",label:"Week",required:!1},{key:"day",label:"Day",required:!1},{key:"day_number",label:"Day Number (1-7)",required:!1},{key:"week_number",label:"Week Number",required:!1},{key:"semester_number",label:"Semester Number",required:!1},{key:"status",label:"Status (1=Active, 0=Day Off, 2=Activity, 3=Test, 4=Final Exam)",required:!1},{key:"event",label:"Event",required:!1},{key:"event_academic",label:"Academic Event",required:!1},{key:"vacation",label:"Vacation",required:!1}],W=()=>{S.value=!1,A.value=null,I.value=null},M=(e=null)=>{A.value=e,S.value=!0},$=({form:e})=>{B.value=!0,A.value?u.put(`${D}/${A.value.id}`,e,{onSuccess:()=>{W()},onError:e=>{console.error("Update failed:",e)},onFinish:()=>{B.value=!1}}):u.post(D,e,{onSuccess:()=>{W()},onError:e=>{console.error("Creation failed:",e)},onFinish:()=>{B.value=!1}})},V=()=>{const e=N.value.map(e=>{var a;return{date:e.date,week:e.week,day:e.day,day_number:e.day_number,week_number:e.week_number,semester_number:e.semester_number,school:null==(a=e.school)?void 0:a.name,status:e.status,event:e.event,event_academic:e.event_academic,vacation:e.vacation}}),a=y.json_to_sheet(e),l=y.book_new();y.book_append_sheet(l,a,"Calendar"),f(l,"calendar_export.xlsx")},L=()=>{u.reload()},Y={1:{label:"Work Day",color:"#10B981",bgColor:"#D1FAE5"},0:{label:"Day Off",color:"#EF4444",bgColor:"#FEE2E2"},2:{label:"Activity",color:"#3B82F6",bgColor:"#DBEAFE"},3:{label:"Test",color:"#F59E0B",bgColor:"#FEF3C7"},4:{label:"Final Exam",color:"#8B5CF6",bgColor:"#EDE9FE"}},H=a(()=>N.value.map(e=>{var a;const l=Y[e.status]||Y[1],r=e.event||l.label;return{id:e.id,title:r,date:e.date,status:e.status,color:l.color,backgroundColor:l.bgColor,description:`${l.label}${e.event?` - ${e.event}`:""}`,school:(null==(a=e.school)?void 0:a.name)||"",week:e.week,semester:e.semester_number,originalEvent:e}})),P=e=>{const a=N.value.find(a=>a.id===e.id);a&&M(a)},Q=e=>{I.value=e;const a={date:R(e)};M(a)},R=e=>"string"==typeof e?e:e instanceof Date?e.toISOString().split("T")[0]:(new Date).toISOString().split("T")[0];return(e,a)=>(r(),l(m,{title:q},{default:t(()=>[s("div",g,[s("div",w,[s("div",_,[s("div",h,[s("div",null,[s("h1",{class:"text-2xl font-bold text-gray-900"},i(q)),a[1]||(a[1]=s("p",{class:"text-sm text-gray-600 mt-1"},"Manage academic calendar entries and events",-1))]),s("div",E,[n(c,{onClick:a[0]||(a[0]=e=>M()),disabled:B.value},{default:t(()=>a[2]||(a[2]=[s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),d(" Add New Entry ")])),_:1},8,["disabled"]),n(p,{onImported:L,"validate-url":D+"/validate-import","import-url":D+"/import",columns:T,"button-text":"Import Calendar","preview-title":"Preview Calendar Data"},null,8,["validate-url","import-url"]),n(v,{onClick:V,disabled:B.value||!N.value.length},{default:t(()=>a[3]||(a[3]=[s("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),d(" Export ")])),_:1},8,["disabled"])])]),a[5]||(a[5]=s("div",{class:"mb-6 p-4 bg-gray-50 rounded-lg"},[s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"Calendar Legend:"),s("div",{class:"flex flex-wrap gap-4 text-xs"},[s("div",{class:"flex items-center"},[s("div",{class:"w-3 h-3 rounded-full bg-green-500 mr-2"}),s("span",null,"Work Day")]),s("div",{class:"flex items-center"},[s("div",{class:"w-3 h-3 rounded-full bg-red-500 mr-2"}),s("span",null,"Day Off")]),s("div",{class:"flex items-center"},[s("div",{class:"w-3 h-3 rounded-full bg-blue-500 mr-2"}),s("span",null,"Activity")]),s("div",{class:"flex items-center"},[s("div",{class:"w-3 h-3 rounded-full bg-yellow-500 mr-2"}),s("span",null,"Test")]),s("div",{class:"flex items-center"},[s("div",{class:"w-3 h-3 rounded-full bg-purple-500 mr-2"}),s("span",null,"Final Exam")])])],-1)),B.value?(r(),o("div",C,a[4]||(a[4]=[s("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),s("span",{class:"ml-3 text-gray-600"},"Loading calendar...",-1)]))):(r(),o("div",j,[n(x,{events:H.value,onEventClick:P,onDateClick:Q},null,8,["events"])]))])])]),n(b,{show:S.value,title:"Calendar Entry",fields:O,editing:A.value,onClose:W,onSubmitted:$},null,8,["show","editing"])]),_:1}))}},[["__scopeId","data-v-e80f7617"]]);export{F as default};
