import{I as e,ac as l,ah as a,at as t,af as i,ai as n,au as u,aj as s,av as o,aw as r,ae as d,al as c,G as v}from"./app-4gpSDtVV.js";import{u as p,a as f,b as m}from"./use-file-Ce4kWIwa.js";import{f as b,a as g,h as y,p as h}from"./vendor-BWKGNkNB.js";const x=e({name:"QFile",inheritAttrs:!1,props:{...t,...a,...f,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...l,...p],setup(e,{slots:l,emit:a,attrs:t}){const{proxy:p}=h(),f=i(),x=b(null),C=b(!1),V=n(e),{pickFiles:F,onDragover:j,onDragleave:S,processFiles:O,getDndNode:q}=m({editable:f.editable,dnd:C,getFileInput:E,addFilesToQueue:K}),A=u(e),_=g(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),k=g(()=>s(_.value)),D=g(()=>_.value.map(e=>e.name).join(", ")),L=g(()=>o(_.value.reduce((e,l)=>e+l.size,0))),N=g(()=>({totalSize:L.value,filesNumber:_.value.length,maxFiles:e.maxFiles})),w=g(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:V.value,...t,id:f.targetUid.value,disabled:!0!==f.editable.value})),I=g(()=>"q-file q-field--auto-height"+(!0===C.value?" q-file--dnd":"")),Q=g(()=>!0===e.multiple&&!0===e.append);function R(e){const l=_.value.slice();l.splice(e,1),$(l)}function $(l){a("update:modelValue",!0===e.multiple?l:l[0])}function z(e){13===e.keyCode&&c(e)}function B(e){13!==e.keyCode&&32!==e.keyCode||F(e)}function E(){return x.value}function K(l,a){const t=O(l,a,_.value,Q.value),i=E();null!=i&&(i.value=""),void 0!==t&&((!0===e.multiple?e.modelValue&&t.every(e=>_.value.includes(e)):e.modelValue===t[0])||$(!0===Q.value?_.value.concat(t):t))}function G(){return[y("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function J(){const l={ref:x,...w.value,...A.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:K};return!0===e.multiple&&(l.multiple=!0),y("input",l)}return Object.assign(f,{fieldClass:I,emitValue:$,hasValue:k,inputRef:x,innerValue:_,floatingLabel:g(()=>!0===k.value||s(e.displayValue)),computedCounter:g(()=>{if(void 0!==e.counterLabel)return e.counterLabel(N.value);const l=e.maxFiles;return`${_.value.length}${void 0!==l?" / "+l:""} (${L.value})`}),getControlChild:()=>q("file"),getControl:()=>{const a={ref:f.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return!0===f.editable.value&&Object.assign(a,{onDragover:j,onDragleave:S,onKeydown:z,onKeyup:B}),y("div",a,[J()].concat(function(){if(void 0!==l.file)return 0===_.value.length?G():_.value.map((e,a)=>l.file({index:a,file:e,ref:this}));if(void 0!==l.selected)return 0===_.value.length?G():l.selected({files:_.value,ref:this});if(!0===e.useChips)return 0===_.value.length?G():_.value.map((l,a)=>y(v,{key:"file-"+a,removable:f.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{R(a)}},()=>y("span",{class:"ellipsis",textContent:l.name})));const a=void 0!==e.displayValue?e.displayValue:D.value;return 0!==a.length?[y("div",{class:e.inputClass,style:e.inputStyle,textContent:a})]:G()}()))}}),Object.assign(p,{removeAtIndex:R,removeFile:function(e){const l=_.value.indexOf(e);-1!==l&&R(l)},getNativeElement:()=>x.value}),r(p,"nativeEl",()=>x.value),d(f)}});export{x as Q};
