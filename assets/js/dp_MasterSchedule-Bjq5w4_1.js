import{I as e,ah as l,Y as a,Z as t,aG as u,bj as n,ax as o,X as s,aA as i,ap as r,a7 as d,b as c,k as v,l as m,j as p,i as f,d as h,f as _,h as k,Q as y,aS as b,o as q,e as g,N as w}from"./app-DTyzyps1.js";import{u as x,a as C,b as V,g as M}from"./use-datetime-BzjrMzuv.js";import{_ as O,f as S}from"./date-DdP0mR3S.js";import{p as j,f as D,a as H,k as A,n as B,h as U,B as K,y as I,a7 as Y,N as $,J as F,O as P,b as Q,K as z,F as N,R,I as X,W as G,V as J,z as L}from"./vendor-BJyC5yAd.js";import{Q as T}from"./QPopupProxy-CdYKLzTS.js";import"./offline-BzIlwqNM.js";import"./i18n-BDgsCcB6.js";import"./ui-DFn3cvMd.js";function W(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}const Z=e({name:"QTime",props:{...a,...l,...C,modelValue:{required:!0,validator:e=>"string"==typeof e||null===e},mask:{...C.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:x,setup(e,{slots:l,emit:a}){const v=j(),{$q:m}=v.proxy,p=t(e,m),{tabindex:f,headerClass:h,getLocale:_,getCurrentDate:k}=V(e,m),y=u(e),b=i(y);let q,g;const w=D(null),x=H(()=>"persian"!==e.calendar&&null!==e.mask?e.mask:"HH:mm"+(!0===e.withSeconds?":ss":"")),C=H(()=>_()),Y=H(()=>function(){if("string"!=typeof e.defaultDate){const e=k(!0);return e.dateHash=M(e),e}return O(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}()),$=O(e.modelValue,x.value,C.value,e.calendar,Y.value),F=D(function(e){return null!==e.hour&&null===e.minute?"minute":"hour"}($)),P=D($),Q=D(null===$.hour||$.hour<12),z=H(()=>"q-time q-time--"+(!0===e.landscape?"landscape":"portrait")+(!0===p.value?" q-time--dark q-dark":"")+(!0===e.disable?" disabled":!0===e.readonly?" q-time--readonly":"")+(!0===e.bordered?" q-time--bordered":"")+(!0===e.square?" q-time--square no-border-radius":"")+(!0===e.flat?" q-time--flat no-shadow":"")),N=H(()=>{const e=P.value;return{hour:null===e.hour?"--":!0===R.value?n(e.hour):String(!0===Q.value?0===e.hour?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:null===e.minute?"--":n(e.minute),second:null===e.second?"--":n(e.second)}}),R=H(()=>null!==e.format24h?e.format24h:m.lang.date.format24h),X=H(()=>{const e="hour"===F.value,l=!0===e?12:60,a=P.value[F.value];let t=`rotate(${Math.round(a*(360/l))-180}deg) translateX(-50%)`;return!0===e&&!0===R.value&&P.value.hour>=12&&(t+=" scale(.7)"),{transform:t}}),G=H(()=>null!==P.value.hour),J=H(()=>!0===G.value&&null!==P.value.minute),L=H(()=>void 0!==e.hourOptions?l=>e.hourOptions.includes(l):void 0!==e.options?l=>e.options(l,null,null):null),T=H(()=>void 0!==e.minuteOptions?l=>e.minuteOptions.includes(l):void 0!==e.options?l=>e.options(P.value.hour,l,null):null),Z=H(()=>void 0!==e.secondOptions?l=>e.secondOptions.includes(l):void 0!==e.options?l=>e.options(P.value.hour,P.value.minute,l):null),E=H(()=>{if(null===L.value)return null;const e=oe(0,11,L.value),l=oe(12,11,L.value);return{am:e,pm:l,values:e.values.concat(l.values)}}),ee=H(()=>null!==T.value?oe(0,59,T.value):null),le=H(()=>null!==Z.value?oe(0,59,Z.value):null),ae=H(()=>{switch(F.value){case"hour":return E.value;case"minute":return ee.value;case"second":return le.value}}),te=H(()=>{let e,l,a=0,t=1;const u=null!==ae.value?ae.value.values:void 0;"hour"===F.value?!0===R.value?(e=0,l=23):(e=0,l=11,!1===Q.value&&(a=12)):(e=0,l=55,t=5);const n=[];for(let o=e,s=e;o<=l;o+=t,s++){const e=o+a,l=!1===(null==u?void 0:u.includes(e)),t="hour"===F.value&&0===o?!0===R.value?"00":"12":o;n.push({val:e,index:s,disable:l,label:t})}return n}),ue=H(()=>[[o,ce,void 0,{stop:!0,prevent:!0,mouse:!0}]]);function ne(){const e={...k(),...W()};je(e),Object.assign(P.value,e),F.value="hour"}function oe(e,l,a){const t=Array.apply(null,{length:l+1}).map((l,t)=>{const u=t+e;return{index:u,val:!0===a(u)}}).filter(e=>!0===e.val).map(e=>e.index);return{min:t[0],max:t[t.length-1],values:t,threshold:l+1}}function se(e,l,a){const t=Math.abs(e-l);return Math.min(t,a-t)}function ie(e,{min:l,max:a,values:t,threshold:u}){if(e===l)return l;if(e<l||e>a)return se(e,l,u)<=se(e,a,u)?l:a;const n=t.findIndex(l=>e<=l),o=t[n-1],s=t[n];return e-o<=s-e?o:s}function re(){return!0===r(v)||null!==ae.value&&(0===ae.value.values.length||"hour"===F.value&&!0!==R.value&&0===E.value[!0===Q.value?"am":"pm"].values.length)}function de(){const e=w.value,{top:l,left:a,width:t}=e.getBoundingClientRect(),u=t/2;return{top:l+u,left:a+u,dist:.7*u}}function ce(e){if(!0!==re()){if(!0===e.isFirst)return q=de(),void(g=me(e.evt,q));g=me(e.evt,q,g),!0===e.isFinal&&(q=!1,g=null,ve())}}function ve(){"hour"===F.value?F.value="minute":e.withSeconds&&"minute"===F.value&&(F.value="second")}function me(e,l,a){const t=d(e),u=Math.abs(t.top-l.top),n=Math.sqrt(Math.pow(Math.abs(t.top-l.top),2)+Math.pow(Math.abs(t.left-l.left),2));let o,s=Math.asin(u/n)*(180/Math.PI);if(s=t.top<l.top?l.left<t.left?90-s:270+s:l.left<t.left?s+90:270-s,"hour"===F.value){if(o=s/30,null!==E.value){const e=!0!==R.value?!0===Q.value:0!==E.value.am.values.length&&0!==E.value.pm.values.length?n>=l.dist:0!==E.value.am.values.length;o=ie(o+(!0===e?0:12),E.value[!0===e?"am":"pm"])}else o=Math.round(o),!0===R.value?n<l.dist?o<12&&(o+=12):12===o&&(o=0):!0===Q.value&&12===o?o=0:!1===Q.value&&12!==o&&(o+=12);!0===R.value&&(Q.value=o<12)}else o=Math.round(s/6)%60,"minute"===F.value&&null!==ee.value?o=ie(o,ee.value):"second"===F.value&&null!==le.value&&(o=ie(o,le.value));return a!==o&&Ce[F.value](o),o}A(()=>e.modelValue,l=>{const a=O(l,x.value,C.value,e.calendar,Y.value);a.dateHash===P.value.dateHash&&a.timeHash===P.value.timeHash||(P.value=a,null===a.hour?F.value="hour":Q.value=a.hour<12)}),A([x,C],()=>{B(()=>{je()})});const pe={hour(){F.value="hour"},minute(){F.value="minute"},second(){F.value="second"}};function fe(e){13===e.keyCode&&Ve()}function he(e){13===e.keyCode&&Me()}function _e(e){!0!==re()&&(!0!==m.platform.is.desktop&&me(e,de()),ve())}function ke(e){!0!==re()&&me(e,de())}function ye(e){if(13===e.keyCode)F.value="hour";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==E.value){const e=!0===R.value?E.value.values:E.value[!0===Q.value?"am":"pm"].values;if(0===e.length)return;if(null===P.value.hour)ge(e[0]);else{const a=(e.length+e.indexOf(P.value.hour)+l)%e.length;ge(e[a])}}else{const e=!0===R.value?24:12;ge((!0!==R.value&&!1===Q.value?12:0)+(24+(null===P.value.hour?-l:P.value.hour)+l)%e)}}}function be(e){if(13===e.keyCode)F.value="minute";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==ee.value){const e=ee.value.values;if(0===e.length)return;if(null===P.value.minute)we(e[0]);else{const a=(e.length+e.indexOf(P.value.minute)+l)%e.length;we(e[a])}}else{we((60+(null===P.value.minute?-l:P.value.minute)+l)%60)}}}function qe(e){if(13===e.keyCode)F.value="second";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==le.value){const e=le.value.values;if(0===e.length)return;if(null===P.value.seconds)xe(e[0]);else{const a=(e.length+e.indexOf(P.value.second)+l)%e.length;xe(e[a])}}else{xe((60+(null===P.value.second?-l:P.value.second)+l)%60)}}}function ge(e){P.value.hour!==e&&(P.value.hour=e,Se())}function we(e){P.value.minute!==e&&(P.value.minute=e,Se())}function xe(e){P.value.second!==e&&(P.value.second=e,Se())}const Ce={hour:ge,minute:we,second:xe};function Ve(){!1===Q.value&&(Q.value=!0,null!==P.value.hour&&(P.value.hour-=12,Se()))}function Me(){!0===Q.value&&(Q.value=!1,null!==P.value.hour&&(P.value.hour+=12,Se()))}function Oe(l){const a=e.modelValue;F.value!==l&&null!=a&&""!==a&&"string"!=typeof a&&(F.value=l)}function Se(){return null!==L.value&&!0!==L.value(P.value.hour)?(P.value=O(),void Oe("hour")):null!==T.value&&!0!==T.value(P.value.minute)?(P.value.minute=null,P.value.second=null,void Oe("minute")):!0===e.withSeconds&&null!==Z.value&&!0!==Z.value(P.value.second)?(P.value.second=null,void Oe("second")):void(null===P.value.hour||null===P.value.minute||!0===e.withSeconds&&null===P.value.second||je())}function je(l){const t=Object.assign({...P.value},l),u="persian"===e.calendar?n(t.hour)+":"+n(t.minute)+(!0===e.withSeconds?":"+n(t.second):""):S(new Date(t.year,null===t.month?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),x.value,C.value,t.year,t.timezoneOffset);t.changed=u!==e.modelValue,a("update:modelValue",u,t)}function De(){const l=[U("div",{class:"q-time__link "+("hour"===F.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:pe.hour,onKeyup:ye},N.value.hour),U("div",":"),U("div",!0===G.value?{class:"q-time__link "+("minute"===F.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:be,onClick:pe.minute}:{class:"q-time__link"},N.value.minute)];!0===e.withSeconds&&l.push(U("div",":"),U("div",!0===J.value?{class:"q-time__link "+("second"===F.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:qe,onClick:pe.second}:{class:"q-time__link"},N.value.second));const a=[U("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},l)];return!1===R.value&&a.push(U("div",{class:"q-time__header-ampm column items-between no-wrap"},[U("div",{class:"q-time__link "+(!0===Q.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Ve,onKeyup:fe},"AM"),U("div",{class:"q-time__link "+(!0!==Q.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Me,onKeyup:he},"PM")])),U("div",{class:"q-time__header flex flex-center no-wrap "+h.value},a)}function He(){const l=P.value[F.value];return U("div",{class:"q-time__content col relative-position"},[U(K,{name:"q-transition--scale"},()=>U("div",{key:"clock"+F.value,class:"q-time__container-parent absolute-full"},[U("div",{ref:w,class:"q-time__container-child fit overflow-hidden"},[I(U("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:_e,onMousedown:ke},[U("div",{class:"q-time__clock-circle fit"},[U("div",{class:"q-time__clock-pointer"+(null===P.value[F.value]?" hidden":void 0!==e.color?` text-${e.color}`:""),style:X.value}),te.value.map(e=>U("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${e.index}`+(e.val===l?" q-time__clock-position--active "+h.value:!0===e.disable?" q-time__clock-position--disable":"")},[U("span",e.label)]))])]),ue.value)])])),!0===e.nowBtn?U(c,{class:"q-time__now-button absolute",icon:m.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:f.value,onClick:ne}):null])}return v.proxy.setNow=ne,()=>{const a=[He()],t=s(l.default);return void 0!==t&&a.push(U("div",{class:"q-time__actions"},t)),void 0!==e.name&&!0!==e.disable&&b(a,"push"),U("div",{class:z.value,tabindex:-1},[De(),U("div",{class:"q-time__main col overflow-auto"},a)])}}}),E={class:"q-pa-md"},ee={class:"row items-center justify-between q-mb-md"},le={class:"row q-gutter-sm"},ae={class:"text-h6"},te={class:"row q-col-gutter-sm q-mt-sm"},ue={class:"col-6"},ne={class:"row items-center justify-end"},oe={class:"col-6"},se={class:"row items-center justify-end"},ie={__name:"dp_MasterSchedule",props:{tasks:Array},setup(e){const l=D(!1),a=D(!1),t=D(null),u=Y({title:"",start_time:"",end_time:"",description:"",type:"general"}),n=()=>{a.value?u.put(route("dp.master.update",t.value),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸÜÿ¨ÿßÿ≠"})}}):u.post(route("dp.master.store"),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠"})}})},o=()=>{a.value=!1,t.value=null,u.reset()};return(o,s)=>(F(),$("div",E,[P("div",ee,[s[8]||(s[8]=P("div",{class:"text-h5"},"ÿßŸÑÿ¨ÿØŸàŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä üìÖ",-1)),Q(c,{label:"ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸáŸÖÿ©",color:"primary",icon:"add",onClick:s[0]||(s[0]=e=>l.value=!0)})]),Q(f,{bordered:"",separator:"",class:"bg-white rounded-borders"},{default:z(()=>[(F(!0),$(N,null,R(e.tasks,e=>(F(),X(p,{key:e.id},{default:z(()=>[Q(v,null,{default:z(()=>[Q(m,null,{default:z(()=>[G(J(e.title),1)]),_:2},1024),Q(m,{caption:""},{default:z(()=>[G(J(e.start_time)+" - "+J(e.end_time),1)]),_:2},1024)]),_:2},1024),Q(v,{side:""},{default:z(()=>[P("div",le,[Q(c,{flat:"",round:"",color:"primary",icon:"edit",onClick:n=>(e=>{a.value=!0,t.value=e.id,u.title=e.title,u.start_time=e.start_time?e.start_time.substr(0,5):"",u.end_time=e.end_time?e.end_time.substr(0,5):"",u.description=e.description,l.value=!0})(e)},null,8,["onClick"]),Q(c,{flat:"",round:"",color:"negative",icon:"delete",onClick:l=>{return a=e.id,void(confirm("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ∞ŸÅÿü")&&u.delete(route("dp.master.destroy",a),{onSuccess:()=>w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ≠ÿ∞ŸÅ"})}));var a}},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),Q(g,{modelValue:l.value,"onUpdate:modelValue":s[7]||(s[7]=e=>l.value=e)},{default:z(()=>[Q(h,{style:{"min-width":"350px"}},{default:z(()=>[Q(_,null,{default:z(()=>[P("div",ae,J(a.value?"ÿ™ÿπÿØŸäŸÑ ŸÖŸáŸÖÿ©":"ŸÖŸáŸÖÿ© ÿ¨ÿØŸäÿØÿ©"),1)]),_:1}),Q(_,{class:"q-pt-none"},{default:z(()=>[Q(k,{modelValue:L(u).title,"onUpdate:modelValue":s[1]||(s[1]=e=>L(u).title=e),label:"ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖŸáŸÖÿ©",autofocus:""},null,8,["modelValue"]),P("div",te,[P("div",ue,[Q(k,{modelValue:L(u).start_time,"onUpdate:modelValue":s[3]||(s[3]=e=>L(u).start_time=e),label:"ŸÖŸÜ",mask:"time",rules:["time"]},{append:z(()=>[Q(y,{name:"access_time",class:"cursor-pointer"},{default:z(()=>[Q(T,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:z(()=>[Q(Z,{modelValue:L(u).start_time,"onUpdate:modelValue":s[2]||(s[2]=e=>L(u).start_time=e),format24h:""},{default:z(()=>[P("div",ne,[I(Q(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),P("div",oe,[Q(k,{modelValue:L(u).end_time,"onUpdate:modelValue":s[5]||(s[5]=e=>L(u).end_time=e),label:"ÿ•ŸÑŸâ",mask:"time",rules:["time"]},{append:z(()=>[Q(y,{name:"access_time",class:"cursor-pointer"},{default:z(()=>[Q(T,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:z(()=>[Q(Z,{modelValue:L(u).end_time,"onUpdate:modelValue":s[4]||(s[4]=e=>L(u).end_time=e),format24h:""},{default:z(()=>[P("div",se,[I(Q(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),Q(k,{modelValue:L(u).description,"onUpdate:modelValue":s[6]||(s[6]=e=>L(u).description=e),label:"ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ™ÿ≠ŸÅŸäÿ≤Ÿäÿ©",type:"textarea",rows:"2"},null,8,["modelValue"])]),_:1}),Q(q,{align:"right",class:"text-primary"},{default:z(()=>[I(Q(c,{flat:"",label:"ÿ•ŸÑÿ∫ÿßÿ°"},null,512),[[b]]),Q(c,{flat:"",label:"ÿ≠ŸÅÿ∏",onClick:n})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ie as default};
