import{E as e,T as a,U as l,S as t,d as s,e as o,Q as n,C as i,a as u,f as d,i as r,j as c,A as p,k as m,g as _,m as b,n as y,b as g,aD as v}from"./app-BXm70mdJ.js";import{Q as f}from"./QSpace-Bu8V-QDa.js";import{p as h,a as j,h as S,f as x,k as V,H as k,I as q,J as Q,b as w,O as A,M as T,x as C,V as O,U as B,m as z,R as $,S as U}from"./vendor-DNM7Y6Xn.js";import{Q as N}from"./QSelect-CnZtzPIC.js";import{Q as R}from"./QForm-DyZk5PSh.js";const D=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],M=["wave","pulse","pulse-x","pulse-y","fade","blink","none"],P=e({name:"QSkeleton",props:{...a,tag:{type:String,default:"div"},type:{type:String,validator:e=>D.includes(e),default:"rect"},animation:{type:String,validator:e=>M.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:a}){const s=h(),o=l(e,s.proxy.$q),n=j(()=>{const a=void 0!==e.size?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:a[0],height:a[1]}}),i=j(()=>`q-skeleton q-skeleton--${!0===o.value?"dark":"light"} q-skeleton--type-${e.type}`+("none"!==e.animation?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(!0===e.square?" q-skeleton--square":"")+(!0===e.bordered?" q-skeleton--bordered":""));return()=>S(e.tag,{class:i.value,style:n.value},t(a.default))}}),F={class:"text-h6"},I={class:"row q-gutter-sm text-caption text-grey-7"},E={class:"text-weight-medium"},H={__name:"CSTAssignDialog",props:{modelValue:{type:Boolean,default:!1},schedule:{type:Object,default:null},day:{type:Number,default:null},period:{type:Number,default:null},classroomName:{type:String,default:""},cstOptions:{type:Array,default:()=>[]},teachers:{type:Array,default:()=>[]},subjects:{type:Array,default:()=>[]},loadingCST:{type:Boolean,default:!1},loadingTeachers:{type:Boolean,default:!1},loadingSubjects:{type:Boolean,default:!1},saving:{type:Boolean,default:!1},slotAvailability:{type:Object,default:null},loadingAvailability:{type:Boolean,default:!1}},emits:["update:modelValue","submit","filter-cst"],setup(e,{emit:a}){const l=e,t=a,h=j({get:()=>l.modelValue,set:e=>t("update:modelValue",e)}),S=["","Sunday","Monday","Tuesday","Wednesday","Thursday"],D=j(()=>S[l.day]||"Day"),M=j(()=>{if(!l.slotAvailability)return l.cstOptions.map(e=>({...e,is_busy:!1,busy_info:null,display_label:`${e.subject_name} - ${e.teacher_name}`}));const e=l.slotAvailability.busy_teachers||{};return l.cstOptions.map(a=>{const l=e[a.teacher_id],t=!!l&&!l.is_current_classroom;return{...a,is_busy:t,busy_info:l,display_label:t?`${a.subject_name} - ${a.teacher_name} ⚠️`:`${a.subject_name} - ${a.teacher_name}`}})}),H=j(()=>{if(!l.slotAvailability)return 0;const e=l.slotAvailability.busy_teachers||{};return Object.values(e).filter(e=>!e.is_current_classroom).length}),J=x({cst_id:null,teacher_substitute_id:null,co_teacher_id:null,co_subject_id:null,place:"",notes:""});V(()=>l.schedule,e=>{J.value=e?{cst_id:e.cst_id,teacher_substitute_id:e.teacher_substitute_id,co_teacher_id:e.co_teacher_id,co_subject_id:e.co_subject_id,place:e.place||"",notes:e.notes||""}:{cst_id:null,teacher_substitute_id:null,co_teacher_id:null,co_subject_id:null,place:"",notes:""}},{immediate:!0}),V(h,e=>{e||(J.value={cst_id:null,teacher_substitute_id:null,co_teacher_id:null,co_subject_id:null,place:"",notes:""})});const L=(e,a,l)=>{t("filter-cst",e),a()},W=()=>{var e;t("submit",{...J.value,schedule_id:null==(e=l.schedule)?void 0:e.id,day:l.day,period:l.period})};return(a,l)=>(q(),k(g,{modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=e=>h.value=e),persistent:""},{default:Q(()=>[w(y,{style:{"min-width":"450px","max-width":"550px"}},{default:Q(()=>[w(s,{class:"row items-center q-pb-none"},{default:Q(()=>[T("div",F,[w(o,{name:"assignment",class:"q-mr-sm",color:"primary"}),l[7]||(l[7]=O(" Assign Subject & Teacher "))]),w(f),C(w(n,{icon:"close",flat:"",round:"",dense:""},null,512),[[v]])]),_:1}),w(s,{class:"q-pt-sm"},{default:Q(()=>[T("div",I,[w(i,{dense:"",icon:"calendar_today",size:"sm"},{default:Q(()=>[O(B(D.value)+" - Period "+B(e.period),1)]),_:1}),e.classroomName?(q(),k(i,{key:0,dense:"",icon:"meeting_room",size:"sm"},{default:Q(()=>[O(B(e.classroomName),1)]),_:1})):A("",!0)])]),_:1}),w(u),e.loadingAvailability?(q(),k(s,{key:0,class:"q-py-sm"},{default:Q(()=>[w(P,{type:"text",width:"60%"})]),_:1})):H.value>0?(q(),k(s,{key:1,class:"q-py-sm"},{default:Q(()=>[w(d,{dense:"",rounded:"",class:"bg-orange-1 text-orange-9"},{avatar:Q(()=>[w(o,{name:"warning",color:"orange"})]),default:Q(()=>[T("span",E,B(H.value)+" teacher(s)",1),l[8]||(l[8]=O(" already assigned at this time slot in other classrooms. ")),l[9]||(l[9]=T("div",{class:"text-caption q-mt-xs"}," They are marked with ⚠️ in the dropdown below. ",-1))]),_:1})]),_:1})):A("",!0),w(s,null,{default:Q(()=>[w(R,{class:"q-gutter-md"},{default:Q(()=>[w(N,{modelValue:J.value.cst_id,"onUpdate:modelValue":l[0]||(l[0]=e=>J.value.cst_id=e),options:M.value,"option-value":"id","option-label":"display_label",label:"Subject & Teacher *",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"","use-input":"","input-debounce":"300",onFilter:L,loading:e.loadingCST||e.loadingAvailability},{prepend:Q(()=>[w(o,{name:"menu_book",color:"primary"})]),option:Q(({opt:e,itemProps:a})=>[w(r,z(a,{class:{"bg-orange-1":e.is_busy}}),{default:Q(()=>[w(c,{avatar:""},{default:Q(()=>[w(p,{style:$({backgroundColor:e.c_bg||"#e0e0e0",color:e.c_text||"#333"}),size:"32px"},{default:Q(()=>{var a;return[O(B((null==(a=e.subject_name)?void 0:a.charAt(0))||"S"),1)]}),_:2},1032,["style"])]),_:2},1024),w(c,null,{default:Q(()=>[w(m,{class:U({"text-orange-9":e.is_busy})},{default:Q(()=>[O(B(e.subject_name)+" ",1),e.is_busy?(q(),k(o,{key:0,name:"warning",color:"orange",size:"xs",class:"q-ml-xs"})):A("",!0)]),_:2},1032,["class"]),w(m,{caption:"",class:U({"text-orange-7":e.is_busy})},{default:Q(()=>[O(B(e.teacher_name),1)]),_:2},1032,["class"]),e.is_busy?(q(),k(m,{key:0,caption:"",class:"text-orange-8"},{default:Q(()=>{var a,l;return[w(o,{name:"info",size:"xs",class:"q-mr-xs"}),O(" Busy in "+B(null==(a=e.busy_info)?void 0:a.assigned_to_classroom)+" ("+B(null==(l=e.busy_info)?void 0:l.subject)+") ",1)]}),_:2},1024)):A("",!0)]),_:2},1024)]),_:2},1040,["class"])]),"no-option":Q(()=>[w(r,null,{default:Q(()=>[w(c,{class:"text-grey"},{default:Q(()=>l[10]||(l[10]=[O("No options available")])),_:1})]),_:1})]),_:1},8,["modelValue","options","loading"]),w(N,{modelValue:J.value.teacher_substitute_id,"onUpdate:modelValue":l[1]||(l[1]=e=>J.value.teacher_substitute_id=e),options:e.teachers,"option-value":"id","option-label":"name",label:"Substitute Teacher (Optional)",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"",loading:e.loadingTeachers},{prepend:Q(()=>[w(o,{name:"swap_horiz",color:"orange"})]),_:1},8,["modelValue","options","loading"]),w(N,{modelValue:J.value.co_teacher_id,"onUpdate:modelValue":l[2]||(l[2]=e=>J.value.co_teacher_id=e),options:e.teachers,"option-value":"id","option-label":"name",label:"Co-Teacher (Optional)",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"",loading:e.loadingTeachers},{prepend:Q(()=>[w(o,{name:"group",color:"blue"})]),_:1},8,["modelValue","options","loading"]),w(N,{modelValue:J.value.co_subject_id,"onUpdate:modelValue":l[3]||(l[3]=e=>J.value.co_subject_id=e),options:e.subjects,"option-value":"id","option-label":"name",label:"Co-Subject (Optional)",outlined:"",dense:"","emit-value":"","map-options":"",clearable:"",loading:e.loadingSubjects},{prepend:Q(()=>[w(o,{name:"library_books",color:"teal"})]),_:1},8,["modelValue","options","loading"]),w(_,{modelValue:J.value.place,"onUpdate:modelValue":l[4]||(l[4]=e=>J.value.place=e),label:"Location/Room (Optional)",outlined:"",dense:""},{prepend:Q(()=>[w(o,{name:"place"})]),_:1},8,["modelValue"]),w(_,{modelValue:J.value.notes,"onUpdate:modelValue":l[5]||(l[5]=e=>J.value.notes=e),label:"Notes",outlined:"",dense:"",type:"textarea",rows:"2"},{prepend:Q(()=>[w(o,{name:"note"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),w(u),w(b,{align:"right",class:"q-pa-md"},{default:Q(()=>[C(w(n,{flat:"",label:"Cancel",color:"grey"},null,512),[[v]]),w(n,{label:"Save Assignment",color:"primary",loading:e.saving,onClick:W},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},J=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{J as C,P as Q,H as _};
