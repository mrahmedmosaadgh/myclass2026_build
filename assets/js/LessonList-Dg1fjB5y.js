import{p as e,u as s,q as a,Q as t,aq as l,e as o,n as r,d as i,A as n,a as d,m as c}from"./app-Dccx8xF5.js";import{Q as u}from"./QTab-BJCUrT4L.js";import{Q as m}from"./QTabs-4quOvtr1.js";import{Q as g}from"./QBadge-BoQNzKR2.js";import{Q as v}from"./QSpace-BWA-UIs7.js";import{f as p,a as f,k as y,o as b,ac as h,L as x,I as w,b as q,M as _,O as k,H as j,J as z,V as Q,U as C,y as D,F as L,Q as M,S as V,$ as S,P as E,Z as F}from"./vendor-EI0FRBVb.js";import{u as I}from"./teacherStore-BELNLpdq.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./rtl-Cr6c3OOr.js";const P={class:"q-pa-md bg-grey-2"},$={class:"max-w-7xl mx-auto"},H={class:"row justify-between items-center q-mb-lg"},N={class:"row items-center gap-2"},T={class:"text-h4 text-weight-bold text-grey-9 q-my-none"},A={class:"text-subtitle2 text-grey-7 q-mt-xs"},B={key:0,class:"row justify-center q-py-xl"},O={key:1},U={key:0,class:"col-12 text-center q-py-xl"},G={key:1},J={key:0,class:"q-mb-lg"},Z={class:"q-mt-md row q-col-gutter-lg"},K={class:"text-h6 text-weight-bold"},R={class:"text-subtitle1 text-grey-9 text-weight-bold q-mt-md"},W={key:2},X={key:0,class:"text-center q-py-xl bg-white rounded-borders shadow-1"},Y={class:"text-body2 text-grey-6 q-mt-xs"},ee={class:"q-mt-md"},se={key:1,class:"row q-col-gutter-md"},ae={class:"row items-center q-gutter-xs q-mb-sm"},te={class:"text-caption text-grey-5"},le=["title"],oe={class:"text-body2 text-grey-6 ellipsis-2-lines q-mt-xs"},re={class:"column full-width q-gutter-xs"},ie={class:"row justify-between items-center"},ne={class:"row q-gutter-xs"},de={class:"row q-gutter-xs"},ce=["href"],ue={class:"row q-gutter-xs full-width"},me=e({__name:"LessonList",setup(e){const me=s(),ge=I(),ve=p([]),pe=p(!1),fe=p("dashboard"),ye=p(null),be=p(null),he=f(()=>{const e=new Map;return ge.grades?(ge.grades.forEach(s=>{s.classrooms&&s.classrooms.forEach(a=>{a.subjects&&a.subjects.forEach(t=>{e.has(t.id)||e.set(t.id,{id:t.id,name:t.name,classrooms:[]}),e.get(t.id).classrooms.push({id:a.id,name:a.name,grade_id:s.id,grade_name:s.name})})})}),Array.from(e.values())):[]});y(he,e=>{e.length>0&&!ye.value&&(ye.value=e[0].id)},{immediate:!0});const xe=f(()=>{const e=he.value.find(e=>e.id===ye.value);return e?e.classrooms:[]}),we=f(()=>he.value.find(e=>e.id===ye.value)),qe=e=>{be.value=e,fe.value="lessons",_e()},_e=async()=>{if(be.value&&ye.value){pe.value=!0;try{const e={grade_id:be.value.grade_id,subject_id:ye.value},s=await F.get(route("lesson-presentation.list"),{params:e});ve.value=s.data}catch(e){console.error("Failed to fetch lessons:",e),me.notify({type:"negative",message:"Failed to fetch lessons."})}finally{pe.value=!1}}};return b(async()=>{await ge.fetchTeacherData()}),(e,s)=>{var p,f,y,b;const I=h("Head");return w(),x(L,null,[q(I,{title:"Lesson Dashboard"}),_("div",P,[_("div",$,[_("div",H,[_("div",null,[_("div",N,["lessons"===fe.value?(w(),j(t,{key:0,flat:"",round:"",dense:"",icon:"arrow_back",color:"primary",onClick:s[0]||(s[0]=e=>fe.value="dashboard")},{default:z(()=>[q(a,null,{default:z(()=>s[2]||(s[2]=[Q("Back to Dashboard")])),_:1})]),_:1})):k("",!0),_("h1",T,C("dashboard"===fe.value?"My Classes":`${null==(p=be.value)?void 0:p.name} - ${null==(f=we.value)?void 0:f.name} Lessons`),1)]),_("p",A,C("dashboard"===fe.value?"Select a class to manage lessons.":"Manage your interactive lessons for this class."),1)])]),pe.value||D(ge).loading?(w(),x("div",B,[q(l,{color:"primary",size:"3em"})])):"dashboard"===fe.value?(w(),x("div",O,[0===he.value.length?(w(),x("div",U,[q(o,{name:"school",size:"4rem",color:"grey-4",class:"q-mb-md"}),s[3]||(s[3]=_("h3",{class:"text-h6 text-grey-7"},"No classes assigned.",-1))])):(w(),x("div",G,[he.value.length>1?(w(),x("div",J,[q(r,{flat:"",bordered:"",class:"rounded-borders"},{default:z(()=>[q(m,{modelValue:ye.value,"onUpdate:modelValue":s[1]||(s[1]=e=>ye.value=e),dense:"",class:"text-grey-7 bg-grey-1","active-color":"white","active-bg-color":"primary","indicator-color":"transparent",align:"left","narrow-indicator":"","content-class":"q-pa-sm"},{default:z(()=>[(w(!0),x(L,null,M(he.value,e=>(w(),j(u,{key:e.id,name:e.id,label:e.name,class:"rounded-borders q-mr-sm"},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1})])):k("",!0),_("div",Z,[(w(!0),x(L,null,M(xe.value,(a,l)=>(w(),x("div",{key:a.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[q(r,{class:"cursor-pointer hover-shadow transition-generic full-height column no-wrap overflow-hidden rounded-borders-lg",onClick:e=>qe(a)},{default:z(()=>[_("div",{class:V(["q-pa-md text-white row items-center justify-between",["bg-blue-6","bg-purple-6","bg-teal-6","bg-indigo-6","bg-deep-orange-6"][l%5]])},[_("div",K,C(a.name),1),q(o,{name:"class",size:"24px",class:"opacity-80"})],2),q(i,{class:"col flex flex-center column q-py-lg bg-white relative-position"},{default:z(()=>[q(n,{size:"60px","font-size":"30px",class:V(["text-blue-6","text-purple-6","text-teal-6","text-indigo-6","text-deep-orange-6"][l%5]),color:"grey-2",icon:"school"},null,8,["class"]),_("div",R,C(a.grade_name),1),s[4]||(s[4]=_("div",{class:"text-caption text-grey-6 q-mt-xs text-center"}," Manage lessons & student progress ",-1))]),_:2},1024),q(d),q(c,{align:"center",class:"bg-grey-1 q-pa-md row q-gutter-md"},{default:z(()=>[q(t,{flat:"",dense:"",color:"grey-8",icon:"visibility",label:"View",class:"col",onClick:S(e=>qe(a),["stop"])},null,8,["onClick"]),q(D(E),{href:e.route("lesson-presentation.edit",{grade_id:a.grade_id,subject_id:ye.value}),class:"col"},{default:z(()=>[q(t,{unelevated:"",dense:"",color:["blue-6","purple-6","teal-6","indigo-6","deep-orange-6"][l%5],icon:"add",label:"Create",class:"full-width"},null,8,["color"])]),_:2},1032,["href"])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])]))])):"lessons"===fe.value?(w(),x("div",W,[0===ve.value.length?(w(),x("div",X,[q(o,{name:"auto_stories",size:"4rem",color:"grey-4",class:"q-mb-md"}),s[5]||(s[5]=_("h3",{class:"text-h6 text-weight-medium text-grey-9 q-my-none"},"No lessons found",-1)),_("p",Y,"Get started by creating your first interactive lesson for "+C(null==(y=be.value)?void 0:y.name)+".",1),_("div",ee,[q(D(E),{href:e.route("lesson-presentation.edit",{grade_id:null==(b=be.value)?void 0:b.grade_id,subject_id:ye.value})},{default:z(()=>[q(t,{color:"primary",icon:"add",label:"Create Lesson","no-caps":""})]),_:1},8,["href"])])])):(w(),x("div",se,[(w(!0),x(L,null,M(ve.value,a=>(w(),x("div",{key:a.id,class:"col-12 col-sm-6 col-lg-4"},[q(r,{class:"column full-height hover-shadow transition-generic"},{default:z(()=>[q(i,{class:"col q-pb-none"},{default:z(()=>[_("div",ae,[q(g,{color:"blue-1","text-color":"primary"},{default:z(()=>[q(o,{name:"menu_book",size:"xs",class:"q-mr-xs"}),Q(" "+C(a.slides_count||0),1)]),_:2},1024),a.quiz_id?(w(),j(g,{key:0,color:"green-1","text-color":"green"},{default:z(()=>[q(o,{name:"quiz",size:"xs",class:"q-mr-xs"}),s[6]||(s[6]=Q(" Quiz "))]),_:1})):k("",!0),q(v),_("span",te,C(new Date(a.created_at).toLocaleDateString()),1)]),_("div",{class:"text-h6 text-grey-9 ellipsis",title:a.name},C(a.name),9,le),_("div",oe,C(a.description||"No description provided."),1)]),_:2},1024),q(c,{class:"bg-grey-1 border-top-grey-3 q-px-md q-py-sm"},{default:z(()=>[_("div",re,[_("div",ie,[_("div",ne,[q(D(E),{href:e.route("lesson-presentation.edit",{id:a.id})},{default:z(()=>[q(t,{flat:"",dense:"",size:"sm",color:"grey-7",icon:"edit",label:"Edit","no-caps":""})]),_:2},1032,["href"]),q(t,{flat:"",dense:"",size:"sm",color:"grey-7",icon:"delete",label:"Delete","no-caps":"",onClick:e=>(async e=>{me.dialog({title:"Confirm Deletion",message:`Delete "${e.name}"?`,cancel:!0,persistent:!0}).onOk(async()=>{try{await F.delete(route("lesson-presentation.destroy",{id:e.id})),ve.value=ve.value.filter(s=>s.id!==e.id),me.notify({type:"positive",message:"Lesson deleted."})}catch(s){me.notify({type:"negative",message:"Failed to delete lesson."})}})})(a)},null,8,["onClick"])]),_("div",de,[_("a",{href:e.route("lesson-presentation.student.view",{id:a.id}),target:"_blank"},[q(t,{flat:"",dense:"",size:"sm",color:"primary",icon:"play_arrow",label:"Preview","no-caps":""})],8,ce)])]),q(d),_("div",ue,[q(D(E),{href:e.route("lesson-presentation.teacher.progress",{lessonId:a.id})},{default:z(()=>[q(t,{unelevated:"",dense:"",size:"sm",color:"primary",icon:"assessment",label:"View Progress","no-caps":""})]),_:2},1032,["href"])])])]),_:2},1024)]),_:2},1024)]))),128))]))])):k("",!0)])])],64)}}},[["__scopeId","data-v-c01e2f98"]]);export{me as default};
