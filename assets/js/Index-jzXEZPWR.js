import{a as e,f as a,N as o,J as r,b as s,R as t,z as l,a4 as i,I as n,O as d,K as c,W as m,F as u,_ as p,$ as y}from"./vendor-BWKGNkNB.js";import{_ as b}from"./PrimaryButton-DVJXOzHH.js";import{_ as v}from"./Pagination-DMF9MOGD.js";import{_ as f}from"./DataTable-zMwSNXZH.js";import{_ as h}from"./FormModal-1_Fvrun3.js";import"./LucideIcon-CYYJCXCs.js";import"./createLucideIcon-bevK9Pnz.js";import"./printer-yyUpIzJF.js";import"./image-T1FtDBZI.js";import"./Modal-DfUGIOzP.js";import"./app-YpH5vqWh.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./SecondaryButton-WaufSYeJ.js";const j={class:"py-12"},g={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},w={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},x={class:"flex justify-between items-center mb-6"},S={__name:"Index",props:{records:{type:Object,required:!0},schools:{type:Array,required:!0}},setup(S){const _=S,k=[{name:"name",label:"Name",type:"text",required:!0,autofocus:!0},{name:"description",label:"Description",type:"textarea"},{name:"school_id",label:"School",type:"select",required:!0,options:e(()=>_.schools.map(e=>({value:e.id,label:e.name})))}],A=a(!1),D=a(null),q=a(!1),I=(e=null)=>{D.value=e,A.value=!0},N=()=>{A.value=!1,D.value=null},B=()=>{y.reload({only:["records"],preserveScroll:!0,preserveState:!0})},C=async({form:e,onSuccess:a,onError:o})=>{var r,s,t;if(q.value)return;q.value=!0;const l=null==(r=D.value)?void 0:r.id,i=l?`/admin/stage/${l}`:"/admin/stage";try{await p.post(i,{...l&&{_method:"PUT"},...e}),a(),N(),B()}catch(n){console.error("Submission error:",n),o((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.errors)||{error:["An error occurred"]})}finally{q.value=!1}},P=async e=>{if(confirm("Are you sure you want to delete this stage?"))try{await p.delete(`/admin/stage/${e.id}`),B()}catch(a){console.error("Deletion error:",a),alert("An error occurred while deleting the record.")}};return(e,a)=>(r(),o(u,null,[s(l(i),{title:"Stages"}),t("div",j,[t("div",g,[t("div",w,[t("div",x,[s(b,{onClick:a[0]||(a[0]=e=>I())},{default:c(()=>a[1]||(a[1]=[m(" Create New Stage ")])),_:1})]),s(f,{columns:[{key:"name",label:"Name"},{key:"description",label:"Description"},{key:"school.name",label:"School"},{key:"actions",label:"Actions"}],items:S.records.data,loading:!1,onEdit:I,onDelete:P},null,8,["items"]),S.records.meta?(r(),n(v,{key:0,links:S.records.meta.links,class:"mt-6"},null,8,["links"])):d("",!0)])])]),s(h,{show:A.value,title:"Stage",fields:k,editing:D.value,onClose:N,onSubmitted:C},null,8,["show","editing"])],64))}};export{S as default};
