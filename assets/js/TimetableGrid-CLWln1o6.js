import e from"./TimetableCell-BOwakE1p.js";import{u as l}from"./i18n-B0T1C7j3.js";import{r as a}from"./app-CWAnT6CT.js";import{aR as s,a as r,N as t,J as d,R as i,F as o,Q as u,V as c,U as n,b as y}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";const h=["dir"],f={class:"grid-row header-row"},v={class:"period-number"},m={class:"period-time text-caption text-grey-6"},p={class:"grid-cell day-header"},b={class:"day-name"},w={class:"day-short"},_=a({__name:"TimetableGrid",props:{schedules:{type:Array,default:()=>[]},periodTimes:{type:Object,default:()=>({})},teacherConflicts:{type:Object,default:()=>({})},visibleDays:{type:Array,default:()=>[1,2,3,4,5]},visiblePeriods:{type:Array,default:()=>[1,2,3,4,5,6,7,8]},filterSubjectIds:{type:Array,default:()=>[]},filterTeacherIds:{type:Array,default:()=>[]},filterClassroomIds:{type:Array,default:()=>[]},readonly:{type:Boolean,default:!1},showClassroom:{type:Boolean,default:!1},hideTeacher:{type:Boolean,default:!1},showFullName:{type:Boolean,default:!1},rewardSystemDisabled:{type:Boolean,default:!1}},emits:["cell-click","edit","clear","open-reward"],setup(a,{emit:_}){s(e=>({"22e52426":g.value.length}));const{t:k}=l(),D=a,j=_,I=[{value:1,label:k("weeklyPlans.fullDays.1"),short:k("weeklyPlans.shortDays.1")},{value:2,label:k("weeklyPlans.fullDays.2"),short:k("weeklyPlans.shortDays.2")},{value:3,label:k("weeklyPlans.fullDays.3"),short:k("weeklyPlans.shortDays.3")},{value:4,label:k("weeklyPlans.fullDays.4"),short:k("weeklyPlans.shortDays.4")},{value:5,label:k("weeklyPlans.fullDays.5"),short:k("weeklyPlans.shortDays.5")},{value:6,label:k("weeklyPlans.fullDays.6"),short:k("weeklyPlans.shortDays.6")},{value:7,label:k("weeklyPlans.fullDays.7"),short:k("weeklyPlans.shortDays.7")}],P=r(()=>I.filter(e=>D.visibleDays.includes(e.value))),g=r(()=>D.visiblePeriods),T=r(()=>{const e={};return D.schedules.forEach(l=>{const a=l.day||l.day_number,s=l.period||l.period_number;a&&s&&(e[`${a}-${s}`]=l)}),e}),C=(e,l)=>T.value[`${e}-${l}`]||null,S=e=>D.periodTimes[e]||"",$=e=>{j("edit",e)},A=e=>{j("clear",e)},B=e=>{j("open-reward",e)},x=e=>{var l,a,s,r,t,d,i,o;if(!(null==(l=D.filterSubjectIds)?void 0:l.length)&&!(null==(a=D.filterTeacherIds)?void 0:a.length))return!0;if(!e||!e.cst_id)return!1;let u=!0;(null==(s=D.filterSubjectIds)?void 0:s.length)>0&&(u=D.filterSubjectIds.includes(null==(r=e.cst)?void 0:r.subject_id)||e.co_subject_id&&D.filterSubjectIds.includes(e.co_subject_id));let c=!0;(null==(t=D.filterTeacherIds)?void 0:t.length)>0&&(c=D.filterTeacherIds.includes(null==(d=e.cst)?void 0:d.teacher_id)||e.teacher_substitute_id&&D.filterTeacherIds.includes(e.teacher_substitute_id)||e.co_teacher_id&&D.filterTeacherIds.includes(e.co_teacher_id));let n=!0;return(null==(i=D.filterClassroomIds)?void 0:i.length)>0&&(n=D.filterClassroomIds.includes(null==(o=e.cst)?void 0:o.classroom_id)),u&&c&&n};return(l,s)=>(d(),t("div",{class:"timetable-grid",dir:"ar"===l.$i18n.locale?"rtl":"ltr"},[i("div",f,[s[0]||(s[0]=i("div",{class:"grid-cell day-header"},null,-1)),(d(!0),t(o,null,u(g.value,e=>(d(),t("div",{key:e,class:"grid-cell period-header"},[i("div",v,c(e),1),i("div",m,c(S(e)),1)]))),128))]),(d(!0),t(o,null,u(P.value,l=>(d(),t("div",{key:l.value,class:"grid-row"},[i("div",p,[i("span",b,c(l.label),1),i("span",w,c(l.short),1)]),(d(!0),t(o,null,u(g.value,s=>{return d(),t("div",{key:`${l.value}-${s}`,class:n(["grid-cell schedule-cell",{"dimmed-cell":!x(C(l.value,s))}])},[y(e,{schedule:C(l.value,s),"conflict-info":(r=C(l.value,s),(null==r?void 0:r.id)&&D.teacherConflicts[r.id]||null),readonly:a.readonly,"show-classroom":a.showClassroom,"hide-teacher":a.hideTeacher,"show-full-name":a.showFullName,"reward-system-disabled":a.rewardSystemDisabled,onClick:e=>((e,l)=>{const a=C(e,l);j("cell-click",{day:e,period:l,schedule:a})})(l.value,s),onEdit:$,onClear:A,onOpenReward:B},null,8,["schedule","conflict-info","readonly","show-classroom","hide-teacher","show-full-name","reward-system-disabled","onClick"])],2);var r}),128))]))),128))],8,h))}},[["__scopeId","data-v-d9cbfb49"]]);export{_ as default};
