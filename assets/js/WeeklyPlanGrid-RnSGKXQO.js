import{d as e}from"./vuedraggable.umd-B6xfz0Kr.js";import{r as a}from"./app-DTyzyps1.js";import{f as s,k as d,N as l,J as o,O as t,F as n,R as r,V as i,b as m,K as u,S as c,U as p,Q as y,z as v}from"./vendor-BJyC5yAd.js";import"./index-DsCb48G-.js";import"./offline-BzIlwqNM.js";import"./i18n-BDgsCcB6.js";import"./ui-DFn3cvMd.js";const f={class:"weekly-plan-grid"},g={class:"grid-header"},h={class:"grid-body"},b={class:"time-column"},k=["onClick"],j={class:"lesson-title"},_={class:"lesson-meta"},x={key:0,class:"completion"},C=a({__name:"WeeklyPlanGrid",props:{days:{type:Array,default:()=>["Sunday","Monday","Tuesday","Wednesday","Thursday"]},periods:{type:Number,default:8},initialPlanData:{type:Array,default:()=>[]},subjectColors:{type:Object,default:()=>({})}},emits:["update:planData","cell-click","lesson-moved"],setup(a,{emit:C}){const A=a,I=C,P=s(Array.from({length:A.periods},()=>Array.from({length:A.days.length},()=>[])));d(()=>A.initialPlanData,e=>{e&&e.length&&$(e)},{immediate:!0});const $=e=>{P.value=Array.from({length:A.periods},()=>Array.from({length:A.days.length},()=>[])),e.forEach(e=>{const a=e.period_number-1,s=A.days.findIndex(a=>a===e.day);a>=0&&s>=0&&P.value[a][s].push(e)})},D=()=>{const e=[];return P.value.forEach((a,s)=>{a.forEach((a,d)=>{a.forEach(a=>{e.push({...a,period_number:s+1,day:A.days[d]})})})}),e};return(s,d)=>(o(),l("div",f,[t("div",g,[d[0]||(d[0]=t("div",{class:"time-column"},"Period/Day",-1)),(o(!0),l(n,null,r(a.days,e=>(o(),l("div",{key:e,class:"day-column"},i(e),1))),128))]),t("div",h,[(o(!0),l(n,null,r(a.periods,(d,f)=>{return o(),l("div",{key:`period-${f}`,class:"grid-row"},[t("div",b,i((g=f,`Period ${g+1}`)),1),(o(!0),l(n,null,r(a.days,(a,d)=>(o(),l("div",{key:`${f}-${d}`,class:"grid-cell",onClick:e=>s.$emit("cell-click",{periodIndex:f,dayIndex:d})},[m(v(e),{modelValue:P.value[f][d],"onUpdate:modelValue":e=>P.value[f][d]=e,group:"lessons","item-key":"id",animation:200,onChange:e=>((e,a,s)=>{if(I("update:planData",D()),e.added||e.moved){const d=e.added?e.added.element:e.moved.element;I("lesson-moved",{lesson:d,newPosition:{periodIndex:a,dayIndex:s}})}})(e,f,d)},{item:u(({element:e})=>{return[t("div",{class:p(["lesson-item",[`status-${e.status}`,{"has-notes":e.notes}]]),style:c({backgroundColor:(a=e.subject_id,A.subjectColors[a]||"#e2e8f0")})},[t("div",j,i(e.title),1),t("div",_,["planned"!==e.status?(o(),l("span",x,i(e.completion_percentage)+"% ",1)):y("",!0)])],6)];var a}),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])],8,k))),128))]);var g}),128))])]))}},[["__scopeId","data-v-93d6c686"]]);export{C as default};
