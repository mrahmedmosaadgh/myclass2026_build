import{r as e,u as s,Q as t,f as a,d as i,b as l}from"./app-DTyzyps1.js";import{Q as u}from"./QBadge-CkKjK8Tj.js";import{Q as o}from"./QSpace-BwAH5_uj.js";import{f as n,a as r,o as c,e as v,N as d,J as _,O as q,Q as z,V as m,b as p,K as f,I as h,F as b,R as k,a2 as y,U as g,a0 as w,z as Q,B as C,$ as x,_ as I}from"./vendor-BJyC5yAd.js";import"./offline-BzIlwqNM.js";import"./i18n-BDgsCcB6.js";import"./ui-DFn3cvMd.js";const M={class:"quiz-test"},j={class:"quiz-test__header"},S={class:"quiz-test__header-content"},T={class:"quiz-test__title"},B={class:"quiz-test__progress"},F={key:0,class:"quiz-test__timer"},L={key:0,class:"quiz-test__container"},N={class:"quiz-test__question-container"},$={class:"quiz-test__question-header"},A={class:"quiz-test__question-number"},D={class:"quiz-test__question-wrapper"},H=["innerHTML"],K={class:"quiz-test__options-grid"},R=["onClick","aria-checked","onKeydown"],E={class:"quiz-test__option-prefix"},J={class:"quiz-test__option-letter"},O={class:"quiz-test__option-text"},V={key:0,class:"quiz-test__feedback-icon"},Y={key:0,class:"icon-success",viewBox:"0 0 24 24"},P={key:1,class:"icon-error",viewBox:"0 0 24 24"},U={class:"quiz-test__navigation"},G={class:"quiz-test__sidebar"},W={class:"quiz-test__question-grid"},X=["onClick"],Z={key:1,class:"quiz-test__results"},ee={class:"quiz-test__results-stats"},se={class:"quiz-test__stat"},te={class:"quiz-test__stat-value"},ae={class:"quiz-test__stat"},ie={class:"quiz-test__stat-value"},le={class:"quiz-test__results-actions"},ue=e({__name:"QuizTest",props:{quizId:Number},setup(e){const ue=s(),oe=e,ne=n({name:"",questions:[],time_limit_minutes:null}),re=n(0),ce=n({}),ve=n(null),de=n(!1),_e=n(0),qe=n(0),ze=n(null);let me=null,pe=n(!1);const fe=r(()=>{var e;return(null==(e=ne.value.questions)?void 0:e[re.value])||{}}),he=()=>{me=setInterval(()=>{_e.value--,_e.value<=0&&Ce()},1e3)},be=e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,ke=e=>{ve.value=e},ye=()=>{ve.value&&(ce.value[re.value]=ve.value)},ge=()=>{ve.value=ce.value[re.value]||null},we=()=>{var e;ye(),re.value<((null==(e=ne.value.questions)?void 0:e.length)||0)-1&&(re.value++,ge())},Qe=()=>{ye(),re.value>0&&(re.value--,ge())},Ce=async()=>{ye(),qe.value=Math.floor((Date.now()-ze.value)/1e3),me&&clearInterval(me);let e=0;ne.value.questions.forEach((s,t)=>{var a;const i=ce.value[t],l=null==(a=s.options)?void 0:a.find(e=>e.is_correct);i===(null==l?void 0:l.id)&&e++});const s=Math.round(e/ne.value.questions.length*100);sessionStorage.setItem("quizResults",JSON.stringify({quizId:oe.quizId,quizName:ne.value.name,answers:ce.value,questions:ne.value.questions,score:s,correctAnswers:e,totalQuestions:ne.value.questions.length,timeTaken:qe.value}));try{de.value=!0,ue.notify({type:"positive",message:"Quiz submitted successfully!",icon:"check"})}catch(t){console.error("Failed to submit quiz:",t),ue.notify({type:"negative",message:"Failed to submit quiz",icon:"error"})}},xe=()=>{x.visit(`/quizzes/${oe.quizId}/results`)};return c(()=>{(async()=>{try{const e=await I.get(`/api/quizzes/${oe.quizId}`);ne.value=e.data,ne.value.time_limit_minutes&&(_e.value=60*ne.value.time_limit_minutes,he()),ze.value=Date.now(),ge()}catch(e){console.error("Failed to load quiz:",e),ue.notify({type:"negative",message:"Failed to load quiz",icon:"error"})}})()}),v(()=>{me&&clearInterval(me)}),(e,s)=>{var n,r;return _(),d("div",M,[q("div",j,[q("div",S,[q("h1",T,m(ne.value.name),1),q("div",B," Question "+m(re.value+1)+" of "+m((null==(n=ne.value.questions)?void 0:n.length)||0),1)]),ne.value.time_limit_minutes&&!de.value?(_(),d("div",F,[p(t,{name:"schedule",size:"20px"}),q("span",null,m(be(_e.value)),1)])):z("",!0)]),de.value?(_(),d("div",Z,[p(i,{class:"quiz-test__results-card"},{default:f(()=>[p(a,{class:"text-center"},{default:f(()=>{var e;return[p(t,{name:"check_circle",size:"80px",color:"positive"}),s[6]||(s[6]=q("h2",null,"Quiz Completed!",-1)),s[7]||(s[7]=q("p",{class:"quiz-test__results-message"}," You've completed the quiz. Your answers have been submitted. ",-1)),q("div",ee,[q("div",se,[q("div",te,m((null==(e=ne.value.questions)?void 0:e.length)||0),1),s[4]||(s[4]=q("div",{class:"quiz-test__stat-label"},"Questions Answered",-1))]),q("div",ae,[q("div",ie,m(be(qe.value)),1),s[5]||(s[5]=q("div",{class:"quiz-test__stat-label"},"Time Taken",-1))])]),q("div",le,[p(l,{flat:"",label:"Back to Dashboard",icon:"arrow_back",onClick:s[0]||(s[0]=e=>Q(x).visit("/quizzes"))}),p(l,{unelevated:"",color:"primary",label:"View Results",icon:"assessment",onClick:xe})])]}),_:1})]),_:1})])):(_(),d("div",L,[q("div",N,[p(i,{class:"quiz-test__question-card"},{default:f(()=>[p(a,null,{default:f(()=>{return[q("div",$,[q("div",A," Question "+m(re.value+1),1),fe.value.difficulty?(_(),h(u,{key:0,color:(e=fe.value.difficulty,{Easy:"positive",Medium:"warning",Hard:"negative"}[e]||"info"),label:fe.value.difficulty},null,8,["color","label"])):z("",!0)]),q("div",D,[q("div",{class:"quiz-test__question-text",innerHTML:fe.value.question_text},null,8,H),q("div",K,[(_(!0),d(b,null,k(fe.value.options,(e,t)=>(_(),d("div",{key:e.id,class:g(["quiz-test__option-card",{selected:ve.value===e.id,correct:Q(pe)&&e.is_correct,incorrect:Q(pe)&&ve.value===e.id&&!e.is_correct}]),onClick:s=>ke(e.id),role:"radio","aria-checked":ve.value===e.id,tabindex:0,onKeydown:y(w(s=>ke(e.id),["prevent"]),["enter","space"])},[q("div",E,[q("div",J,m(String.fromCharCode(65+t)),1)]),q("div",O,m(e.option_text),1),p(C,{name:"fade-scale"},{default:f(()=>[Q(pe)&&ve.value===e.id?(_(),d("div",V,[e.is_correct?(_(),d("svg",Y,s[1]||(s[1]=[q("path",{fill:"currentColor",d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"},null,-1)]))):(_(),d("svg",P,s[2]||(s[2]=[q("path",{fill:"currentColor",d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"},null,-1)])))])):z("",!0)]),_:2},1024)],42,R))),128))])])];var e}),_:1})]),_:1}),q("div",U,[p(l,{flat:"",label:"Previous",icon:"arrow_back",disable:0===re.value,onClick:Qe},null,8,["disable"]),p(o),re.value<((null==(r=ne.value.questions)?void 0:r.length)||0)-1?(_(),h(l,{key:0,unelevated:"",color:"primary",label:"Next","icon-right":"arrow_forward",disable:!ve.value,onClick:we},null,8,["disable"])):(_(),h(l,{key:1,unelevated:"",color:"positive",label:"Submit Quiz","icon-right":"check",disable:!ve.value,onClick:Ce},null,8,["disable"]))])]),q("div",G,[p(i,null,{default:f(()=>[p(a,null,{default:f(()=>[s[3]||(s[3]=q("h4",null,"Questions",-1)),q("div",W,[(_(!0),d(b,null,k(ne.value.questions,(e,s)=>(_(),d("div",{key:e.id,class:g(["quiz-test__question-nav-item",{"quiz-test__question-nav-item--current":s===re.value,"quiz-test__question-nav-item--answered":void 0!==ce.value[s]}]),onClick:e=>(e=>{ye(),re.value=e,ge()})(s)},m(s+1),11,X))),128))])]),_:1})]),_:1})])]))])}}},[["__scopeId","data-v-feac7914"]]);export{ue as default};
