import{u as e,w as t,r as a}from"./xlsx-cMC2LkxH.js";const r=({items:a=[],columns:r=[],fileName:o="export",sheetName:s="Sheet1"})=>{try{const l=r.map(e=>e.label),n=a.map(e=>r.map(t=>{let a;if(t.key.includes(".")){const r=t.key.split(".");a=e;for(const e of r)a=null==a?void 0:a[e]}else a=e[t.key];return null!=a?a:""})),m=e.aoa_to_sheet([l,...n]),c=e.book_new();return e.book_append_sheet(c,m,s),t(c,`${o}.xlsx`),!0}catch(l){return console.error("Export error:",l),!1}},o=(t,r={})=>new Promise((o,s)=>{try{const l=new FileReader;l.onload=t=>{try{const s=new Uint8Array(t.target.result),l=a(s,{type:"array"}),n=l.Sheets[l.SheetNames[0]];let m=e.sheet_to_json(n,{header:r.header||void 0,defval:r.defval||""});r.transform&&(m=m.map(r.transform)),o({data:m,workbook:l,sheetName:l.SheetNames[0]})}catch(l){s(l)}},l.onerror=e=>s(e),l.readAsArrayBuffer(t)}catch(l){s(l)}}),s=(e,t="template")=>{e.map(e=>e.label),r({items:[],columns:e,fileName:t,sheetName:"Template"})};export{s as d,r as e,o as i};
