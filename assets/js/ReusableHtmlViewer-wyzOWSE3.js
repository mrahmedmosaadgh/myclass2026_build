import e from"./purify.es-C2Ba6vpb.js";import t from"./EditorToolbar-Ayf5jY92.js";import n from"./EditorContent-dniwShfs.js";import a from"./PrintLayout-CNsvkEbI.js";import{p as i}from"./app-BzjXrVp9.js";import{f as l,a as o,k as r,L as m,I as s,b as u}from"./vendor-EI0FRBVb.js";import"./TitleInput-Db14sL-R.js";import"./TextFormatControls-C_gVRsAB.js";import"./underline-PDlIMkNx.js";import"./createLucideIcon-APVJ2SH-.js";import"./LineSpacingControl-DccO5RlC.js";import"./AlignmentControls-CKTzz6AH.js";import"./align-right-CnRMXp62.js";import"./ImageControls-j4n1uop2.js";import"./image-CpjPXLZL.js";import"./PrintButton-DMqoc7gq.js";import"./printer-DTcC0fi8.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";const d={class:"relative bg-white"},p=i({__name:"ReusableHtmlViewer",props:{modelValue:{type:String,required:!0},title:{type:String,default:"Document"}},emits:["update:modelValue"],setup(i,{emit:p}){const c=i,g=p,v=l(c.title),f=l(null),h=l(null),b=l(1.5),y=l("left"),j=l("inline-block"),w=l(100),C=l([]),I=[5,10,15,20,25,33,50,75,100,110,120,150,200,300],T=o(()=>e.sanitize(c.modelValue)),V=o(()=>["bold","italic","underline"].filter(e=>document.queryCommandState(e))),k=e=>{document.execCommand(e,!1,null)},L=e=>{"IMG"===e.target.tagName&&(C.value=[e.target])},U=()=>{C.value.length&&C.value.forEach(e=>{e.style.width=`${w.value}%`})},_=()=>{const e=window.open("","_blank"),t=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <title>${v.value}</title>\n            <style>\n                @page {\n                    margin: 1cm;\n                    size: A4;\n                }\n                body {\n                    font-family: system-ui, -apple-system, sans-serif;\n                    line-height: ${b.value};\n                    margin: 0;\n                    padding: 1cm;\n                    text-align: ${y.value};\n                }\n                .prose {\n                    max-width: none;\n                }\n                .prose img {\n                    max-width: 100%;\n                    height: auto;\n                    page-break-inside: avoid;\n                }\n                @media print {\n                    html, body {\n                        width: 210mm;\n                        height: 297mm;\n                    }\n                }\n            </style>\n        </head>\n        <body>\n            ${T.value}\n        </body>\n        </html>\n    `;e.document.write(t),e.document.close(),e.onload=()=>{e.print(),e.onafterprint=()=>{e.close()}}},x=async()=>{if(!h.value)return;const t=h.value.$el||h.value,n=t.getElementsByTagName("img"),a=Array.from(n).map(async e=>{if(!e.src.startsWith("data:"))try{const t=await fetch(e.src),n=await t.blob(),a=await(e=>new Promise((t,n)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=n,a.readAsDataURL(e)}))(n);e.src=a}catch(t){console.error("Failed to convert image to base64:",t)}});await Promise.all(a),(t=>{const n=t.target.innerHTML,a=e.sanitize(n);g("update:modelValue",a)})({target:t})};return r(()=>c.modelValue,t=>{h.value&&h.value.innerHTML!==t&&(h.value.innerHTML=e.sanitize(t))}),(e,l)=>(s(),m("div",d,[u(t,{title:v.value,"onUpdate:title":l[0]||(l[0]=e=>v.value=e),"line-spacing":b.value,"onUpdate:lineSpacing":l[1]||(l[1]=e=>b.value=e),alignment:y.value,"onUpdate:alignment":l[2]||(l[2]=e=>y.value=e),"image-display-mode":j.value,"onUpdate:imageDisplayMode":l[3]||(l[3]=e=>j.value=e),"image-width":w.value,"onUpdate:imageWidth":l[4]||(l[4]=e=>w.value=e),"active-formats":V.value,"image-sizes":I,onFormat:k,onConvertImagesToBase64:x,onResizeImages:U,onPrint:_},null,8,["title","line-spacing","alignment","image-display-mode","image-width","active-formats"]),u(n,{"model-value":i.modelValue,"line-spacing":b.value,alignment:y.value,"onUpdate:modelValue":l[5]||(l[5]=e=>g("update:modelValue",e)),onImageClick:L,ref_key:"editableContent",ref:h},null,8,["model-value","line-spacing","alignment"]),u(a,{ref_key:"printContainer",ref:f,content:T.value,"line-spacing":b.value,alignment:y.value},null,8,["content","line-spacing","alignment"])]))}},[["__scopeId","data-v-98ba914f"]]);export{p as default};
