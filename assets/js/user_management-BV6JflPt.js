import{f as e,a as s,a6 as o,ae as r,L as l,I as a,b as t,M as n,O as i,y as m,U as d,V as u,H as c,F as p,Q as v,S as b,J as f,x,ab as g,ad as y,aa as w,_ as h}from"./vendor-CUZ9QTQV.js";import k from"./DialogModal_7-B_qUjrP0.js";import{_}from"./PrimaryButton-DNYxrPcC.js";import{_ as j}from"./SecondaryButton-BH3tlEGv.js";import C from"./UsersManagement-BVTEQD5h.js";import S from"./RolesManagement-B-pcV14N.js";import U from"./PermissionsManagement-BgS9GBPL.js";import I from"./UsersRoles-Cz6rfm0V.js";import{u as $}from"./i18n-CP46N9fu.js";import"./app-Buylb2AA.js";import"./offline-BzIlwqNM.js";import"./ui-LrZmvB2D.js";import"./QSelect-CcTxzM62.js";import"./rtl-Cr6c3OOr.js";import"./QTab-DYNjFyV-.js";import"./QTabs-DdUHRwMQ.js";import"./QTabPanel-CY2oJrqN.js";import"./use-panel-B1dc8KLj.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-BcXMjpO5.js";import"./UsersList-FHhGIjw4.js";import"./QSpinnerDots-DjseaGnd.js";import"./QSpace-1_yTqfel.js";import"./UserDetailsDialog-CQ92DI1G.js";const E={class:"flex justify-between items-center"},V={class:"font-semibold text-xl text-gray-800 leading-tight"},D={key:0,class:"py-12"},Q={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},R={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},L={class:"border-b border-gray-200 mb-5"},M={class:"-mb-px flex space-x-8"},P=["onClick"],A={class:"mb-4"},T={for:"role-name",class:"block text-sm font-medium text-gray-700"},B={key:0,class:"text-red-500 text-sm mt-1"},O={class:"mb-4"},F={class:"block text-sm font-medium text-gray-700 mb-2"},H={class:"max-h-60 overflow-y-auto p-2 border rounded-md"},J={class:"flex items-center h-5"},G=["id","value"],K={class:"ml-3 text-sm"},q=["for"],z={key:0,class:"text-red-500 text-sm mt-1"},N={class:"mb-4"},W={for:"permission-name",class:"block text-sm font-medium text-gray-700"},X={key:0,class:"text-red-500 text-sm mt-1"},Y={class:"mb-4"},Z={class:"max-h-60 overflow-y-auto p-2 border rounded-md"},ee={class:"flex items-center h-5"},se=["id","value"],oe={class:"ml-3 text-sm"},re=["for"],le={class:"space-y-4"},ae={class:"block text-sm font-medium text-gray-700"},te={key:0,class:"text-red-500 text-sm mt-1"},ne={class:"block text-sm font-medium text-gray-700"},ie={key:0,class:"text-red-500 text-sm mt-1"},me={key:0},de={class:"block text-sm font-medium text-gray-700"},ue={key:0,class:"text-red-500 text-sm mt-1"},ce={key:1},pe={class:"block text-sm font-medium text-gray-700"},ve={class:"block text-sm font-medium text-gray-700"},be=["value"],fe={key:0,class:"text-red-500 text-sm mt-1"},xe={__name:"user_management",props:{roles:Array,permissions:Array,users:Array,enhancedUserData:{type:Object,default:()=>({})}},setup(xe){const{t:ge}=$(),ye=xe,we=e("users-management"),he=e(""),ke=e("all"),_e=e(!1),je=e(!1),Ce=e(null),Se=e(null),Ue=s(()=>[{id:"users-management",name:ge("tabs.users_management")},{id:"roles",name:ge("tabs.roles")},{id:"permissions",name:ge("tabs.permissions")},{id:"users",name:ge("tabs.users_roles")}]),Ie=o({name:"",email:"",password:"",password_confirmation:"",roles:[]}),$e=e(!1),Ee=e(null),Ve=o({name:"",permissionIds:[]}),De=e(!1),Qe=e(null),Re=o({name:""}),Le=e(!1),Me=e(null),Pe=o({userId:"",roleIds:[]});function Ae(e=null){Ee.value=e,e?(Ve.name=e.name,Ve.permissionIds=e.permissions.map(e=>e.id)):Ve.reset(),$e.value=!0}function Te(e=null){e?(Qe.value=e,Re.name=e.name):(Qe.value=null,Re.reset()),De.value=!0}function Be(e){Me.value=e,Pe.userId=e.id,Pe.roleIds=e.roles.map(e=>e.id),Le.value=!0}function Oe(){Ee.value?Ve.put(`/admin/roles/${Ee.value.id}`,{preserveScroll:!0,onSuccess:()=>{$e.value=!1,Ve.reset()},onError:e=>{console.error(e)}}):Ve.post("/admin/roles",{preserveScroll:!0,onSuccess:()=>{$e.value=!1,Ve.reset()},onError:e=>{console.error(e)}})}function Fe(e){confirm(ge("role.confirm_delete",{name:e.name}))&&h.delete(`/admin/roles/${e.id}`,{preserveScroll:!0})}function He(){Qe.value?Re.put(`/admin/permissions/${Qe.value.id}`,{preserveScroll:!0,onSuccess:()=>{De.value=!1,Re.reset()},onError:e=>{console.error(e)}}):Re.post("/admin/permissions",{preserveScroll:!0,onSuccess:()=>{De.value=!1,Re.reset()},onError:e=>{console.error(e)}})}function Je(e){confirm(ge("permission.confirm_delete",{name:e.name}))&&h.delete(`/admin/permissions/${e.id}`,{preserveScroll:!0})}function Ge(){h.put(`/admin/users/${Me.value.id}/roles`,Pe,{preserveScroll:!0,onSuccess:()=>{Le.value=!1,Pe.reset()}})}s(()=>{let e=[...ye.users];if(he.value){const s=he.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(s)||e.email.toLowerCase().includes(s))}return"active"===ke.value?e=e.filter(e=>!e.deleted_at):"deleted"===ke.value&&(e=e.filter(e=>e.deleted_at)),e});const Ke=(e=null)=>{Ce.value=e,e?(Ie.name=e.name,Ie.email=e.email,Ie.password="",Ie.password_confirmation="",Ie.roles=e.roles.map(e=>e.id)):Ie.reset(),_e.value=!0},qe=()=>{_e.value=!1,Ce.value=null,Ie.reset()},ze=()=>{Ce.value?(Ie.password||(delete Ie.password,delete Ie.password_confirmation),Ie.put(route("admin.users.update",Ce.value.id),{preserveScroll:!0,onSuccess:()=>{qe()},onError:e=>{console.error(e)}})):Ie.post(route("admin.users.store"),{preserveScroll:!0,onSuccess:()=>{qe()},onError:e=>{console.error(e)}})},Ne=e=>{Se.value=e,je.value=!0},We=()=>{je.value=!1,Se.value=null},Xe=()=>{Se.value&&o({}).delete(route("admin.users.destroy",Se.value.id),{onSuccess:()=>We()})},Ye=e=>{o({}).put(route("admin.users.restore",e.id))},Ze=()=>{const e=ye.users.map(e=>({name:e.name,email:e.email,password:"12345678",roles:e.roles.map(e=>e.name).join(";")})),s=[["name","email","password","roles"].join(","),...e.map(e=>[`"${e.name}"`,`"${e.email}"`,`"${e.password}"`,`"${e.roles}"`].join(","))].join("\n"),o=new Blob([s],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),l=URL.createObjectURL(o);r.setAttribute("href",l),r.setAttribute("download","users_export.csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)};return(e,s)=>{const o=r("Head");return a(),l(p,null,[t(o,{title:m(ge)("permissions.dashboard")},null,8,["title"]),n("div",null,[n("div",E,[n("h2",V,d(m(ge)("user.management_dashboard")),1),n("button",{onClick:Ze,class:"px-4 py-2 bg-green-600 text-white text-sm rounded-md hover:bg-green-700 flex items-center gap-2"},[s[17]||(s[17]=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),u(" "+d(m(ge)("user.export_users")),1)])])]),xe.users?(a(),l("div",D,[n("div",Q,[n("div",R,[n("div",L,[n("nav",M,[(a(!0),l(p,null,v(Ue.value,e=>(a(),l("button",{key:e.id,onClick:s=>we.value=e.id,class:b([we.value===e.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},d(e.name),11,P))),128))])]),"users-management"===we.value?(a(),c(C,{key:0,users:xe.users,onEditUser:Ke,onDeleteUser:Ne,onRestoreUser:Ye},null,8,["users"])):i("",!0),"roles"===we.value?(a(),c(S,{key:1,roles:xe.roles,onCreateRole:s[0]||(s[0]=e=>Ae()),onEditRole:Ae,onDeleteRole:Fe},null,8,["roles"])):i("",!0),"permissions"===we.value?(a(),c(U,{key:2,permissions:xe.permissions,onCreatePermission:s[1]||(s[1]=e=>Te()),onEditPermission:Te,onDeletePermission:Je},null,8,["permissions"])):i("",!0),"users"===we.value?(a(),c(I,{key:3,users:xe.users,"enhanced-user-data":xe.enhancedUserData,onManageUserRoles:Be},null,8,["users","enhanced-user-data"])):i("",!0)])])])):i("",!0),t(k,{show:$e.value,onClose:s[5]||(s[5]=e=>$e.value=!1)},{title:f(()=>[u(d(Ee.value?m(ge)("role.edit"):m(ge)("role.create")),1)]),content:f(()=>[n("div",null,[n("div",A,[n("label",T,d(m(ge)("role.name")),1),x(n("input",{type:"text",id:"role-name","onUpdate:modelValue":s[2]||(s[2]=e=>m(Ve).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ve).name]]),m(Ve).errors.name?(a(),l("div",B,d(m(Ve).errors.name),1)):i("",!0)]),n("div",O,[n("label",F,d(m(ge)("permissions.label")),1),n("div",H,[(a(!0),l(p,null,v(xe.permissions,e=>(a(),l("div",{key:e.id,class:"flex items-start mb-2"},[n("div",J,[x(n("input",{id:`permission-${e.id}`,type:"checkbox",value:e.id,"onUpdate:modelValue":s[3]||(s[3]=e=>m(Ve).permissionIds=e),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,G),[[y,m(Ve).permissionIds]])]),n("div",K,[n("label",{for:`permission-${e.id}`,class:"font-medium text-gray-700"},d(e.name),9,q)])]))),128))]),m(Ve).errors.permissionIds?(a(),l("div",z,d(m(Ve).errors.permissionIds),1)):i("",!0)])])]),footer:f(()=>[t(j,{onClick:s[4]||(s[4]=e=>$e.value=!1)},{default:f(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:Oe,disabled:m(Ve).processing},{default:f(()=>[u(d(Ee.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["disabled"])]),_:1},8,["show"]),t(k,{show:De.value,onClose:s[8]||(s[8]=e=>De.value=!1)},{title:f(()=>[u(d(Qe.value?m(ge)("permission.edit"):m(ge)("permission.create")),1)]),content:f(()=>[n("div",null,[n("div",N,[n("label",W,d(m(ge)("permission.name")),1),x(n("input",{type:"text",name:"permission-name",id:"permission-name","onUpdate:modelValue":s[6]||(s[6]=e=>m(Re).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Re).name]]),m(Re).errors.name?(a(),l("div",X,d(m(Re).errors.name),1)):i("",!0)])])]),footer:f(()=>[t(j,{onClick:s[7]||(s[7]=e=>De.value=!1)},{default:f(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:He,disabled:m(Re).processing},{default:f(()=>[u(d(Qe.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["disabled"])]),_:1},8,["show"]),t(k,{show:Le.value,onClose:s[11]||(s[11]=e=>Le.value=!1)},{title:f(()=>[u(d(m(ge)("user.manage_roles_for",{name:Me.value?Me.value.name:""})),1)]),content:f(()=>[n("div",null,[n("div",Y,[n("div",Z,[(a(!0),l(p,null,v(xe.roles,e=>(a(),l("div",{key:e.id,class:"flex items-start mb-2"},[n("div",ee,[x(n("input",{id:`user-role-${e.id}`,type:"checkbox",value:e.id,"onUpdate:modelValue":s[9]||(s[9]=e=>m(Pe).roleIds=e),class:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"},null,8,se),[[y,m(Pe).roleIds]])]),n("div",oe,[n("label",{for:`user-role-${e.id}`,class:"font-medium text-gray-700"},d(e.name),9,re)])]))),128))])])])]),footer:f(()=>[t(j,{onClick:s[10]||(s[10]=e=>Le.value=!1)},{default:f(()=>[u(d(m(ge)("common.cancel")),1)]),_:1}),t(_,{class:"ml-3",onClick:Ge},{default:f(()=>[u(d(m(ge)("user.save_roles")),1)]),_:1})]),_:1},8,["show"]),t(k,{show:_e.value,onClose:qe},{title:f(()=>[u(d(Ce.value?m(ge)("user.edit"):m(ge)("user.create")),1)]),content:f(()=>[n("div",le,[n("div",null,[n("label",ae,d(m(ge)("user.name")),1),x(n("input",{type:"text","onUpdate:modelValue":s[12]||(s[12]=e=>m(Ie).name=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).name]]),m(Ie).errors.name?(a(),l("div",te,d(m(Ie).errors.name),1)):i("",!0)]),n("div",null,[n("label",ne,d(m(ge)("user.email")),1),x(n("input",{type:"email","onUpdate:modelValue":s[13]||(s[13]=e=>m(Ie).email=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).email]]),m(Ie).errors.email?(a(),l("div",ie,d(m(Ie).errors.email),1)):i("",!0)]),Ce.value?i("",!0):(a(),l("div",me,[n("label",de,d(m(ge)("user.password")),1),x(n("input",{type:"password","onUpdate:modelValue":s[14]||(s[14]=e=>m(Ie).password=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).password]]),m(Ie).errors.password?(a(),l("div",ue,d(m(Ie).errors.password),1)):i("",!0)])),!Ce.value||m(Ie).password?(a(),l("div",ce,[n("label",pe,d(m(ge)("user.confirm_password")),1),x(n("input",{type:"password","onUpdate:modelValue":s[15]||(s[15]=e=>m(Ie).password_confirmation=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,512),[[g,m(Ie).password_confirmation]])])):i("",!0),n("div",null,[n("label",ve,d(m(ge)("user.roles")),1),x(n("select",{multiple:"","onUpdate:modelValue":s[16]||(s[16]=e=>m(Ie).roles=e),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[(a(!0),l(p,null,v(xe.roles,e=>(a(),l("option",{key:e.id,value:e.id},d(e.name),9,be))),128))],512),[[w,m(Ie).roles]]),m(Ie).errors.roles?(a(),l("div",fe,d(m(Ie).errors.roles),1)):i("",!0)])])]),footer:f(()=>[n("button",{onClick:qe,class:"mr-3 px-4 py-2 text-gray-700 hover:text-gray-900"},d(m(ge)("common.cancel")),1),n("button",{onClick:ze,class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},d(Ce.value?m(ge)("common.update"):m(ge)("common.create")),1)]),_:1},8,["show"]),t(k,{show:je.value,onClose:We},{title:f(()=>[u(d(m(ge)("user.delete")),1)]),content:f(()=>[u(d(m(ge)("user.confirm_delete")),1)]),footer:f(()=>[n("button",{onClick:We,class:"mr-3 px-4 py-2 text-gray-700 hover:text-gray-900"},d(m(ge)("common.cancel")),1),n("button",{onClick:Xe,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"},d(m(ge)("user.delete")),1)]),_:1},8,["show"])],64)}}};export{xe as default};
