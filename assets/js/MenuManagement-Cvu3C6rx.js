import{u as e,Q as a,a as l,b as s}from"./app-B9g134Ig.js";import{Q as o}from"./QTab-Cz1WPncs.js";import{Q as t}from"./QTabs-CeWTaR6G.js";import{Q as u}from"./QTabPanel-pSOuZD-K.js";import{Q as n}from"./QTabPanels-R7xx_0TT.js";import{M as m,f as i,k as r,I as d,J as p,K as c,O as v,b as y,N as f,R as b,F as j,_ as g,$ as Q}from"./vendor-nQjeLEvd.js";import{u as V,A as M}from"./AdminLayout-BcIX_l_r.js";import C from"./MenuList-B4-F99xO.js";import _ from"./MenuForm-BqfMiyOA.js";import h from"./MenuDeleteDialog-CEnaT2Mc.js";import k from"./BulkImportDialog-lxt-DJ1M.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-DG3Ijog8.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-DTOqueiL.js";import"./QSpace-DtKzCIdL.js";import"./QSelect-s_FFdLoI.js";import"./QForm-Dxdw_MSq.js";import"./QStepperNavigation-CK4QGnw2.js";import"./QStepper-DHzY1Glp.js";import"./copy-to-clipboard-C03lBTpB.js";const U={class:"q-pa-md"},w={class:"row q-mb-md items-center"},F={class:"col-auto"},S={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(S){const x=e();m();const A=S,T=i(A.modules[0]||"academics"),D=i(!1),I=i(!1),q=i(!1),B=i(!1),L=i(null),N=i(null),P=e=>A.menus.filter(a=>a.module===e),R=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");r(I,e=>{e&&(L.value=null,D.value=!0,I.value=!1)});const $=e=>{L.value=e,D.value=!0},J=e=>{N.value=e,q.value=!0},K=async e=>{var a,l;try{L.value?(await g.put(`/api/admin/menus/${L.value.id}`,e),x.notify({type:"positive",message:"Menu updated successfully"})):(await g.post("/api/admin/menus",e),x.notify({type:"positive",message:"Menu created successfully"})),z(),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to save menu"})}},O=async()=>{var e,a;try{await g.delete(`/api/admin/menus/${N.value.id}`),x.notify({type:"positive",message:"Menu deleted successfully"}),q.value=!1,Q.reload({only:["menus"]})}catch(l){x.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},E=async e=>{var a,l;try{await g.post("/api/admin/menus/reorder",{items:e}),x.notify({type:"positive",message:"Menu order updated successfully"}),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to reorder menus"})}},W=V(),X=async()=>{await W.invalidateCache(),Q.reload({only:["menus"]})},z=()=>{D.value=!1,L.value=null};return(e,m)=>(p(),d(M,null,{default:c(()=>[v("div",U,[v("div",w,[m[8]||(m[8]=v("div",{class:"col"},[v("div",{class:"text-h4"},"Menu Management"),v("div",{class:"text-subtitle2 text-grey-7"},"Manage navigation menus for your application")],-1)),v("div",F,[y(a,{color:"primary",icon:"add",label:"Create Menu",onClick:m[0]||(m[0]=e=>I.value=!0)}),y(a,{color:"secondary",icon:"upload",label:"Bulk Import",class:"q-ml-sm",onClick:m[1]||(m[1]=e=>B.value=!0)})])]),y(t,{modelValue:T.value,"onUpdate:modelValue":m[2]||(m[2]=e=>T.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left"},{default:c(()=>[(p(!0),f(j,null,b(S.modules,e=>(p(),d(o,{key:e,name:e,label:R(e)},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),y(l),y(n,{modelValue:T.value,"onUpdate:modelValue":m[3]||(m[3]=e=>T.value=e),animated:""},{default:c(()=>[(p(!0),f(j,null,b(S.modules,e=>(p(),d(u,{key:e,name:e},{default:c(()=>[y(C,{menus:P(e),module:e,onEdit:$,onDelete:J,onReorder:E},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),y(s,{modelValue:D.value,"onUpdate:modelValue":m[4]||(m[4]=e=>D.value=e),persistent:""},{default:c(()=>[y(_,{menu:L.value,modules:S.modules,onSave:K,onCancel:z},null,8,["menu","modules"])]),_:1},8,["modelValue"]),y(h,{modelValue:q.value,"onUpdate:modelValue":m[5]||(m[5]=e=>q.value=e),menu:N.value,onConfirm:O,onCancel:m[6]||(m[6]=e=>q.value=!1)},null,8,["modelValue","menu"]),y(k,{modelValue:B.value,"onUpdate:modelValue":m[7]||(m[7]=e=>B.value=e),onImported:X},null,8,["modelValue"])])]),_:1}))}};export{S as default};
