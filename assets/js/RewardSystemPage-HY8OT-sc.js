import{p as e,u as a,Q as l,n as t,b as o}from"./app-DXXarK7I.js";import{Q as s}from"./QSelect-OI6RFhnT.js";import{f as u,o as d,L as i,I as n,M as r,b as m,F as v,Q as p,H as c,J as b,U as f,Z as h}from"./vendor-EI0FRBVb.js";import y from"./StudentCard-Ckuzsb7x.js";import j from"./BehaviorManager-B-Fo5uIl.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./rtl-Cr6c3OOr.js";import"./QTab-DzZGFS5V.js";import"./QTabs-BC5MrYhV.js";import"./QTabPanel-Cip5Q1JD.js";import"./use-panel-v2pzMR_n.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-BXLgHK63.js";const w={class:"row justify-between items-center q-mb-md"},_={class:"row q-mb-md q-gutter-md"},g={class:"q-gutter-md row wrap"},V=e({__name:"RewardSystemPage",setup(e){const V=a(),k=u([]),Q=u([]),q=u(null),C=u(["Week 1","Week 2","Week 3","Week 4"]),S=u(C.value[0]),B=u([]),I=u([]),U=u(!1),x=u(null),L=u(null),P=u(!1),R=u([]),T=async()=>{const e=k.value.find(e=>e.id===q.value);if(B.value=(null==e?void 0:e.students)||[],0===I.value.length)try{const{data:e}=await h.get("/api/behaviors");I.value=e}catch(a){console.error(a),V.notify({type:"negative",message:"Failed to load behaviors."})}},W=e=>{x.value=e,L.value=e.behavior_id,U.value=!0},F=async()=>{if(x.value)try{const{data:e}=await h.get(`/api/student-behaviors/${x.value.id}`);x.value.total_points=e.total_points}catch(e){console.error(e)}};return d(()=>{(async()=>{try{const{data:e}=await h.get("/my_classes_with_students");k.value=e,Q.value=e.map(e=>({id:e.id,name:e.name}))}catch(e){console.error(e),V.notify({type:"negative",message:"Failed to load classrooms."})}})()}),(e,a)=>(n(),i(v,null,[r("div",w,[a[6]||(a[6]=r("div",{class:"text-h5"},"Classroom Reward System",-1)),r("div",null,[m(l,{label:"Leaderboard",color:"primary",onClick:a[0]||(a[0]=e=>P.value=!0)})])]),r("div",_,[m(s,{outlined:"",label:"Select Classroom",modelValue:q.value,"onUpdate:modelValue":[a[1]||(a[1]=e=>q.value=e),T],options:Q.value,"option-label":"name","option-value":"id"},null,8,["modelValue","options"]),m(s,{outlined:"",label:"Select Period",modelValue:S.value,"onUpdate:modelValue":a[2]||(a[2]=e=>S.value=e),options:C.value},null,8,["modelValue","options"])]),r("div",g,[(n(!0),i(v,null,p(B.value,e=>(n(),c(y,{key:e.id,student:e,onOpenBehavior:W},null,8,["student"]))),128))]),m(j,{modelValue:U.value,"onUpdate:modelValue":a[3]||(a[3]=e=>U.value=e),student:x.value,studentBehaviorId:L.value,behaviors:I.value,onRecorded:F},null,8,["modelValue","student","studentBehaviorId","behaviors"]),m(o,{modelValue:P.value,"onUpdate:modelValue":a[5]||(a[5]=e=>P.value=e),persistent:""},{default:b(()=>[m(t,{class:"q-pa-md",style:{width:"400px"}},{default:b(()=>[a[7]||(a[7]=r("div",{class:"text-h6 q-mb-md"},"Leaderboard",-1)),(n(!0),i(v,null,p(R.value,e=>(n(),i("div",{key:e.id,class:"row justify-between q-mb-sm"},[r("div",null,f(e.name),1),r("div",null,f(e.total_points),1)]))),128)),m(l,{flat:"",label:"Close",onClick:a[4]||(a[4]=e=>P.value=!1)})]),_:1})]),_:1},8,["modelValue"])],64))}},[["__scopeId","data-v-de1e62ad"]]);export{V as default};
