import{u as e,a,Q as s,b as l,c as o,d as t,e as n}from"./app-CWAnT6CT.js";import{Q as u}from"./QTab-BMD61nU3.js";import{Q as m}from"./QTabs-BXUhAxYJ.js";import{Q as r}from"./QTabPanel-16_gtepn.js";import{Q as i}from"./QTabPanels-BZNF5OxK.js";import{M as d,f as p,k as c,I as v,J as y,K as f,R as g,b as j,N as b,Q,W as V,V as w,F as M,_ as x,$ as _}from"./vendor-BWKGNkNB.js";import{A as q}from"./AdminLayout-DG9AtDfd.js";import C from"./MenuList-BrlY4ApJ.js";import h from"./MenuForm-BJSn8cof.js";import F from"./MenuDeleteDialog-XGLHDcBH.js";import k from"./BulkImportDialog--V4KRHA2.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-BQUWxHno.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-D8mJvg-f.js";import"./QSpace-DC5Rdnaf.js";import"./QSelect-5P1Qxg14.js";import"./QForm-BHNk-Zcq.js";import"./QStepperNavigation-CeKPv5Lg.js";import"./QStepper-DV5CWNDg.js";import"./copy-to-clipboard-DT9EgFap.js";const A={class:"q-pa-md"},U={class:"row q-mb-lg items-center justify-between"},D={class:"col"},S={class:"row items-center q-gutter-x-sm text-grey-8 q-mb-xs"},z={class:"col-auto row q-gutter-sm"},I={class:"row items-center no-wrap"},T={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(T){const B=e();d();const $=a(),E=T,L=p(E.modules[0]||"academics"),N=p(!1),P=p(!1),R=p(!1),J=p(!1),K=p(null),W=p(null),G=e=>E.menus.filter(a=>a.module===e),H=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");c(P,e=>{e&&(K.value=null,N.value=!0,P.value=!1)});const O=e=>{K.value=e,N.value=!0},X=e=>{W.value=e,R.value=!0},Y=async e=>{var a,s;try{K.value?(await x.put(`/api/admin/menus/${K.value.id}`,e),B.notify({type:"positive",message:"Menu updated successfully"})):(await x.post("/api/admin/menus",e),B.notify({type:"positive",message:"Menu created successfully"})),se(),_.reload({only:["menus"]})}catch(l){B.notify({type:"negative",message:(null==(s=null==(a=l.response)?void 0:a.data)?void 0:s.message)||"Failed to save menu"})}},Z=async()=>{var e,a;try{await x.delete(`/api/admin/menus/${W.value.id}`),B.notify({type:"positive",message:"Menu deleted successfully"}),R.value=!1,_.reload({only:["menus"]})}catch(s){B.notify({type:"negative",message:(null==(a=null==(e=s.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},ee=async e=>{var a,s;try{await x.post("/api/admin/menus/reorder",{items:e}),B.notify({type:"positive",message:"Menu order updated successfully"}),_.reload({only:["menus"]})}catch(l){B.notify({type:"negative",message:(null==(s=null==(a=l.response)?void 0:a.data)?void 0:s.message)||"Failed to reorder menus"})}},ae=async()=>{$.menus.clear(),_.reload({only:["menus"]})},se=()=>{N.value=!1,K.value=null};return(e,a)=>(y(),v(q,null,{default:f(()=>[g("div",A,[g("div",U,[g("div",D,[g("div",S,[j(s,{name:"settings",size:"sm"}),a[8]||(a[8]=g("div",{class:"text-h5 text-weight-bold"},"Menu Management",-1))]),a[9]||(a[9]=g("div",{class:"text-subtitle2 text-grey-7"},"Configure and organize application navigation menus",-1))]),g("div",z,[j(l,{color:"secondary",icon:"upload",label:"Import",outline:"",onClick:a[0]||(a[0]=e=>J.value=!0)}),j(l,{color:"primary",icon:"add",label:"Create Menu",unelevated:"",onClick:a[1]||(a[1]=e=>P.value=!0)})])]),j(t,{flat:"",bordered:"",class:"bg-white rounded-borders"},{default:f(()=>[j(m,{modelValue:L.value,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value=e),dense:"",class:"text-grey-7 bg-grey-1","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":""},{default:f(()=>[(y(!0),b(M,null,Q(T.modules,e=>(y(),v(u,{key:e,name:e,class:"q-px-lg q-py-md"},{default:f(()=>[g("div",I,[j(s,{name:"widgets",class:"q-mr-sm",size:"xs"}),V(" "+w(H(e)),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),j(o),j(i,{modelValue:L.value,"onUpdate:modelValue":a[3]||(a[3]=e=>L.value=e),animated:"",class:"bg-transparent"},{default:f(()=>[(y(!0),b(M,null,Q(T.modules,e=>(y(),v(r,{key:e,name:e,class:"q-pa-none"},{default:f(()=>[j(C,{menus:G(e),module:e,onEdit:O,onDelete:X,onReorder:ee},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1}),j(n,{modelValue:N.value,"onUpdate:modelValue":a[4]||(a[4]=e=>N.value=e),persistent:""},{default:f(()=>[j(h,{menu:K.value,modules:T.modules,onSave:Y,onCancel:se},null,8,["menu","modules"])]),_:1},8,["modelValue"]),j(F,{modelValue:R.value,"onUpdate:modelValue":a[5]||(a[5]=e=>R.value=e),menu:W.value,onConfirm:Z,onCancel:a[6]||(a[6]=e=>R.value=!1)},null,8,["modelValue","menu"]),j(k,{modelValue:J.value,"onUpdate:modelValue":a[7]||(a[7]=e=>J.value=e),onImported:ae},null,8,["modelValue"])])]),_:1}))}};export{T as default};
