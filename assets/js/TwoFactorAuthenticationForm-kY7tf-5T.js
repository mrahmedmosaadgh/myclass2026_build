import{f as e,r as o,L as t,I as a,M as s,b as r,K as l,J as n,V as i,S as u,U as c,a1 as d,n as m,N as p,a6 as f,a as v,k as y,H as g,O as h,y as w,F as b,Q as x,_ as k}from"./vendor-EI0FRBVb.js";import{_}from"./ActionSection-CBkKjuwY.js";import{_ as C}from"./DialogModal-DIV6VG0a.js";import{_ as S}from"./InputError-murmiSoy.js";import{_ as j}from"./PrimaryButton-D4MqeasW.js";import{_ as T}from"./SecondaryButton-UHI6KqaH.js";import{_ as F}from"./TextInput-BSv0fPPu.js";import{D as M}from"./DangerButton-BoPdGLQl.js";import{_ as V}from"./InputLabel-B2bobwOZ.js";import"./SectionTitle-DrRzgjTs.js";import"./app-BzjXrVp9.js";import"./offline-BzIlwqNM.js";import"./i18n-BbKXhR_S.js";import"./ui-B__oX9pK.js";import"./Modal-DOPZQLRD.js";const A={class:"mt-4"},B={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(p,{emit:f}){const v=f,y=e(!1),g=o({password:"",error:"",processing:!1}),h=e(null),w=()=>{axios.get(route("password.confirmation")).then(e=>{e.data.confirmed?v("confirmed"):(y.value=!0,setTimeout(()=>h.value.focus(),250))})},b=()=>{g.processing=!0,axios.post(route("password.confirm"),{password:g.password}).then(()=>{g.processing=!1,x(),m().then(()=>v("confirmed"))}).catch(e=>{g.processing=!1,g.error=e.response.data.errors.password[0],h.value.focus()})},x=()=>{y.value=!1,g.password="",g.error=""};return(e,o)=>(a(),t("span",null,[s("span",{onClick:w},[l(e.$slots,"default")]),r(C,{show:y.value,onClose:x},{title:n(()=>[i(c(p.title),1)]),content:n(()=>[i(c(p.content)+" ",1),s("div",A,[r(F,{ref_key:"passwordInput",ref:h,modelValue:g.password,"onUpdate:modelValue":o[0]||(o[0]=e=>g.password=e),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:d(b,["enter"])},null,8,["modelValue"]),r(S,{message:g.error,class:"mt-2"},null,8,["message"])])]),footer:n(()=>[r(T,{onClick:x},{default:n(()=>o[1]||(o[1]=[i(" Cancel ")])),_:1}),r(j,{class:u(["ms-3",{"opacity-25":g.processing}]),disabled:g.processing,onClick:b},{default:n(()=>[i(c(p.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},L={key:0,class:"text-lg font-medium text-gray-900"},P={key:1,class:"text-lg font-medium text-gray-900"},D={key:2,class:"text-lg font-medium text-gray-900"},H={key:3},I={key:0},K={class:"mt-4 max-w-xl text-sm text-gray-600"},R={key:0,class:"font-semibold"},E={key:1},q=["innerHTML"],Q={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},U={class:"font-semibold"},Y=["innerHTML"],G={key:1,class:"mt-4"},O={key:1},z={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},J={class:"mt-5"},N={key:0},W={key:1},$={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(o){const l=o,m=p(),C=e(!1),A=e(!1),$=e(!1),X=e(null),Z=e(null),ee=e([]),oe=f({code:""}),te=v(()=>{var e;return!C.value&&(null==(e=m.props.auth.user)?void 0:e.two_factor_enabled)});y(te,()=>{te.value||(oe.reset(),oe.clearErrors())});const ae=()=>{C.value=!0,k.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([se(),re(),le()]),onFinish:()=>{C.value=!1,A.value=l.requiresConfirmation}})},se=()=>axios.get(route("two-factor.qr-code")).then(e=>{X.value=e.data.svg}),re=()=>axios.get(route("two-factor.secret-key")).then(e=>{Z.value=e.data.secretKey}),le=()=>axios.get(route("two-factor.recovery-codes")).then(e=>{ee.value=e.data}),ne=()=>{oe.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{A.value=!1,X.value=null,Z.value=null}})},ie=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>le())},ue=()=>{$.value=!0,k.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{$.value=!1,A.value=!1}})};return(e,o)=>(a(),g(_,null,{title:n(()=>o[1]||(o[1]=[i(" Two Factor Authentication ")])),description:n(()=>o[2]||(o[2]=[i(" Add additional security to your account using two factor authentication. ")])),content:n(()=>[te.value&&!A.value?(a(),t("h3",L," You have enabled two factor authentication. ")):te.value&&A.value?(a(),t("h3",P," Finish enabling two factor authentication. ")):(a(),t("h3",D," You have not enabled two factor authentication. ")),o[11]||(o[11]=s("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[s("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1)),te.value?(a(),t("div",H,[X.value?(a(),t("div",I,[s("div",K,[A.value?(a(),t("p",R," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(a(),t("p",E," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),s("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:X.value},null,8,q),Z.value?(a(),t("div",Q,[s("p",U,[o[3]||(o[3]=i(" Setup Key: ")),s("span",{innerHTML:Z.value},null,8,Y)])])):h("",!0),A.value?(a(),t("div",G,[r(V,{for:"code",value:"Code"}),r(F,{id:"code",modelValue:w(oe).code,"onUpdate:modelValue":o[0]||(o[0]=e=>w(oe).code=e),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:d(ne,["enter"])},null,8,["modelValue"]),r(S,{message:w(oe).errors.code,class:"mt-2"},null,8,["message"])])):h("",!0)])):h("",!0),ee.value.length>0&&!A.value?(a(),t("div",O,[o[4]||(o[4]=s("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[s("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1)),s("div",z,[(a(!0),t(b,null,x(ee.value,e=>(a(),t("div",{key:e},c(e),1))),128))])])):h("",!0)])):h("",!0),s("div",J,[te.value?(a(),t("div",W,[r(B,{onConfirmed:ne},{default:n(()=>[A.value?(a(),g(j,{key:0,type:"button",class:u(["me-3",{"opacity-25":C.value}]),disabled:C.value},{default:n(()=>o[6]||(o[6]=[i(" Confirm ")])),_:1},8,["class","disabled"])):h("",!0)]),_:1}),r(B,{onConfirmed:ie},{default:n(()=>[ee.value.length>0&&!A.value?(a(),g(T,{key:0,class:"me-3"},{default:n(()=>o[7]||(o[7]=[i(" Regenerate Recovery Codes ")])),_:1})):h("",!0)]),_:1}),r(B,{onConfirmed:le},{default:n(()=>[0!==ee.value.length||A.value?h("",!0):(a(),g(T,{key:0,class:"me-3"},{default:n(()=>o[8]||(o[8]=[i(" Show Recovery Codes ")])),_:1}))]),_:1}),r(B,{onConfirmed:ue},{default:n(()=>[A.value?(a(),g(T,{key:0,class:u({"opacity-25":$.value}),disabled:$.value},{default:n(()=>o[9]||(o[9]=[i(" Cancel ")])),_:1},8,["class","disabled"])):h("",!0)]),_:1}),r(B,{onConfirmed:ue},{default:n(()=>[A.value?h("",!0):(a(),g(M,{key:0,class:u({"opacity-25":$.value}),disabled:$.value},{default:n(()=>o[10]||(o[10]=[i(" Disable ")])),_:1},8,["class","disabled"]))]),_:1})])):(a(),t("div",N,[r(B,{onConfirmed:ae},{default:n(()=>[r(j,{type:"button",class:u({"opacity-25":C.value}),disabled:C.value},{default:n(()=>o[5]||(o[5]=[i(" Enable ")])),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{$ as default};
