import{r as e}from"./app-DTyzyps1.js";import{a as n,k as d,N as t,J as o,O as a,Q as r,V as l,y as i,ac as s,a2 as p,U as c,F as u,R as g,I as x,a0 as m}from"./vendor-BJyC5yAd.js";import"./offline-BzIlwqNM.js";import"./i18n-BDgsCcB6.js";import"./ui-DFn3cvMd.js";const h={class:"flex items-center gap-2"},v={class:"text-gray-500"},f={key:1,class:"w-4"},y={key:2,class:"flex items-center gap-1"},b={key:3,class:"flex-grow"},k={key:0,class:"pl-4 mt-2 border-l border-gray-200"},D=e({__name:"TreeNode",props:{node:Object,parent:Array,index:Number,expandAll:{type:Boolean,default:!1}},emits:["update","node-drag","node-drop"],setup(e,{emit:w}){const A=e,N=w,j=n(()=>!A.parent||A.parent===A.node.parent);d(()=>A.expandAll,e=>{}),void 0===A.node.expanded&&(A.node.expanded=!1);const C=()=>{A.node.expanded=!A.node.expanded,N("update")},I=()=>{A.node.children||(A.node.children=[]);const e=Date.now();A.node.children.push({id:e,text:"",children:[],editing:!0,expanded:!0}),A.node.expanded=!0,N("update")},U=()=>{A.node.children&&A.node.children.length>0&&!confirm(`Delete "${A.node.text}" and all its children?`)||$()},$=()=>{A.parent.splice(A.index,1),N("update")},_=()=>{A.node.editing=!0},B=()=>{""===A.node.text.trim()&&(A.node.text="Unnamed Node"),A.node.editing=!1,N("update")};let T=null,E=null,L=null;const O=e=>{T=A.node,E=A.parent,L=A.index,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",A.node.id),e.target.classList.add("dragging")},P=e=>{e.target.getBoundingClientRect(),N("node-drag",{y:e.clientY}),e.preventDefault()},R=e=>{e.target.classList.remove("dragging"),N("node-drag",{visible:!1})},V=e=>{F(A.node,T)||N("node-drop",{sourceNodeId:T.id,sourceParent:E,sourceIndex:L,targetParent:A.parent,targetIndex:A.index})},F=(e,n)=>e.id===n.id||!!(e.children&&e.children.length>0)&&e.children.some(e=>F(e,n));return(n,d)=>(o(),t("div",{class:c(["relative group mb-2",{"pl-4":!j.value}]),draggable:"true",onDragstart:O,onDragover:m(P,["prevent"]),onDragend:R,onDrop:m(V,["prevent"])},[a("div",h,[e.node.children&&e.node.children.length>0?(o(),t("div",{key:0,class:"cursor-pointer",onClick:C},[a("span",v,l(e.node.expanded?"ðŸ”½":"â–¶ï¸"),1)])):(o(),t("div",f)),e.node.editing?(o(),t("div",y,[i(a("input",{"onUpdate:modelValue":d[0]||(d[0]=n=>e.node.text=n),onBlur:B,onKeyup:p(B,["enter"]),type:"text",placeholder:"Enter node name",class:"border rounded p-1 text-sm w-full min-w-[150px]",autofocus:""},null,544),[[s,e.node.text]])])):(o(),t("div",b,[a("span",{class:c(["py-1 px-2 rounded cursor-pointer hover:bg-gray-100",{"font-medium":j.value}])},l(e.node.text),3)])),a("div",{class:"hidden group-hover:flex gap-1 items-center"},[a("button",{onClick:I,class:"p-1 rounded hover:bg-green-100 text-green-600",title:"Add child node"}," âž• "),a("button",{onClick:_,class:"p-1 rounded hover:bg-yellow-100 text-yellow-600",title:"Edit node"}," âœï¸ "),a("button",{onClick:U,class:"p-1 rounded hover:bg-red-100 text-red-600",title:"Delete node"}," ðŸ—‘ï¸ ")])]),e.node.children&&e.node.children.length>0&&(e.node.expanded||e.expandAll)?(o(),t("div",k,[(o(!0),t(u,null,g(e.node.children,(t,a)=>(o(),x(D,{key:t.id,node:t,parent:e.node.children,index:a,"expand-all":e.expandAll,onUpdate:d[1]||(d[1]=e=>n.$emit("update")),onNodeDrag:d[2]||(d[2]=e=>n.$emit("node-drag",e)),onNodeDrop:d[3]||(d[3]=e=>n.$emit("node-drop",e))},null,8,["node","parent","index","expand-all"]))),128))])):r("",!0)],34))}},[["__scopeId","data-v-84fc6b11"]]);export{D as default};
