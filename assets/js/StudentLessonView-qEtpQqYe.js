import{r as e,u as a,aI as t,t as s,b as i,d as o,Q as r,aS as n,f as l,e as p}from"./app-DlLesFGi.js";import{Q as m}from"./QSpace-BK_PGLKv.js";import{Q as d}from"./QBar-BlDe36WY.js";import{M as u,f as j,a as c,o as v,af as y,N as f,J as g,b as Q,I as b,O as w,K as S,W as _,S as h,y as x,Y as P,ak as C,F as T,_ as k}from"./vendor-BWKGNkNB.js";import z from"./LessonPlayer-Cy1BVxFi.js";import I from"./reward_sys-CIn6N6CT.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";import"./QSpinnerDots-B_GSDqC3.js";import"./QBadge-IdEcTs8C.js";import"./QPage-G667z0uO.js";import"./QPageContainer-B58763XF.js";import"./QLayout-D0lw7ajL.js";import"./QuestionSlide-CaWf0fL_.js";import"./EnhancedQuestionEditor-2tLgaFBF.js";import"./QuestionEditor-DzqtNbjI.js";import"./RichTextEditor-B2mNAQ-X.js";import"./QColor-eqGXYKL_.js";import"./QSlider-CuF3S-6I.js";import"./QTabs-BClcf-CB.js";import"./rtl-Cr6c3OOr.js";import"./QTab-CYxYFXBq.js";import"./QTabPanels-CTgZWG49.js";import"./use-panel-BqxRbB7W.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanel-DXa1fEFB.js";import"./purify.es-C2Ba6vpb.js";import"./MathEditor-BWwFmcgr.js";import"./katex-BXKQVcz-.js";import"./MathPastePreview-BAeMQ_tH.js";import"./QSelect-BTh0khse.js";import"./StepByStepEditor-60mASDZI.js";import"./QuestionTypeSelector-XZ2uPFLf.js";import"./QuizEngine-DN5HImKN.js";import"./useQuizI18n-COVRmzJR.js";import"./PlayerSidebar-DdbwymgH.js";import"./QDrawer-DkMr0RRs.js";import"./SectionCard-B2V81MSo.js";import"./SectionBanner-rpZjn7Er.js";import"./QLinearProgress-CX6G9yBK.js";import"./SlideRenderer-COVW7n4O.js";import"./FingerDrawingSlide-CyfcwUV3.js";import"./QPopupProxy-CedVGKZ2.js";import"./NavigationFooter-DDDRU4Xa.js";import"./DrawingOverlay-B0d9kMMy.js";import"./DrawingCanvas-2wfgnsN0.js";import"./DrawingToolbar-6dN0L9Ax.js";import"./QBtnToggle-iboNob1y.js";import"./SlideAnnotationOverlay-Dn2f4O8U.js";import"./QuizMode-BeI1yfls.js";import"./QuizNumpad-BoO7KE-q.js";import"./PointsDisplaySettings-DPPzcAOY.js";import"./TimerRandomTools-DNUzQwdo.js";import"./QCircularProgress-DK0g-hyO.js";import"./ClassroomHelper-C1qKyV5s.js";import"./QTd-BU_S4ffH.js";import"./QTable-BIAJAIui.js";import"./QMarkupTable-CzIo4GGA.js";import"./use-fullscreen-BQHoXYBI.js";import"./StudentCard-CbFaRqLr.js";import"./AvatarManager-DLzJfNWg.js";import"./CameraCapture-Dpv7Dqyp.js";import"./QFile-Cve4lAri.js";import"./use-file-DHXgO9tP.js";import"./QImg-BzYsb9cL.js";import"./noise-WU7qH7c7.js";const M={key:1,class:"h-screen flex items-center justify-center bg-gray-50"},D={key:2,class:"fixed-bottom-right q-ma-md",style:{"z-index":"2000"}},F={key:0,class:"text-h6 q-ml-sm"},L={key:1,class:"text-subtitle2 q-ml-sm"},E=e({__name:"StudentLessonView",props:{presentationId:{type:[String,Number],required:!0},studentId:{type:[String,Number],required:!0},sections:{type:Array,default:()=>[]}},setup(e){const E=a(),N=u(),B=e,q=j({}),A=j([]),O=j(null),R=j(!0),V=j(!1),W=j(!1),K=c(()=>{var e,a;const t=null==(a=null==(e=N.props.auth)?void 0:e.user)?void 0:a.role;return"teacher"===t||"admin"===t}),U=async()=>{try{R.value=!0;const e=await k.get(route("lesson-presentation.show",{id:B.presentationId}));q.value=e.data,A.value=(e.data.slides||[]).map(e=>({...e,section:e.section||"learn"}));const a=(await k.get(route("lesson-presentation.progress.student",{studentId:B.studentId}))).data.find(e=>e.lesson_presentation_id==B.presentationId);O.value=a}catch(e){console.error("Failed to load data:",e),E.notify({type:"negative",message:"Failed to load lesson data"})}finally{R.value=!1}},Y=async()=>{try{await k.put(route("lesson-presentation.progress.complete-learn",{id:O.value.id})),await U(),E.notify({type:"positive",message:"Learn section completed! Practice unlocked."})}catch(e){console.error("Failed to complete learn:",e)}},H=async()=>{await U(),E.notify({type:"positive",message:"Practice submitted! Waiting for teacher review."})};return v(()=>{U()}),(a,u)=>{const j=y("Head");return g(),f(T,null,[Q(j,{title:q.value.name?`Lesson: ${q.value.name}`:"Lesson View"},null,8,["title"]),R.value?(g(),f("div",M,[Q(t,{color:"primary",size:"3em"})])):(g(),b(z,{key:0,presentation:q.value,sections:e.sections,slides:A.value,progress:O.value,loading:R.value,onCompleteLearn:Y,onSubmitPractice:H},null,8,["presentation","sections","slides","progress","loading"])),K.value?(g(),f("div",D,[Q(i,{fab:"",icon:"emoji_events",color:"warning",onClick:u[0]||(u[0]=e=>{V.value=!0,W.value=!1})},{default:S(()=>[Q(s,null,{default:S(()=>u[4]||(u[4]=[_("Reward System")])),_:1})]),_:1})])):w("",!0),Q(p,{modelValue:V.value,"onUpdate:modelValue":u[3]||(u[3]=e=>V.value=e),maximized:!W.value,seamless:W.value,position:W.value?"bottom":"standard","transition-show":"slide-up","transition-hide":"slide-down"},{default:S(()=>[Q(o,{style:h(W.value?"width: 300px":"")},{default:S(()=>[Q(d,{class:"bg-primary text-white"},{default:S(()=>[Q(r,{name:"emoji_events"}),W.value?(g(),f("div",L,"Rewards")):(g(),f("div",F,"Reward System")),Q(m),W.value?(g(),b(i,{key:2,dense:"",flat:"","no-caps":"",label:"Maximize",icon:"open_in_full",onClick:u[1]||(u[1]=e=>W.value=!1)},{default:S(()=>[Q(s,null,{default:S(()=>u[5]||(u[5]=[_("Maximize")])),_:1})]),_:1})):(g(),b(i,{key:3,dense:"",flat:"",icon:"minimize",onClick:u[2]||(u[2]=e=>W.value=!0)},{default:S(()=>[Q(s,null,{default:S(()=>u[6]||(u[6]=[_("Minimize")])),_:1})]),_:1})),x((g(),b(i,{dense:"",flat:"",icon:"close"},{default:S(()=>[Q(s,null,{default:S(()=>u[7]||(u[7]=[_("Close")])),_:1})]),_:1})),[[n]])]),_:1}),x(Q(l,{class:"q-pa-none",style:{height:"calc(100vh - 32px)"}},{default:S(()=>[(g(),b(C,null,[Q(I,{isDialog:!0})],1024))]),_:1},512),[[P,!W.value]])]),_:1},8,["style"])]),_:1},8,["modelValue","maximized","seamless","position"])],64)}}},[["__scopeId","data-v-8d7bb35e"]]);export{E as default};
