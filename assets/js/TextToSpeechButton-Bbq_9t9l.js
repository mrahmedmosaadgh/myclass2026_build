import{r as e,u as t,t as a,b as o}from"./app-BxJhpxku.js";import{f as s,a as n,e as i,I as l,J as r,K as u,b as p,W as d,V as c}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const h=e({__name:"TextToSpeechButton",props:{text:{type:String,required:!0},size:{type:String,default:"sm"},flat:{type:Boolean,default:!0},round:{type:Boolean,default:!1},dense:{type:Boolean,default:!0},autoDetectLanguage:{type:Boolean,default:!0},voice:{type:String,default:null},rate:{type:Number,default:1,validator:e=>e>=.1&&e<=10},pitch:{type:Number,default:1,validator:e=>e>=0&&e<=2}},setup(e){const h=e,v=t(),f=s(!1),y=s(!1),g=s(null),m=n(()=>"speechSynthesis"in window&&h.text&&h.text.trim().length>0);n(()=>{if(!h.autoDetectLanguage)return!0;const e=h.text.toLowerCase(),t=["the","and","or","but","in","on","at","to","for","of","with","by","is","are","was","were","have","has","had","will","would","could","should"].some(t=>e.includes(` ${t} `)||e.startsWith(`${t} `)||e.endsWith(` ${t}`)),a=/^[a-zA-Z0-9\s.,!?;:'"()\-]+$/.test(e);return t&&a});const w=()=>{m.value?f.value?x():S():v.notify({type:"negative",message:"Text-to-speech is not supported in this browser",position:"top"})},S=()=>{if(h.text&&h.text.trim()){y.value=!0;try{window.speechSynthesis.cancel();const e=new SpeechSynthesisUtterance(h.text.trim());if(e.rate=h.rate,e.pitch=h.pitch,e.lang="en-US",h.voice){const t=window.speechSynthesis.getVoices().find(e=>e.name===h.voice);t&&(e.voice=t)}e.onstart=()=>{f.value=!0,y.value=!1},e.onend=()=>{f.value=!1,y.value=!1,g.value=null},e.onerror=e=>{console.error("Speech synthesis error:",e),f.value=!1,y.value=!1,g.value=null,v.notify({type:"negative",message:"Failed to read text aloud",position:"top"})},e.onpause=()=>{f.value=!1},e.onresume=()=>{f.value=!0},g.value=e,window.speechSynthesis.speak(e)}catch(e){console.error("Error starting speech:",e),y.value=!1,v.notify({type:"negative",message:"Failed to start text-to-speech",position:"top"})}}},x=()=>{try{window.speechSynthesis.cancel(),f.value=!1,y.value=!1,g.value=null}catch(e){console.error("Error stopping speech:",e)}};return i(()=>{x()}),"speechSynthesis"in window&&(window.speechSynthesis.onvoiceschanged=()=>{}),(t,s)=>(r(),l(o,{icon:f.value?"stop":"volume_up",color:f.value?"negative":"primary",size:e.size,flat:e.flat,round:e.round,dense:e.dense,disable:!m.value||y.value,loading:y.value,onClick:w,class:"text-to-speech-btn"},{default:u(()=>[p(a,{delay:500},{default:u(()=>[d(c(f.value?"Stop reading":"Read aloud"),1)]),_:1})]),_:1},8,["icon","color","size","flat","round","dense","disable","loading"]))}},[["__scopeId","data-v-3493cd99"]]);export{h as default};
