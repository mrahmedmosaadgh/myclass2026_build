const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/TopLeaderboard-FcuWGmxS.js","assets/js/app-BxJhpxku.js","assets/js/vendor-BWKGNkNB.js","assets/js/offline-BzIlwqNM.js","assets/js/i18n-B0T1C7j3.js","assets/js/ui-B7TfxbV_.js","assets/css/app-QAOnovzD.css","assets/js/QSelect-DvJQhHwY.js","assets/js/rtl-Cr6c3OOr.js","assets/js/html2canvas.esm-Cq3pa7K9.js","assets/css/TopLeaderboard-Dw9a8_8K.css","assets/js/BehaviorIncidents-CE5wm0Hx.js","assets/js/QBtnToggle-Dqui2Vw8.js","assets/js/QBadge-CVqhPkEU.js","assets/js/QToolbar-B7b0X7xh.js","assets/js/StudentCard-BPeF4Ft1.js","assets/js/AvatarManager-BBpcOWb-.js","assets/js/CameraCapture-Bws2meS3.js","assets/js/QFile-CLL4r4Tq.js","assets/js/use-file-CTRmpBK5.js","assets/js/QImg-6mrswKOg.js","assets/css/CameraCapture-BSPKVu_J.css","assets/css/AvatarManager-C1Pqt1hB.css","assets/css/BarcodeScanner-tn0RQdqM.css","assets/js/IncidentPrintReport-CPXKMq_0.js","assets/css/IncidentPrintReport-BcWCgfP6.css","assets/js/StudentGrouping-D86CoQuM.js","assets/js/vuedraggable.umd-DshT_Vng.js","assets/js/index-SlSKjXnq.js","assets/css/StudentGrouping-CRYXuU7Q.css"])))=>i.map(i=>d[i]);
import{r as e,u as a,f as t,Q as l,p as s,b as o,t as n,d as r,i,j as d,k as u,c,aR as v,s as m,l as p,e as g,o as f,g as b,h as y,_ as h,G as x,aS as w,m as _}from"./app-BxJhpxku.js";import{Q as S}from"./QBtnToggle-Dqui2Vw8.js";import{Q as k}from"./QBadge-CVqhPkEU.js";import{Q as $}from"./QTab-BW3Qt6f3.js";import{Q as I}from"./QTabs-4Kad7p-S.js";import{Q as C}from"./QTabPanel-BOH9ztYE.js";import{Q as j}from"./QTabPanels-D4uDKOIK.js";import{Q as E}from"./QSpace-BD6HDuXW.js";import{Q as V}from"./QSelect-DvJQhHwY.js";import{u as A}from"./i18n-B0T1C7j3.js";import{_ as T,f as z,o as U,k as P,M as D,a as N,af as F,N as L,J as R,b as q,R as B,I as O,O as M,K as Q,V as W,z as G,l as J,W as Y,F as H,Q as Z,S as K,y as X,U as ee,E as ae,ag as te,ah as le,aS as se,Y as oe}from"./vendor-BWKGNkNB.js";import ne from"./PointsDisplaySettings-C9pRzhIt.js";import re from"./TimerRandomTools-C53u9ZRt.js";import ie from"./ClassroomHelper-6wc9tdqa.js";import de from"./StudentCard-BPeF4Ft1.js";import ue from"./noise-Cwlpxl-Q.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-BQ81VRJa.js";import"./use-render-cache-CmTcazfP.js";import"./QCircularProgress-CEpiDj0u.js";import"./QTd-CdMOzIxb.js";import"./QTable-bfrPmXFn.js";import"./QMarkupTable-FlbqetwF.js";import"./QLinearProgress-C8hggxm2.js";import"./use-fullscreen-Dx2-rb4h.js";import"./AvatarManager-BBpcOWb-.js";import"./CameraCapture-Bws2meS3.js";import"./QFile-CLL4r4Tq.js";import"./use-file-CTRmpBK5.js";import"./QImg-6mrswKOg.js";const ce="/api",ve={behaviors:`${ce}/behaviors`,studentBehaviors:`${ce}/student-behaviors`,pointActions:`${ce}/student-behaviors-point-actions`,leaderboard:`${ce}/leaderboard`,studentSummary:e=>`${ce}/student-behaviors/${e}/summary`,pointActionStatistics:e=>`${ce}/student-behaviors/${e}/statistics`,attendance:`${ce}/student-attendance`,attendanceBatch:`${ce}/student-attendance/batch`},me="reward_sys_offline_queue";function pe(){try{const e=localStorage.getItem(me);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading offline queue:",e),[]}}function ge(e){const a=pe();e.id=e.id||Date.now()+Math.random().toString(36).substr(2,9),e.timestamp=e.timestamp||Date.now(),e.status="pending",a.push(e),localStorage.setItem(me,JSON.stringify(a)),console.log("üì¶ Action added to offline queue:",e)}async function fe({classroomId:e,startDate:a,endDate:t,limit:l=10}){var s,o;try{const s=await T.get(ve.leaderboard,{params:{classroom_id:e,start_date:a,end_date:t,limit:Math.min(l,50)}});return{success:!0,data:Array.isArray(s.data)?s.data:[]}}catch(n){return console.error("Error fetching leaderboard:",n),{success:!1,error:(null==(o=null==(s=n.response)?void 0:s.data)?void 0:o.message)||"Failed to fetch leaderboard",data:[],details:n}}}const be={addPoint:async function(e,a,t=null,l="",s={}){var o,n;try{const o={student_behaviors_id:e,value:parseInt(a),reason_id:t?parseInt(t):null,note:l||null};if(!navigator.onLine&&!s.isSync)throw new Error("Network Error");return{success:!0,data:(await T.post(ve.pointActions,o)).data,message:`Point ${a>0?"added":"deducted"} successfully`}}catch(r){return s.isSync||"Network Error"!==r.message&&navigator.onLine?(console.error("Error adding point:",r),{success:!1,error:(null==(n=null==(o=r.response)?void 0:o.data)?void 0:n.message)||"Failed to add point",details:r}):(ge({type:"addPoint",payload:{studentBehaviorsId:e,value:a,reasonId:t,note:l},desc:`Point ${a>0?"+":""}${a}`}),{success:!0,data:{id:"temp_"+Date.now(),value:parseInt(a),created_at:(new Date).toISOString(),offline:!0},message:"Saved offline. Will sync when online.",offline:!0})}},cancelPoint:async function(e,a){var t,l;try{return{success:!0,data:(await T.post(`${ve.pointActions}/${e}/cancel`,{cancel_reason:a})).data,message:"Point action canceled successfully"}}catch(s){return console.error("Error canceling point:",s),{success:!1,error:(null==(l=null==(t=s.response)?void 0:t.data)?void 0:l.message)||"Failed to cancel point",details:s}}},restorePoint:async function(e){var a,t;try{return{success:!0,data:(await T.post(`${ve.pointActions}/${e}/restore`)).data,message:"Point action restored successfully"}}catch(l){return console.error("Error restoring point:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to restore point",details:l}}},deletePoint:async function(e){var a,t;try{return{success:!0,data:(await T.delete(`${ve.pointActions}/${e}`)).data,message:"Point action deleted successfully"}}catch(l){return console.error("Error deleting point:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to delete point",details:l}}},createStudentBehavior:async function(e){var a,t;try{const a={school_id:e.schoolId,student_behaviors_mains_id:e.studentBehaviorsMainsId,student_id:e.studentId,attend:e.attend||null,points_plus:e.pointsPlus||0,points_minus:e.pointsMinus||0,points_details:e.pointsDetails||"",notes:e.notes||null};return{success:!0,data:(await T.post(ve.studentBehaviors,a)).data,message:"Student behavior record created successfully"}}catch(l){return console.error("Error creating student behavior:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to create behavior record",details:l}}},getStudentSummary:async function(e){var a,t;try{return{success:!0,data:(await T.get(ve.studentSummary(e))).data}}catch(l){return console.error("Error fetching student summary:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch student summary",details:l}}},getPointActions:async function(e){var a,t;try{return{success:!0,data:(await T.get(ve.pointActions,{params:{student_behaviors_id:e}})).data}}catch(l){return console.error("Error fetching point actions:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch point actions",details:l}}},getPointStatistics:async function(e){var a,t;try{return{success:!0,data:(await T.get(`${ve.pointActions}/statistics/${e}`)).data}}catch(l){return console.error("Error fetching point statistics:",l),{success:!1,error:(null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||"Failed to fetch statistics",details:l}}},fetchBehaviors:async function(){var e,a;try{const e=await T.get(ve.behaviors);return{success:!0,data:Array.isArray(e.data)?e.data:[]}}catch(t){return console.error("Error fetching behaviors:",t),{success:!1,error:(null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||"Failed to fetch behaviors",data:[],details:t}}},applyBehaviorToStudents:async function(e,a,t={}){var l,s,o,n,r;const i=t.isSync||!1;if(!navigator.onLine&&!i)return ge({type:"applyBehaviorToStudents",payload:{studentIds:e,behaviorId:a,options:t},desc:`Batch behavior apply to ${e.length} students`}),{success:!0,data:[],results:e.map(e=>({studentId:e,success:!0,offline:!0})),message:`Saved offline. ${e.length} updates pending.`,offline:!0};try{const n=[],r=[],u="object"==typeof a?a.id:a;if(console.log("üéØ applyBehaviorToStudents called with:",{studentCount:e.length,behaviorIdInput:a,actualBehaviorId:u,behaviorIdType:typeof a}),!u||isNaN(u))return console.error("‚ùå Invalid behavior ID:",a),{success:!1,error:"Invalid behavior ID provided"};for(const a of e){const e={student_id:a,behavior_id:u,date:t.date||(new Date).toISOString().split("T")[0],period_code:t.periodCode||null,points_mode:t.points_mode||"session",notes:t.notes||null};console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),console.log("üì§ Sending behavior application request"),console.log("   Student ID:",a),console.log("   Behavior ID:",u),console.log("   Payload:",JSON.stringify(e,null,2)),console.log("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê");try{const t=await T.post(`${ce}/student-behaviors/quick-create`,e);n.push({studentId:a,success:!0,data:t.data})}catch(d){"Network Error"!==d.message||i?(console.error("‚ùå FAILED - Error applying behavior to student:",a,d),r.push({studentId:a,success:!1,error:(null==(s=null==(l=d.response)?void 0:l.data)?void 0:s.message)||"Failed to apply behavior",fullError:null==(o=d.response)?void 0:o.data})):r.push({studentId:a,success:!1,error:"Network Error",fullError:d})}}return console.log("üéØ BATCH RESULT:",{totalRequests:e.length,successful:n.length,failed:r.length,successRate:`${Math.round(n.length/e.length*100)}%`}),{success:0===r.length,results:n,errors:r,message:`Applied to ${n.length}/${e.length} students`}}catch(u){return i||"Network Error"!==u.message&&navigator.onLine?(console.error("‚ùå OUTER ERROR - Exception in applyBehaviorToStudents:",u),{success:!1,error:(null==(r=null==(n=u.response)?void 0:n.data)?void 0:r.message)||"Failed to apply behavior",details:u}):(ge({type:"applyBehaviorToStudents",payload:{studentIds:e,behaviorId:a,options:t},desc:`Batch behavior apply to ${e.length} students`}),{success:!0,data:[],results:e.map(e=>({studentId:e,success:!0,offline:!0})),message:`Saved offline. ${e.length} updates pending.`,offline:!0})}},fetchLeaderboard:fe,getTopStudentsByPeriod:async function({classroomId:e,period:a="week",limit:t=5}){try{const l=new Date;let s;switch(a){case"week":default:s=new Date(l.getTime()-6048e5);break;case"month":s=new Date(l.getFullYear(),l.getMonth(),1);break;case"all":s=new Date("2020-01-01")}const o=e=>e.toISOString().split("T")[0];return fe({classroomId:e,startDate:o(s),endDate:o(l),limit:t})}catch(l){return console.error("Error getting top students:",l),{success:!1,error:"Failed to get top students",data:[],details:l}}},updateAttendance:async function(e,a,t={}){var l,s,o;try{const r={student_id:parseInt(e),attend:Boolean(a),date:t.date||(new Date).toISOString().split("T")[0],period_code:t.periodCode||null,classroom_id:t.classroomId||null};try{const e=await T.post(ve.attendance,r);return{success:!0,data:e.data,message:(null==(l=e.data)?void 0:l.message)||"Student marked as "+(a?"present":"absent")}}catch(n){return console.warn("Attendance API call failed, falling back to client-only update:",null==(s=null==n?void 0:n.response)?void 0:s.status),{success:!0,data:{studentId:parseInt(e),isPresent:Boolean(a),updatedAt:(new Date).toISOString()},message:`Student marked as ${a?"present":"absent"} (local)`,warning:(null==(o=n.response)?void 0:o.data)||n.message}}}catch(r){return console.error("Error updating attendance:",r),{success:!1,error:"Failed to update attendance",details:r}}},batchUpdateAttendance:async function(e,a={}){var t,l,s;try{if(!e||"object"!=typeof e)return{success:!1,error:"Invalid attendance data"};const n=Object.entries(e).map(([e,t])=>({student_id:parseInt(e),attend:Boolean(t),date:a.date||(new Date).toISOString().split("T")[0],period_code:a.periodCode||null,classroom_id:a.classroomId||null,updated_at:(new Date).toISOString()}));try{const e=await T.post(ve.attendanceBatch,{attendance:n});return{success:!0,data:e.data,message:(null==(t=e.data)?void 0:t.message)||`Updated attendance for ${n.length} students`}}catch(o){return console.warn("Batch attendance API call failed, falling back to local update:",null==(l=null==o?void 0:o.response)?void 0:l.status),{success:!0,data:n,message:`Updated attendance for ${n.length} students (local)`,warning:(null==(s=o.response)?void 0:s.data)||o.message}}}catch(n){return console.error("Error batch updating attendance:",n),{success:!1,error:"Failed to batch update attendance",details:n}}},getRecentActions:async function({classroomId:e,date:a,limit:t=10}){var l,s;try{const l=await T.get(`${ce}/student-behaviors/recent-actions`,{params:{classroom_id:e,date:a,limit:t}});return{success:!0,data:Array.isArray(l.data.data)?l.data.data:[]}}catch(o){return console.error("Error fetching recent actions:",o),{success:!1,error:(null==(s=null==(l=o.response)?void 0:l.data)?void 0:s.message)||"Failed to fetch recent actions",data:[]}}},undoAction:async function(e,a="Undone by teacher",t={}){var l,s;if("string"==typeof e&&e.startsWith("temp_"))return function(e){const a=pe().filter(a=>a.id!==e);localStorage.setItem(me,JSON.stringify(a))}(e.replace("temp_","")),{success:!0,message:"Offline action removed."};const o=t.isSync||!1;if(!navigator.onLine&&!o)return ge({type:"undoAction",payload:{actionId:e,reason:a},desc:`Undo action ${e}`}),{success:!0,message:"Undo saved offline.",offline:!0};try{const t=await T.post(`${ce}/student-behaviors/actions/${e}/cancel`,{cancel_reason:a});return{success:!0,data:t.data.data,message:t.data.message||"Action undone successfully"}}catch(n){return o||"Network Error"!==n.message&&navigator.onLine?(console.error("Error undoing action:",n),{success:!1,error:(null==(s=null==(l=n.response)?void 0:l.data)?void 0:s.message)||"Failed to undo action"}):(ge({type:"undoAction",payload:{actionId:e,reason:a},desc:`Undo action ${e}`}),{success:!0,message:"Undo saved offline.",offline:!0})}},formatPointValue:function(e){return e>0?`+${e} ‚≠ê`:e<0?`${e} ‚ö†Ô∏è`:"0"},getActionTypeLabel:function(e){return{plus:"Added",minus:"Deducted",cancel:"Canceled",revoke:"Revoked"}[e]||e},calculateTotalPoints:function(e,a=!1){return Array.isArray(e)?e.filter(e=>a||!e.canceled).reduce((e,a)=>e+(a.value||0),0):0},separatePoints:function(e){if(!Array.isArray(e))return{positive:0,negative:0};const a=e.filter(e=>!e.canceled);return{positive:a.filter(e=>e.value>0).reduce((e,a)=>e+a.value,0),negative:Math.abs(a.filter(e=>e.value<0).reduce((e,a)=>e+a.value,0))}},isActionEditable:function(e,a=24){try{const t=new Date(e);return(new Date-t)/36e5<a}catch(t){return!1}},getUserFriendlyErrorMessage:function(e){var a,t,l,s,o,n,r;return 401===(null==(a=e.response)?void 0:a.status)?"You are not authenticated. Please log in.":403===(null==(t=e.response)?void 0:t.status)?"You do not have permission to perform this action.":404===(null==(l=e.response)?void 0:l.status)?"The requested resource was not found.":422===(null==(s=e.response)?void 0:s.status)?"Invalid data provided. Please check your input.":500===(null==(o=e.response)?void 0:o.status)?"Server error. Please try again later.":"Network Error"===e.message?"Network error. Please check your connection.":(null==(r=null==(n=e.response)?void 0:n.data)?void 0:r.message)||"An unexpected error occurred."},retryWithBackoff:async function(e,a=3,t=1e3){let l;for(let o=0;o<a;o++)try{return await e()}catch(s){if(l=s,o<a-1){const e=t*Math.pow(2,o);await new Promise(a=>setTimeout(a,e))}}throw l}},ye=new Map;async function he(e){const a=Object.entries(e).map(([e,a])=>ye.has(e)?Promise.resolve():new Promise(t=>{const l=new Audio(a);l.addEventListener("canplaythrough",()=>{ye.set(e,l),t()},{once:!0}),l.addEventListener("error",()=>{console.warn(`Failed to preload sound "${e}"`),t()},{once:!0}),l.load()}));await Promise.all(a)}const xe={class:"bg-gradient-to-br from-gray-800 to-gray-900 h-full"},we={class:"text-3xl font-bold"},_e={class:"text-blue-100"},Se={class:"flex items-center justify-between bg-white p-4 rounded-lg border border-gray-200 shadow-sm"},ke={class:"flex items-center gap-4"},$e={class:"bg-blue-100 p-3 rounded-full text-blue-600"},Ie={class:"text-sm text-gray-500 font-medium"},Ce={class:"text-lg font-bold text-gray-800 flex items-center gap-2"},je={key:0},Ee={key:1,class:"text-gray-400 italic"},Ve={class:"text-blue-600 font-mono bg-blue-50 px-2 py-0.5 rounded text-base"},Ae={class:"text-xs text-gray-500 mt-1"},Te={key:0,class:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 rounded-lg border border-blue-200 shadow-sm"},ze={class:"flex items-center justify-between flex-wrap gap-3"},Ue={class:"flex items-center gap-2"},Pe={class:"text-sm font-bold text-gray-700"},De={class:"flex items-center gap-3 flex-wrap"},Ne={key:0,class:"text-xs text-gray-500 bg-white px-2 py-1 rounded border border-dashed border-gray-300"},Fe={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-blue-200"},Le={class:"flex flex-col"},Re={class:"text-xs text-gray-500"},qe={class:"text-lg font-bold text-blue-600"},Be={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-green-200"},Oe={class:"flex flex-col"},Me={class:"text-xs text-gray-500"},Qe={class:"text-lg font-bold text-green-600"},We={class:"flex items-center gap-2 bg-white px-3 py-1.5 rounded-lg border border-red-200"},Ge={class:"flex flex-col"},Je={class:"text-xs text-gray-500"},Ye={class:"text-lg font-bold text-red-600"},He={key:0,class:"mt-3 pt-3 border-t border-blue-200"},Ze={class:"text-xs font-semibold text-gray-600 mb-2 flex items-center gap-1"},Ke={class:"bg-white border border-red-200 rounded-lg p-2"},Xe={class:"flex flex-wrap gap-1.5"},ea={class:"sticky top-0 z-50 bg-white shadow-md border-b border-gray-200"},aa={class:"q-pa-sm flex justify-between items-center flex-nowrap gap-2"},ta={class:"flex items-center gap-2 flex-nowrap overflow-hidden"},la={class:"row no-wrap q-pa-md"},sa={key:0},oa={key:1,class:"column items-center",style:{"min-width":"180px"}},na={class:"column q-gutter-y-sm full-width"},ra={class:"q-py-sm"},ia={key:0,class:"flex items-center gap-1 overflow-hidden"},da={class:"flex items-center ml-4 transition-all duration-300"},ua={key:0,class:"flex items-center text-gray-400 text-xs italic"},ca={key:1,class:"flex items-center gap-3 bg-gray-100 px-3 py-1 rounded-full border border-gray-200 shadow-sm animate-fade-in overflow-hidden"},va=["src"],ma={class:"flex flex-col leading-none overflow-hidden"},pa={class:"text-sm font-bold text-gray-900 truncate max-w-[150px]"},ga={key:0,class:"text-xs text-blue-800 font-arabic font-bold mt-0.5 truncate max-w-[150px]"},fa={class:"flex items-center gap-2"},ba={style:{width:"420px","max-width":"90vw"}},ya={key:0,class:"bg-blue-50 p-2 border-b border-blue-100"},ha={class:"text-xs font-bold text-blue-900 mb-1 flex justify-between items-center"},xa={class:"flex flex-wrap gap-1 max-h-[60px] overflow-y-auto custom-scrollbar"},wa=["src"],_a={class:"max-w-[80px] ellipsis"},Sa={class:"row q-col-gutter-sm"},ka=["onClick"],$a={class:"column items-center justify-center q-pa-xs bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md hover:border-blue-300 transition-all text-center h-full relative-position group hover:bg-blue-50",style:{"min-height":"80px"}},Ia={class:"text-[9px] font-bold text-gray-700 leading-tight flex items-center justify-center px-1 text-center h-[2.5em] overflow-hidden"},Ca={class:"mt-1"},ja={class:"bg-green-50 text-green-700 text-[9px] font-bold px-1.5 py-0.5 rounded border border-green-100"},Ea={class:"row q-col-gutter-sm"},Va=["onClick"],Aa={class:"column items-center q-pa-sm bg-red-50 rounded-xl border border-red-100 shadow-sm hover:shadow-md hover:bg-red-100 transition-all text-center h-full relative-position"},Ta={class:"text-caption text-weight-bold text-grey-9 ellipsis-2-lines leading-tight min-h-[2.5em] flex items-center justify-center"},za={class:"absolute-top-right q-ma-xs"},Ua={key:0,class:"bg-orange-50 p-1 text-center border-b border-orange-100 text-xs text-orange-800 font-bold"},Pa={class:"space-y-4"},Da={class:"flex justify-between items-center mb-4"},Na={class:"text-xl font-bold"},Fa={class:"flex gap-2"},La={class:"flex flex-wrap justify-center gap-6 p-4 bg-gray-400"},Ra={class:""},qa={class:"mt-6"},Ba={class:"row items-center q-gutter-x-sm"},Oa={class:"font-bold"},Ma={class:"font-bold"},Qa={class:"text-h6"},Wa={key:0,class:"text-gray-500 italic text-center py-4"},Ga=["src"],Ja={key:1,class:"mb-4 overflow-x-auto whitespace-nowrap p-2 bg-white rounded-lg shadow-sm border border-gray-100 flex gap-2 custom-scrollbar items-center"},Ya={key:0,class:"mb-3 p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200"},Ha={class:"flex items-center justify-between"},Za={class:"font-bold text-indigo-900 flex items-center gap-2"},Ka={class:"flex gap-2"},Xa={class:"flex flex-wrap justify-center gap-6"},et={class:"space-y-4"},at={class:"mb-4"},tt={class:"text-xl font-bold mb-2"},lt={class:"text-sm text-gray-600"},st={class:"p-4 bg-red-50 rounded-lg border border-red-200"},ot={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},nt={class:"mt-2 text-sm"},rt={class:"flex flex-wrap justify-center gap-6 p-4"},it={class:"space-y-4"},dt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ut=["onClick"],ct={class:"flex items-start justify-between mb-3"},vt={class:"flex-1"},mt={class:"font-semibold text-lg"},pt={class:"text-xs text-gray-600"},gt={key:0,class:"text-xs text-red-600 mt-1"},ft={class:"space-y-2"},bt={class:"p-2 bg-green-100 rounded flex justify-between items-center"},yt={class:"text-sm font-bold text-green-900"},ht={class:"p-2 bg-red-100 rounded flex justify-between items-center"},xt={class:"text-sm font-bold text-red-900"},wt={class:"p-2 bg-blue-100 rounded flex justify-between items-center"},_t={class:"text-lg font-bold text-blue-600"},St={class:"space-y-4"},kt={class:"flex justify-between items-center mb-4"},$t={class:"text-xl font-bold"},It={key:0,class:"text-center py-8"},Ct={class:"text-gray-500 text-lg"},jt={class:"flex items-start justify-between"},Et={class:"flex-1"},Vt={class:"flex items-center gap-2 mb-1"},At={class:"font-bold text-lg"},Tt={class:"text-2xl"},zt={class:"text-sm text-gray-700"},Ut={class:"text-xs text-gray-500 mt-1"},Pt={key:0,class:"text-xs text-gray-600 mt-1 italic"},Dt={key:1,class:"text-xs text-red-600 mt-1"},Nt={class:"flex flex-col h-full gap-4"},Ft={class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},Lt={class:"space-y-6"},Rt={class:"flex justify-between items-center mb-6"},qt={class:"text-2xl font-bold text-gray-800"},Bt={class:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200"},Ot={class:"flex items-center gap-3 mb-4"},Mt={class:"text-xl font-bold text-green-800"},Qt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Wt={class:"flex items-start justify-between mb-2"},Gt={class:"flex items-center gap-2"},Jt={class:"text-3xl"},Yt={class:"font-bold text-gray-800"},Ht={class:"text-xs text-gray-500"},Zt={class:"flex gap-1"},Kt={class:"flex items-center justify-between mt-3 pt-3 border-t border-green-100"},Xt={class:"text-lg font-bold text-green-600"},el={key:0,class:"text-center py-8 text-gray-400"},al={class:"bg-gradient-to-r from-red-50 to-rose-50 rounded-xl p-6 border border-red-200"},tl={class:"flex items-center gap-3 mb-4"},ll={class:"text-xl font-bold text-red-800"},sl={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},ol={class:"flex items-start justify-between mb-2"},nl={class:"flex items-center gap-2"},rl={class:"text-3xl"},il={class:"font-bold text-gray-800"},dl={class:"text-xs text-gray-500"},ul={class:"flex gap-1"},cl={class:"flex items-center justify-between mt-3 pt-3 border-t border-red-100"},vl={class:"text-lg font-bold text-red-600"},ml={key:0,class:"text-center py-8 text-gray-400"},pl={class:"text-2xl font-semibold text-gray-600"},gl={class:"font-bold text-blue-900 flex items-center gap-2 text-base md:text-lg"},fl={class:"md:hidden"},bl={class:"flex-1 overflow-y-auto p-3 custom-scrollbar"},yl={key:0,class:"text-center py-4 text-gray-400 italic text-sm"},hl={key:1,class:"flex flex-col gap-2"},xl={class:"flex flex-col leading-tight overflow-hidden w-full"},wl={class:"font-bold text-sm md:text-base truncate"},_l={class:"p-2 border-t border-blue-200 bg-white"},Sl={class:"grid grid-cols-3 gap-2"},kl={class:"flex-1 flex flex-col bg-white order-1 md:order-2 h-full overflow-hidden"},$l={key:0,class:"bg-white border-b border-gray-100 p-3 flex justify-center items-center"},Il={class:"flex items-center gap-2"},Cl={class:"text-lg font-bold text-gray-800"},jl={class:"text-base md:text-xl flex items-center gap-2"},El={class:"hidden xs:inline"},Vl={class:"bg-white/60 p-1 rounded-full flex gap-1 shadow-sm border border-white/60 backdrop-blur-sm"},Al={class:"flex flex-wrap gap-2 justify-center md:gap-3 pb-20 md:pb-0"},Tl=["onClick"],zl={class:"font-bold text-sm md:text-base leading-tight text-gray-800 line-clamp-2 md:line-clamp-3 w-full"},Ul={class:"flex justify-between items-center"},Pl={class:"text-h6"},Dl=["src"],Nl={class:"text-h5 font-bold mb-1"},Fl={class:"text-h3 font-black my-2 flex items-center gap-2 animate-bounce"},Ll={class:"text-4xl"},Rl={class:"text-subtitle1 opacity-90 font-medium bg-white/20 px-4 py-1 rounded-full"},ql=e({__name:"reward_sys",props:{isDialog:{type:Boolean,default:!1},classroomId:{type:Number,default:null},subjectId:{type:Number,default:null},period:{type:Number,default:null},date:{type:String,default:null},week:{type:Number,default:null},initialTab:{type:String,default:"positive"}},setup(e){const ce=e,ve=se(()=>h(()=>import("./TopLeaderboard-FcuWGmxS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),me=se(()=>h(()=>import("./BehaviorIncidents-CE5wm0Hx.js"),__vite__mapDeps([11,1,2,3,4,5,6,12,13,14,7,8,15,16,17,18,19,20,21,22,23,24,25]))),pe=se(()=>h(()=>import("./StudentGrouping-D86CoQuM.js"),__vite__mapDeps([26,1,2,3,4,5,6,27,28,29]))),ge={select:"/audio/click-234708.mp3",reward:"/audio/purchase-success-384963.mp3",penalty:"/audio/error-010-206498.mp3"},fe=z(null),ql=z(!1);U(()=>{!function(e){"requestIdleCallback"in window?requestIdleCallback(()=>he(e),{timeout:2e3}):setTimeout(()=>he(e),1e3)}(ge);const e=localStorage.getItem("reward-system-bg-music");ql.value="true"===e,fe.value&&(fe.value.volume=.1,ql.value&&fe.value.play().catch(e=>console.log("Autoplay prevented:",e)))}),P(ql,e=>{localStorage.setItem("reward-system-bg-music",e),fe.value&&(e?fe.value.play().catch(e=>console.log("Playback error:",e)):fe.value.pause())});const Bl=e=>{!async function(e,a){if(!a[e])return void console.warn(`Sound key "${e}" not found in soundFiles`);if(!ye.has(e)){const t=new Audio(a[e]);await new Promise((e,a)=>{t.addEventListener("canplaythrough",e,{once:!0}),t.addEventListener("error",a,{once:!0}),t.load()}).catch(a=>{console.warn(`Failed to load sound "${e}":`,a)}),ye.set(e,t)}const t=ye.get(e);t&&(t.currentTime=0,t.play().catch(e=>console.log("Sound play error:",e)))}(e,ge)},{t:Ol,locale:Ml}=A(),Ql=e=>e?"ar"===Ml.value&&e.name_ar?e.name_ar:e.name:"",Wl=D(),Gl=N(()=>{var e,a;const t=null==(a=null==(e=Wl.props.auth)?void 0:e.user)?void 0:a.school;return Array.isArray(t)&&t.length>0?t[0].logo_url:null}),Jl=N(()=>{const e=new Map;return as.value.forEach(a=>{a.subject_id&&!e.has(a.subject_id)&&e.set(a.subject_id,{id:a.subject_id,name:a.subject_name,name_ar:a.subject_name_ar})}),Array.from(e.values())});N(()=>os.value?as.value.filter(e=>e.subject_id===os.value):[]);const Yl=N(()=>{const e=ts.value.length;if(0===e)return{present:0,absent:0,absentList:[]};const a=ts.value.filter(e=>gs.value[e.id]).length;return{present:a,absent:e-a,absentList:ts.value.filter(e=>!gs.value[e.id])}}),Hl=()=>{const e=Yl.value.absentList.map(e=>"ar"===Ml.value&&e.name_ar?e.name_ar:e.name).join("\n");e&&navigator.clipboard.writeText(e).then(()=>{Zl.notify({message:Ol("rewardSys.session.copied"),color:"positive",icon:"content_copy",position:"top"})}).catch(e=>{console.error("Failed to copy: ",e)})};z("https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf");const Zl=a(),Kl=z(ce.initialTab||"positive"),Xl=z("positive");P(()=>ce.initialTab,e=>{e&&(Kl.value=e)});const es=z("behavior_incidents");P(Kl,(e,a)=>{localStorage.setItem("reward-system-active-tab",e),e!==a&&(ms.value=[])});const as=z([]),ts=z([]),ls=z([]),ss=z(null),os=z(null),ns=z((new Date).toISOString().split("T")[0]),rs=z(1),is=z(1),ds=z(1),us=z(1),cs=z(null),vs=z(null),ms=z([]),ps=z({}),gs=z({}),fs=z({}),bs=z([]);z([]);const ys=z(!1),hs=z(!1),xs=z(!1),ws=z(!1),_s=z(!1),Ss=z(null),ks=z(null),$s=z({message:"",created:0,skipped:0}),Is=z(!1),Cs=z(!1),js=z(!1),Es=z("positive"),Vs=z(null),As=z("no_groups"),Ts=z([]),zs=z(!1),Us=z(null),Ps=z(!1),Ds=z(localStorage.getItem("points-display-mode")||"overall"),Ns=z({}),Fs=z(localStorage.getItem("competition-start-time")||null),Ls=z(localStorage.getItem("custom-date-from")||null),Rs=z(localStorage.getItem("custom-date-to")||null),qs=z(localStorage.getItem("leaderboard-mode")||"top5"),Bs=z("individual"),Os=z("false"!==localStorage.getItem("reward-system-read-aloud"));P(Os,e=>{localStorage.setItem("reward-system-read-aloud",e)});const Ms=z(!1),Qs=z(null),Ws=z(!1),Gs=z({name:"",type:"positive",points:0,icon:""}),Js=z(!1),Ys=z({student:null,behavior:null,points:0}),Hs=z(!1),Zs=z(null),Ks=z(null);function Xs(e){"attendance"!==Kl.value?"selection"!==Bs.value?(ms.value=[e],function(e){if(0===ms.value.length)return void Zl.notify({message:"Please select students first",color:"warning",position:"top"});Es.value=e,Vs.value=null,js.value=!0}("positive")):Eo(e):Fo(e)}P(os,e=>{null!==e&&(localStorage.setItem("reward-system-selected-subject-id",e.toString()),console.log(`üíæ Saved subject to localStorage: ${e}`))}),P(ss,e=>{null!==e&&(localStorage.setItem("reward-system-selected-classroom-id",e.toString()),console.log(`üíæ Saved classroom to localStorage: ${e}`))}),P(rs,e=>{null!==e&&(localStorage.setItem("reward-system-selected-semester",e.toString()),console.log(`üíæ Saved semester to localStorage: ${e}`))}),P(is,e=>{null!==e&&(localStorage.setItem("reward-system-selected-week",e.toString()),console.log(`üíæ Saved week to localStorage: ${e}`))}),P(ds,e=>{null!==e&&(localStorage.setItem("reward-system-selected-day",e.toString()),console.log(`üíæ Saved day to localStorage: ${e}`))}),P(us,e=>{null!==e&&(localStorage.setItem("reward-system-selected-period-number",e.toString()),console.log(`üíæ Saved period number to localStorage: ${e}`))}),P(ns,e=>{if(e){const a=new Date(e);ds.value=a.getDay()+1,console.log(`üìÖ Date changed to ${e}, Day updated to ${ds.value}`)}});const eo=N(()=>`${rs.value}.${is.value}.${ds.value}.${us.value}`);N(()=>{const e=as.value.find(e=>e.classroom_id===ss.value);return e?e.classroom_name:Ol("rewardSys.session.unknownClass")}),N(()=>{const e=Jl.value.find(e=>e.subject_id===os.value);return e?"ar"===Ml.value&&e.subject_name_ar?e.subject_name_ar:e.subject_name:""});const ao=N(()=>ts.value.filter(e=>gs.value[e.id]).length),to=N(()=>ts.value.filter(e=>!gs.value[e.id]).length),lo=z(!1),so=z("present"),oo=N(()=>"selected"===so.value?ts.value.filter(e=>ms.value.includes(e.id)):ts.value.filter(e=>"present"===so.value?gs.value[e.id]:!gs.value[e.id]));function no(e){so.value=e,lo.value=!0}function ro(){const e=oo.value.map(e=>e.name).join("\n");navigator.clipboard.writeText(e).then(()=>{})}function io(e){if(!e||!e.avatar)return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>");const a=e.avatar;return a.startsWith("http")||a.startsWith("data:")||a.startsWith("/")?a:`/${a}`}const uo=z(JSON.parse(localStorage.getItem("behaviorUsage")||"{}"));N(()=>Object.keys(uo.value).sort((e,a)=>{const t=uo.value[e],l=uo.value[a];return t.count!==l.count?l.count-t.count:l.lastUsed-t.lastUsed}).map(e=>ls.value.find(a=>a.id==e)).filter(e=>e&&("positive"===e.type||"reward"===e.type||(e.value||e.points||0)>0)).slice(0,5));const co=N(()=>{console.log("üîç All behaviors:",ls.value);const e=ls.value.filter(e=>{if(e.type)return"positive"===e.type||"reward"===e.type;return(e.value||e.points||0)>0});return console.log("‚úÖ Positive behaviors:",e),e}),vo=N(()=>{const e=ls.value.filter(e=>{if(e.type)return"negative"===e.type||"penalty"===e.type;return(e.value||e.points||0)<0});return console.log("‚ö†Ô∏è Negative behaviors:",e),e}),mo=N(()=>[{label:"No Groups",value:"no_groups",icon:"grid_view"},{label:"Name (A‚ÜíZ)",value:"name_asc",icon:"sort_by_alpha"},{label:"Name (Z‚ÜíA)",value:"name_desc",icon:"sort_by_alpha"},...Ts.value.map(e=>({label:e.name,value:e.id,icon:"groups"}))]);N(()=>{const e=mo.value.find(e=>e.value===As.value);return(null==e?void 0:e.icon)||"grid_view"});const po=z(null),go=N(()=>{const e=new Set;return ts.value.forEach(a=>{let t=a.firstName||a.name||"";t.length>=2&&e.add(t.substring(0,2).toUpperCase())}),Array.from(e).sort()});const fo=N(()=>{let e=ts.value;if(po.value&&(e="__SELECTED__"===po.value?ts.value.filter(e=>ms.value.includes(e.id)):"__UNSELECTED__"===po.value?ts.value.filter(e=>!ms.value.includes(e.id)):ts.value.filter(e=>(e.firstName||e.name||"").toUpperCase().startsWith(po.value))),"no_groups"===As.value)return[{name:null,students:e}];if("name_asc"===As.value){return[{name:null,students:[...e].sort((e,a)=>(e.firstName||"").localeCompare(a.firstName||""))}]}if("name_desc"===As.value){return[{name:null,students:[...e].sort((e,a)=>(a.firstName||"").localeCompare(e.firstName||""))}]}const a=Ts.value.find(e=>e.id===As.value);if(!a)return[{name:null,students:e}];const t=a.groups.map(a=>({name:a.name,students:e.filter(e=>a.student_ids.includes(e.id))})).filter(e=>e.students.length>0),l=new Set(a.groups.flatMap(e=>e.student_ids)),s=e.filter(e=>!l.has(e.id));return s.length>0&&t.push({name:"Unassigned",students:s}),t});function bo(){const e=ts.value.filter(e=>gs.value[e.id]);ms.value=e.map(e=>e.id)}function yo(){const e=ts.value.filter(e=>gs.value[e.id]),a=new Set(ms.value),t=[];e.forEach(e=>{a.has(e.id)||t.push(e.id)}),ms.value=t}async function ho(){if(!Vs.value)return;const e=ls.value.find(e=>e.id===Vs.value),a="individual"===Bs.value&&1===ms.value.length,t=a?ts.value.find(e=>e.id===ms.value[0]):null;if("positive"===Es.value?(cs.value=Vs.value,await async function(){await Po(cs.value),cs.value=null}()):(vs.value=Vs.value,await Uo()),a&&t&&e){Ys.value={student:t,behavior:e,points:e.value||e.points||0};const a=e.value||e.points||0,l=`${a} points`;setTimeout(()=>{!function(e){if(!window.speechSynthesis||!Os.value)return;window.speechSynthesis.cancel();const a=new SpeechSynthesisUtterance(e);a.rate=1,a.pitch=1,a.volume=1,window.speechSynthesis.speak(a)}(`${function(e){const a="ar"===Ml.value&&e.name_ar?e.name_ar:e.name;if(!a)return"Student";if("ar"!==Ml.value&&e.firstName)return`${e.firstName} ${e.secondName||""}`.trim();const t=a.trim().split(/\s+/).filter(e=>e.length>0);if(t.length>0)return`${t[0]} ${t.length>1?t[1]:""}`.trim();return a}(t)}. ${l}.`)},300),Js.value=!0,setTimeout(()=>{Js.value=!1},2500)}js.value=!1,Vs.value=null}const xo=z(null);let wo=null;function _o(e){wo&&clearTimeout(wo),xo.value=e}function So(){wo&&clearTimeout(wo),wo=setTimeout(()=>{xo.value=null},3e3)}async function ko(e){var a,t;const l=Ts.value.findIndex(a=>a.id===e.id);l>=0?Ts.value[l]=e:Ts.value.push(e);try{const a=await T.post("/api/classroom-layouts/save",{classroom_id:ss.value,layouts:Ts.value});if(!a.data.success)throw new Error(a.data.message||"Failed to save layout");Zl.notify({message:`Layout "${e.name}" saved successfully!`,color:"positive",position:"top",icon:"check_circle"}),As.value=e.id,zs.value=!1,Us.value=null}catch(s){if(console.error("Error saving layout:",s),Zl.notify({message:"Failed to save layout: "+((null==(t=null==(a=s.response)?void 0:a.data)?void 0:t.message)||s.message),color:"negative",position:"top",icon:"error"}),l>=0)Ts.value.splice(l,1);else{const a=Ts.value.findIndex(a=>a.id===e.id);a>=0&&Ts.value.splice(a,1)}}}async function $o(e){var a,t;const l=Ts.value.findIndex(a=>a.id===e);if(l<0)return;const s=Ts.value[l];Ts.value.splice(l,1),As.value===e&&(As.value="no_groups");try{const e=await T.post("/api/classroom-layouts/save",{classroom_id:ss.value,layouts:Ts.value});if(!e.data.success)throw new Error(e.data.message||"Failed to delete layout");Zl.notify({message:`Layout "${s.name}" deleted successfully!`,color:"positive",position:"top",icon:"delete"})}catch(o){console.error("Error deleting layout:",o),Zl.notify({message:"Failed to delete layout: "+((null==(t=null==(a=o.response)?void 0:a.data)?void 0:t.message)||o.message),color:"negative",position:"top",icon:"error"}),Ts.value.splice(l,0,s),"no_groups"===As.value&&(As.value=e)}}function Io(e){e?(Qs.value=e,Gs.value={name:e.name,type:e.type||(e.value>0?"positive":"negative"),points:e.value||e.points||0,icon:e.icon||""}):(Qs.value=null,Gs.value={name:"",type:"positive",points:0,icon:""}),Ms.value=!0}async function Co(){var e,a;if(Gs.value.name&&Gs.value.type&&null!==Gs.value.points){Ws.value=!0;try{const e={name:Gs.value.name,name_ar:Gs.value.name_ar||null,type:Gs.value.type,value:Gs.value.points,points:Gs.value.points,icon:Gs.value.icon||null,school_id:1,year_id:2};if(Qs.value){const a=await T.put(`/api/behaviors/${Qs.value.id}`,e),t=ls.value.findIndex(e=>e.id===Qs.value.id);t>=0&&(ls.value[t]=a.data),Zl.notify({message:"Behavior updated successfully!",color:"positive",icon:"check_circle"})}else{const a=await T.post("/api/behaviors",e);ls.value.push(a.data),Zl.notify({message:"Behavior created successfully!",color:"positive",icon:"check_circle"})}Ms.value=!1,Qs.value=null}catch(t){console.error("Error saving behavior:",t),Zl.notify({message:"Failed to save behavior: "+((null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||t.message),color:"negative",icon:"error"})}finally{Ws.value=!1}}else Zl.notify({message:"Please fill in all required fields",color:"warning",position:"top"})}function jo(e){Zl.dialog({title:"Confirm Delete",message:`Are you sure you want to delete "${e.name}"? This action cannot be undone.`,cancel:!0,persistent:!0,color:"negative"}).onOk(()=>{!async function(e){var a,t;try{await T.delete(`/api/behaviors/${e.id}`);const a=ls.value.findIndex(a=>a.id===e.id);a>=0&&ls.value.splice(a,1),Zl.notify({message:"Behavior deleted successfully!",color:"positive",icon:"check_circle"})}catch(l){console.error("Error deleting behavior:",l),Zl.notify({message:"Failed to delete behavior: "+((null==(t=null==(a=l.response)?void 0:a.data)?void 0:t.message)||l.message),color:"negative",icon:"error"})}}(e)})}function Eo(e){if(!gs.value[e])return void Zl.notify({message:"Cannot select absent students",color:"warning",position:"top",timeout:1e3});const a=ms.value.indexOf(e);-1===a?(ms.value.push(e),Bl("select")):ms.value.splice(a,1)}function Vo(e,a){if(a){const a=e.filter(e=>gs.value[e.id]).map(e=>e.id),t=new Set(ms.value);a.forEach(e=>t.add(e)),ms.value=Array.from(t),Bl("select")}else{const a=new Set(e.map(e=>e.id));ms.value=ms.value.filter(e=>!a.has(e))}}function Ao(){ms.value=[]}async function To(e){if(!e)return ts.value=[],ms.value=[],void(Ts.value=[]);try{hs.value=!0,ts.value=[],ms.value=[],ks.value=null,$s.value={message:"",created:0,skipped:0},await async function(){if(ss.value)try{const e=await T.get("/api/classroom-layouts/load",{params:{classroom_id:ss.value}});e.data.success&&(Ts.value=e.data.data||[])}catch(e){console.error("Error loading layouts:",e)}}()}catch(a){console.error("Failed to load classroom:",a),Zl.notify({message:"Failed to load classroom: "+a.message,color:"negative",position:"top"})}finally{hs.value=!1}}async function zo(){if(ss.value){hs.value=!0,$s.value={message:"Initializing...",created:0,skipped:0};try{const e={classroom_id:ss.value,date:ns.value,period_code:eo.value,points_mode:"from_now"===Ds.value?"overall":Ds.value},a=await T.post("/api/student-behaviors/init-classroom",e);if(a&&a.data){const e=a.data;ks.value=e.student_behaviors_mains_id,$s.value={message:`Session initialized (created ${e.created}, skipped ${e.skipped}, mode: ${e.points_mode})`,created:e.created,skipped:e.skipped};const t=e.student_behaviors||[],l=t.map(e=>e.student?{id:e.student.id,name:e.student.name||`Student ${e.student_id}`,name_ar:e.student.name_ar,firstName:e.student.first_name,secondName:e.student.second_name,lastName:e.student.last_name,avatar:e.student.avatar,behaviorRecordId:e.id}:null).filter(e=>null!==e);ts.value=l,ms.value=[];const s={};for(const a of t)gs.value[a.student_id]=void 0===a.attend||a.attend,s[a.student_id]={attend:void 0===a.attend||a.attend,points_plus:a.points_plus||0,points_minus:a.points_minus||0,academic_tracker:a.academic_tracker||{},behavior_tracker:a.behavior_tracker||[],logistics_tracker:a.logistics_tracker||{}};ps.value=s,Zl.notify({message:"Session initialized",color:"positive",position:"top"}),await Bo()}}catch(e){console.error("Failed to init classroom session:",e),$s.value={message:"Initialization failed",created:0,skipped:0},Zl.notify({message:"Failed to init session: "+(e.message||"error"),color:"negative",position:"top"})}finally{hs.value=!1}}}async function Uo(){await Po(vs.value),vs.value=null}async function Po(e){var a;if(ms.value.length&&e)try{xs.value=!0;const t=await be.applyBehaviorToStudents(ms.value,e,{date:ns.value,periodCode:eo.value,classroomId:ss.value,points_mode:"from_now"===Ds.value?"overall":Ds.value});if(t.results&&t.results.length>0){t.results.forEach(e=>{if(e.success&&e.data){const a=e.studentId,t=e.data;ps.value[a]||(ps.value[a]={points_plus:0,points_minus:0,attend:!0}),ps.value[a]&&(ps.value[a].points_plus=t.points_plus,ps.value[a].points_minus=t.points_minus,void 0!==t.attend&&(ps.value[a].attend=t.attend,gs.value[a]=t.attend))}});const a=ls.value.find(a=>a.id===e);if(a){const e=a.value||a.points||0;e>0&&Bl("reward"),e<0&&Bl("penalty")}"individual"===Bs.value&&1===t.results.length||Zl.notify({message:`Applied behavior to ${t.results.length} students`+(t.errors&&t.errors.length?` (${t.errors.length} failed)`:""),color:t.errors&&t.errors.length?"warning":"positive",position:"top"}),await Bo(),ms.value=[]}if(t.errors&&t.errors.length>0)console.error("Partial or full failure:",t.errors),0===t.results.length&&Zl.notify({message:t.error||"Failed to apply behavior to selected students",color:"negative",position:"top"});else{const e=t.results.length;if(e>0&&bs.value.length>0){const l=bs.value.slice(0,e).map(e=>({actionId:e.id,studentId:e.student_id,offline:!1})),s=t.results.filter(e=>e.offline).map(e=>{var a;return{actionId:(null==(a=e.data)?void 0:a.id)||"temp_"+Date.now(),studentId:e.studentId,offline:!0}}),o=s.length>0?s:l;o.length>0&&(a={type:"point_action",actions:o,desc:1===e?"Last Action":`Group Action (${e})`},Do.value.push(a),Do.value.length>10&&Do.value.shift())}}}catch(t){console.error("Error applying behavior:",t),Zl.notify({message:t.message||"Error applying behavior",color:"negative",position:"top"})}finally{xs.value=!1}}P(Ds,e=>{if("from_now"===e){const e={};for(const[a,t]of Object.entries(ps.value))e[a]={plus:t.points_plus||0,minus:t.points_minus||0};Ns.value=e}else zo()});const Do=z([]);async function No(){if(0===Do.value.length)return;const e=Do.value.pop();Zl.loading.show({message:"Undoing..."});try{let a=0;for(const t of e.actions){(await be.undoAction(t.actionId)).success&&a++}a>0?(Zl.notify({message:"Undone successfully",color:"positive",icon:"undo",position:"top"}),Bo(),zo()):Zl.notify({message:"Failed to undo action",color:"warning",position:"top"})}catch(a){console.error("Undo failed",a),Zl.notify({message:"Undo failed",color:"negative",position:"top"})}finally{Zl.loading.hide()}}async function Fo(e,a){const t=void 0===gs.value[e]||gs.value[e],l=!t;if(!1===l){const a=ps.value[e];if(a&&(a.points_plus>0||a.points_minus>0))return void Zl.dialog({title:"Warning",message:`This student has ${a.points_plus} positive and ${a.points_minus} negative points for this session. Marking them absent will remove all their points for this session. Continue?`,cancel:!0,persistent:!0,ok:{label:"Yes, Mark Absent",color:"negative"},cancel:{label:"Cancel",color:"grey"}}).onOk(async()=>{await Lo(e,l,t)})}await Lo(e,l,t)}async function Lo(e,a,t){gs.value[e]=a,fs.value[e]=!0,Bl("select");try{const t=await be.updateAttendance(e,a,{date:ns.value,periodCode:eo.value,classroomId:ss.value});if(!t.success)throw new Error(t.error||"Failed to update attendance");Zl.notify({message:t.message||"Attendance updated",color:"positive",position:"top"}),!1===a&&await zo()}catch(l){console.error("Failed to persist attendance for",e,l),gs.value[e]=t,Zl.notify({message:"Failed to update attendance. Reverted.",color:"negative",position:"top"})}finally{fs.value[e]=!1}}async function Ro(){ws.value=!0;const e={};for(const t of ts.value)e[t.id]=!0,gs.value[t.id]=!0;try{(await be.batchUpdateAttendance(e,{date:ns.value,periodCode:eo.value,classroomId:ss.value})).success&&Zl.notify({message:"All students marked present",color:"positive",position:"top"})}catch(a){console.error("Failed to mark all present:",a),Zl.notify({message:"Failed to mark all present",color:"negative",position:"top"})}finally{ws.value=!1}}async function qo(){ws.value=!0;const e={};for(const t of ts.value)e[t.id]=!1,gs.value[t.id]=!1;try{(await be.batchUpdateAttendance(e,{date:ns.value,periodCode:eo.value,classroomId:ss.value})).success&&Zl.notify({message:"All students marked absent",color:"warning",position:"top"})}catch(a){console.error("Failed to mark all absent:",a),Zl.notify({message:"Failed to mark all absent",color:"negative",position:"top"})}finally{ws.value=!1}}async function Bo(){_s.value=!0;try{const e=await be.getRecentActions({classroomId:ss.value,date:ns.value,limit:10});e.success?bs.value=e.data:console.error("Failed to load history:",e.error)}catch(e){console.error("Error loading history:",e)}finally{_s.value=!1}}function Oo(e){if(!e)return"";return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Mo(){localStorage.setItem("points-display-mode",Ds.value),Fs.value?localStorage.setItem("competition-start-time",Fs.value):localStorage.removeItem("competition-start-time"),Ls.value&&localStorage.setItem("custom-date-from",Ls.value),Rs.value&&localStorage.setItem("custom-date-to",Rs.value),localStorage.setItem("leaderboard-mode",qs.value),Ps.value=!1,ss.value&&zo(),Zl.notify({message:"Points display settings applied",color:"positive",position:"top",icon:"check_circle"})}function Qo(){Ds.value="overall",Fs.value=null,Ls.value=null,Rs.value=null,qs.value="top5",localStorage.removeItem("points-display-mode"),localStorage.removeItem("competition-start-time"),localStorage.removeItem("custom-date-from"),localStorage.removeItem("custom-date-to"),localStorage.removeItem("leaderboard-mode"),Ps.value=!1,ss.value&&zo(),Zl.notify({message:"Reset to normal view",color:"info",position:"top"})}async function Wo(e){console.log("Incident recorded:",e),await zo(),Zl.notify({message:"Behavior incident recorded (-1 point)",color:"warning",position:"top"})}return U(async()=>{var e,a;if(Is.value)console.log("‚è≠Ô∏è Skipping re-initialization - component already initialized");else try{console.log("üöÄ Initializing reward system...");const l=await T.get("/my_classes_with_students");as.value=l.data,console.log(`‚úÖ Loaded ${as.value.length} classrooms`);let s=!1;if(ce.classroomId&&ce.subjectId){console.log("üéØ Props detected (dialog mode) - auto-initializing..."),ss.value=ce.classroomId,os.value=ce.subjectId;try{const t=null==(a=null==(e=D().props.auth)?void 0:e.school)?void 0:a.active_semester_id;t?(rs.value=parseInt(t),console.log(`üè´ Active Semester from Inertia: ${rs.value}`)):rs.value=1}catch(t){console.warn("Could not fetch active semester, defaulting to 1",t),rs.value=1}ce.date?ns.value=ce.date:ns.value=(new Date).toISOString().split("T")[0];const l=new Date(ns.value);ds.value=l.getDay()+1,ce.period&&(us.value=ce.period),ce.week&&(is.value=ce.week,console.log(`üìÖ Props Week: ${ce.week}`)),s=!0,console.log(`üìö Props Subject: ${ce.subjectId}`),console.log(`üè´ Props Classroom: ${ce.classroomId}`),console.log(`üìÖ Props Date: ${ns.value}`),console.log(`‚ö° Calc Day: ${ds.value}`),console.log(`üî¢ Props Period: ${ce.period}`)}else{const e=new URLSearchParams(window.location.search),a=e.get("classroom_id"),t=e.get("subject_id"),l=e.get("period"),o=e.get("date");if(a&&t)console.log("üîó URL parameters detected - auto-initializing..."),ss.value=parseInt(a),os.value=parseInt(t),ns.value=o||(new Date).toISOString().split("T")[0],l&&(us.value=parseInt(l)),s=!0,console.log(`üìö URL Subject: ${t}`),console.log(`üè´ URL Classroom: ${a}`),console.log(`üìÖ URL Date: ${ns.value}`),console.log(`üî¢ URL Period: ${l}`);else{const e=localStorage.getItem("reward-system-selected-subject-id"),a=localStorage.getItem("reward-system-selected-classroom-id");e&&Jl.value.some(a=>a.id===parseInt(e))?(os.value=parseInt(e),console.log(`üìö Restored subject from localStorage: ${e}`)):Jl.value.length>0&&(os.value=Jl.value[0].id,console.log(`üìö Auto-selected first subject: ${Jl.value[0].name}`)),a&&as.value.some(e=>e.classroom_id===parseInt(a))&&(ss.value=parseInt(a),console.log(`üè´ Restored classroom from localStorage: ${a}`));const t=localStorage.getItem("reward-system-active-tab");t&&(Kl.value=t);const l=localStorage.getItem("reward-system-selected-semester"),s=localStorage.getItem("reward-system-selected-week"),o=localStorage.getItem("reward-system-selected-day"),n=localStorage.getItem("reward-system-selected-period-number");l&&(rs.value=parseInt(l),console.log(`üìÖ Restored semester from localStorage: ${l}`)),s&&(is.value=parseInt(s),console.log(`üìÖ Restored week from localStorage: ${s}`)),o&&(ds.value=parseInt(o),console.log(`üìÖ Restored day from localStorage: ${o}`)),n&&(us.value=parseInt(n),console.log(`üìÖ Restored period number from localStorage: ${n}`))}}console.log(`üî¢ Active Period Code: ${rs.value}.${is.value}.${ds.value}.${us.value}`);const o=await be.fetchBehaviors();o.success?(ls.value=o.data,console.log(`‚úÖ Loaded ${ls.value.length} behaviors`),console.log("üìã Behaviors data:",ls.value),ls.value=ls.value.map(e=>({...e,value:e.value||e.points||0})),console.log("üìã Normalized behaviors:",ls.value)):(console.error("‚ùå Failed to load behaviors:",o.error),Zl.notify({message:"Failed to load behaviors: "+o.error,color:"negative",position:"top"})),console.log("‚úÖ Reward system initialized"),Is.value=!0,s&&ss.value&&(console.log("üöÄ Auto-initializing classroom session..."),await To(ss.value),await zo(),function(e,a=3e3){Zs.value=e,Ks.value&&clearTimeout(Ks.value),Ks.value=setTimeout(()=>{Zs.value=null},a)}(ce.isDialog?"Session loaded!":"Session loaded from schedule!",3e3))}catch(l){console.error("‚ùå Failed to initialize reward system:",l),Zl.notify({message:"Failed to initialize reward system: "+l.message,color:"negative",position:"top"})}}),(a,h)=>{const A=F("Head");return R(),L(H,null,[q(A,{title:"Reward System"}),B("div",xe,[h[92]||(h[92]=B("div",{class:"p-1 scale-25"},null,-1)),e.isDialog?M("",!0):(R(),O(r,{key:0,class:"shadow-lg rounded-2xl overflow-hidden"},{default:Q(()=>[q(t,{class:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white flex justify-between items-center"},{default:Q(()=>[B("div",null,[B("h1",we,"üèÜ "+W(a.$t("rewardSys.behaviors.management")),1),B("p",_e,W(a.$t("rewardSys.behaviors.management")),1)]),q(S,{modelValue:G(Ml),"onUpdate:modelValue":h[0]||(h[0]=e=>J(Ml)?Ml.value=e:null),options:[{label:"üá¨üáß English",value:"en"},{label:"üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",value:"ar"}],flat:"",color:"white","text-color":"white","toggle-color":"white","toggle-text-color":"primary",unelevated:""},null,8,["modelValue"])]),_:1}),q(t,{class:"p-6 space-y-4"},{default:Q(()=>{var e;return[B("div",Se,[B("div",ke,[B("div",$e,[q(l,{name:"event_note",size:"md"})]),B("div",null,[B("div",Ie,W(a.$t("rewardSys.session.current")),1),B("div",Ce,[ss.value?(R(),L("span",je,W((null==(e=as.value.find(e=>e.classroom_id===ss.value))?void 0:e.classroom_name)||a.$t("rewardSys.session.unknownClass")),1)):(R(),L("span",Ee,W(a.$t("rewardSys.session.noClassroom")),1)),h[58]||(h[58]=B("span",{class:"text-gray-300"},"|",-1)),B("span",Ve,W(eo.value),1)]),B("div",Ae,W(new Date(ns.value).toLocaleDateString())+" ‚Ä¢ Period "+W(us.value),1)])])]),ss.value?(R(),L("div",Te,[B("div",ze,[B("div",Ue,[q(l,{name:"groups",class:"text-blue-600",size:"sm"}),B("span",Pe,W(a.$t("rewardSys.session.classroomSummary")),1)]),B("div",De,[q(s,{modelValue:Cs.value,"onUpdate:modelValue":h[1]||(h[1]=e=>Cs.value=e),icon:"edit",label:"Edit Avatars",dense:"",color:"secondary",size:"sm",class:"bg-white px-2 py-1 rounded-lg border border-gray-200"},null,8,["modelValue"]),$s.value.message?(R(),L("div",Ne,W($s.value.message)+" ("+W($s.value.created)+") ",1)):M("",!0),B("div",Fe,[q(l,{name:"people",class:"text-blue-600",size:"sm"}),B("div",Le,[B("span",Re,W(a.$t("rewardSys.session.total")),1),B("span",qe,W(ts.value.length),1)])]),B("div",Be,[q(l,{name:"check_circle",class:"text-green-600",size:"sm"}),B("div",Oe,[B("span",Me,W(a.$t("rewardSys.session.present")),1),B("span",Qe,W(Yl.value.present),1)])]),B("div",We,[q(l,{name:"cancel",class:"text-red-600",size:"sm"}),B("div",Ge,[B("span",Je,W(a.$t("rewardSys.session.absent")),1),B("span",Ye,W(Yl.value.absent),1)])]),q(o,{dense:"",color:"primary",icon:"content_copy",label:a.$t("rewardSys.session.copyList"),onClick:Hl,disable:0===Yl.value.absent,size:"sm",class:"shadow-sm"},{default:Q(()=>[q(n,null,{default:Q(()=>[Y(W(a.$t("rewardSys.session.copyToClipboard")),1)]),_:1})]),_:1},8,["label","disable"])])]),Yl.value.absent>0?(R(),L("div",He,[B("div",Ze,[q(l,{name:"person_off",size:"xs",color:"red"}),B("span",null,W(a.$t("rewardSys.session.absentStudentsList")),1),q(k,{color:"red",label:Yl.value.absent,class:"ml-1"},null,8,["label"])]),B("div",Ke,[B("div",Xe,[(R(!0),L(H,null,Z(Yl.value.absentList,e=>(R(),O(x,{key:e.id,color:"red","text-color":"white",size:"sm",dense:"",icon:"person"},{default:Q(()=>[Y(W("ar"===G(Ml)&&e.name_ar?e.name_ar:e.name),1)]),_:2},1024))),128))])])])):M("",!0)])):M("",!0)]}),_:1})]),_:1})),B("audio",{ref_key:"bgMusic",ref:fe,loop:"",id:"bg-music"},h[59]||(h[59]=[B("source",{src:"/audio/background_music2.mp3",type:"audio/mpeg"},null,-1)]),512),ts.value.length?(R(),O(r,{key:1,class:"shadow-lg rounded-2xl"},{default:Q(()=>{var e,b,y,S,A,T,z,U,P,D,N;return[B("div",ea,[B("div",aa,[B("div",ta,[q(v,{color:"primary",icon:"menu",label:G(Zl).screen.gt.xs?"Menu":"",class:"shadow-sm glossy","content-class":"bg-white",dense:""},{default:Q(()=>[B("div",la,[B("div",{class:"column",style:K(G(Zl).screen.lt.sm?"min-width: 250px":"min-width: 220px")},[h[68]||(h[68]=B("div",{class:"text-subtitle1 text-weight-bold q-mb-sm text-grey-8"},"Navigation",-1)),q(i,{dense:""},{default:Q(()=>[X((R(),O(d,{clickable:"",onClick:h[2]||(h[2]=e=>Kl.value="positive"),active:"positive"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"add_circle"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.positivePoints")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[3]||(h[3]=e=>Kl.value="attendance"),active:"attendance"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"how_to_reg"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.attendance")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[4]||(h[4]=e=>Kl.value="history"),active:"history"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"cancel"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.history")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[5]||(h[5]=e=>Kl.value="classroom_helper"),active:"classroom_helper"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"assignment"})]),_:1}),q(u,null,{default:Q(()=>h[60]||(h[60]=[Y("Classroom Helper")])),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[6]||(h[6]=e=>Kl.value="timer_random"),active:"timer_random"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"timer"})]),_:1}),q(u,null,{default:Q(()=>h[61]||(h[61]=[Y("Timer & Random")])),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[7]||(h[7]=e=>{ys.value=!0,Kl.value="champions"}),active:"champions"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"emoji_events"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.champions")),1)]),_:1})]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[8]||(h[8]=e=>Kl.value="settings_reports"),active:"settings_reports"===Kl.value,"active-class":"bg-blue-50 text-primary"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"settings_applications"})]),_:1}),q(u,null,{default:Q(()=>[Y(W(a.$t("rewardSys.tabs.settingsReports")),1)]),_:1})]),_:1},8,["active"])),[[w]])]),_:1}),q(c,{class:"q-my-md"}),h[69]||(h[69]=B("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Points Filter",-1)),q(i,{dense:""},{default:Q(()=>[X((R(),O(d,{clickable:"",onClick:h[9]||(h[9]=e=>Ds.value="overall"),active:"overall"===Ds.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"functions",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[62]||(h[62]=[Y("Overall (All Time)")])),_:1}),"overall"===Ds.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[10]||(h[10]=e=>Ds.value="all_subjects"),active:"all_subjects"===Ds.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"public",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[63]||(h[63]=[Y("Overall (All Subjects)")])),_:1}),"all_subjects"===Ds.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[11]||(h[11]=e=>Ds.value="session"),active:"session"===Ds.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"timer",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[64]||(h[64]=[Y("This Session")])),_:1}),"session"===Ds.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[12]||(h[12]=e=>Ds.value="competition"),active:"competition"===Ds.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"date_range",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[65]||(h[65]=[Y("Competition (Week)")])),_:1}),"competition"===Ds.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]]),X((R(),O(d,{clickable:"",onClick:h[13]||(h[13]=e=>Ds.value="from_now"),active:"from_now"===Ds.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"restart_alt",size:"xs"})]),_:1}),q(u,null,{default:Q(()=>h[66]||(h[66]=[Y("From Now (Reset View)")])),_:1}),"from_now"===Ds.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:1},8,["active"])),[[w]])]),_:1}),q(c,{class:"q-my-md"}),h[70]||(h[70]=B("div",{class:"text-subtitle2 text-grey-7 q-mb-xs"},"Layout",-1)),q(i,{dense:""},{default:Q(()=>[(R(!0),L(H,null,Z(mo.value,e=>X((R(),O(d,{clickable:"",key:e.value,onClick:a=>As.value=e.value,active:As.value===e.value,"active-class":"text-orange-9 text-weight-bold"},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:e.icon,size:"xs"},null,8,["name"])]),_:2},1024),q(u,null,{default:Q(()=>[Y(W(e.label),1)]),_:2},1024),As.value===e.value?(R(),O(u,{key:0,side:""},{default:Q(()=>[q(l,{name:"check",size:"xs",color:"orange"})]),_:1})):M("",!0)]),_:2},1032,["onClick","active"])),[[w]])),128)),q(c,{class:"q-my-xs"}),X((R(),O(d,{clickable:"",onClick:h[14]||(h[14]=e=>zs.value=!0)},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"settings",size:"xs",class:"text-grey-7"})]),_:1}),q(u,{class:"text-grey-8"},{default:Q(()=>[Y(W(a.$t("rewardSys.manageGroups")),1)]),_:1})]),_:1})),[[w]])]),_:1}),G(Zl).screen.lt.sm?(R(),L("div",sa,[q(c,{class:"q-my-md"}),h[67]||(h[67]=B("div",{class:"text-subtitle1 text-weight-bold q-mb-md text-grey-8"},"Settings",-1)),q(s,{modelValue:ql.value,"onUpdate:modelValue":h[15]||(h[15]=e=>ql.value=e),"checked-icon":"music_note","unchecked-icon":"music_off",label:"Music On",color:"primary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Cs.value,"onUpdate:modelValue":h[16]||(h[16]=e=>Cs.value=e),icon:"edit",label:"Edit Avatars",color:"secondary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Os.value,"onUpdate:modelValue":h[17]||(h[17]=e=>Os.value=e),icon:"volume_up",label:"Read Aloud",color:"purple",dense:""},null,8,["modelValue"])])):M("",!0)],4),G(Zl).screen.gt.xs?(R(),O(c,{key:0,vertical:"",inset:"",class:"q-mx-lg"})):M("",!0),G(Zl).screen.gt.xs?(R(),L("div",oa,[h[71]||(h[71]=B("div",{class:"text-subtitle1 text-weight-bold q-mb-md text-grey-8"},"Settings",-1)),B("div",na,[q(s,{modelValue:ql.value,"onUpdate:modelValue":h[18]||(h[18]=e=>ql.value=e),"checked-icon":"music_note","unchecked-icon":"music_off",label:"Music On",color:"primary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Cs.value,"onUpdate:modelValue":h[19]||(h[19]=e=>Cs.value=e),icon:"edit",label:"Edit Avatars",color:"secondary",dense:""},null,8,["modelValue"]),q(s,{modelValue:Os.value,"onUpdate:modelValue":h[20]||(h[20]=e=>Os.value=e),icon:"volume_up",label:"Read Aloud",color:"purple",dense:""},null,8,["modelValue"])]),q(c,{class:"q-my-md full-width"}),B("div",ra,[q(ue,{class:"scale-90 transform-origin-center"})])])):M("",!0)])]),_:1},8,["label"]),"positive"!==Kl.value||G(Zl).screen.gt.xs?(R(),L("div",ia,[q(k,{color:"blue-1","text-color":"blue-9",class:"q-py-xs q-px-sm text-subtitle2 whitespace-nowrap"},{default:Q(()=>[Y(W("positive"===Kl.value?a.$t("rewardSys.tabs.positivePoints"):"attendance"===Kl.value?a.$t("rewardSys.tabs.attendance"):"history"===Kl.value?a.$t("rewardSys.tabs.history"):"champions"===Kl.value?a.$t("rewardSys.tabs.champions"):"classroom_helper"===Kl.value?"Classroom Helper":"timer_random"===Kl.value?"Timer & Random":a.$t("rewardSys.tabs.settingsReports")),1)]),_:1})])):M("",!0),B("div",da,[xo.value||0!==ms.value.length?(R(),L("div",ca,[xo.value||ms.value.length>0&&ts.value.find(e=>e.id===ms.value[ms.value.length-1])?(R(),L(H,{key:0},[q(m,{size:"24px"},{default:Q(()=>{var e;return[B("img",{src:(null==(e=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:e.avatar)||"data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>"),onError:h[21]||(h[21]=e=>{e.target.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><rect width='24' height='24' fill='#e2e8f0'/><text x='50%' y='50%' dy='.3em' text-anchor='middle' font-size='12' fill='#64748b'>ST</text></svg>")})},null,40,va)]}),_:1}),B("div",ma,[B("span",pa,W(null==(e=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:e.name),1),(null==(b=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:b.name_ar)?(R(),L("span",ga,W(null==(y=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:y.name_ar),1)):M("",!0)]),h[73]||(h[73]=B("div",{class:"h-4 w-px bg-gray-300 mx-1 flex-shrink-0"},null,-1)),B("div",{class:ee(["bg-white px-2 py-0.5 rounded text-xs font-mono font-bold border border-gray-200 flex-shrink-0",((null==(A=ps.value[null==(S=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:S.id])?void 0:A.points_plus)||0)-((null==(z=ps.value[null==(T=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:T.id])?void 0:z.points_minus)||0)>=0?"text-green-700":"text-red-700"])},W(((null==(P=ps.value[null==(U=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:U.id])?void 0:P.points_plus)||0)-((null==(N=ps.value[null==(D=xo.value||ts.value.find(e=>e.id===ms.value[ms.value.length-1]))?void 0:D.id])?void 0:N.points_minus)||0))+" Pts ",3)],64)):M("",!0)])):(R(),L("div",ua,[q(l,{name:"touch_app",size:"xs",class:"mr-1"}),h[72]||(h[72]=Y(" mouse on or active card "))]))])]),B("div",fa,[q(v,{color:"primary",icon:"stars",label:G(Zl).screen.gt.xs?"Give Feedback":"",disable:0===ms.value.length,class:"shadow-sm glossy","content-class":"rounded-xl",dense:""},{default:Q(()=>[B("div",ba,[ms.value.length>0?(R(),L("div",ya,[B("div",ha,[B("span",null,"Giving to "+W(ms.value.length)+" student"+W(ms.value.length>1?"s":"")+":",1),B("span",{class:"text-gray-500 cursor-pointer hover:text-blue-700",onClick:Ao},"Clear")]),B("div",xa,[(R(!0),L(H,null,Z(ms.value,e=>(R(),O(x,{key:e,dense:"",removable:"",onRemove:a=>Eo(e),onMouseenter:a=>_o(ts.value.find(a=>a.id===e)),onMouseleave:So,color:"white","text-color":"primary",class:"shadow-sm border border-blue-100 text-xs m-0"},{default:Q(()=>{var a;return[q(m,{size:"16px"},{default:Q(()=>[B("img",{src:io(ts.value.find(a=>a.id===e))},null,8,wa)]),_:2},1024),B("span",_a,W(null==(a=ts.value.find(a=>a.id===e))?void 0:a.firstName),1)]}),_:2},1032,["onRemove","onMouseenter"]))),128))])])):M("",!0),q(I,{modelValue:Xl.value,"onUpdate:modelValue":h[22]||(h[22]=e=>Xl.value=e),class:"text-grey-7 bg-grey-1","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":"",dense:""},{default:Q(()=>[q($,{name:"positive",icon:"thumb_up",label:"Positive",class:"text-weight-bold"}),q($,{name:"needs_work",icon:"warning",label:"Needs Work",class:"text-weight-bold"})]),_:1},8,["modelValue"]),q(c),q(j,{modelValue:Xl.value,"onUpdate:modelValue":h[23]||(h[23]=e=>Xl.value=e),animated:"",class:"bg-white",style:{"max-height":"400px","overflow-y":"auto"}},{default:Q(()=>[q(C,{name:"positive",class:"q-pa-md"},{default:Q(()=>[B("div",Sa,[(R(!0),L(H,null,Z(co.value,e=>(R(),L("div",{class:"col-3 cursor-pointer",key:e.id,onClick:a=>Po(e.id)},[X((R(),L("div",$a,[q(l,{name:e.icon||"star",size:"1.2em",class:"q-mb-xs text-orange-400"},null,8,["name"]),B("div",Ia,W(e.name),1),B("div",Ca,[B("span",ja,"+"+W(e.points||e.value),1)])])),[[w]])],8,ka))),128))])]),_:1}),q(C,{name:"needs_work",class:"q-pa-md"},{default:Q(()=>[B("div",Ea,[(R(!0),L(H,null,Z(vo.value,e=>(R(),L("div",{class:"col-4 cursor-pointer",key:e.id,onClick:a=>Po(e.id)},[X((R(),L("div",Aa,[q(l,{name:e.icon||"warning",size:"2em",class:"q-mb-xs text-red"},null,8,["name"]),B("div",Ta,W(e.name),1),B("div",za,[q(k,{color:"red-1","text-color":"red-9",class:"text-xs font-bold border border-red-200 shadow-sm rounded-full px-1.5"},{default:Q(()=>[Y(W(e.points||e.value),1)]),_:2},1024)])])),[[w]])],8,Va))),128))])]),_:1})]),_:1},8,["modelValue"])])]),_:1},8,["label","disable"])])])]),"positive"===Kl.value&&"session"!==Ds.value?(R(),L("div",Ua," Viewing: "+W("overall"===Ds.value?"Overall (All Time)":"all_subjects"===Ds.value?"Overall (All Subjects)":"from_now"===Ds.value?"From Now (Temporary)":"Competition (Week)"),1)):M("",!0),q(c),q(j,{modelValue:Kl.value,"onUpdate:modelValue":h[37]||(h[37]=e=>Kl.value=e),animated:""},{default:Q(()=>[q(C,{name:"attendance"},{default:Q(()=>[B("div",Pa,[B("div",Da,[B("h3",Na,W(a.$t("rewardSys.attendance.manage")),1),B("div",Fa,[q(o,{color:"positive",label:a.$t("rewardSys.attendance.markAllPresent"),onClick:Ro,loading:ws.value},null,8,["label","loading"]),q(o,{color:"warning",label:a.$t("rewardSys.attendance.markAllAbsent"),onClick:qo,loading:ws.value},null,8,["label","loading"])])]),B("div",La,[(R(!0),L(H,null,Z(ts.value,e=>{var a,t,l,s;return R(),O(de,{key:e.id,student:e,"disable-behavior":!gs.value[e.id],"allow-disabled-click":!0,"avatar-edit-enabled":Cs.value,"student-summary":{positive:((null==(a=ps.value[e.id])?void 0:a.points_plus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].plus:0),negative:((null==(t=ps.value[e.id])?void 0:t.points_minus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].minus:0),total:((null==(l=ps.value[e.id])?void 0:l.points_plus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].plus:0)-(((null==(s=ps.value[e.id])?void 0:s.points_minus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].minus:0))},onSelect:a=>Fo(e.id),onPreview:_o,onLeave:So},null,8,["student","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))])])]),_:1}),q(C,{name:"classroom_helper"},{default:Q(()=>[q(ie,{students:ts.value,"student-behaviors":ps.value,"student-attendance":gs.value,"period-info":{date:ns.value,periodCode:eo.value,classroomId:ss.value}},null,8,["students","student-behaviors","student-attendance","period-info"])]),_:1}),q(C,{name:"timer_random"},{default:Q(()=>[q(re,{students:ts.value},null,8,["students"])]),_:1}),q(C,{name:"positive"},{default:Q(()=>[B("div",Ra,[B("div",qa,[(R(),O(ae,{to:"#dialog-header-actions"},[B("div",Ba,[q(v,{split:"",color:ms.value.length>0?"blue-6":"blue-1","text-color":ms.value.length>0?"white":"primary",icon:"checklist",label:ms.value.length>0?a.$t("rewardSys.selected")+": "+ms.value.length:"Select",dense:"",rounded:"",unelevated:"",class:"mr-2 transition-all duration-300","content-style":"border-radius: 12px",onClick:h[25]||(h[25]=e=>ms.value.length>0?no("selected"):bo())},{default:Q(()=>[q(i,{dense:"",style:{"min-width":"180px"}},{default:Q(()=>[X((R(),O(d,{clickable:"",onClick:h[24]||(h[24]=e=>no("selected"))},{default:Q(()=>[q(u,null,{default:Q(()=>[q(p,{header:"",class:"text-xs text-uppercase text-gray-500 font-bold bg-gray-50 border-b cursor-pointer hover:bg-gray-100 transition-colors"},{default:Q(()=>[Y(W(a.$t("rewardSys.selected"))+": "+W(ms.value.length),1)]),_:1})]),_:1})]),_:1})),[[w]]),X((R(),O(d,{clickable:"",onClick:ro,disable:0===ms.value.length},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"content_copy",color:"grey-8"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>h[74]||(h[74]=[Y("Copy Names")])),_:1})]),_:1})]),_:1},8,["disable"])),[[w]]),q(c),X((R(),O(d,{clickable:"",onClick:bo},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"check_box",color:"primary"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(a.$t("rewardSys.selection.all")),1)]),_:1})]),_:1})]),_:1})),[[w]]),X((R(),O(d,{clickable:"",onClick:yo},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"swap_vert",color:"orange"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(a.$t("rewardSys.selection.inv")),1)]),_:1})]),_:1})]),_:1})),[[w]]),q(c),X((R(),O(d,{clickable:"",onClick:Ao,disable:0===ms.value.length},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(l,{name:"clear",color:"negative"})]),_:1}),q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(a.$t("rewardSys.selection.clear")),1)]),_:1})]),_:1})]),_:1},8,["disable"])),[[w]])]),_:1})]),_:1},8,["color","text-color","label"]),q(s,{modelValue:Bs.value,"onUpdate:modelValue":h[26]||(h[26]=e=>Bs.value=e),label:"individual"===Bs.value?"Individual":"Selection","true-value":"individual","false-value":"selection","checked-icon":"person","unchecked-icon":"checklist",color:"green-13","icon-color":"white",size:"sm",dense:"",class:"mr-2 text-white font-bold"},null,8,["modelValue","label"]),q(c,{vertical:"",inset:"",class:"mx-2"}),q(o,{rounded:"",dense:"","no-caps":"",color:"positive",class:"px-3 shadow-sm",onClick:h[27]||(h[27]=e=>no("present"))},{default:Q(()=>[q(l,{name:"check_circle",class:"mr-1",size:"xs"}),B("span",Oa,W(ao.value),1)]),_:1}),q(o,{rounded:"",dense:"","no-caps":"",color:"negative",class:"px-3 shadow-sm",onClick:h[28]||(h[28]=e=>no("absent"))},{default:Q(()=>[q(l,{name:"cancel",class:"mr-1",size:"xs"}),B("span",Ma,W(to.value),1)]),_:1})])])),q(c,{vertical:"",inset:"",class:"mx-2"}),q(g,{modelValue:lo.value,"onUpdate:modelValue":h[29]||(h[29]=e=>lo.value=e)},{default:Q(()=>[q(r,{style:{"min-width":"350px"}},{default:Q(()=>[q(t,{class:"row items-center"},{default:Q(()=>[B("div",Qa,[Y(W("present"===so.value?"Present Students":"selected"===so.value?"Selected Students":"Absent Students")+" ",1),q(k,{color:"present"===so.value?"positive":"selected"===so.value?"blue":"negative",class:"ml-2"},{default:Q(()=>[Y(W(oo.value.length),1)]),_:1},8,["color"])]),q(E),X(q(o,{icon:"close",flat:"",round:"",dense:""},null,512),[[w]])]),_:1}),q(t,{class:"q-pt-none",style:{"max-height":"50vh","overflow-y":"auto"}},{default:Q(()=>[0===oo.value.length?(R(),L("div",Wa," No students found. ")):(R(),O(i,{key:1,bordered:"",separator:"",class:"rounded-lg"},{default:Q(()=>[(R(!0),L(H,null,Z(oo.value,e=>(R(),O(d,{key:e.id},{default:Q(()=>[q(u,{avatar:""},{default:Q(()=>[q(m,{size:"sm"},{default:Q(()=>[B("img",{src:io(e)},null,8,Ga)]),_:2},1024)]),_:2},1024),q(u,null,{default:Q(()=>[Y(W(e.name),1)]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1}),q(f,{align:"right",class:"bg-gray-50"},{default:Q(()=>[X(q(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]]),q(o,{label:"Copy List",color:"primary",icon:"content_copy",onClick:ro,disable:0===oo.value.length},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Do.value.length>0?(R(),O(o,{key:0,dense:"",rounded:"",color:"grey-8",icon:"undo",label:"Undo",onClick:No,class:"ml-2 shadow-sm",size:"sm"},{default:Q(()=>[q(n,null,{default:Q(()=>h[75]||(h[75]=[Y("Undo last action")])),_:1})]),_:1})):M("",!0),go.value.length>0?(R(),L("div",Ja,[q(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"filter_alt_off",label:"ALL",color:null===po.value?"grey-3":"grey-2","text-color":null===po.value?"grey-8":"grey-6",class:ee(["px-4 font-bold",null===po.value?"bg-gray-200":""]),onClick:h[30]||(h[30]=e=>po.value=null)},null,8,["color","text-color","class"]),q(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"check_circle",color:"__SELECTED__"===po.value?"primary":"grey-2","text-color":"__SELECTED__"===po.value?"white":"grey-8",class:"px-3 font-bold",onClick:h[31]||(h[31]=e=>po.value="__SELECTED__"===po.value?null:"__SELECTED__")},{default:Q(()=>[q(n,null,{default:Q(()=>h[76]||(h[76]=[Y("Selected Only")])),_:1})]),_:1},8,["color","text-color"]),q(o,{unelevated:"",dense:"",rounded:"",size:"md",icon:"radio_button_unchecked",color:"__UNSELECTED__"===po.value?"primary":"grey-2","text-color":"__UNSELECTED__"===po.value?"white":"grey-8",class:"px-3 font-bold mr-2",onClick:h[32]||(h[32]=e=>po.value="__UNSELECTED__"===po.value?null:"__UNSELECTED__")},{default:Q(()=>[q(n,null,{default:Q(()=>h[77]||(h[77]=[Y("Not Selected")])),_:1})]),_:1},8,["color","text-color"]),(R(!0),L(H,null,Z(go.value,e=>(R(),O(o,{key:e,unelevated:"",dense:"",round:"",size:"md",label:e,color:po.value===e?"primary":"grey-1","text-color":po.value===e?"white":"grey-7",onClick:a=>function(e){po.value===e?po.value=null:po.value=e}(e),class:ee(["font-bold shadow-sm",po.value===e?"shadow-md scale-110":"hover:bg-gray-200"])},null,8,["label","color","text-color","onClick","class"]))),128))])):M("",!0),(R(!0),L(H,null,Z(fo.value,(e,t)=>(R(),L("div",{key:t,class:"mb-6 bg-gray-400"},[e.name?(R(),L("div",Ya,[B("div",Ha,[B("h4",Za,[q(l,{name:"groups"}),Y(" "+W(e.name)+" ",1),q(k,{label:e.students.length,color:"indigo"},null,8,["label"])]),B("div",Ka,[q(o,{dense:"",size:"sm",color:"indigo",icon:"check_box",label:a.$t("rewardSys.selection.all"),onClick:a=>Vo(e.students,!0),outline:""},null,8,["label","onClick"]),q(o,{dense:"",size:"sm",color:"grey",icon:"check_box_outline_blank",label:a.$t("rewardSys.selection.clear"),onClick:a=>Vo(e.students,!1),outline:""},null,8,["label","onClick"])])])])):M("",!0),B("div",Xa,[(R(!0),L(H,null,Z(e.students,e=>{var a,t,l,s,o,n;return R(),O(de,{key:e.id,student:e,selected:ms.value.includes(e.id),"selected-id":ms.value.includes(e.id)?e.id:null,"disable-behavior":!gs.value[e.id],"is-absent":!gs.value[e.id],"allow-disabled-click":!1,"avatar-edit-enabled":Cs.value,"overall-points":((null==(a=ps.value[e.id])?void 0:a.points_plus)||0)-((null==(t=ps.value[e.id])?void 0:t.points_minus)||0),"student-summary":{positive:((null==(l=ps.value[e.id])?void 0:l.points_plus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].plus:0),negative:((null==(s=ps.value[e.id])?void 0:s.points_minus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].minus:0),total:((null==(o=ps.value[e.id])?void 0:o.points_plus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].plus:0)-(((null==(n=ps.value[e.id])?void 0:n.points_minus)||0)-("from_now"===Ds.value&&Ns.value[e.id]?Ns.value[e.id].minus:0))},onSelect:a=>Xs(e.id),onPreview:_o,onLeave:So},null,8,["student","selected","selected-id","disable-behavior","is-absent","avatar-edit-enabled","overall-points","student-summary","onSelect"])}),128))])]))),128))])])]),_:1}),q(C,{name:"negative"},{default:Q(()=>[B("div",et,[B("div",at,[B("h3",tt,W(a.$t("rewardSys.points.deduct")),1),B("p",lt,W(a.$t("rewardSys.points.selectStudentsNegative")),1)]),B("div",st,[B("div",ot,[q(V,{modelValue:vs.value,"onUpdate:modelValue":h[33]||(h[33]=e=>vs.value=e),options:vo.value,"option-value":"id","option-label":"name",outlined:"",dense:"",placeholder:a.$t("rewardSys.points.selectNegativeBehavior"),"emit-value":"","map-options":""},{option:Q(e=>[q(d,te(le(e.itemProps)),{default:Q(()=>[q(u,null,{default:Q(()=>[q(p,null,{default:Q(()=>[Y(W(Ql(e.opt)),1)]),_:2},1024),q(p,{caption:""},{default:Q(()=>[Y(W(e.opt.value||e.opt.points||0)+" points",1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","placeholder"]),q(o,{color:"negative",icon:"remove_circle",label:a.$t("rewardSys.points.applyToSelected"),onClick:Uo,disable:!ms.value.length||!vs.value,loading:xs.value},null,8,["label","disable","loading"])]),B("div",nt,[h[78]||(h[78]=Y("Selected: ")),B("strong",null,W(ms.value.length),1),h[79]||(h[79]=Y(" students"))])]),B("div",rt,[(R(!0),L(H,null,Z(ts.value,e=>{var a,t,l,s;return R(),O(de,{key:e.id,student:e,selected:ms.value.includes(e.id),"selected-id":ms.value.includes(e.id)?e.id:null,"disable-behavior":!gs.value[e.id],"allow-disabled-click":!1,"avatar-edit-enabled":Cs.value,"student-summary":{positive:(null==(a=ps.value[e.id])?void 0:a.points_plus)||0,negative:(null==(t=ps.value[e.id])?void 0:t.points_minus)||0,total:((null==(l=ps.value[e.id])?void 0:l.points_plus)||0)-((null==(s=ps.value[e.id])?void 0:s.points_minus)||0)},onSelect:a=>Eo(e.id)},null,8,["student","selected","selected-id","disable-behavior","avatar-edit-enabled","student-summary","onSelect"])}),128))])])]),_:1}),q(C,{name:"old_card"},{default:Q(()=>[B("div",it,[h[83]||(h[83]=B("h3",{class:"text-xl font-bold mb-4"},"Old Card View",-1)),B("div",dt,[(R(!0),L(H,null,Z(ts.value,e=>{var a,t,l,s;return R(),L("div",{key:e.id,class:ee(["p-4 border-2 rounded-lg transition",[gs.value[e.id]?ms.value.includes(e.id)?"bg-green-100 border-green-500 cursor-pointer":"bg-white border-gray-200 cursor-pointer":"bg-gray-100 border-gray-300 opacity-50 cursor-not-allowed"]]),onClick:a=>gs.value[e.id]&&Eo(e.id)},[B("div",ct,[B("div",vt,[B("p",mt,W(e.name),1),B("p",pt,"ID: "+W(e.id),1),gs.value[e.id]?M("",!0):(R(),L("p",gt,"‚ùå Absent"))]),q(_,{"model-value":ms.value.includes(e.id),"onUpdate:modelValue":a=>Eo(e.id),disable:!gs.value[e.id],color:"positive",size:"lg"},null,8,["model-value","onUpdate:modelValue","disable"])]),B("div",ft,[B("div",bt,[h[80]||(h[80]=B("span",{class:"text-xs font-semibold text-green-800"},"Positive",-1)),B("span",yt,"+"+W((null==(a=ps.value[e.id])?void 0:a.points_plus)||0)+" ‚≠ê",1)]),B("div",ht,[h[81]||(h[81]=B("span",{class:"text-xs font-semibold text-red-800"},"Negative",-1)),B("span",xt,"-"+W((null==(t=ps.value[e.id])?void 0:t.points_minus)||0)+" ‚ö†Ô∏è",1)]),B("div",wt,[h[82]||(h[82]=B("span",{class:"text-xs font-semibold text-blue-800"},"Total",-1)),B("span",_t,W(((null==(l=ps.value[e.id])?void 0:l.points_plus)||0)-((null==(s=ps.value[e.id])?void 0:s.points_minus)||0)),1)])])],10,ut)}),128))])])]),_:1}),q(C,{name:"history"},{default:Q(()=>[B("div",St,[B("div",kt,[B("h3",$t,W(a.$t("rewardSys.history.title")),1),q(o,{color:"primary",icon:"refresh",label:a.$t("rewardSys.history.refresh"),onClick:Bo,loading:_s.value},null,8,["label","loading"])]),bs.value.length?M("",!0):(R(),L("div",It,[B("p",Ct,W(a.$t("rewardSys.history.empty")),1)])),(R(!0),L(H,null,Z(bs.value,e=>{var t,l,s;return R(),L("div",{key:e.id,class:ee(["p-4 bg-white rounded-lg border-l-4",[e.canceled?"border-gray-400 opacity-60":e.value>0?"border-green-500":"border-red-500"]])},[B("div",jt,[B("div",Et,[B("div",Vt,[B("span",At,W((null==(l=null==(t=e.student_behavior)?void 0:t.student)?void 0:l.name)||a.$t("rewardSys.history.unknown")),1),B("span",Tt,W(e.value>0?"‚≠ê":"‚ö†Ô∏è"),1)]),B("p",zt,[B("strong",null,W(Ql(e.behavior)||a.$t("rewardSys.history.unknownBehavior")),1),B("span",{class:ee(e.value>0?"text-green-600":"text-red-600")}," ("+W(e.value>0?"+":"")+W(e.value)+" "+W(a.$t("rewardSys.points.title"))+") ",3)]),B("p",Ut,W(Oo(e.created_at))+" by "+W((null==(s=e.created_by)?void 0:s.name)||a.$t("rewardSys.history.unknown")),1),e.note?(R(),L("p",Pt,W(a.$t("rewardSys.history.note"))+" "+W(e.note),1)):M("",!0),e.canceled?(R(),L("p",Dt," ‚ùå "+W(a.$t("rewardSys.history.canceled"))+" "+W(e.cancel_reason)+" ("+W(Oo(e.canceled_at))+") ",1)):M("",!0)]),e.canceled?M("",!0):(R(),O(o,{key:0,color:"warning",icon:"undo",label:a.$t("rewardSys.history.undo"),size:"sm",onClick:a=>async function(e){Ss.value=e;try{const a=await be.undoAction(e,"Undone by teacher");a.success?(Zl.notify({message:"Action undone successfully",color:"positive",position:"top"}),await Bo(),await zo()):Zl.notify({message:a.error||"Failed to undo action",color:"negative",position:"top"})}catch(a){console.error("Error undoing action:",a),Zl.notify({message:"Error undoing action",color:"negative",position:"top"})}finally{Ss.value=null}}(e.id),loading:Ss.value===e.id},null,8,["label","onClick","loading"]))])],2)}),128))])]),_:1}),q(C,{name:"settings_reports",class:"p-4"},{default:Q(()=>[B("div",Nt,[B("div",Ft,[q(I,{modelValue:es.value,"onUpdate:modelValue":h[34]||(h[34]=e=>es.value=e),align:"left",class:"text-gray-600 bg-gray-50 border-b border-gray-200","active-color":"primary","indicator-color":"primary",dense:""},{default:Q(()=>[q($,{name:"behavior_incidents",icon:"report_problem",label:a.$t("rewardSys.tabs.behaviorIncidents")},null,8,["label"]),q($,{name:"behaviors",icon:"settings",label:a.$t("rewardSys.tabs.behaviors")},null,8,["label"])]),_:1},8,["modelValue"]),q(j,{modelValue:es.value,"onUpdate:modelValue":h[36]||(h[36]=e=>es.value=e),animated:"",class:"bg-transparent"},{default:Q(()=>[q(C,{name:"behavior_incidents"},{default:Q(()=>[q(G(me),{students:ts.value,"classroom-id":ss.value,date:ns.value,"period-code":eo.value,onIncidentRecorded:Wo},null,8,["students","classroom-id","date","period-code"])]),_:1}),q(C,{name:"behaviors"},{default:Q(()=>[B("div",Lt,[B("div",Rt,[B("h3",qt,W(a.$t("rewardSys.behaviors.management")),1),q(o,{color:"primary",icon:"add",label:a.$t("rewardSys.behaviors.addNew"),onClick:h[35]||(h[35]=e=>Io(null)),size:"md",class:"shadow-md"},null,8,["label"])]),B("div",Bt,[B("div",Ot,[q(l,{name:"add_circle",size:"md",color:"positive"}),B("h4",Mt,W(a.$t("rewardSys.behaviors.positiveSection")),1),q(k,{label:co.value.length,color:"positive"},null,8,["label"])]),B("div",Qt,[(R(!0),L(H,null,Z(co.value,e=>(R(),L("div",{key:e.id,class:"bg-white rounded-lg p-4 shadow-sm border border-green-100 hover:shadow-md transition-all"},[B("div",Wt,[B("div",Gt,[B("div",Jt,W(e.icon||"‚≠ê"),1),B("div",null,[B("h5",Yt,W(Ql(e)),1),B("p",Ht,"ID: "+W(e.id),1)])]),B("div",Zt,[q(o,{flat:"",round:"",dense:"",icon:"edit",color:"primary",size:"sm",onClick:a=>Io(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[84]||(h[84]=[Y("Edit")])),_:1})]),_:2},1032,["onClick"]),q(o,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"sm",onClick:a=>jo(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[85]||(h[85]=[Y("Delete")])),_:1})]),_:2},1032,["onClick"])])]),B("div",Kt,[h[86]||(h[86]=B("span",{class:"text-sm text-gray-600"},"Points:",-1)),B("span",Xt,"+"+W(e.value||e.points||0),1)])]))),128))]),0===co.value.length?(R(),L("div",el,[q(l,{name:"sentiment_neutral",size:"3rem",class:"mb-2"}),B("p",null,W(a.$t("rewardSys.behaviors.noPositive")),1)])):M("",!0)]),B("div",al,[B("div",tl,[q(l,{name:"remove_circle",size:"md",color:"negative"}),B("h4",ll,W(a.$t("rewardSys.behaviors.negativeSection")),1),q(k,{label:vo.value.length,color:"negative"},null,8,["label"])]),B("div",sl,[(R(!0),L(H,null,Z(vo.value,e=>(R(),L("div",{key:e.id,class:"bg-white rounded-lg p-4 shadow-sm border border-red-100 hover:shadow-md transition-all"},[B("div",ol,[B("div",nl,[B("div",rl,W(e.icon||"‚ö†Ô∏è"),1),B("div",null,[B("h5",il,W(Ql(e)),1),B("p",dl,"ID: "+W(e.id),1)])]),B("div",ul,[q(o,{flat:"",round:"",dense:"",icon:"edit",color:"primary",size:"sm",onClick:a=>Io(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[87]||(h[87]=[Y("Edit")])),_:1})]),_:2},1032,["onClick"]),q(o,{flat:"",round:"",dense:"",icon:"delete",color:"negative",size:"sm",onClick:a=>jo(e)},{default:Q(()=>[q(n,null,{default:Q(()=>h[88]||(h[88]=[Y("Delete")])),_:1})]),_:2},1032,["onClick"])])]),B("div",cl,[h[89]||(h[89]=B("span",{class:"text-sm text-gray-600"},"Points:",-1)),B("span",vl,W(e.value||e.points||0),1)])]))),128))]),0===vo.value.length?(R(),L("div",ml,[q(l,{name:"sentiment_neutral",size:"3rem",class:"mb-2"}),B("p",null,W(a.$t("rewardSys.behaviors.noNegative")),1)])):M("",!0)])])]),_:1})]),_:1},8,["modelValue"])])])]),_:1})]),_:1},8,["modelValue"])]}),_:1})):M("",!0),ts.value.length?M("",!0):(R(),O(r,{key:2,class:"shadow-lg rounded-2xl"},{default:Q(()=>[q(t,{class:"text-center py-12"},{default:Q(()=>[B("p",pl,"üìö "+W(a.$t("rewardSys.messages.selectClassroom")),1)]),_:1})]),_:1})),q(g,{modelValue:ys.value,"onUpdate:modelValue":h[38]||(h[38]=e=>ys.value=e),maximized:""},{default:Q(()=>[q(r,null,{default:Q(()=>[q(f,{align:"right"},{default:Q(()=>[X(q(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]])]),_:1}),q(t,{class:"p-0"},{default:Q(()=>[q(G(ve),{students:ts.value,"student-behaviors":ps.value,"period-code":eo.value,date:ns.value,"school-logo":Gl.value},null,8,["students","student-behaviors","period-code","date","school-logo"])]),_:1}),q(f,{align:"right"},{default:Q(()=>[X(q(o,{flat:"",label:"Close",color:"primary"},null,512),[[w]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),q(g,{modelValue:js.value,"onUpdate:modelValue":h[42]||(h[42]=e=>js.value=e),"full-width":"",maxWidth:"1200px"},{default:Q(()=>[q(r,{class:"flex flex-col md:flex-row h-[90vh] md:h-[80vh] overflow-hidden"},{default:Q(()=>{var e;return[q(t,{class:ee(["w-full md:w-1/4 bg-blue-50 border-r border-blue-100 flex flex-col p-0 order-2 md:order-1 transition-all",{"h-16 overflow-hidden md:h-auto":G(Zl).screen.lt.md&&!Hs.value}])},{default:Q(()=>[B("div",{class:"p-3 border-b border-blue-200 bg-blue-100/50 flex justify-between items-center cursor-pointer md:cursor-default",onClick:h[39]||(h[39]=e=>G(Zl).screen.lt.md?Hs.value=!Hs.value:null)},[B("h4",gl,[q(l,{name:"checklist"}),Y(" "+W(a.$t("rewardSys.selected"))+" ("+W(ms.value.length)+") ",1)]),B("div",fl,[q(l,{name:Hs.value?"expand_less":"expand_more",color:"primary"},null,8,["name"])])]),X(B("div",bl,[0===ms.value.length?(R(),L("div",yl,W(a.$t("rewardSys.messages.clickToSelect")),1)):(R(),L("div",hl,[(R(!0),L(H,null,Z(ms.value,e=>(R(),O(x,{key:e,removable:"",onRemove:a=>Eo(e),color:"white","text-color":"primary",class:"shadow-sm border border-blue-100 m-0 w-full"},{default:Q(()=>{var a;return[q(m,{icon:"person",color:"primary","text-color":"white","font-size":"12px"}),B("div",xl,[B("span",wl,W(null==(a=ts.value.find(a=>a.id===e))?void 0:a.firstName),1)])]}),_:2},1032,["onRemove"]))),128))]))],512),[[oe,!G(Zl).screen.lt.md||Hs.value]]),X(B("div",_l,[B("div",Sl,[q(o,{flat:"",dense:"",color:"primary",label:"All",size:"sm",onClick:bo,class:"bg-blue-50"}),q(o,{flat:"",dense:"",color:"primary",label:"Inv",size:"sm",onClick:yo,class:"bg-blue-50"}),q(o,{flat:"",dense:"",color:"negative",label:"Clear",size:"sm",onClick:Ao,class:"bg-red-50"})])],512),[[oe,!G(Zl).screen.lt.md||Hs.value]])]),_:1},8,["class"]),B("div",kl,[1===ms.value.length?(R(),L("div",$l,[B("div",Il,[B("div",Cl,W(null==(e=ts.value.find(e=>e.id===ms.value[0]))?void 0:e.name),1)])])):M("",!0),q(t,{class:ee(["positive"===Es.value?"bg-green-50 border-b border-green-100":"bg-red-50 border-b border-red-100","flex flex-wrap justify-between items-center py-2 px-3 gap-2 shrink-0"])},{default:Q(()=>[B("div",{class:ee(["font-bold flex items-center gap-2 transition-colors duration-300","positive"===Es.value?"text-green-800":"text-red-800"])},[B("span",jl,[q(l,{name:"positive"===Es.value?"emoji_events":"warning",size:"sm"},null,8,["name"]),B("span",El,W("positive"===Es.value?a.$t("rewardSys.points.positiveTitle"):a.$t("rewardSys.points.negativeTitle")),1)])],2),B("div",Vl,[q(o,{unelevated:"",rounded:"",dense:"",color:"positive"===Es.value?"positive":"transparent","text-color":"positive"===Es.value?"white":"grey-7",class:"px-3 md:px-4 transition-all duration-300 text-xs md:text-sm",onClick:h[40]||(h[40]=e=>Es.value="positive")},{default:Q(()=>[q(l,{name:"thumb_up",size:"xs",class:"mr-1"}),h[90]||(h[90]=B("span",{class:"hidden sm:inline"},"Pos",-1))]),_:1},8,["color","text-color"]),q(o,{unelevated:"",rounded:"",dense:"",color:"negative"===Es.value?"negative":"transparent","text-color":"negative"===Es.value?"white":"grey-7",class:"px-3 md:px-4 transition-all duration-300 text-xs md:text-sm",onClick:h[41]||(h[41]=e=>Es.value="negative")},{default:Q(()=>[q(l,{name:"thumb_down",size:"xs",class:"mr-1"}),h[91]||(h[91]=B("span",{class:"hidden sm:inline"},"Neg",-1))]),_:1},8,["color","text-color"])])]),_:1},8,["class"]),q(t,{class:"flex-1 overflow-y-auto p-2 md:p-4 custom-scrollbar bg-gray-50/50"},{default:Q(()=>[B("div",Al,[(R(!0),L(H,null,Z("positive"===Es.value?co.value:vo.value,e=>(R(),L("div",{key:e.id,class:"cursor-pointer transition-all duration-200 relative group touch-manipulation w-24",onClick:a=>Vs.value=e.id},[B("div",{class:ee(["h-full p-2 md:p-3 rounded-xl border flex flex-col items-center text-center gap-1 md:gap-2 active:scale-95 transition-transform bg-white shadow-sm",[Vs.value===e.id?"positive"===Es.value?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-red-500 bg-red-50 ring-2 ring-red-200":"border-gray-200 hover:border-gray-300 hover:shadow-md"]])},[B("div",{class:ee(["text-2xl md:text-3xl p-2 rounded-full mb-0 md:mb-1","positive"===Es.value?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},W(e.icon||("positive"===Es.value?"‚≠ê":"‚ö†Ô∏è")),3),B("div",zl,W(Ql(e)),1),B("div",{class:ee(["text-sm md:text-lg font-bold px-2 md:px-3 py-0.5 md:py-1 rounded-full mt-auto","positive"===Es.value?"bg-green-200 text-green-900":"bg-red-200 text-red-900"])},W("positive"===Es.value?"+":"")+W(e.value||e.points||0),3),Vs.value===e.id?(R(),L("div",{key:0,class:ee(["absolute top-1 right-1 md:top-2 md:right-2 text-lg md:text-xl drop-shadow-sm","positive"===Es.value?"text-green-600":"text-red-600"])},[q(l,{name:"check_circle"})],2)):M("",!0)],2)],8,Tl))),128))])]),_:1}),q(f,{align:"right",class:"p-4 border-t border-gray-100 bg-gray-50 gap-3"},{default:Q(()=>[X(q(o,{flat:"",label:a.$t("rewardSys.tabs.cancel"),color:"grey-7",size:"lg",class:"font-bold"},null,8,["label"]),[[w]]),q(o,{color:"positive"===Es.value?"positive":"negative",label:"positive"===Es.value?a.$t("rewardSys.points.applyPositive"):a.$t("rewardSys.points.applyNegative"),icon:"positive"===Es.value?"check_circle":"warning",onClick:ho,disable:!Vs.value,loading:xs.value,size:"lg",class:"px-8 font-bold shadow-md",push:""},null,8,["color","label","icon","disable","loading"])]),_:1})])]}),_:1})]),_:1},8,["modelValue"]),q(g,{modelValue:Ms.value,"onUpdate:modelValue":h[48]||(h[48]=e=>Ms.value=e),persistent:""},{default:Q(()=>[q(r,{class:"min-w-[500px]"},{default:Q(()=>[q(t,{class:"bg-primary text-white"},{default:Q(()=>[B("div",Ul,[B("div",Pl,W(Qs.value?a.$t("rewardSys.behaviors.edit"):a.$t("rewardSys.behaviors.create")),1),Qs.value&&!Qs.value.teacher_id?(R(),O(k,{key:0,color:"blue",label:"üîí "+a.$t("rewardSys.behaviors.schoolDefault")},null,8,["label"])):M("",!0)])]),_:1}),q(t,{class:"q-pt-md space-y-4"},{default:Q(()=>[Qs.value&&!Qs.value.teacher_id?(R(),O(b,{key:0,class:"bg-blue-50 text-blue-900",rounded:"",dense:""},{avatar:Q(()=>[q(l,{name:"info",color:"blue"})]),default:Q(()=>[Y(" "+W(a.$t("rewardSys.behaviors.readOnlyWarning")),1)]),_:1})):M("",!0),q(y,{modelValue:Gs.value.name,"onUpdate:modelValue":h[43]||(h[43]=e=>Gs.value.name=e),label:"üá¨üáß "+a.$t("rewardSys.behaviors.form.nameEn")+" *",outlined:"",dense:"",rules:[e=>!!e||"Name is required"],readonly:Qs.value&&!Qs.value.teacher_id},{prepend:Q(()=>[q(l,{name:"translate"})]),_:1},8,["modelValue","label","rules","readonly"]),q(y,{modelValue:Gs.value.name_ar,"onUpdate:modelValue":h[44]||(h[44]=e=>Gs.value.name_ar=e),label:"üá∏üá¶ "+a.$t("rewardSys.behaviors.form.nameAr"),outlined:"",dense:"",dir:"rtl",readonly:Qs.value&&!Qs.value.teacher_id},{prepend:Q(()=>[q(l,{name:"translate"})]),_:1},8,["modelValue","label","readonly"]),q(V,{modelValue:Gs.value.type,"onUpdate:modelValue":h[45]||(h[45]=e=>Gs.value.type=e),options:[{label:a.$t("rewardSys.behaviors.form.types.positive"),value:"positive"},{label:a.$t("rewardSys.behaviors.form.types.negative"),value:"negative"}],label:a.$t("rewardSys.behaviors.form.type")+" *",outlined:"",dense:"","emit-value":"","map-options":"",rules:[e=>!!e||"Type is required"],readonly:Qs.value&&!Qs.value.teacher_id},null,8,["modelValue","options","label","rules","readonly"]),q(y,{modelValue:Gs.value.points,"onUpdate:modelValue":h[46]||(h[46]=e=>Gs.value.points=e),modelModifiers:{number:!0},label:a.$t("rewardSys.behaviors.form.points")+" *",type:"number",outlined:"",dense:"",rules:[e=>null!==e&&""!==e||"Points are required"],hint:"positive"===Gs.value.type?"Positive number (e.g., 5)":"Negative number (e.g., -3)",readonly:Qs.value&&!Qs.value.teacher_id},null,8,["modelValue","label","rules","hint","readonly"]),q(y,{modelValue:Gs.value.icon,"onUpdate:modelValue":h[47]||(h[47]=e=>Gs.value.icon=e),label:a.$t("rewardSys.behaviors.form.icon"),outlined:"",dense:"",hint:"Optional emoji, e.g., ‚≠ê üéâ ‚ö†Ô∏è üö´",readonly:Qs.value&&!Qs.value.teacher_id},null,8,["modelValue","label","readonly"])]),_:1}),q(f,{align:"right",class:"q-px-md q-pb-md"},{default:Q(()=>[X(q(o,{flat:"",label:a.$t("rewardSys.tabs.cancel")},null,8,["label"]),[[w]]),!Qs.value||Qs.value.teacher_id?(R(),O(o,{key:0,color:"primary",label:Qs.value?a.$t("common.update"):a.$t("common.create"),onClick:Co,loading:Ws.value},null,8,["label","loading"])):M("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),q(g,{modelValue:zs.value,"onUpdate:modelValue":h[50]||(h[50]=e=>zs.value=e),maximized:""},{default:Q(()=>[q(G(pe),{students:ts.value,"saved-layouts":Ts.value,"editing-layout":Us.value,onSave:ko,onDelete:$o,onClose:h[49]||(h[49]=e=>zs.value=!1)},null,8,["students","saved-layouts","editing-layout"])]),_:1},8,["modelValue"]),q(g,{modelValue:Ps.value,"onUpdate:modelValue":h[56]||(h[56]=e=>Ps.value=e)},{default:Q(()=>[q(ne,{mode:Ds.value,"competition-start-time":Fs.value,"date-from":Ls.value,"date-to":Rs.value,"leaderboard-mode":qs.value,"onUpdate:mode":h[51]||(h[51]=e=>Ds.value=e),"onUpdate:competitionStartTime":h[52]||(h[52]=e=>Fs.value=e),"onUpdate:dateFrom":h[53]||(h[53]=e=>Ls.value=e),"onUpdate:dateTo":h[54]||(h[54]=e=>Rs.value=e),"onUpdate:leaderboardMode":h[55]||(h[55]=e=>qs.value=e),onApply:Mo,onReset:Qo},null,8,["mode","competition-start-time","date-from","date-to","leaderboard-mode"])]),_:1},8,["modelValue"]),q(g,{modelValue:Js.value,"onUpdate:modelValue":h[57]||(h[57]=e=>Js.value=e),position:"top"},{default:Q(()=>[q(r,{style:{"min-width":"350px","border-radius":"20px"},class:"q-ma-md bg-deep-purple-8 text-white shadow-2xl"},{default:Q(()=>[q(t,{class:"column items-center text-center q-pa-lg"},{default:Q(()=>{var e,a;return[q(m,{size:"80px",class:"q-mb-md shadow-lg border-4 border-white"},{default:Q(()=>[Ys.value.student&&Ys.value.student.avatar?(R(),L("img",{key:0,src:io(Ys.value.student)},null,8,Dl)):(R(),O(l,{key:1,name:"person"}))]),_:1}),B("div",Nl,W(null==(e=Ys.value.student)?void 0:e.name),1),B("div",Fl,[B("span",{class:ee(Ys.value.points>0?"text-green-300":"text-red-300")},W(Ys.value.points>0?"+":"")+W(Ys.value.points),3),B("span",Ll,W((null==(a=Ys.value.behavior)?void 0:a.icon)||"‚≠ê"),1)]),B("div",Rl,W(Ql(Ys.value.behavior)),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"])])],64)}}},[["__scopeId","data-v-c4d20c62"]]);export{ql as default};
