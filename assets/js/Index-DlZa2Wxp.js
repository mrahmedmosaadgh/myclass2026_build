import{a as e,f as o,L as r,I as a,b as s,M as t,y as l,a3 as i,H as n,O as c,J as m,V as d,F as u,Z as p,_ as y}from"./vendor-CUZ9QTQV.js";import{_ as v}from"./PrimaryButton-DNYxrPcC.js";import{_ as f}from"./Pagination-CZ87PeIC.js";import{_ as j}from"./DataTable-CQiV1Hx1.js";import{_ as b}from"./FormModal-C8Fr0242.js";import"./LucideIcon-BIJr1cpK.js";import"./createLucideIcon-D8qi68V_.js";import"./align-right-BZZ7ajs4.js";import"./underline-o77cex9c.js";import"./image-odJN2dKV.js";import"./printer-D7revZzT.js";import"./Modal-BVf9TNwG.js";import"./app-C-NJhdpe.js";import"./offline-BzIlwqNM.js";import"./i18n-CP46N9fu.js";import"./ui-LrZmvB2D.js";import"./SecondaryButton-BH3tlEGv.js";const g={class:"py-12"},h={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},w={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},S={class:"flex justify-between items-center mb-6"},x={__name:"Index",props:{records:{type:Object,required:!0},schools:{type:Array,required:!0}},setup(x){const k=x,_=[{name:"name",label:"Name",type:"text",required:!0,autofocus:!0},{name:"description",label:"Description",type:"textarea"},{name:"school_id",label:"School",type:"select",required:!0,options:e(()=>k.schools.map(e=>({value:e.id,label:e.name})))}],A=o(!1),D=o(null),q=o(!1),I=(e=null)=>{D.value=e,A.value=!0},C=()=>{A.value=!1,D.value=null},F=()=>{y.reload({only:["records"],preserveScroll:!0,preserveState:!0})},L=async({form:e,onSuccess:o,onError:r})=>{var a,s,t;if(q.value)return;q.value=!0;const l=null==(a=D.value)?void 0:a.id,i=l?`/admin/stage/${l}`:"/admin/stage";try{await p.post(i,{...l&&{_method:"PUT"},...e}),o(),C(),F()}catch(n){console.error("Submission error:",n),r((null==(t=null==(s=n.response)?void 0:s.data)?void 0:t.errors)||{error:["An error occurred"]})}finally{q.value=!1}},M=async e=>{if(confirm("Are you sure you want to delete this stage?"))try{await p.delete(`/admin/stage/${e.id}`),F()}catch(o){console.error("Deletion error:",o),alert("An error occurred while deleting the record.")}};return(e,o)=>(a(),r(u,null,[s(l(i),{title:"Stages"}),t("div",g,[t("div",h,[t("div",w,[t("div",S,[s(v,{onClick:o[0]||(o[0]=e=>I())},{default:m(()=>o[1]||(o[1]=[d(" Create New Stage ")])),_:1})]),s(j,{columns:[{key:"name",label:"Name"},{key:"description",label:"Description"},{key:"school.name",label:"School"},{key:"actions",label:"Actions"}],items:x.records.data,loading:!1,onEdit:I,onDelete:M},null,8,["items"]),x.records.meta?(a(),n(f,{key:0,links:x.records.meta.links,class:"mt-6"},null,8,["links"])):c("",!0)])])]),s(b,{show:A.value,title:"Stage",fields:_,editing:D.value,onClose:C,onSubmitted:L},null,8,["show","editing"])],64))}};export{x as default};
