const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/html2pdf-B9Lz9h-9.js","assets/js/vendor-BWKGNkNB.js"])))=>i.map(i=>d[i]);
import{r as e,Q as l,d as a,b as s,t,e as n,_ as o,G as r}from"./app-CWAnT6CT.js";import{Q as d}from"./QTd-7QzJJbSb.js";import{Q as i}from"./QBadge-D8mJvg-f.js";import{Q as c}from"./QEditor-DokZzLXq.js";import{Q as u}from"./QTable-CegydSFg.js";import{Q as m,a as p}from"./QToolbar-oT7Dn8Ft.js";import{u as y}from"./i18n-B0T1C7j3.js";import w from"./StatusBadge-DgbgdRkM.js";import{f as v,a as b,N as k,J as h,O as f,b as _,F as g,Q as x,R as P,V as j,z as C,K as T,W as N,a0 as q,I as L,S as M}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./use-fullscreen-6qPmzoi_.js";import"./QMarkupTable-2zMPstj6.js";import"./QSelect-5P1Qxg14.js";import"./rtl-Cr6c3OOr.js";import"./QLinearProgress-DmE3hCo3.js";const V={class:"classrooms-grid"},z={class:"classroom-header bg-primary text-white q-pa-md"},Q={class:"q-ma-none flex items-center q-gutter-sm"},H={key:0,class:"inline-edit-cell-vertical"},D={class:"editor-header"},E={class:"text-caption text-weight-medium q-ml-xs"},B={key:1},$={key:0,class:"text-info html-content"},O=["innerHTML"],S={key:1,class:"text-grey-5"},U={key:0,class:"inline-edit-cell-vertical"},R={class:"editor-header"},A={class:"text-caption text-weight-medium q-ml-xs"},W={key:1},F={key:0,class:"text-warning html-content"},I=["innerHTML"],G={key:1,class:"text-grey-5"},J={key:0,class:"inline-edit-cell-vertical"},K={class:"editor-header"},Z={class:"text-caption text-weight-medium q-ml-xs"},X={key:1},Y=["innerHTML"],ee={key:1,class:"text-grey-5"},le={key:0,class:"text-center q-pa-xl"},ae={class:"text-h6 text-grey-7 q-mt-md"},se={class:"text-grey-6"},te={class:"text-h2 y-12"},ne={class:"text-h6 text-grey-7"},oe={class:"no-print"},re={class:"mobile-cards-container q-pa-md"},de={class:"day-title"},ie={class:"mobile-day-table"},ce={class:"period-col"},ue={class:"subject-col"},me={class:"cw-col"},pe={class:"hw-notes-col"},ye={class:"period-cell"},we={class:"period-badge"},ve={class:"subject-cell"},be={class:"subject-text"},ke={class:"content-cell-mobile"},he=["innerHTML"],fe={key:1,class:"text-grey-5 text-center"},_e={class:"content-cell-mobile"},ge={key:0,class:"content-section"},xe={class:"content-label"},Pe=["innerHTML"],je={key:1,class:"content-section"},Ce={class:"content-label"},Te=["innerHTML"],Ne={key:2,class:"text-grey-5 text-center"},qe=e({__name:"WeeklyPlanClassroomList",props:{plans:{type:Array,required:!0,default:()=>[]},days:{type:Object,required:!0},inlineEditMode:{type:Boolean,default:!1},copiedData:{type:Object,default:null},weekNumber:{type:[Number,String],default:1},semesterNumber:{type:[Number,String],default:1}},emits:["edit","save","paste"],setup(e,{expose:qe,emit:Le}){const{t:Me}=y(),Ve=e,ze=Le,Qe=v(!1),He=[["bold","italic","underline"],["link"],["unordered","ordered"],["undo","redo"]],De=b(()=>{const e={};return Ve.plans.forEach(l=>{var a,s;const t=null==(s=null==(a=l.schedule)?void 0:a.cst)?void 0:s.classroom_name;e[t]||(e[t]={name:t,plans:[]}),e[t].plans.push({id:l.id,data:l})}),Object.values(e).forEach(e=>{e.plans.sort((e,l)=>{var a,s,t,n;const o=((null==(a=e.data.schedule)?void 0:a.day)||0)-((null==(s=l.data.schedule)?void 0:s.day)||0);return 0!==o?o:((null==(t=e.data.schedule)?void 0:t.period_number)||0)-((null==(n=l.data.schedule)?void 0:n.period_number)||0)})}),Object.values(e).sort((e,l)=>e.name.localeCompare(l.name))}),Ee=b(()=>{const e={};return Ve.plans.forEach(l=>{var a;const s=null==(a=l.schedule)?void 0:a.day;e[s]||(e[s]={dayNumber:s,dayName:Ve.days[s]||Me(`weeklyPlans.fullDays.${s}`)||`Day ${s}`,plans:[]}),e[s].plans.push(l)}),Object.values(e).forEach(e=>{e.plans.sort((e,l)=>{var a,s;return((null==(a=e.schedule)?void 0:a.period_number)||0)-((null==(s=l.schedule)?void 0:s.period_number)||0)})}),Object.values(e).sort((e,l)=>e.dayNumber-l.dayNumber)}),Be=b(()=>[{name:"day",label:Me("weeklyPlans.day"),field:e=>{var l,a;return Ve.days[null==(l=e.data.schedule)?void 0:l.day]||Me(`weeklyPlans.fullDays.${null==(a=e.data.schedule)?void 0:a.day}`)||"N/A"},align:"left"},{name:"period",label:Me("weeklyPlans.period"),field:e=>{var l;return null==(l=e.data.schedule)?void 0:l.period_number},align:"center"},{name:"subject",label:Me("weeklyPlans.subject"),field:e=>{var l,a;return null==(a=null==(l=e.data.schedule)?void 0:l.cst)?void 0:a.subject_name},align:"left"},{name:"status",label:Me("weeklyPlans.status"),field:e=>e.data.status,align:"left"},{name:"cw",label:Me("weeklyPlans.classwork"),field:e=>e.data.cw,align:"left"},{name:"hw",label:Me("weeklyPlans.homework"),field:e=>e.data.hw,align:"left"},{name:"notes",label:Me("weeklyPlans.notes"),field:e=>e.data.notes,align:"left"}]),$e=()=>{window.print()},Oe=async()=>{var e;const l=(await o(async()=>{const{default:e}=await import("./html2pdf-B9Lz9h-9.js").then(e=>e.h);return{default:e}},__vite__mapDeps([0,1]))).default,a=document.querySelector(".mobile-cards-container");if(!a)return;const s={margin:[10,10],filename:`${((null==(e=De.value[0])?void 0:e.name)||"Weekly_Plans").replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"")}_Week_${Ve.weekNumber}_Semester_${Ve.semesterNumber}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,letterRendering:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["avoid-all","css","legacy"]}};l().set(s).from(a).save()},Se=e=>{ze("save",e)},Ue=(e,l)=>{if(!Ve.copiedData)return;const a=Ve.copiedData[l];void 0!==a&&(e[l]=a,ze("save",e))},Re=(e,l)=>{if(!e)return"";const a=e.replace(/<[^>]*>/g,"");if(a.length<=l)return e;return a.substring(0,l)+"..."};return qe({openMobilePrint:()=>{Qe.value=!0},downloadPDF:Oe}),(o,y)=>(h(),k("div",V,[(h(!0),k(g,null,x(De.value,n=>(h(),k("div",{key:n.name,class:"classroom-card q-mb-lg"},[_(a,{flat:"",bordered:""},{default:T(()=>[P("div",z,[P("h5",Q,[_(l,{name:"meeting_room"}),N(" "+j(n.name)+" ",1),_(r,{dense:"",label:`${n.plans.length} ${C(Me)("weeklyPlans.classes")}`,"text-color":"white"},null,8,["label"])])]),_(u,{flat:"",bordered:"",rows:n.plans,columns:Be.value,"row-key":"id",dense:"",class:"classroom-table",onRowClick:y[3]||(y[3]=(e,l)=>o.$emit("edit",l.data))},{"body-cell-day":T(l=>[_(d,{props:l},{default:T(()=>{var a;return[P("strong",null,j(e.days[null==(a=l.row.data.schedule)?void 0:a.day]||"N/A"),1)]}),_:2},1032,["props"])]),"body-cell-period":T(e=>[_(d,{props:e,class:"text-center"},{default:T(()=>{var l;return[_(i,{label:`P${null==(l=e.row.data.schedule)?void 0:l.period_number}`},null,8,["label"])]}),_:2},1032,["props"])]),"body-cell-subject":T(e=>[_(d,{props:e},{default:T(()=>{var l,a,s,t,n,o;return[P("span",{class:"subject-badge",style:M({backgroundColor:null==(a=null==(l=e.row.data.schedule)?void 0:l.cst)?void 0:a.c_bg,color:null==(t=null==(s=e.row.data.schedule)?void 0:s.cst)?void 0:t.c_text})},j(null==(o=null==(n=e.row.data.schedule)?void 0:n.cst)?void 0:o.subject_name),5)]}),_:2},1032,["props"])]),"body-cell-status":T(e=>[_(d,{props:e},{default:T(()=>[_(w,{status:e.row.data.status},null,8,["status"])]),_:2},1032,["props"])]),"body-cell-cw":T(a=>[_(d,{props:a,class:"content-preview",onClick:y[0]||(y[0]=q(()=>{},["stop"]))},{default:T(()=>{var n;return[e.inlineEditMode?(h(),k("div",H,[P("div",D,[_(l,{name:"school",size:"xs",color:"blue"}),P("span",E,j(C(Me)("weeklyPlans.classwork")),1),(null==(n=e.copiedData)?void 0:n.cw)?(h(),L(s,{key:0,icon:"content_paste",size:"sm",flat:"",dense:"",color:"primary",onClick:e=>Ue(a.row.data,"cw")},{default:T(()=>[_(t,null,{default:T(()=>[N(j(C(Me)("weeklyPlans.teacher.pasteCw")),1)]),_:1})]),_:2},1032,["onClick"])):f("",!0)]),_(c,{modelValue:a.row.data.cw,"onUpdate:modelValue":e=>a.row.data.cw=e,"min-height":"5rem",toolbar:He,onBlur:e=>Se(a.row.data),class:"inline-editor"},null,8,["modelValue","onUpdate:modelValue","onBlur"])])):(h(),k("div",B,[a.row.data.cw?(h(),k("div",$,[_(l,{name:"school",size:"xs"}),P("span",{class:"q-ml-xs",innerHTML:Re(a.row.data.cw,50)},null,8,O)])):(h(),k("span",S,"-"))]))]}),_:2},1032,["props"])]),"body-cell-hw":T(a=>[_(d,{props:a,class:"content-preview",onClick:y[1]||(y[1]=q(()=>{},["stop"]))},{default:T(()=>{var n;return[e.inlineEditMode?(h(),k("div",U,[P("div",R,[_(l,{name:"home_work",size:"xs",color:"orange"}),P("span",A,j(C(Me)("weeklyPlans.homework")),1),(null==(n=e.copiedData)?void 0:n.hw)?(h(),L(s,{key:0,icon:"content_paste",size:"sm",flat:"",dense:"",color:"primary",onClick:e=>Ue(a.row.data,"hw")},{default:T(()=>[_(t,null,{default:T(()=>[N(j(C(Me)("weeklyPlans.teacher.pasteHw")),1)]),_:1})]),_:2},1032,["onClick"])):f("",!0)]),_(c,{modelValue:a.row.data.hw,"onUpdate:modelValue":e=>a.row.data.hw=e,"min-height":"5rem",toolbar:He,onBlur:e=>Se(a.row.data),class:"inline-editor"},null,8,["modelValue","onUpdate:modelValue","onBlur"])])):(h(),k("div",W,[a.row.data.hw?(h(),k("div",F,[_(l,{name:"home_work",size:"xs"}),P("span",{class:"q-ml-xs",innerHTML:Re(a.row.data.hw,50)},null,8,I)])):(h(),k("span",G,"-"))]))]}),_:2},1032,["props"])]),"body-cell-notes":T(a=>[_(d,{props:a,class:"content-preview",onClick:y[2]||(y[2]=q(()=>{},["stop"]))},{default:T(()=>{var n;return[e.inlineEditMode?(h(),k("div",J,[P("div",K,[_(l,{name:"note",size:"xs",color:"grey"}),P("span",Z,j(C(Me)("weeklyPlans.notes")),1),(null==(n=e.copiedData)?void 0:n.notes)?(h(),L(s,{key:0,icon:"content_paste",size:"sm",flat:"",dense:"",color:"primary",onClick:e=>Ue(a.row.data,"notes")},{default:T(()=>[_(t,null,{default:T(()=>[N(j(C(Me)("weeklyPlans.teacher.pasteNotes")),1)]),_:1})]),_:2},1032,["onClick"])):f("",!0)]),_(c,{modelValue:a.row.data.notes,"onUpdate:modelValue":e=>a.row.data.notes=e,"min-height":"5rem",toolbar:He,onBlur:e=>Se(a.row.data),class:"inline-editor"},null,8,["modelValue","onUpdate:modelValue","onBlur"])])):(h(),k("div",X,[a.row.data.notes?(h(),k("span",{key:0,class:"text-info html-content",innerHTML:Re(a.row.data.notes,40)},null,8,Y)):(h(),k("span",ee,"-"))]))]}),_:2},1032,["props"])]),_:2},1032,["rows","columns"])]),_:2},1024)]))),128)),De.value&&0!==De.value.length?f("",!0):(h(),k("div",le,[_(l,{name:"meeting_room",size:"64px",color:"grey-5"}),P("p",ae,j(C(Me)("weeklyPlans.teacher.noClassrooms")),1),P("p",se,j(C(Me)("weeklyPlans.teacher.selectToView")),1)])),_(n,{modelValue:Qe.value,"onUpdate:modelValue":y[5]||(y[5]=e=>Qe.value=e),maximized:""},{default:T(()=>[_(a,{class:"mobile-print-card"},{default:T(()=>[_(m,{class:"mobile-print-header sticky-top"},{default:T(()=>[_(p,{class:"text-center"},{default:T(()=>{var l;return[P("div",te,j((null==(l=De.value[0])?void 0:l.name)||C(Me)("weeklyPlans.weeklyLearningPlan")),1),P("div",ne,j(C(Me)("weeklyPlans.week"))+" "+j(e.weekNumber)+" - "+j(C(Me)("weeklyPlans.semester"))+" "+j(e.semesterNumber),1)]}),_:1}),P("div",oe,[_(s,{icon:"picture_as_pdf",class:"mx-12",flat:"",round:"",dense:"",onClick:Oe,color:"red-7"},{default:T(()=>[_(t,null,{default:T(()=>[N(j(C(Me)("weeklyPlans.teacher.downloadPdf")),1)]),_:1})]),_:1}),_(s,{icon:"print",class:"mx-12",flat:"",round:"",dense:"",onClick:$e},{default:T(()=>[_(t,null,{default:T(()=>[N(j(C(Me)("weeklyPlans.print")),1)]),_:1})]),_:1}),_(s,{icon:"close",flat:"",round:"",dense:"",onClick:y[4]||(y[4]=e=>Qe.value=!1)},{default:T(()=>[_(t,null,{default:T(()=>[N(j(C(Me)("common.close")||C(Me)("weeklyPlans.close")||"Close"),1)]),_:1})]),_:1})])]),_:1}),P("div",re,[(h(!0),k(g,null,x(Ee.value,a=>(h(),k("div",{key:a.dayNumber,class:"day-group q-mb-lg"},[P("div",de,j(C(Me)("weeklyPlans.week"))+" "+j(e.weekNumber)+" - "+j(a.dayName),1),P("table",ie,[P("thead",null,[P("tr",null,[P("th",ce,j(C(Me)("weeklyPlans.period")),1),P("th",ue,j(C(Me)("weeklyPlans.subject")),1),P("th",me,j(C(Me)("weeklyPlans.classwork")),1),P("th",pe,j(C(Me)("weeklyPlans.homework"))+" / "+j(C(Me)("weeklyPlans.notes")),1)])]),P("tbody",null,[(h(!0),k(g,null,x(a.plans,e=>{var a,s,t;return h(),k("tr",{key:e.id},[P("td",ye,[P("div",we,j(null==(a=e.schedule)?void 0:a.period_number),1)]),P("td",ve,[P("div",be,j(null==(t=null==(s=e.schedule)?void 0:s.cst)?void 0:t.subject_name),1)]),P("td",ke,[e.cw?(h(),k("div",{key:0,class:"content-text",innerHTML:e.cw},null,8,he)):(h(),k("div",fe,"-"))]),P("td",_e,[e.hw?(h(),k("div",ge,[P("div",xe,[_(l,{name:"home_work",size:"xs",color:"orange"}),P("span",null,j(C(Me)("weeklyPlans.teacher.hwLabel")),1)]),P("div",{class:"content-text",innerHTML:e.hw},null,8,Pe)])):f("",!0),e.notes?(h(),k("div",je,[P("div",Ce,[_(l,{name:"note",size:"xs",color:"grey-7"}),P("span",null,j(C(Me)("weeklyPlans.teacher.notesLabel")),1)]),P("div",{class:"content-text",innerHTML:e.notes},null,8,Te)])):f("",!0),e.hw||e.notes?f("",!0):(h(),k("div",Ne," - "))])])}),128))])])]))),128))])]),_:1})]),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-41bd4b5e"]]);export{qe as default};
