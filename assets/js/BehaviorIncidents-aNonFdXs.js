import{u as e,Q as a,aE as t,d as l,m as n,c as i,f as o,k as s,l as d,b as r,C as c,p as u,aP as v}from"./app-B77gjd5a.js";import{Q as p}from"./QBtnToggle-BRf5Indz.js";import{Q as m}from"./QBadge-ZkvAqPBD.js";import{Q as f,a as g}from"./QToolbar-D9EsGUqs.js";import{Q as y}from"./QSelect-DB_tK-Lk.js";import{f as _,a as b,o as h,k as x,M as w,J as V,N as I,Q as S,b as A,V as k,F as D,R as T,K as C,y as j,W as E,I as N,_ as U,U as $}from"./vendor-DuKqz2x4.js";import M from"./StudentCard-BFf2HGpB.js";import P from"./IncidentPrintReport-5BmMnZqP.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./rtl-Cr6c3OOr.js";import"./AvatarManager-BORxz7Tb.js";import"./CameraCapture-DRfCgzbb.js";const L={class:"behavior-incidents-container"},B={class:"flex justify-between items-center mb-6"},H={class:"text-2xl font-bold text-gray-800"},R={class:"flex gap-2"},q={class:"mb-6"},Q={class:"flex justify-between items-center mb-4"},z={class:"text-lg font-bold text-gray-700"},G={class:"flex gap-2"},O={class:"flex flex-wrap justify-center gap-4"},F={key:0,class:"mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200"},W={class:"flex items-center justify-between"},J={class:"font-bold text-blue-800"},K={class:"flex flex-wrap gap-2 mt-2"},Y={class:"space-y-4"},X={key:0,class:"text-center py-8"},Z={class:"text-gray-500 mt-2"},ee={key:1,class:"text-center py-12 bg-gray-50 rounded-lg"},ae={class:"text-gray-500 mt-2"},te={key:2,class:"grid grid-cols-1 gap-4"},le={class:"flex justify-between items-start"},ne={class:"flex-1"},ie={class:"flex items-center gap-2 mb-2"},oe={class:"text-sm text-gray-500"},se={class:"text-lg font-bold text-gray-800 mb-1"},de={class:"grid grid-cols-2 gap-2 text-sm mt-3"},re={class:"font-semibold text-gray-600"},ce={class:"ml-1"},ue={class:"font-semibold text-gray-600"},ve={class:"ml-1"},pe={class:"flex gap-1"},me={class:"text-sm text-gray-700 italic"},fe={class:"max-w-6xl mx-auto"},ge={class:"mb-6 p-4 bg-blue-50 rounded-lg"},ye={class:"font-bold text-blue-900 mb-2"},_e={class:"flex flex-wrap gap-2"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},he={class:"space-y-4"},xe={class:"text-subtitle1 font-bold text-blue-900"},we={class:"grid grid-cols-2 gap-3"},Ve={class:"text-subtitle1 font-bold text-orange-900"},Ie={class:"space-y-4"},Se={class:"text-subtitle1 font-bold text-green-900"},Ae={class:"text-subtitle1 font-bold text-purple-900"},ke={class:"text-subtitle1 font-bold text-gray-900"},De={class:"flex justify-between items-center"},Te={class:"text-h6"},Ce={class:"grid grid-cols-2 gap-4"},je={class:"text-sm font-semibold text-gray-600"},Ee={class:"text-base"},Ne={class:"text-sm font-semibold text-gray-600"},Ue={class:"text-base"},$e={class:"text-sm font-semibold text-gray-600"},Me={class:"text-base"},Pe={class:"text-sm font-semibold text-gray-600"},Le={class:"text-base"},Be={class:"text-sm font-semibold text-gray-600"},He={class:"text-base"},Re={class:"text-sm font-semibold text-gray-600"},qe={class:"text-base"},Qe={class:"text-sm font-semibold text-gray-600"},ze={class:"text-base"},Ge={class:"text-sm font-semibold text-gray-600"},Oe={class:"text-base"},Fe={class:"text-sm font-semibold text-gray-600"},We={class:"text-base"},Je={class:"text-sm font-semibold text-gray-600"},Ke={class:"text-base"},Ye={key:0},Xe={class:"text-sm font-semibold text-gray-600"},Ze={class:"text-base"},ea={class:"text-sm font-semibold text-gray-600"},aa={class:"text-base"},ta={class:"text-h6"},la={key:0,class:"text-subtitle2"},na={class:"text-gray-500 mt-2"},ia={class:"grid grid-cols-4 gap-4"},oa={class:"text-3xl font-bold text-blue-600"},sa={class:"text-sm text-gray-600"},da={class:"text-3xl font-bold text-yellow-600"},ra={class:"text-sm text-gray-600"},ca={class:"text-3xl font-bold text-red-600"},ua={class:"text-sm text-gray-600"},va={class:"text-3xl font-bold text-purple-600"},pa={class:"text-sm text-gray-600"},ma={class:"font-bold text-gray-700 mb-3"},fa={class:"space-y-2 max-h-96 overflow-y-auto"},ga={class:"flex justify-between items-start"},ya={class:"ml-2 text-sm text-gray-500"},_a={class:"text-sm"},ba={class:"font-semibold"},ha={class:"text-sm text-gray-600 mt-1"},xa={__name:"BehaviorIncidents",props:{students:{type:Array,required:!0},classroomId:{type:Number,required:!1},date:{type:String,required:!0},periodCode:{type:String,required:!0}},emits:["incident-recorded"],setup(xa,{emit:wa}){const Va=xa,Ia=wa,Sa=e(),Aa=_("en"),ka=_([]),Da=_(!1),Ta=_(!1),Ca=_(!1),ja=_(!1),Ea=_(!1),Na=_(!1),Ua=_(null),$a=_([]),Ma=_({}),Pa=_(null),La=_(!1),Ba=_({student_id:null,date:(new Date).toISOString().split("T")[0],time:(new Date).toTimeString().slice(0,5),incident_type:"Minor",location:"Classroom",behavior:"Disruption",description_en:"",description_ar:"",motivation:"Gain peer attention",others_involved:"None",teacher_action_en:"",teacher_action_ar:"",admin_action_en:"",admin_action_ar:"",follow_up_needed:!1}),Ha=["Minor","Major"],Ra=["Classroom","Playground","Hallway","Cafeteria","Library","Tech Lab","Gym","Bus"],qa=["Disruption","Physical Aggression","Noncompliance","Bullying","Property Misuse","Technology Violation","Teasing","Threats","Inappropriate Language","Defiance / Insubordination"],Qa=["Gain peer attention","Gain items/activities","Avoid task","Escape/Avoid peer or adult"],za=["None","Peers","Staff","Multiple students"],Ga={en:{title:"Behavior Incidents",printReport:"Print Report",selectStudents:"Select Students",selectAll:"Select All",clear:"Clear",recordIncident:"Record Incident",selectedStudents:"Selected Students",loadingIncidents:"Loading incidents...",noIncidents:"No behavior incidents recorded yet",location:"Location",behavior:"Behavior",viewDetails:"View Details",delete:"Delete",whenWhere:"When & Where",date:"Date",time:"Time",incidentDetails:"Incident Details",incidentType:"Incident Type",motivation:"Motivation",othersInvolved:"Others Involved",description:"Description",descriptionEn:"Description (English)",descriptionAr:"Description (Arabic)",actionsTaken:"Actions Taken",teacherActionEn:"Teacher Action (English)",teacherActionAr:"Teacher Action (Arabic)",adminActionEn:"Admin Action (English)",followUpNeeded:"Follow-up Needed",quickActions:"Quick Actions",loadLastSettings:"Load Last Incident Settings",saveAsTemplate:"Save as Template",cancel:"Cancel",save:"Record Incident",close:"Close",student:"Student",grade:"Grade",dateTime:"Date & Time",viewStudentHistory:"View Student History",studentBehaviorHistory:"Student Behavior History",last90Days:"Last 90 Days",loadingHistory:"Loading history...",totalIncidents:"Total Incidents",minor:"Minor",major:"Major",netPoints:"Net Points",recentIncidents:"Recent Incidents",confirmDelete:"Confirm Delete",confirmDeleteMsg:"Are you sure you want to delete this incident for",yes:"Yes",no:"No"},ar:{title:"Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø³Ù„ÙˆÙƒ",printReport:"Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±",selectStudents:"Ø§Ø®ØªØ± Ø§Ù„Ø·Ù„Ø§Ø¨",selectAll:"Ø§Ø®ØªØ± Ø§Ù„ÙƒÙ„",clear:"Ù…Ø³Ø­",recordIncident:"ØªØ³Ø¬ÙŠÙ„ Ø­Ø§Ø¯Ø«Ø©",selectedStudents:"Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø®ØªØ§Ø±ÙˆÙ†",loadingIncidents:"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­ÙˆØ§Ø¯Ø«...",noIncidents:"Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Ø­ÙˆØ§Ø¯Ø« Ø³Ù„ÙˆÙƒ Ø¨Ø¹Ø¯",location:"Ø§Ù„Ù…ÙˆÙ‚Ø¹",behavior:"Ø§Ù„Ø³Ù„ÙˆÙƒ",viewDetails:"Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„",delete:"Ø­Ø°Ù",whenWhere:"Ù…ØªÙ‰ ÙˆØ£ÙŠÙ†",date:"Ø§Ù„ØªØ§Ø±ÙŠØ®",time:"Ø§Ù„ÙˆÙ‚Øª",incidentDetails:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø§Ø¯Ø«Ø©",incidentType:"Ù†ÙˆØ¹ Ø§Ù„Ø­Ø§Ø¯Ø«Ø©",motivation:"Ø§Ù„Ø¯Ø§ÙØ¹",othersInvolved:"Ø¢Ø®Ø±ÙˆÙ† Ù…ØªÙˆØ±Ø·ÙˆÙ†",description:"Ø§Ù„ÙˆØµÙ",descriptionEn:"Ø§Ù„ÙˆØµÙ (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)",descriptionAr:"Ø§Ù„ÙˆØµÙ (Ø¹Ø±Ø¨ÙŠ)",actionsTaken:"Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…ØªØ®Ø°Ø©",teacherActionEn:"Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¹Ù„Ù… (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)",teacherActionAr:"Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¹Ù„Ù… (Ø¹Ø±Ø¨ÙŠ)",adminActionEn:"Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© (Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ)",followUpNeeded:"ÙŠØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©",quickActions:"Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©",loadLastSettings:"ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",saveAsTemplate:"Ø­ÙØ¸ ÙƒÙ‚Ø§Ù„Ø¨",cancel:"Ø¥Ù„ØºØ§Ø¡",save:"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø­Ø§Ø¯Ø«Ø©",close:"Ø¥ØºÙ„Ø§Ù‚",student:"Ø§Ù„Ø·Ø§Ù„Ø¨",grade:"Ø§Ù„ØµÙ",dateTime:"Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª",viewStudentHistory:"Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø·Ø§Ù„Ø¨",studentBehaviorHistory:"Ø³Ø¬Ù„ Ø³Ù„ÙˆÙƒ Ø§Ù„Ø·Ø§Ù„Ø¨",last90Days:"Ø¢Ø®Ø± 90 ÙŠÙˆÙ…",loadingHistory:"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¬Ù„...",totalIncidents:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­ÙˆØ§Ø¯Ø«",minor:"Ø¨Ø³ÙŠØ·",major:"ÙƒØ¨ÙŠØ±",netPoints:"ØµØ§ÙÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·",recentIncidents:"Ø§Ù„Ø­ÙˆØ§Ø¯Ø« Ø§Ù„Ø£Ø®ÙŠØ±Ø©",confirmDelete:"ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù",confirmDeleteMsg:"Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ø¯Ø«Ø© Ù„Ù€",yes:"Ù†Ø¹Ù…",no:"Ù„Ø§"}},Oa=b(()=>Ga[Aa.value]);b(()=>Va.students.map(e=>({id:e.id,name:`${e.firstName} ${e.lastName}`})));const Fa=b(()=>0===$a.value.length?Va.students:Va.students.filter(e=>$a.value.includes(e.id))),Wa=b(()=>0===$a.value.length?ka.value:ka.value.filter(e=>$a.value.includes(e.student_id)));function Ja(e){const a=$a.value.indexOf(e);-1===a?$a.value.push(e):$a.value.splice(a,1)}function Ka(){$a.value=Va.students.map(e=>e.id)}function Ya(e){const a=Va.students.find(a=>a.id===e);return a?`${a.firstName} ${a.lastName}`:"Unknown"}function Xa(){0!==$a.value.length?(et(),Ca.value=!0):Sa.notify({message:"Please select at least one student",color:"warning",position:"top"})}function Za(){$a.value.length>0&&Sa.notify({message:`Printing report for ${$a.value.length} selected student(s)`,color:"info",position:"top"}),Ea.value=!0}function et(){const e=localStorage.getItem("behavior_incident_template");if(e)try{const a=JSON.parse(e);Ba.value={...Ba.value,incident_type:a.incident_type||Ba.value.incident_type,location:a.location||Ba.value.location,behavior:a.behavior||Ba.value.behavior,motivation:a.motivation||Ba.value.motivation,others_involved:a.others_involved||Ba.value.others_involved,teacher_action_en:a.teacher_action_en||"",teacher_action_ar:a.teacher_action_ar||""}}catch(a){console.error("Error loading saved settings:",a)}}function at(){et(),Sa.notify({message:"Last settings loaded",color:"positive",position:"top"})}function tt(){const e={incident_type:Ba.value.incident_type,location:Ba.value.location,behavior:Ba.value.behavior,motivation:Ba.value.motivation,others_involved:Ba.value.others_involved,teacher_action_en:Ba.value.teacher_action_en,teacher_action_ar:Ba.value.teacher_action_ar};localStorage.setItem("behavior_incident_template",JSON.stringify(e)),Sa.notify({message:"Settings saved as template",color:"positive",position:"top",icon:"save"})}async function lt(){Da.value=!0;try{const e=await U.get("/api/behavior-incidents",{params:{classroom_id:Va.classroomId,date:Va.date}});ka.value=e.data.data||[]}catch(e){console.error("Error loading incidents:",e),Sa.notify({message:"Failed to load incidents",color:"negative",position:"top"})}finally{Da.value=!1}}async function nt(){var e,a;if(!Ba.value.description_en)return void Sa.notify({message:"Please fill in required fields",color:"warning",position:"top"});Ta.value=!0;let t=0,l=0;try{tt();for(const e of $a.value)try{const a=Va.students.find(a=>a.id===e),l={student_id:e,student_name:`${a.firstName} ${a.lastName}`,grade:a.grade||5,date:Ba.value.date,time:Ba.value.time,classroom_id:Va.classroomId,period_code:Va.periodCode,incident_type:{en:Ba.value.incident_type,ar:"Minor"===Ba.value.incident_type?"Ø³Ù„ÙˆÙƒ Ø¨Ø³ÙŠØ·":"Ø³Ù„ÙˆÙƒ ÙƒØ¨ÙŠØ±"},location:{en:Ba.value.location,ar:dt(Ba.value.location)},behavior:{en:Ba.value.behavior,ar:rt(Ba.value.behavior)},description:{en:Ba.value.description_en,ar:Ba.value.description_ar||Ba.value.description_en},motivation:{en:Ba.value.motivation,ar:ct(Ba.value.motivation)},others_involved:{en:Ba.value.others_involved,ar:ut(Ba.value.others_involved)},teacher_action:{en:Ba.value.teacher_action_en,ar:Ba.value.teacher_action_ar||Ba.value.teacher_action_en},admin_action:Ba.value.admin_action_en?{en:Ba.value.admin_action_en,ar:Ba.value.admin_action_ar||Ba.value.admin_action_en}:null,follow_up_needed:Ba.value.follow_up_needed},n=await U.post("/api/behavior-incidents",l);t++,Ia("incident-recorded",n.data)}catch(n){console.error(`Error saving incident for student ${e}:`,n),l++}t>0&&Sa.notify({message:`${t} incident(s) recorded successfully (-1 point each)`,color:"positive",position:"top",icon:"check_circle"}),l>0&&Sa.notify({message:`${l} incident(s) failed to save`,color:"warning",position:"top"}),Ca.value=!1,$a.value=[],st(),await lt()}catch(n){console.error("Error saving incidents:",n),Sa.notify({message:"Failed to save incidents: "+((null==(a=null==(e=n.response)?void 0:e.data)?void 0:a.message)||n.message),color:"negative",position:"top"})}finally{Ta.value=!1}}async function it(e){if(e){La.value=!0,Na.value=!0;try{const a=await async function(e){if(Ma.value[e])return Ma.value[e];try{const a=await U.get(`/api/behavior-incidents/student/${e}/report`,{params:{start_date:new Date(Date.now()-7776e6).toISOString().split("T")[0],end_date:(new Date).toISOString().split("T")[0]}});return Ma.value[e]=a.data.data,a.data.data}catch(a){return console.error("Error loading student history:",a),null}}(e);Pa.value=a}catch(a){console.error("Error loading student history:",a),Sa.notify({message:"Failed to load student history",color:"negative",position:"top"})}finally{La.value=!1}}}function ot(e){Sa.dialog({title:"Confirm Delete",message:`Are you sure you want to delete this incident for ${e.student_name}?`,cancel:!0,persistent:!0,color:"negative"}).onOk(async()=>{await async function(e){try{await U.delete(`/api/behavior-incidents/${e}`),Sa.notify({message:"Incident deleted successfully",color:"positive",position:"top"}),await lt()}catch(a){console.error("Error deleting incident:",a),Sa.notify({message:"Failed to delete incident",color:"negative",position:"top"})}}(e.id)})}function st(){Ba.value={student_id:null,date:(new Date).toISOString().split("T")[0],time:(new Date).toTimeString().slice(0,5),incident_type:"Minor",location:"Classroom",behavior:"Disruption",description_en:"",description_ar:"",motivation:"Gain peer attention",others_involved:"None",teacher_action_en:"",teacher_action_ar:"",admin_action_en:"",admin_action_ar:"",follow_up_needed:!1}}function dt(e){return{Classroom:"Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ",Playground:"Ø³Ø§Ø­Ø© Ø§Ù„Ù„Ø¹Ø¨",Hallway:"Ø§Ù„Ù…Ù…Ø±",Cafeteria:"Ø§Ù„Ù…Ù‚ØµÙ",Library:"Ø§Ù„Ù…ÙƒØªØ¨Ø©","Tech Lab":"Ù…Ø¹Ù…Ù„ Ø§Ù„ØªÙ‚Ù†ÙŠØ©",Gym:"Ø§Ù„ØµØ§Ù„Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©",Bus:"Ø§Ù„Ø­Ø§ÙÙ„Ø©"}[e]||e}function rt(e){return{Disruption:"Ø¥Ø­Ø¯Ø§Ø« ÙÙˆØ¶Ù‰","Physical Aggression":"Ø§Ø¹ØªØ¯Ø§Ø¡ Ø¨Ø¯Ù†ÙŠ",Noncompliance:"Ø¹Ø¯Ù… Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„",Bullying:"ØªÙ†Ù…Ù‘Ø±","Property Misuse":"Ø³ÙˆØ¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù…ØªÙ„ÙƒØ§Øª","Technology Violation":"Ù…Ø®Ø§Ù„ÙØ© ØªÙ‚Ù†ÙŠØ©",Teasing:"Ø³Ø®Ø±ÙŠØ©",Threats:"ØªÙ‡Ø¯ÙŠØ¯Ø§Øª","Inappropriate Language":"Ù„ØºØ© ØºÙŠØ± Ù„Ø§Ø¦Ù‚Ø©","Defiance / Insubordination":"Ø¹ØµÙŠØ§Ù† / Ø¹Ø¯Ù… Ø§Ø­ØªØ±Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª"}[e]||e}function ct(e){return{"Gain peer attention":"Ø¬Ø°Ø¨ Ø§Ù†ØªØ¨Ø§Ù‡ Ø§Ù„Ø²Ù…Ù„Ø§Ø¡","Gain items/activities":"Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ø´ÙŠØ§Ø¡ Ø£Ùˆ Ø£Ù†Ø´Ø·Ø©","Avoid task":"ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ù‡Ù…Ø©","Escape/Avoid peer or adult":"Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø²Ù…ÙŠÙ„ Ø£Ùˆ Ø´Ø®Øµ Ø¨Ø§Ù„Øº"}[e]||e}function ut(e){return{None:"Ù„Ø§ Ø£Ø­Ø¯",Peers:"Ø§Ù„Ø²Ù…Ù„Ø§Ø¡",Staff:"Ø£Ø­Ø¯ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†","Multiple students":"Ø¹Ø¯Ø© Ø·Ù„Ø§Ø¨"}[e]||e}return h(()=>{lt()}),x(()=>Va.date,()=>{lt()}),x(()=>Va.classroomId,()=>{lt()}),(e,_)=>(V(),w("div",L,[I("div",B,[I("h3",H,k(Oa.value.title),1),I("div",R,[A(a,{flat:"",icon:"print",label:Oa.value.printReport,onClick:Za,color:"primary"},null,8,["label"]),A(p,{modelValue:Aa.value,"onUpdate:modelValue":_[0]||(_[0]=e=>Aa.value=e),options:[{label:"English",value:"en"},{label:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",value:"ar"}],color:"primary","toggle-color":"primary",unelevated:""},null,8,["modelValue"])])]),I("div",q,[I("div",Q,[I("h4",z,k(Oa.value.selectStudents),1),I("div",G,[A(a,{flat:"",dense:"",color:"primary",label:Oa.value.selectAll,size:"sm",onClick:Ka},null,8,["label"]),A(a,{flat:"",dense:"",color:"primary",label:Oa.value.clear,size:"sm",onClick:_[1]||(_[1]=e=>$a.value=[])},null,8,["label"]),A(a,{color:"primary",icon:"add",label:`${Oa.value.recordIncident} (${$a.value.length})`,onClick:Xa,disable:0===$a.value.length,size:"md",class:"shadow-md"},null,8,["label","disable"])])]),I("div",O,[(V(!0),w(D,null,T(xa.students,e=>(V(),N(M,{key:e.id,student:e,selected:$a.value.includes(e.id),"avatar-edit-enabled":!1,onSelect:a=>Ja(e.id)},null,8,["student","selected","onSelect"]))),128))])]),$a.value.length>0?(V(),w("div",F,[I("div",W,[I("div",null,[I("span",J,k(Oa.value.selectedStudents)+" ("+k($a.value.length)+"):",1),I("div",K,[(V(!0),w(D,null,T($a.value,e=>(V(),N(c,{key:e,removable:"",onRemove:a=>Ja(e),color:"primary","text-color":"white",size:"sm"},{default:C(()=>[E(k(Ya(e)),1)]),_:2},1032,["onRemove"]))),128))])])])])):S("",!0),I("div",Y,[Da.value?(V(),w("div",X,[A(t,{color:"primary",size:"3rem"}),I("p",Z,k(Oa.value.loadingIncidents),1)])):0===ka.value.length?(V(),w("div",ee,[A(l,{name:"info",size:"3rem",color:"grey-5"}),I("p",ae,k(Oa.value.noIncidents),1)])):(V(),w("div",te,[(V(!0),w(D,null,T(ka.value,e=>(V(),N(n,{key:e.id,class:$(["shadow-md hover:shadow-lg transition-shadow","Major"===e.incident_type[Aa.value]||"Ø³Ù„ÙˆÙƒ ÙƒØ¨ÙŠØ±"===e.incident_type[Aa.value]?"border-l-4 border-red-500":"border-l-4 border-yellow-500"])},{default:C(()=>[A(i,{class:"pb-2"},{default:C(()=>[I("div",le,[I("div",ne,[I("div",ie,[A(m,{color:"Major"===e.incident_type[Aa.value]||"Ø³Ù„ÙˆÙƒ ÙƒØ¨ÙŠØ±"===e.incident_type[Aa.value]?"red":"orange",label:e.incident_type[Aa.value]},null,8,["color","label"]),I("span",oe,k(e.date)+" â€¢ "+k(e.time),1)]),I("h4",se,k(e.student_name)+" (Grade "+k(e.grade)+") ",1),I("div",de,[I("div",null,[I("span",re,k(Oa.value.location)+":",1),I("span",ce,k(e.location[Aa.value]),1)]),I("div",null,[I("span",ue,k(Oa.value.behavior)+":",1),I("span",ve,k(e.behavior[Aa.value]),1)])])]),I("div",pe,[A(a,{flat:"",round:"",dense:"",icon:"visibility",color:"primary",onClick:a=>function(e){Ua.value=e,ja.value=!0}(e)},{default:C(()=>[A(u,null,{default:C(()=>[E(k(Oa.value.viewDetails),1)]),_:1})]),_:2},1032,["onClick"]),A(a,{flat:"",round:"",dense:"",icon:"delete",color:"negative",onClick:a=>ot(e)},{default:C(()=>[A(u,null,{default:C(()=>[E(k(Oa.value.delete),1)]),_:1})]),_:2},1032,["onClick"])])])]),_:2},1024),A(i,{class:"pt-0"},{default:C(()=>[I("p",me,k(e.description[Aa.value]),1)]),_:2},1024)]),_:2},1032,["class"]))),128))]))]),A(r,{modelValue:Ca.value,"onUpdate:modelValue":_[15]||(_[15]=e=>Ca.value=e),persistent:"",maximized:""},{default:C(()=>[A(n,null,{default:C(()=>[A(f,{class:"bg-primary text-white"},{default:C(()=>[A(g,null,{default:C(()=>[E(k(Oa.value.recordIncident)+" - "+k($a.value.length)+" "+k(Oa.value.student)+"(s) ",1)]),_:1}),j(A(a,{flat:"",round:"",dense:"",icon:"close",onClick:st},null,512),[[v]])]),_:1}),A(i,{class:"q-pt-md"},{default:C(()=>[I("div",fe,[I("div",ge,[I("h5",ye,k(Oa.value.selectedStudents)+":",1),I("div",_e,[(V(!0),w(D,null,T($a.value,e=>(V(),N(c,{key:e,color:"primary","text-color":"white",icon:"person"},{default:C(()=>[E(k(Ya(e)),1)]),_:2},1024))),128))])]),I("div",be,[I("div",he,[A(n,{class:"shadow-sm"},{default:C(()=>[A(i,{class:"bg-blue-50"},{default:C(()=>[I("div",xe,"ðŸ“… "+k(Oa.value.whenWhere),1)]),_:1}),A(i,{class:"space-y-3"},{default:C(()=>[I("div",we,[A(o,{modelValue:Ba.value.date,"onUpdate:modelValue":_[2]||(_[2]=e=>Ba.value.date=e),label:`${Oa.value.date} *`,type:"date",outlined:"",dense:""},null,8,["modelValue","label"]),A(o,{modelValue:Ba.value.time,"onUpdate:modelValue":_[3]||(_[3]=e=>Ba.value.time=e),label:`${Oa.value.time} *`,type:"time",outlined:"",dense:""},null,8,["modelValue","label"])]),A(y,{modelValue:Ba.value.location,"onUpdate:modelValue":_[4]||(_[4]=e=>Ba.value.location=e),options:Ra,label:`${Oa.value.location} *`,outlined:"",dense:""},{prepend:C(()=>[A(l,{name:"place"})]),_:1},8,["modelValue","label"])]),_:1})]),_:1}),A(n,{class:"shadow-sm"},{default:C(()=>[A(i,{class:"bg-orange-50"},{default:C(()=>[I("div",Ve,"âš ï¸ "+k(Oa.value.incidentDetails),1)]),_:1}),A(i,{class:"space-y-3"},{default:C(()=>[A(y,{modelValue:Ba.value.incident_type,"onUpdate:modelValue":_[5]||(_[5]=e=>Ba.value.incident_type=e),options:Ha,label:`${Oa.value.incidentType} *`,outlined:"",dense:""},{prepend:C(()=>[A(l,{name:"warning"})]),_:1},8,["modelValue","label"]),A(y,{modelValue:Ba.value.behavior,"onUpdate:modelValue":_[6]||(_[6]=e=>Ba.value.behavior=e),options:qa,label:`${Oa.value.behavior} *`,outlined:"",dense:""},{prepend:C(()=>[A(l,{name:"psychology"})]),_:1},8,["modelValue","label"]),A(y,{modelValue:Ba.value.motivation,"onUpdate:modelValue":_[7]||(_[7]=e=>Ba.value.motivation=e),options:Qa,label:Oa.value.motivation,outlined:"",dense:""},{prepend:C(()=>[A(l,{name:"lightbulb"})]),_:1},8,["modelValue","label"]),A(y,{modelValue:Ba.value.others_involved,"onUpdate:modelValue":_[8]||(_[8]=e=>Ba.value.others_involved=e),options:za,label:Oa.value.othersInvolved,outlined:"",dense:""},{prepend:C(()=>[A(l,{name:"group"})]),_:1},8,["modelValue","label"])]),_:1})]),_:1})]),I("div",Ie,[A(n,{class:"shadow-sm"},{default:C(()=>[A(i,{class:"bg-green-50"},{default:C(()=>[I("div",Se,"ðŸ“ "+k(Oa.value.description),1)]),_:1}),A(i,{class:"space-y-3"},{default:C(()=>[A(o,{modelValue:Ba.value.description_en,"onUpdate:modelValue":_[9]||(_[9]=e=>Ba.value.description_en=e),label:`${Oa.value.descriptionEn} *`,type:"textarea",outlined:"",dense:"",rows:"3"},null,8,["modelValue","label"]),A(o,{modelValue:Ba.value.description_ar,"onUpdate:modelValue":_[10]||(_[10]=e=>Ba.value.description_ar=e),label:Oa.value.descriptionAr,type:"textarea",outlined:"",dense:"",rows:"3"},null,8,["modelValue","label"])]),_:1})]),_:1}),A(n,{class:"shadow-sm"},{default:C(()=>[A(i,{class:"bg-purple-50"},{default:C(()=>[I("div",Ae,"âœ… "+k(Oa.value.actionsTaken),1)]),_:1}),A(i,{class:"space-y-3"},{default:C(()=>[A(o,{modelValue:Ba.value.teacher_action_en,"onUpdate:modelValue":_[11]||(_[11]=e=>Ba.value.teacher_action_en=e),label:Oa.value.teacherActionEn,outlined:"",dense:"",placeholder:"e.g., Verbal warning, Seat change"},null,8,["modelValue","label"]),A(o,{modelValue:Ba.value.teacher_action_ar,"onUpdate:modelValue":_[12]||(_[12]=e=>Ba.value.teacher_action_ar=e),label:Oa.value.teacherActionAr,outlined:"",dense:""},null,8,["modelValue","label"]),A(o,{modelValue:Ba.value.admin_action_en,"onUpdate:modelValue":_[13]||(_[13]=e=>Ba.value.admin_action_en=e),label:Oa.value.adminActionEn,outlined:"",dense:"",placeholder:"Optional - if admin involved"},null,8,["modelValue","label"]),A(s,{modelValue:Ba.value.follow_up_needed,"onUpdate:modelValue":_[14]||(_[14]=e=>Ba.value.follow_up_needed=e),label:Oa.value.followUpNeeded,color:"orange"},null,8,["modelValue","label"])]),_:1})]),_:1}),A(n,{class:"shadow-sm"},{default:C(()=>[A(i,{class:"bg-gray-50"},{default:C(()=>[I("div",ke,"âš¡ "+k(Oa.value.quickActions),1)]),_:1}),A(i,{class:"space-y-2"},{default:C(()=>[A(a,{flat:"",dense:"",color:"primary",icon:"history",label:Oa.value.loadLastSettings,onClick:at,class:"w-full"},null,8,["label"]),A(a,{flat:"",dense:"",color:"secondary",icon:"save",label:Oa.value.saveAsTemplate,onClick:tt,class:"w-full"},null,8,["label"])]),_:1})]),_:1})])])])]),_:1}),A(d,{align:"right",class:"q-px-md q-pb-md"},{default:C(()=>[j(A(a,{flat:"",label:Oa.value.cancel,onClick:st},null,8,["label"]),[[v]]),A(a,{color:"primary",label:Oa.value.save,onClick:nt,loading:Ta.value},null,8,["label","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(r,{modelValue:Ea.value,"onUpdate:modelValue":_[16]||(_[16]=e=>Ea.value=e),maximized:""},{default:C(()=>[A(n,null,{default:C(()=>[A(f,{class:"bg-primary text-white"},{default:C(()=>[A(g,null,{default:C(()=>[E(k(Oa.value.printReport),1)]),_:1}),j(A(a,{flat:"",round:"",dense:"",icon:"close"},null,512),[[v]])]),_:1}),A(i,null,{default:C(()=>[A(P,{incidents:Wa.value,students:Fa.value,"classroom-id":xa.classroomId,date:xa.date,language:Aa.value},null,8,["incidents","students","classroom-id","date","language"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(r,{modelValue:ja.value,"onUpdate:modelValue":_[18]||(_[18]=e=>ja.value=e),"full-width":""},{default:C(()=>[A(n,{style:{"max-width":"900px",width:"100%"}},{default:C(()=>[A(i,{class:"bg-primary text-white"},{default:C(()=>[I("div",De,[I("div",Te,k(Oa.value.viewDetails),1),A(a,{flat:"",dense:"",icon:"history",label:Oa.value.viewStudentHistory,onClick:_[17]||(_[17]=e=>{var a;return it(null==(a=Ua.value)?void 0:a.student_id)})},null,8,["label"])])]),_:1}),Ua.value?(V(),N(i,{key:0,class:"space-y-3"},{default:C(()=>[I("div",Ce,[I("div",null,[I("p",je,k(Oa.value.student),1),I("p",Ee,k(Ua.value.student_name),1)]),I("div",null,[I("p",Ne,k(Oa.value.grade),1),I("p",Ue,k(Ua.value.grade),1)]),I("div",null,[I("p",$e,k(Oa.value.dateTime),1),I("p",Me,k(Ua.value.date)+" "+k(Ua.value.time),1)]),I("div",null,[I("p",Pe,k(Oa.value.incidentType),1),I("p",Le,k(Ua.value.incident_type[Aa.value]),1)]),I("div",null,[I("p",Be,k(Oa.value.location),1),I("p",He,k(Ua.value.location[Aa.value]),1)]),I("div",null,[I("p",Re,k(Oa.value.behavior),1),I("p",qe,k(Ua.value.behavior[Aa.value]),1)])]),I("div",null,[I("p",Qe,k(Oa.value.description),1),I("p",ze,k(Ua.value.description[Aa.value]),1)]),I("div",null,[I("p",Ge,k(Oa.value.motivation),1),I("p",Oe,k(Ua.value.motivation[Aa.value]),1)]),I("div",null,[I("p",Fe,k(Oa.value.othersInvolved),1),I("p",We,k(Ua.value.others_involved[Aa.value]),1)]),I("div",null,[I("p",Je,k(Oa.value.teacherActionEn.replace(" (English)","")),1),I("p",Ke,k(Ua.value.teacher_action[Aa.value]),1)]),Ua.value.admin_action?(V(),w("div",Ye,[I("p",Xe,k(Oa.value.adminActionEn.replace(" (English)","")),1),I("p",Ze,k(Ua.value.admin_action[Aa.value]),1)])):S("",!0),I("div",null,[I("p",ea,k(Oa.value.followUpNeeded),1),I("p",aa,k(Ua.value.follow_up_needed?Oa.value.yes:Oa.value.no),1)])]),_:1})):S("",!0),A(d,{align:"right"},{default:C(()=>[j(A(a,{flat:"",label:Oa.value.close,color:"primary"},null,8,["label"]),[[v]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),A(r,{modelValue:Na.value,"onUpdate:modelValue":_[19]||(_[19]=e=>Na.value=e),"full-width":""},{default:C(()=>[A(n,{style:{"max-width":"1000px",width:"100%"}},{default:C(()=>[A(i,{class:"bg-indigo-600 text-white"},{default:C(()=>[I("div",ta,k(Oa.value.studentBehaviorHistory),1),Pa.value?(V(),w("div",la,k(Pa.value.student_name)+" - "+k(Oa.value.last90Days),1)):S("",!0)]),_:1}),La.value?(V(),N(i,{key:0,class:"text-center py-8"},{default:C(()=>[A(t,{color:"primary",size:"3rem"}),I("p",na,k(Oa.value.loadingHistory),1)]),_:1})):Pa.value?(V(),N(i,{key:1,class:"space-y-4"},{default:C(()=>[I("div",ia,[A(n,{class:"bg-blue-50"},{default:C(()=>[A(i,{class:"text-center"},{default:C(()=>[I("div",oa,k(Pa.value.summary.total_incidents),1),I("div",sa,k(Oa.value.totalIncidents),1)]),_:1})]),_:1}),A(n,{class:"bg-yellow-50"},{default:C(()=>[A(i,{class:"text-center"},{default:C(()=>[I("div",da,k(Pa.value.summary.minor),1),I("div",ra,k(Oa.value.minor),1)]),_:1})]),_:1}),A(n,{class:"bg-red-50"},{default:C(()=>[A(i,{class:"text-center"},{default:C(()=>[I("div",ca,k(Pa.value.summary.major),1),I("div",ua,k(Oa.value.major),1)]),_:1})]),_:1}),A(n,{class:"bg-purple-50"},{default:C(()=>[A(i,{class:"text-center"},{default:C(()=>[I("div",va,k(Pa.value.summary.net_points),1),I("div",pa,k(Oa.value.netPoints),1)]),_:1})]),_:1})]),I("div",null,[I("h5",ma,k(Oa.value.recentIncidents),1),I("div",fa,[(V(!0),w(D,null,T(Pa.value.incidents,e=>(V(),N(n,{key:e.id,class:"shadow-sm"},{default:C(()=>[A(i,{class:"py-2"},{default:C(()=>[I("div",ga,[I("div",null,[A(m,{color:"major"===e.severity?"red":"orange",label:e.incident_type[Aa.value]},null,8,["color","label"]),I("span",ya,k(e.occurred_at),1)]),I("div",_a,[I("span",ba,k(e.behavior[Aa.value]),1)])]),I("p",ha,k(e.description[Aa.value]),1)]),_:2},1024)]),_:2},1024))),128))])])]),_:1})):S("",!0),A(d,{align:"right"},{default:C(()=>[j(A(a,{flat:"",label:Oa.value.close,color:"primary"},null,8,["label"]),[[v]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{xa as default};
