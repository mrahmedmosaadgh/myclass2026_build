import{r as e,b as l}from"./app-NYt77MEb.js";import{Q as a}from"./QSlider-ChpGyxM_.js";import t from"./ScheduleGridControls-DO0Czw2a.js";import{f as r,a as o,e as s,N as d,J as n,R as u,b as i,V as c,a0 as v,S as p,O as h,F as m,Q as y,U as g,W as x,L as f}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const b={class:"zoom-controls flex items-center gap-2 mb-2"},w={class:"text-sm ml-2"},k={class:"relative h-[80vh] w-full"},$={class:"schedule-grid-container overflow-auto h-full w-full",style:{width:"120%",height:"80vh"}},I={class:"overflow-auto h-[calc(80vh-3rem)]",style:{width:"120%",height:"80vh"}},T={key:0,id:"HeaderRow",class:"z-50 bg-white shadow-md border-b border-gray-200"},j={class:"flex p-0 w-max"},C={class:"flex flex-nowrap bg-gray-100"},S={class:"p-0 absolute top-0 z-50 bg-gray-300 text-sm text-center w-full"},z={class:"overflow-y-auto h-[calc(80vh-3rem)] w-full"},M={class:"flex flex-nowrap"},D=["onClick","onMouseenter"],L={class:"p-0 relative"},N=e({__name:"ScheduleGrid",props:{schoolId:{type:[String,Number],required:!0},scheduleCopyId:{type:[String,Number],required:!0},teachers:{type:Array,required:!0,default:()=>[]},days:{type:Array,default:()=>["Sunday","Monday","Tuesday","Wednesday","Thursday"]},periods:{type:Number,default:8},scheduleData:{type:Array,default:()=>[]}},emits:["cell-click"],setup(e,{emit:N}){const V=e,_=r(100);o(()=>_.value/100);const q=()=>{_.value=Math.min(_.value+10,150)},A=()=>{_.value=Math.max(_.value-10,50)},Q=o(()=>[{id:null,name:""},...V.teachers]),G=N,O=r({day:null,period:null,teacher:null}),R=r({day:null,period:null,teacher:null}),U=r({}),W=r({}),F=(e,l,a)=>{const t=`${e}-${l}-${a}`;return U.value[t]||!1},H=(e,l,a)=>{const t=`${e}-${l}-${a}`;return W.value[t]||!1};r(null);const J=r(null),K=r(null),B=r(null),E=(e,l,a)=>{var t,r;return(null==(r=null==(t=V.scheduleData[e])?void 0:t[l])?void 0:r[a])||{empty:!0,id:`empty-${e}-${l}-${a}`}},P=e=>{K.value&&(K.value=null,R.value={day:null,period:null,teacher:null},G("cell-click",{teacherIndex:null,dayIndex:null,periodIndex:null}))};return s(()=>{B.value&&clearTimeout(B.value)}),(r,o)=>(n(),d(m,null,[u("div",b,[i(l,{onClick:A,icon:"remove",dense:"",flat:""}),i(a,{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=e=>_.value=e),min:50,max:150,step:10,style:{width:"200px"}},null,8,["modelValue"]),i(l,{onClick:q,icon:"add",dense:"",flat:""}),u("span",w,c(_.value)+"%",1)]),u("div",k,[u("div",$,[u("div",{class:"schedule-grid",style:p({transform:`scale(${_.value/100})`,transformOrigin:"top left",width:100/_.value*100+"%",height:100/_.value*100+"%"}),onContextmenu:v(P,["prevent"])},[u("div",I,[Q.value.length>0?(n(),d("section",T,[u("div",j,[o[2]||(o[2]=u("div",{class:"w-[148px] left-[30px] bg-white h-12 flex items-center px-3 font-medium text-gray-700 border-r border-gray-200"}," Teacher ",-1)),u("div",C,[(n(!0),d(m,null,y(V.days,(l,a)=>(n(),d("div",{key:a,class:"day-column flex-shrink-0"},[o[1]||(o[1]=u("div",{class:"p-0 w-0.5 bg-gray-300"},null,-1)),u("div",S,c(l),1),(n(!0),d(m,null,y(e.periods,(e,l)=>(n(),d("div",{key:l,class:g([K.value==a+"-"+l+"-"+r.teacherIndex?"period-cell-selected":"","period-cell-head mt-2 text-sm text-center w-[70px] h-12"])},c(e),3))),128))]))),128))])])])):h("",!0),u("div",z,[(n(!0),d(m,null,y(Q.value,(l,a)=>(n(),d("div",{key:a,class:g(["teacher-row flex flex-nowrap pl-2 p-0.5 min-w-max relative",R.value.teacher==a?"bg-red-50 text-lg z-20":"hover:bg-gray-50"])},[u("div",{class:g(["w-[140px] h-12 flex items-center",R.value.teacher==a?"text-yellow-100 bg-red-500":""])},c(l.name),3),u("div",M,[(n(!0),d(m,null,y(V.days,(l,s)=>(n(),d("div",{key:s,class:"day-column flex-shrink-0"},[o[4]||(o[4]=u("div",{class:"p-0 w-0.5 bg-gray-400"},null,-1)),(n(!0),d(m,null,y(e.periods,(e,l)=>(n(),d("div",{key:l,class:g(["period-cell hover:scale-125",K.value==s+"-"+l+"-"+a?"period-cell-selected":""]),onClick:e=>((e,l,a)=>{K.value=l+"-"+a+"-"+e,console.log(K.value),R.value.day=l,R.value.period=a,R.value.teacher=e,G("cell-click",{teacherIndex:e,dayIndex:l,periodIndex:a})})(a,s,l),onMouseenter:e=>{return a=s,t=l,B.value&&clearTimeout(B.value),void(B.value=setTimeout(()=>{O.value.day=a,O.value.period=t,J.value=a+"-"+t,console.log(J.value)},500));var a,t}},[u("div",L,[u("div",{class:g([R.value.day==s&&R.value.period==l?"border-r-2 border-blue-700":"opacity-0","absolute top-0 bottom-0 w-12 h-12 left-0 right-0 pointer-events-none p-2 z-30 hover:opacity-100 transition-opacity duration-200"])},o[3]||(o[3]=[u("div",{class:"-m-4 w-14 h-14 bg-red-400 opacity-25"},null,-1)]),2),u("div",{class:g([O.value.day==s&&O.value.period==l?"bg-blue-500":"bg-transparent","absolute top-0 bottom-0 w-12 h-12 left-0 right-0 pointer-events-none p-2 z-50 opacity-10 hover:opacity-100 transition-opacity duration-200"])},null,2)]),i(t,{locked:F(a,s,l),disabled:H(a,s,l),onToggleLock:e=>((e,l,a)=>{const t=`${e}-${l}-${a}`;U.value[t]=!U.value[t]})(a,s,l),onToggleDisable:e=>((e,l,a)=>{const t=`${e}-${l}-${a}`;W.value[t]=!W.value[t]})(a,s,l)},null,8,["locked","disabled","onToggleLock","onToggleDisable"]),x(" "+c(l)+" ",1),f(r.$slots,"cell",{teacherIndex:a,dayIndex:s,periodIndex:l,item:E(a,s,l)},void 0,!0)],42,D))),128))]))),128))])],2))),128))])])],36)])])],64))}},[["__scopeId","data-v-08c384aa"]]);export{N as default};
