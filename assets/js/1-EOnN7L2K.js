import{Q as e}from"./QSelect-DB_tK-Lk.js";import{o as l,u as a,n as s,d as t,f as o,Q as r,aF as i,m as u,c as d,aP as n,l as c,b as m}from"./app-B77gjd5a.js";import{Q as v}from"./QSpace-Bk4F2b8L.js";import{Q as p}from"./QTd-Cd1TbwhN.js";import{Q as f}from"./QTable-Dzgz30xz.js";import{f as y,a as b,k as g,o as w,M as h,J as k,N as V,b as x,K as q,U as _,I as j,V as S,Q,S as P,y as U,F as C,R as N,a2 as z,aP as I}from"./vendor-DuKqz2x4.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./QMarkupTable-xKG6mM4A.js";import"./QLinearProgress-B9hMkhRG.js";import"./use-fullscreen-Cf3Zl1YN.js";const M={class:"q-pa-md"},A={class:"row q-col-gutter-md q-mb-md items-center"},F={class:"col-12 col-sm-3"},L={class:"col-12 col-sm-3"},R={class:"col-12 col-sm-3"},$={class:"col-12 col-sm-3"},B={class:"row full-width q-pb-md items-center"},E={class:"text-h6"},D={key:1,class:"cell-content"},T={class:"row q-col-gutter-md"},K={class:"text-grey-7"},O={class:"text-grey-7"},H=l({__name:"1",props:{rows:{type:Array,required:!0,default:()=>[]},columns:{type:Array,required:!0,default:()=>[]},title:{type:String,default:"Array Editor"}},emits:["update:rows"],setup(l,{emit:H}){const J=a(),W=l,G=H,X=[{label:"Small",value:"12px"},{label:"Medium",value:"14px"},{label:"Large",value:"16px"},{label:"Extra Large",value:"18px"}],Y=[{label:"Compact",value:"compact"},{label:"Comfortable",value:"comfortable"}],Z=y({fontSize:"14px",density:"comfortable"}),ee=y(""),le=b(()=>{if(!ee.value)return re.value;const e=ee.value.toLowerCase();return re.value.filter(l=>Object.values(l).some(l=>String(l).toLowerCase().includes(e)))}),ae=e=>{Z.value.fontSize=e},se=e=>{Z.value.density=e},te=e=>{ee.value=e},oe=y({sortBy:"name",descending:!1,page:1,rowsPerPage:10,rowsNumber:10}),re=y([...W.rows]),ie=y([...W.columns]),ue=y([]),de=y(!1),ne=y({}),ce=()=>{ne.value=ie.value.reduce((e,l)=>("id"!==l.field&&(e[l.field]=l.default||""),e),{})};ce(),b(()=>Object.values(ne.value).every(e=>""!==e)),g(()=>W.rows,e=>{re.value=[...e]},{deep:!0});const me=()=>{const e=ue.value.map(e=>e.id);re.value=re.value.filter(l=>!e.includes(l.id)),ue.value=[],G("update:rows",re.value)},ve=()=>{re.value=[...W.rows],ue.value=[],ee.value="",G("update:rows",re.value)},pe=y(!1),fe=y(!1),ye=y([]),be=y({}),ge=y({}),we=y(!1),he=async()=>{try{if((await Promise.all(ie.value.filter(e=>"id"!==e.field).map(e=>Ve(e.field)))).includes(!1))return void J.notify({progress:!0,type:"negative",actions:[{icon:"close",color:"white"}],message:"Please fill in all required fields correctly",position:"top-right"});fe.value=!0;const e={id:Date.now().toString(),...ne.value};re.value.push(e),G("update:rows",re.value),J.notify({type:"positive",message:"Item added successfully",position:"top-right"}),ke()}catch(e){console.error("Error adding item:",e),J.notify({type:"negative",message:"Failed to add item",position:"top-right"})}finally{fe.value=!1}},ke=()=>{pe.value=!1,ce(),be.value={},ge.value={},we.value=!1},Ve=e=>{try{ge.value[e]=!0;const l=ne.value[e];if(be.value[e]=null,!l||0===l.trim().length)return be.value[e]=`${xe(e)} is required`,!1;const a=ie.value.find(l=>l.field===e);if(a&&l)switch(a.type){case"email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l))return be.value[e]="Please enter a valid email",!1;break;case"number":if(isNaN(l))return be.value[e]="Please enter a valid number",!1}return!0}catch(l){return console.error("Validation error:",l),!1}},xe=e=>{const l=ie.value.find(l=>l.field===e);return l?l.label:e};return w(()=>{ie.value=W.columns.map(e=>({...e,required:!1!==e.required,rules:[...e.rules||[],..."email"===e.type?[e=>!e||/^[^@]+@[^@]+\.[^@]+$/.test(e)||"Please enter a valid email"]:[],..."number"===e.type?[e=>!e||!isNaN(e)||"Please enter a valid number"]:[]]}))}),g(ne,()=>{try{(()=>{try{const e=ie.value.filter(e=>"id"!==e.field).map(e=>e.field);we.value=e.every(e=>{const l=ne.value[e];return l&&l.trim().length>0&&!be.value[e]})}catch(e){console.error("Form validity update error:",e),we.value=!1}})()}catch(e){console.error("Watch error:",e)}},{deep:!0}),(a,y)=>(k(),h("div",M,[V("div",A,[V("div",F,[x(e,{modelValue:Z.value.fontSize,"onUpdate:modelValue":[y[0]||(y[0]=e=>Z.value.fontSize=e),ae],options:X,label:"Font Size",dense:"",outlined:"",class:"q-mr-sm"},null,8,["modelValue"])]),V("div",L,[x(e,{modelValue:Z.value.density,"onUpdate:modelValue":[y[1]||(y[1]=e=>Z.value.density=e),se],options:Y,label:"Row Height",dense:"",outlined:""},null,8,["modelValue"])]),V("div",R,[x(s,{modelValue:de.value,"onUpdate:modelValue":y[2]||(y[2]=e=>de.value=e),label:"Edit Mode",color:"primary",class:"q-ml-sm"},null,8,["modelValue"])]),V("div",$,[x(o,{modelValue:ee.value,"onUpdate:modelValue":[y[3]||(y[3]=e=>ee.value=e),te],dense:"",outlined:"",placeholder:"Search"},{append:q(()=>[x(t,{name:"search"})]),_:1},8,["modelValue"])])]),x(f,{rows:le.value,columns:ie.value,"row-key":"id",filter:ee.value,pagination:oe.value,class:"my-custom-table",style:P({"--table-font-size":Z.value.fontSize}),dense:"compact"===Z.value.density,flat:"",bordered:"",selection:"multiple",selected:ue.value,"onUpdate:selected":y[7]||(y[7]=e=>ue.value=e)},{top:q(()=>[V("div",B,[V("div",E,S(l.title),1),x(v),de.value?(k(),j(i,{key:0,flat:""},{default:q(()=>[x(r,{color:"primary",icon:"add",label:"Add New",onClick:y[4]||(y[4]=e=>pe.value=!0)}),x(r,{color:"negative",icon:"delete",label:"Delete Selected",onClick:me,disable:!ue.value.length},null,8,["disable"]),x(r,{color:"warning",icon:"refresh",label:"Reset",onClick:ve,flat:""})]),_:1})):Q("",!0)])]),"body-cell":q(e=>[x(p,{onDblclick:y[6]||(y[6]=e=>de.value=!0),props:e,class:_({"cursor-pointer":!de.value})},{default:q(()=>[e.col.editable&&de.value?(k(),j(o,{key:0,modelValue:e.row[e.col.field],"onUpdate:modelValue":[l=>e.row[e.col.field]=l,l=>(e=>{const l=re.value.findIndex(l=>l.id===e.id);-1!==l&&(re.value[l]={...e},G("update:rows",re.value))})(e.row)],dense:"",outlined:"",class:_("comfortable"===Z.value.density?"q-py-sm":""),onBlur:y[5]||(y[5]=e=>de.value=!1)},null,8,["modelValue","onUpdate:modelValue","class"])):(k(),h("div",D,S(e.row[e.col.field]),1))]),_:2},1032,["props","class"])]),_:1},8,["rows","columns","filter","pagination","style","dense","selected"]),x(m,{modelValue:pe.value,"onUpdate:modelValue":y[8]||(y[8]=e=>pe.value=e),persistent:""},{default:q(()=>[x(u,{style:{"min-width":"400px","max-width":"600px"}},{default:q(()=>[x(d,{class:"row items-center q-pb-none"},{default:q(()=>[y[9]||(y[9]=V("div",{class:"text-h6"},"Add New Item",-1)),x(v),U(x(r,{icon:"close",flat:"",round:"",dense:""},null,512),[[n]])]),_:1}),x(d,{class:"q-pt-md"},{default:q(()=>[V("div",T,[(k(!0),h(C,null,N(ie.value.filter(e=>"id"!==e.field),e=>(k(),h("div",{key:e.field,class:"col-12"},[x(o,{modelValue:ne.value[e.field],"onUpdate:modelValue":l=>ne.value[e.field]=l,label:e.label,hint:e.hint,outlined:"",dense:"",rules:[l=>!!l||`${e.label} is required`,l=>l.trim().length>0||`${e.label} cannot be empty`,...e.rules||[]],type:e.type||"text",mask:e.mask,"fill-mask":e.fillMask,"reverse-fill-mask":e.reverseFillMask,ref_for:!0,ref_key:"inputRefs",ref:ye,onKeyup:z(he,["enter"]),onInput:l=>Ve(e.field),onBlur:l=>Ve(e.field),error:!!be.value[e.field],"error-message":be.value[e.field],"hide-bottom-space":""},I({_:2},[e.prefix?{name:"prepend",fn:q(()=>[V("div",K,S(e.prefix),1)]),key:"0"}:void 0,e.suffix?{name:"append",fn:q(()=>[V("div",O,S(e.suffix),1)]),key:"1"}:void 0]),1032,["modelValue","onUpdate:modelValue","label","hint","rules","type","mask","fill-mask","reverse-fill-mask","onInput","onBlur","error","error-message"])]))),128))])]),_:1}),x(c,{align:"right",class:"text-primary q-pa-md"},{default:q(()=>[x(r,{flat:"",label:"Cancel",color:"grey-7",onClick:ke,disable:fe.value},null,8,["disable"]),x(r,{loading:fe.value,label:"Add",color:"primary",onClick:he,disable:!we.value},null,8,["loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}},[["__scopeId","data-v-3e971a94"]]);export{H as default};
