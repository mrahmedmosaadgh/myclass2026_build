import{Z as e,_ as s}from"./vendor-BJyC5yAd.js";const a=e("schoolData",{state:()=>({schoolId:null,schoolName:null,academicYearId:null,academicYearName:null,semesterId:null,semesterName:null,schools:[],academicYears:[],semesters:[],loading:!1}),getters:{isSchoolSelected:e=>!!e.schoolId,isAcademicYearSet:e=>!!e.academicYearId,isSemesterSet:e=>!!e.semesterId,hasAllContext:e=>!!e.schoolId&&!!e.academicYearId&&!!e.semesterId},actions:{async fetchSchools(){this.loading=!0;try{const e=await s.get(route("weekly-system.api.school-data"));this.schools=e.data.schools||[],!this.schoolId&&this.schools.length>0&&this.setSchool(this.schools[0].id)}catch(e){throw console.error("Failed to fetch schools:",e),e}finally{this.loading=!1}},async fetchOptionsForSchool(e){this.loading=!0;try{const e=await s.get("/api/academic-years");this.academicYears=e.data.data||e.data;const a=await s.get("/api/semesters");this.semesters=a.data.data||a.data}catch(a){throw console.error("Failed to fetch options:",a),a}finally{this.loading=!1}},async setSchool(e){if(e){this.schoolId=e;try{const a=(await s.get(`/api/schools/${e}`)).data.data;this.schoolName=a.name,this.academicYearId=a.academic_year_id,this.semesterId=a.semester_id,a.active_academic_year&&(this.academicYearName=a.active_academic_year.name),a.active_semester&&(this.semesterName=a.active_semester.name),await this.fetchOptionsForSchool(e)}catch(a){console.error("Failed to fetch school details:",a)}}},async updateSchoolSettings(e){if(this.schoolId)try{const a=await s.put(`/api/schools/${this.schoolId}`,e);if(void 0!==e.academic_year_id)if(this.academicYearId=e.academic_year_id,e.academic_year_id){const s=this.academicYears.find(s=>s.id===e.academic_year_id);this.academicYearName=s?s.name:null}else this.academicYearName=null;if(void 0!==e.semester_id)if(this.semesterId=e.semester_id,e.semester_id){const s=this.semesters.find(s=>s.id===e.semester_id);this.semesterName=s?s.name:null}else this.semesterName=null;return a.data}catch(a){throw console.error("Failed to update school settings:",a),a}},reset(){this.schoolId=null,this.schoolName=null,this.academicYearId=null,this.academicYearName=null,this.semesterId=null,this.semesterName=null}}});export{a as u};
