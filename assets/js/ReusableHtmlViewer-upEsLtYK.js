import e from"./purify.es-C2Ba6vpb.js";import a from"./EditorToolbar-BWwsqzPr.js";import t from"./EditorContent-DQXDOTtA.js";import n from"./PrintLayout-CHFt6nik.js";import{r as i}from"./app-NYt77MEb.js";import{f as l,a as o,k as r,N as m,J as s,b as u}from"./vendor-BWKGNkNB.js";import"./TitleInput-hkcGwS0o.js";import"./TextFormatControls-CsnSuWyO.js";import"./createLucideIcon-bevK9Pnz.js";import"./LineSpacingControl-CW-9YIjP.js";import"./AlignmentControls-DiKLxAuG.js";import"./ImageControls-C4caiBhL.js";import"./image-T1FtDBZI.js";import"./PrintButton-CNpwQ6v6.js";import"./printer-yyUpIzJF.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const d={class:"relative bg-white"},p=i({__name:"ReusableHtmlViewer",props:{modelValue:{type:String,required:!0},title:{type:String,default:"Document"}},emits:["update:modelValue"],setup(i,{emit:p}){const g=i,c=p,v=l(g.title),f=l(null),h=l(null),y=l(1.5),b=l("left"),j=l("inline-block"),w=l(100),C=l([]),T=[5,10,15,20,25,33,50,75,100,110,120,150,200,300],V=o(()=>e.sanitize(g.modelValue)),I=o(()=>["bold","italic","underline"].filter(e=>document.queryCommandState(e))),_=e=>{document.execCommand(e,!1,null)},k=e=>{"IMG"===e.target.tagName&&(C.value=[e.target])},L=()=>{C.value.length&&C.value.forEach(e=>{e.style.width=`${w.value}%`})},U=()=>{const e=window.open("","_blank"),a=`\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <title>${v.value}</title>\n            <style>\n                @page {\n                    margin: 1cm;\n                    size: A4;\n                }\n                body {\n                    font-family: system-ui, -apple-system, sans-serif;\n                    line-height: ${y.value};\n                    margin: 0;\n                    padding: 1cm;\n                    text-align: ${b.value};\n                }\n                .prose {\n                    max-width: none;\n                }\n                .prose img {\n                    max-width: 100%;\n                    height: auto;\n                    page-break-inside: avoid;\n                }\n                @media print {\n                    html, body {\n                        width: 210mm;\n                        height: 297mm;\n                    }\n                }\n            </style>\n        </head>\n        <body>\n            ${V.value}\n        </body>\n        </html>\n    `;e.document.write(a),e.document.close(),e.onload=()=>{e.print(),e.onafterprint=()=>{e.close()}}},$=async()=>{if(!h.value)return;const a=h.value.$el||h.value,t=a.getElementsByTagName("img"),n=Array.from(t).map(async e=>{if(!e.src.startsWith("data:"))try{const a=await fetch(e.src),t=await a.blob(),n=await(e=>new Promise((a,t)=>{const n=new FileReader;n.onload=()=>a(n.result),n.onerror=t,n.readAsDataURL(e)}))(t);e.src=n}catch(a){console.error("Failed to convert image to base64:",a)}});await Promise.all(n),(a=>{const t=a.target.innerHTML,n=e.sanitize(t);c("update:modelValue",n)})({target:a})};return r(()=>g.modelValue,a=>{h.value&&h.value.innerHTML!==a&&(h.value.innerHTML=e.sanitize(a))}),(e,l)=>(s(),m("div",d,[u(a,{title:v.value,"onUpdate:title":l[0]||(l[0]=e=>v.value=e),"line-spacing":y.value,"onUpdate:lineSpacing":l[1]||(l[1]=e=>y.value=e),alignment:b.value,"onUpdate:alignment":l[2]||(l[2]=e=>b.value=e),"image-display-mode":j.value,"onUpdate:imageDisplayMode":l[3]||(l[3]=e=>j.value=e),"image-width":w.value,"onUpdate:imageWidth":l[4]||(l[4]=e=>w.value=e),"active-formats":I.value,"image-sizes":T,onFormat:_,onConvertImagesToBase64:$,onResizeImages:L,onPrint:U},null,8,["title","line-spacing","alignment","image-display-mode","image-width","active-formats"]),u(t,{"model-value":i.modelValue,"line-spacing":y.value,alignment:b.value,"onUpdate:modelValue":l[5]||(l[5]=e=>c("update:modelValue",e)),onImageClick:k,ref_key:"editableContent",ref:h},null,8,["model-value","line-spacing","alignment"]),u(n,{ref_key:"printContainer",ref:f,content:V.value,"line-spacing":y.value,alignment:b.value},null,8,["content","line-spacing","alignment"])]))}},[["__scopeId","data-v-98ba914f"]]);export{p as default};
