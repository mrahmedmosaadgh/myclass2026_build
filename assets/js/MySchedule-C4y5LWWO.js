import{o as e,u as s,d as a,m as l}from"./app-C-WHvmzS.js";import{Q as t}from"./QSpinnerDots-D98lP8We.js";import{u as r}from"./i18n-kquWfmcz.js";import{f as c,a as o,o as i,af as d,N as n,J as m,b as u,O as y,z as v,I as p,Q as b,W as h,V as g,K as k,F as S,R as w,_ as x,S as f,$ as j}from"./vendor-nQjeLEvd.js";import _ from"./WeeklyPlanMenu-C5iSmaYU.js";import"./offline-BzIlwqNM.js";import"./ui-Bfjdq-TR.js";import"./QTab-Drm8HTkp.js";import"./QTabs-Bu9Nk-Cs.js";import"./rtl-Cr6c3OOr.js";import"./QSpace-B9GNNHOj.js";import"./WeeklySystemGuide-Bi2I09Hv.js";import"./QTabPanel-B6MXX5nx.js";import"./use-panel-C3xzl7zI.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-CD_HzZAU.js";import"./MainSchoolData-DPWC58tO.js";import"./QBadge-DrVfQiJT.js";import"./schoolData-B8mO1d2r.js";import"./SchoolSettingsDialog-CWUoVFKv.js";import"./QSelect-mar89Igw.js";import"./QForm-DJ98CvpZ.js";const Q={class:"q-pa-md"},q={class:"row items-center q-mb-lg"},D={class:"col"},P={class:"q-ma-none text-weight-bold"},$={class:"text-grey-7 q-mb-none"},z={key:0,class:"row justify-center q-pa-xl"},T={class:"text-h6 text-grey-7 q-mt-md"},C={class:"text-grey-6"},M={key:2,class:"timetable-container"},F={class:"grid-row header-row"},K={class:"grid-cell period-header"},W={class:"period-number"},B=["onClick"],E={class:"card-content"},I={class:"subject"},J={class:"classroom"},L={key:1,class:"free-period text-caption text-grey-5"},N={class:"row q-gutter-lg justify-center"},O={class:"text-center"},R={class:"text-h4 text-primary"},G={class:"text-caption text-grey-7"},H={class:"text-center"},U={class:"text-h4 text-secondary"},V={class:"text-caption text-grey-7"},A={class:"text-center"},X={class:"text-h4 text-accent"},Y={class:"text-caption text-grey-7"},Z=e({__name:"MySchedule",setup(e){const{t:Z}=r(),ee=s(),se=c([]),ae=c(!1),le=o(()=>[{value:1,label:Z("weeklyPlans.fullDays.1")},{value:2,label:Z("weeklyPlans.fullDays.2")},{value:3,label:Z("weeklyPlans.fullDays.3")},{value:4,label:Z("weeklyPlans.fullDays.4")},{value:5,label:Z("weeklyPlans.fullDays.5")}]),te=[1,2,3,4,5,6,7,8],re=o(()=>{const e={};return se.value.forEach(s=>{const a=`${s.day}-${s.period_number}`;e[a]=s}),e}),ce=o(()=>se.value.length),oe=o(()=>new Set(se.value.map(e=>{var s;return null==(s=e.cst)?void 0:s.classroom_id})).size),ie=o(()=>new Set(se.value.map(e=>{var s;return null==(s=e.cst)?void 0:s.subject_id})).size),de=(e,s)=>re.value[`${e}-${s}`],ne=(e,s)=>{const a=de(e,s);return(null==a?void 0:a.cst)?{backgroundColor:a.cst.c_bg||"#e0e0e0",color:a.cst.c_text||"#333"}:{}};return i(()=>{(async()=>{ae.value=!0;try{const e=await x.get("/weekly-system/api/teacher/my-schedule");se.value=e.data.data||e.data||[]}catch(e){console.error("Error fetching schedule:",e),ee.notify({type:"negative",message:Z("weeklySystem.notifications.loadFailed")})}finally{ae.value=!1}})()}),(e,s)=>{const r=d("Head");return m(),n(S,null,[u(r,{title:v(Z)("weeklySystem.mySchedule.title")},null,8,["title"]),y("div",Q,[u(_),y("div",q,[y("div",D,[y("h4",P,[u(a,{name:"calendar_month",class:"q-mr-sm",color:"primary"}),h(" "+g(v(Z)("weeklySystem.mySchedule.title")),1)]),y("p",$,g(v(Z)("weeklySystem.mySchedule.subtitle")),1)])]),ae.value?(m(),n("div",z,[u(t,{size:"50px",color:"primary"})])):se.value.length?(m(),n("div",M,[y("div",F,[s[0]||(s[0]=y("div",{class:"grid-cell period-header"},null,-1)),(m(!0),n(S,null,w(le.value,e=>(m(),n("div",{key:e.value,class:"grid-cell day-header"},g(v(Z)(`weeklyPlans.shortDays.${e.value}`)),1))),128))]),(m(),n(S,null,w(te,e=>y("div",{key:e,class:"grid-row"},[y("div",K,[y("div",W,g(e),1)]),(m(!0),n(S,null,w(le.value,s=>{var l,t;return m(),n("div",{key:`${s.value}-${e}`,class:"grid-cell"},[de(s.value,e)?(m(),n("div",{key:0,class:"schedule-card",style:f(ne(s.value,e)),onClick:a=>((e,s)=>{const a=de(e,s);a&&j.visit("/my_table_mnger/weekly_system/teacher/my-weekly-plans",{data:{schedule_id:a.id}})})(s.value,e)},[y("div",E,[y("div",I,g(null==(l=de(s.value,e).cst)?void 0:l.subject_name),1),y("div",J,[u(a,{name:"meeting_room",size:"xs"}),h(" "+g(null==(t=de(s.value,e).cst)?void 0:t.classroom_name),1)])])],12,B)):(m(),n("div",L,g(v(Z)("weeklySystem.mySchedule.free")),1))])}),128))])),64))])):(m(),p(l,{key:1,flat:"",bordered:"",class:"text-center q-pa-xl"},{default:k(()=>[u(a,{name:"event_busy",size:"64px",color:"grey-5"}),y("p",T,g(v(Z)("weeklySystem.schoolBrowser.noDataTitle")),1),y("p",C,g(v(Z)("weeklySystem.mySchedule.emptyState")),1)]),_:1})),se.value.length?(m(),p(l,{key:3,flat:"",bordered:"",class:"q-mt-lg q-pa-md"},{default:k(()=>[y("div",N,[y("div",O,[y("div",R,g(ce.value),1),y("div",G,g(v(Z)("weeklySystem.mySchedule.totalClasses")),1)]),y("div",H,[y("div",U,g(oe.value),1),y("div",V,g(v(Z)("weeklySystem.mySchedule.classrooms")),1)]),y("div",A,[y("div",X,g(ie.value),1),y("div",Y,g(v(Z)("weeklySystem.mySchedule.subjects")),1)])])]),_:1})):b("",!0)])],64)}}},[["__scopeId","data-v-bd704b76"]]);export{Z as default};
