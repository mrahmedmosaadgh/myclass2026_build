import{D as e,ac as l,T as a,U as t,aC as u,bg as n,at as o,S as s,aw as i,ak as r,a2 as d,Q as c,i as v,j as m,h as p,g as f,m as h,c as _,f as k,d as y,aP as b,l as q,b as g,N as w}from"./app-ggGwxJON.js";import{u as x,a as C,b as V,g as M}from"./use-datetime-BAXS8q9i.js";import{_ as O,f as S}from"./date-C_NgUKAH.js";import{p as j,f as D,a as H,k as U,n as B,h as A,B as K,y as P,a7 as $,N as F,J as I,O as Q,b as Y,K as z,F as N,R as J,I as R,W as T,V as L,z as W}from"./vendor-nQjeLEvd.js";import{Q as X}from"./QPopupProxy-B_TgS9uL.js";import"./offline-BzIlwqNM.js";import"./i18n-kquWfmcz.js";import"./ui-Bfjdq-TR.js";function E(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}const G=e({name:"QTime",props:{...a,...l,...C,modelValue:{required:!0,validator:e=>"string"==typeof e||null===e},mask:{...C.mask,default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:x,setup(e,{slots:l,emit:a}){const v=j(),{$q:m}=v.proxy,p=t(e,m),{tabindex:f,headerClass:h,getLocale:_,getCurrentDate:k}=V(e,m),y=u(e),b=i(y);let q,g;const w=D(null),x=H(()=>"persian"!==e.calendar&&null!==e.mask?e.mask:"HH:mm"+(!0===e.withSeconds?":ss":"")),C=H(()=>_()),$=H(()=>function(){if("string"!=typeof e.defaultDate){const e=k(!0);return e.dateHash=M(e),e}return O(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}()),F=O(e.modelValue,x.value,C.value,e.calendar,$.value),I=D(function(e){return null!==e.hour&&null===e.minute?"minute":"hour"}(F)),Q=D(F),Y=D(null===F.hour||F.hour<12),z=H(()=>"q-time q-time--"+(!0===e.landscape?"landscape":"portrait")+(!0===p.value?" q-time--dark q-dark":"")+(!0===e.disable?" disabled":!0===e.readonly?" q-time--readonly":"")+(!0===e.bordered?" q-time--bordered":"")+(!0===e.square?" q-time--square no-border-radius":"")+(!0===e.flat?" q-time--flat no-shadow":"")),N=H(()=>{const e=Q.value;return{hour:null===e.hour?"--":!0===J.value?n(e.hour):String(!0===Y.value?0===e.hour?12:e.hour:e.hour>12?e.hour-12:e.hour),minute:null===e.minute?"--":n(e.minute),second:null===e.second?"--":n(e.second)}}),J=H(()=>null!==e.format24h?e.format24h:m.lang.date.format24h),R=H(()=>{const e="hour"===I.value,l=!0===e?12:60,a=Q.value[I.value];let t=`rotate(${Math.round(a*(360/l))-180}deg) translateX(-50%)`;return!0===e&&!0===J.value&&Q.value.hour>=12&&(t+=" scale(.7)"),{transform:t}}),T=H(()=>null!==Q.value.hour),L=H(()=>!0===T.value&&null!==Q.value.minute),W=H(()=>void 0!==e.hourOptions?l=>e.hourOptions.includes(l):void 0!==e.options?l=>e.options(l,null,null):null),X=H(()=>void 0!==e.minuteOptions?l=>e.minuteOptions.includes(l):void 0!==e.options?l=>e.options(Q.value.hour,l,null):null),G=H(()=>void 0!==e.secondOptions?l=>e.secondOptions.includes(l):void 0!==e.options?l=>e.options(Q.value.hour,Q.value.minute,l):null),Z=H(()=>{if(null===W.value)return null;const e=oe(0,11,W.value),l=oe(12,11,W.value);return{am:e,pm:l,values:e.values.concat(l.values)}}),ee=H(()=>null!==X.value?oe(0,59,X.value):null),le=H(()=>null!==G.value?oe(0,59,G.value):null),ae=H(()=>{switch(I.value){case"hour":return Z.value;case"minute":return ee.value;case"second":return le.value}}),te=H(()=>{let e,l,a=0,t=1;const u=null!==ae.value?ae.value.values:void 0;"hour"===I.value?!0===J.value?(e=0,l=23):(e=0,l=11,!1===Y.value&&(a=12)):(e=0,l=55,t=5);const n=[];for(let o=e,s=e;o<=l;o+=t,s++){const e=o+a,l=!1===(null==u?void 0:u.includes(e)),t="hour"===I.value&&0===o?!0===J.value?"00":"12":o;n.push({val:e,index:s,disable:l,label:t})}return n}),ue=H(()=>[[o,ce,void 0,{stop:!0,prevent:!0,mouse:!0}]]);function ne(){const e={...k(),...E()};je(e),Object.assign(Q.value,e),I.value="hour"}function oe(e,l,a){const t=Array.apply(null,{length:l+1}).map((l,t)=>{const u=t+e;return{index:u,val:!0===a(u)}}).filter(e=>!0===e.val).map(e=>e.index);return{min:t[0],max:t[t.length-1],values:t,threshold:l+1}}function se(e,l,a){const t=Math.abs(e-l);return Math.min(t,a-t)}function ie(e,{min:l,max:a,values:t,threshold:u}){if(e===l)return l;if(e<l||e>a)return se(e,l,u)<=se(e,a,u)?l:a;const n=t.findIndex(l=>e<=l),o=t[n-1],s=t[n];return e-o<=s-e?o:s}function re(){return!0===r(v)||null!==ae.value&&(0===ae.value.values.length||"hour"===I.value&&!0!==J.value&&0===Z.value[!0===Y.value?"am":"pm"].values.length)}function de(){const e=w.value,{top:l,left:a,width:t}=e.getBoundingClientRect(),u=t/2;return{top:l+u,left:a+u,dist:.7*u}}function ce(e){if(!0!==re()){if(!0===e.isFirst)return q=de(),void(g=me(e.evt,q));g=me(e.evt,q,g),!0===e.isFinal&&(q=!1,g=null,ve())}}function ve(){"hour"===I.value?I.value="minute":e.withSeconds&&"minute"===I.value&&(I.value="second")}function me(e,l,a){const t=d(e),u=Math.abs(t.top-l.top),n=Math.sqrt(Math.pow(Math.abs(t.top-l.top),2)+Math.pow(Math.abs(t.left-l.left),2));let o,s=Math.asin(u/n)*(180/Math.PI);if(s=t.top<l.top?l.left<t.left?90-s:270+s:l.left<t.left?s+90:270-s,"hour"===I.value){if(o=s/30,null!==Z.value){const e=!0!==J.value?!0===Y.value:0!==Z.value.am.values.length&&0!==Z.value.pm.values.length?n>=l.dist:0!==Z.value.am.values.length;o=ie(o+(!0===e?0:12),Z.value[!0===e?"am":"pm"])}else o=Math.round(o),!0===J.value?n<l.dist?o<12&&(o+=12):12===o&&(o=0):!0===Y.value&&12===o?o=0:!1===Y.value&&12!==o&&(o+=12);!0===J.value&&(Y.value=o<12)}else o=Math.round(s/6)%60,"minute"===I.value&&null!==ee.value?o=ie(o,ee.value):"second"===I.value&&null!==le.value&&(o=ie(o,le.value));return a!==o&&Ce[I.value](o),o}U(()=>e.modelValue,l=>{const a=O(l,x.value,C.value,e.calendar,$.value);a.dateHash===Q.value.dateHash&&a.timeHash===Q.value.timeHash||(Q.value=a,null===a.hour?I.value="hour":Y.value=a.hour<12)}),U([x,C],()=>{B(()=>{je()})});const pe={hour(){I.value="hour"},minute(){I.value="minute"},second(){I.value="second"}};function fe(e){13===e.keyCode&&Ve()}function he(e){13===e.keyCode&&Me()}function _e(e){!0!==re()&&(!0!==m.platform.is.desktop&&me(e,de()),ve())}function ke(e){!0!==re()&&me(e,de())}function ye(e){if(13===e.keyCode)I.value="hour";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==Z.value){const e=!0===J.value?Z.value.values:Z.value[!0===Y.value?"am":"pm"].values;if(0===e.length)return;if(null===Q.value.hour)ge(e[0]);else{const a=(e.length+e.indexOf(Q.value.hour)+l)%e.length;ge(e[a])}}else{const e=!0===J.value?24:12;ge((!0!==J.value&&!1===Y.value?12:0)+(24+(null===Q.value.hour?-l:Q.value.hour)+l)%e)}}}function be(e){if(13===e.keyCode)I.value="minute";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==ee.value){const e=ee.value.values;if(0===e.length)return;if(null===Q.value.minute)we(e[0]);else{const a=(e.length+e.indexOf(Q.value.minute)+l)%e.length;we(e[a])}}else{we((60+(null===Q.value.minute?-l:Q.value.minute)+l)%60)}}}function qe(e){if(13===e.keyCode)I.value="second";else if([37,39].includes(e.keyCode)){const l=37===e.keyCode?-1:1;if(null!==le.value){const e=le.value.values;if(0===e.length)return;if(null===Q.value.seconds)xe(e[0]);else{const a=(e.length+e.indexOf(Q.value.second)+l)%e.length;xe(e[a])}}else{xe((60+(null===Q.value.second?-l:Q.value.second)+l)%60)}}}function ge(e){Q.value.hour!==e&&(Q.value.hour=e,Se())}function we(e){Q.value.minute!==e&&(Q.value.minute=e,Se())}function xe(e){Q.value.second!==e&&(Q.value.second=e,Se())}const Ce={hour:ge,minute:we,second:xe};function Ve(){!1===Y.value&&(Y.value=!0,null!==Q.value.hour&&(Q.value.hour-=12,Se()))}function Me(){!0===Y.value&&(Y.value=!1,null!==Q.value.hour&&(Q.value.hour+=12,Se()))}function Oe(l){const a=e.modelValue;I.value!==l&&null!=a&&""!==a&&"string"!=typeof a&&(I.value=l)}function Se(){return null!==W.value&&!0!==W.value(Q.value.hour)?(Q.value=O(),void Oe("hour")):null!==X.value&&!0!==X.value(Q.value.minute)?(Q.value.minute=null,Q.value.second=null,void Oe("minute")):!0===e.withSeconds&&null!==G.value&&!0!==G.value(Q.value.second)?(Q.value.second=null,void Oe("second")):void(null===Q.value.hour||null===Q.value.minute||!0===e.withSeconds&&null===Q.value.second||je())}function je(l){const t=Object.assign({...Q.value},l),u="persian"===e.calendar?n(t.hour)+":"+n(t.minute)+(!0===e.withSeconds?":"+n(t.second):""):S(new Date(t.year,null===t.month?null:t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),x.value,C.value,t.year,t.timezoneOffset);t.changed=u!==e.modelValue,a("update:modelValue",u,t)}function De(){const l=[A("div",{class:"q-time__link "+("hour"===I.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:pe.hour,onKeyup:ye},N.value.hour),A("div",":"),A("div",!0===T.value?{class:"q-time__link "+("minute"===I.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:be,onClick:pe.minute}:{class:"q-time__link"},N.value.minute)];!0===e.withSeconds&&l.push(A("div",":"),A("div",!0===L.value?{class:"q-time__link "+("second"===I.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onKeyup:qe,onClick:pe.second}:{class:"q-time__link"},N.value.second));const a=[A("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},l)];return!1===J.value&&a.push(A("div",{class:"q-time__header-ampm column items-between no-wrap"},[A("div",{class:"q-time__link "+(!0===Y.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Ve,onKeyup:fe},"AM"),A("div",{class:"q-time__link "+(!0!==Y.value?"q-time__link--active":"cursor-pointer"),tabindex:f.value,onClick:Me,onKeyup:he},"PM")])),A("div",{class:"q-time__header flex flex-center no-wrap "+h.value},a)}function He(){const l=Q.value[I.value];return A("div",{class:"q-time__content col relative-position"},[A(K,{name:"q-transition--scale"},()=>A("div",{key:"clock"+I.value,class:"q-time__container-parent absolute-full"},[A("div",{ref:w,class:"q-time__container-child fit overflow-hidden"},[P(A("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:_e,onMousedown:ke},[A("div",{class:"q-time__clock-circle fit"},[A("div",{class:"q-time__clock-pointer"+(null===Q.value[I.value]?" hidden":void 0!==e.color?` text-${e.color}`:""),style:R.value}),te.value.map(e=>A("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${e.index}`+(e.val===l?" q-time__clock-position--active "+h.value:!0===e.disable?" q-time__clock-position--disable":"")},[A("span",e.label)]))])]),ue.value)])])),!0===e.nowBtn?A(c,{class:"q-time__now-button absolute",icon:m.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:f.value,onClick:ne}):null])}return v.proxy.setNow=ne,()=>{const a=[He()],t=s(l.default);return void 0!==t&&a.push(A("div",{class:"q-time__actions"},t)),void 0!==e.name&&!0!==e.disable&&b(a,"push"),A("div",{class:z.value,tabindex:-1},[De(),A("div",{class:"q-time__main col overflow-auto"},a)])}}}),Z={class:"q-pa-md"},ee={class:"row items-center justify-between q-mb-md"},le={class:"row q-gutter-sm"},ae={class:"text-h6"},te={class:"row q-col-gutter-sm q-mt-sm"},ue={class:"col-6"},ne={class:"row items-center justify-end"},oe={class:"col-6"},se={class:"row items-center justify-end"},ie={__name:"dp_MasterSchedule",props:{tasks:Array},setup(e){const l=D(!1),a=D(!1),t=D(null),u=$({title:"",start_time:"",end_time:"",description:"",type:"general"}),n=()=>{a.value?u.put(route("dp.master.update",t.value),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ™ÿ≠ÿØŸäÿ´ ÿ®ŸÜÿ¨ÿßÿ≠"})}}):u.post(route("dp.master.store"),{onSuccess:()=>{l.value=!1,o(),w.create({type:"positive",message:"ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ÿ®ŸÜÿ¨ÿßÿ≠"})}})},o=()=>{a.value=!1,t.value=null,u.reset()};return(o,s)=>(I(),F("div",Z,[Q("div",ee,[s[8]||(s[8]=Q("div",{class:"text-h5"},"ÿßŸÑÿ¨ÿØŸàŸÑ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä üìÖ",-1)),Y(c,{label:"ÿ•ÿ∂ÿßŸÅÿ© ŸÖŸáŸÖÿ©",color:"primary",icon:"add",onClick:s[0]||(s[0]=e=>l.value=!0)})]),Y(f,{bordered:"",separator:"",class:"bg-white rounded-borders"},{default:z(()=>[(I(!0),F(N,null,J(e.tasks,e=>(I(),R(p,{key:e.id},{default:z(()=>[Y(v,null,{default:z(()=>[Y(m,null,{default:z(()=>[T(L(e.title),1)]),_:2},1024),Y(m,{caption:""},{default:z(()=>[T(L(e.start_time)+" - "+L(e.end_time),1)]),_:2},1024)]),_:2},1024),Y(v,{side:""},{default:z(()=>[Q("div",le,[Y(c,{flat:"",round:"",color:"primary",icon:"edit",onClick:n=>(e=>{a.value=!0,t.value=e.id,u.title=e.title,u.start_time=e.start_time?e.start_time.substr(0,5):"",u.end_time=e.end_time?e.end_time.substr(0,5):"",u.description=e.description,l.value=!0})(e)},null,8,["onClick"]),Y(c,{flat:"",round:"",color:"negative",icon:"delete",onClick:l=>{return a=e.id,void(confirm("ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿßŸÑÿ≠ÿ∞ŸÅÿü")&&u.delete(route("dp.master.destroy",a),{onSuccess:()=>w.create({type:"positive",message:"ÿ™ŸÖ ÿßŸÑÿ≠ÿ∞ŸÅ"})}));var a}},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),Y(g,{modelValue:l.value,"onUpdate:modelValue":s[7]||(s[7]=e=>l.value=e)},{default:z(()=>[Y(h,{style:{"min-width":"350px"}},{default:z(()=>[Y(_,null,{default:z(()=>[Q("div",ae,L(a.value?"ÿ™ÿπÿØŸäŸÑ ŸÖŸáŸÖÿ©":"ŸÖŸáŸÖÿ© ÿ¨ÿØŸäÿØÿ©"),1)]),_:1}),Y(_,{class:"q-pt-none"},{default:z(()=>[Y(k,{modelValue:W(u).title,"onUpdate:modelValue":s[1]||(s[1]=e=>W(u).title=e),label:"ÿπŸÜŸàÿßŸÜ ÿßŸÑŸÖŸáŸÖÿ©",autofocus:""},null,8,["modelValue"]),Q("div",te,[Q("div",ue,[Y(k,{modelValue:W(u).start_time,"onUpdate:modelValue":s[3]||(s[3]=e=>W(u).start_time=e),label:"ŸÖŸÜ",mask:"time",rules:["time"]},{append:z(()=>[Y(y,{name:"access_time",class:"cursor-pointer"},{default:z(()=>[Y(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:z(()=>[Y(G,{modelValue:W(u).start_time,"onUpdate:modelValue":s[2]||(s[2]=e=>W(u).start_time=e),format24h:""},{default:z(()=>[Q("div",ne,[P(Y(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),Q("div",oe,[Y(k,{modelValue:W(u).end_time,"onUpdate:modelValue":s[5]||(s[5]=e=>W(u).end_time=e),label:"ÿ•ŸÑŸâ",mask:"time",rules:["time"]},{append:z(()=>[Y(y,{name:"access_time",class:"cursor-pointer"},{default:z(()=>[Y(X,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:z(()=>[Y(G,{modelValue:W(u).end_time,"onUpdate:modelValue":s[4]||(s[4]=e=>W(u).end_time=e),format24h:""},{default:z(()=>[Q("div",se,[P(Y(c,{label:"Close",color:"primary",flat:""},null,512),[[b]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),Y(k,{modelValue:W(u).description,"onUpdate:modelValue":s[6]||(s[6]=e=>W(u).description=e),label:"ŸÖŸÑÿßÿ≠ÿ∏ÿ© ÿ™ÿ≠ŸÅŸäÿ≤Ÿäÿ©",type:"textarea",rows:"2"},null,8,["modelValue"])]),_:1}),Y(q,{align:"right",class:"text-primary"},{default:z(()=>[P(Y(c,{flat:"",label:"ÿ•ŸÑÿ∫ÿßÿ°"},null,512),[[b]]),Y(c,{flat:"",label:"ÿ≠ŸÅÿ∏",onClick:n})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ie as default};
