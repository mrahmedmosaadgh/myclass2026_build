import{Z as e,_ as a}from"./vendor-BWKGNkNB.js";const s=e("schoolData",{state:()=>({schoolId:null,schoolName:null,academicYearId:null,academicYearName:null,semesterId:null,semesterName:null,schools:[],academicYears:[],semesters:[],loading:!1}),getters:{isSchoolSelected:e=>!!e.schoolId,isAcademicYearSet:e=>!!e.academicYearId,isSemesterSet:e=>!!e.semesterId,hasAllContext:e=>!!e.schoolId&&!!e.academicYearId&&!!e.semesterId},actions:{async fetchSchools(){this.loading=!0;try{const e=await a.get(route("weekly-system.api.school-data"));this.schools=e.data.schools||[],!this.schoolId&&this.schools.length>0&&this.setSchool(this.schools[0].id)}catch(e){throw console.error("Failed to fetch schools:",e),e}finally{this.loading=!1}},async fetchOptionsForSchool(e){this.loading=!0;try{const e=await a.get("/api/academic-years");this.academicYears=e.data.data||e.data;const s=await a.get("/api/semesters");this.semesters=s.data.data||s.data}catch(s){throw console.error("Failed to fetch options:",s),s}finally{this.loading=!1}},async setSchool(e){if(e){this.schoolId=e;try{const s=(await a.get(`/api/schools/${e}`)).data.data;this.schoolName=s.name,this.academicYearId=s.active_academic_year_id||s.academic_year_id,this.semesterId=s.active_semester_id||s.semester_id,s.active_academic_year&&(this.academicYearName=s.active_academic_year.name),s.active_semester&&(this.semesterName=s.active_semester.name),await this.fetchOptionsForSchool(e)}catch(s){console.error("Failed to fetch school details:",s)}}},async updateSchoolSettings(e){if(this.schoolId)try{const s=await a.put(`/api/schools/${this.schoolId}`,e);if(void 0!==e.academic_year_id)if(this.academicYearId=e.academic_year_id,e.academic_year_id){const a=this.academicYears.find(a=>a.id===e.academic_year_id);this.academicYearName=a?a.name:null}else this.academicYearName=null;if(void 0!==e.semester_id)if(this.semesterId=e.semester_id,e.semester_id){const a=this.semesters.find(a=>a.id===e.semester_id);this.semesterName=a?a.name:null}else this.semesterName=null;return s.data}catch(s){throw console.error("Failed to update school settings:",s),s}},reset(){this.schoolId=null,this.schoolName=null,this.academicYearId=null,this.academicYearName=null,this.semesterId=null,this.semesterName=null}}});export{s as u};
