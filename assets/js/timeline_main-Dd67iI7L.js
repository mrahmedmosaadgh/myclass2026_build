import{Q as e}from"./QSpinnerDots-CnY0H5Kp.js";import{o as t,d as s,e as l}from"./app-B77gjd5a.js";import r from"./timeline-DS_nzJPC.js";import{f as o,k as a,a as i,r as n,M as d,J as u,Q as m,N as c,V as p,y as f,ac as b,b as v,K as g,W as y,F as x,R as j,S as h}from"./vendor-DuKqz2x4.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./QInnerLoading-y_DGBLm2.js";import"./QBadge-ZkvAqPBD.js";import"./QTab-CnAf4tCv.js";import"./QTabs-D_ZwIIJm.js";import"./rtl-Cr6c3OOr.js";import"./CurrentEventCard-DxBLP4SM.js";import"./UpcomingEventsCard-CY0tB1c4.js";import"./PeriodActivityDrawer-CdXUW85m.js";import"./QSelect-DB_tK-Lk.js";import"./StudentRecordsGrid-DVC23E6y.js";import"./QTabPanel-B_PJ80R0.js";import"./use-panel-N2fkKyR_.js";import"./use-render-cache-CmTcazfP.js";import"./QTabPanels-B5JhG1n5.js";import"./purify.es-C2Ba6vpb.js";import"./katex-BXKQVcz-.js";const w={class:"p-6"},k={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},T={class:"bg-white rounded-lg p-6 w-full max-w-md"},Q={class:"text-lg font-semibold mb-4"},C={class:"space-y-4"},_={class:"flex gap-4"},D={class:"flex-1"},E={class:"flex-1"},S=["min"],U={class:"mt-6 flex justify-end gap-3"},A={class:"timeline-wrapper"},I={class:"timeline-container"},L={key:0,class:"flex justify-center items-center h-64"},P={key:1,class:"flex justify-center items-center h-64"},V={key:2,class:"schedule-grid"},N={class:"p-2"},$={class:"font-bold"},M={class:"text-sm"},R={class:"text-xs text-gray-500"},q=t({__name:"timeline_main",props:{title:{type:String,default:""},events:{type:Array,default:()=>[]},schedule:{type:Array,default:()=>[]},timings:{type:Object,default:null},loading:{type:Boolean,default:!1}},emits:["update:events"],setup(t,{emit:q}){const z=t,B=q,F=e=>{const t=new Date,[s,l]=e.split(":");return t.setHours(parseInt(s),parseInt(l),0,0),t},H=o([...z.events]);a(()=>z.events,e=>{H.value=[...e]},{deep:!0});const J=i(()=>{const e=[...H.value].sort((e,t)=>F(e.from)-F(t.from));return e.map(t=>{const s=F(t.from),l=F(t.to),r=e.filter(e=>{if(e.id===t.id)return!1;const r=F(e.from),o=F(e.to);return s<o&&l>r}),o=r.length>0?r.length:0,a=Math.max(o+1,1);return{...t,column:o,totalColumns:a,startTime:s,endTime:l}})}),K=o(!1),O=o(null),G=n({title:"",description:"",from:"",to:""}),W=()=>{K.value=!1,O.value=null,G.title="",G.description="",G.from="",G.to=""},Z=()=>{if(!G.title.trim()||!G.from||!G.to)return void alert("Please fill in all required fields");if(G.from>=G.to)return void alert("End time must be after start time");const e=F(G.from),t=F(G.to),s=H.value.find(s=>{var l;if((null==(l=O.value)?void 0:l.id)===s.id)return!1;const r=F(s.from),o=F(s.to);return e<o&&t>r});if(s&&!confirm(`There is already an event "${s.title}" from ${s.from} to ${s.to}. Do you want to schedule anyway?`))return;const l={title:G.title,description:G.description,from:G.from,to:G.to};let r;r=O.value?H.value.map(e=>e.id===O.value.id?{...e,...l}:e):[...H.value,{id:Date.now(),...l}],H.value=r,B("update:events",r),W()},X=e=>new Date(`2000-01-01T${e}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return(o,a)=>(u(),d("div",w,[K.value?(u(),d("div",k,[c("div",T,[c("h3",Q,p(O.value?"Edit Event":"Add New Event"),1),c("div",C,[c("div",null,[a[4]||(a[4]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Title",-1)),f(c("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>G.title=e),type:"text",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,G.title]])]),c("div",null,[a[5]||(a[5]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Description",-1)),f(c("textarea",{"onUpdate:modelValue":a[1]||(a[1]=e=>G.description=e),class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,G.description]])]),c("div",_,[c("div",D,[a[6]||(a[6]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"From",-1)),f(c("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>G.from=e),type:"time",class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[b,G.from]])]),c("div",E,[a[7]||(a[7]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To",-1)),f(c("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>G.to=e),type:"time",min:G.from,class:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,S),[[b,G.to]])])])]),c("div",U,[c("button",{onClick:W,class:"px-4 py-2 text-gray-600 hover:text-gray-800"}," Cancel "),c("button",{onClick:Z,class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"},p(O.value?"Update":"Add"),1)])])])):m("",!0),c("div",A,[v(r,{events:J.value},null,8,["events"])]),c("div",I,[t.loading?(u(),d("div",L,[v(e,{color:"primary",size:"40px",class:"q-mr-xs"}),a[8]||(a[8]=c("span",{class:"text-primary text-subtitle1"},"Loading schedule...",-1))])):t.schedule.length?(u(),d("div",V,[(u(!0),d(x,null,j(t.schedule,(e,t)=>(u(),d("div",{key:t,class:"schedule-item",style:h({backgroundColor:"#f3f4f6",borderLeft:"4px solid #3b82f6"})},[c("div",N,[c("h3",$,p(e.subject),1),c("p",M,p(e.classroom),1),c("p",R,p(X(e.start_time))+" - "+p(X(e.end_time)),1)])],4))),128))])):(u(),d("div",P,[v(l,{class:"bg-grey-3"},{avatar:g(()=>[v(s,{name:"schedule",color:"primary"})]),default:g(()=>[a[9]||(a[9]=y(" No schedule available for today "))]),_:1})]))])]))}},[["__scopeId","data-v-83951720"]]);export{q as default};
