import{r as e}from"./app-DlLesFGi.js";import{N as s,J as t,R as i,O as n,y as o,U as c,V as d,ac as r}from"./vendor-BWKGNkNB.js";import"./offline-BzIlwqNM.js";import"./i18n-B0T1C7j3.js";import"./ui-B7TfxbV_.js";const a={class:"qr-input-receiver"},u={class:"controls mb-4"},h={key:0,class:"mb-4 p-4 bg-yellow-100 border border-yellow-400 rounded text-yellow-700"},l=["autofocus"],p={key:1,class:"status-indicator mb-4 p-4 bg-blue-100 border border-blue-400 rounded"},v={key:2,class:"mt-4 p-4 bg-green-100 border border-green-400 rounded"};const g=e({name:"QrInputReceiver",data:()=>({qrCode:"",lastScannedCode:"",isReceiving:!1,hasFocus:!0,speechSynthesis:null}),mounted(){window.addEventListener("focus",this.handleFocus),window.addEventListener("blur",this.handleBlur),document.addEventListener("click",this.handleDocumentClick),this.speechSynthesis=window.speechSynthesis},beforeUnmount(){window.removeEventListener("focus",this.handleFocus),window.removeEventListener("blur",this.handleBlur),document.removeEventListener("click",this.handleDocumentClick)},methods:{toggleReceivingMode(){this.isReceiving=!this.isReceiving,this.isReceiving&&this.$nextTick(()=>{this.focusInput()})},focusInput(){this.isReceiving&&this.$refs.qrInput.focus()},handleFocus(){this.hasFocus=!0,this.focusInput()},handleBlur(){this.hasFocus=!1},handleDocumentClick(){this.focusInput()},speakText(e){this.speechSynthesis.cancel();const s=new SpeechSynthesisUtterance(e);s.rate=1,s.pitch=1,s.volume=1,this.speechSynthesis.speak(s)},handleQrInput(){if(this.isReceiving&&this.qrCode.includes("-")){const e=this.qrCode.split("-");if(3===e.length&&"p"===e[2]){this.lastScannedCode=this.qrCode;const s={studentCode:e[0],mark:e[1]};this.$emit("qr-scanned",s),this.speakText(`Student ${s.studentCode}, Mark ${s.mark}`),this.qrCode="",this.focusInput()}}}}},[["render",function(e,g,m,b,f,w){return t(),s("div",a,[i("div",u,[i("button",{onClick:g[0]||(g[0]=(...e)=>w.toggleReceivingMode&&w.toggleReceivingMode(...e)),class:c(["px-4 py-2 rounded font-semibold",f.isReceiving?"bg-red-500 text-white":"bg-green-500 text-white"])},d(f.isReceiving?"Stop Receiving":"Start Receiving"),3)]),!f.hasFocus&&f.isReceiving?(t(),s("div",h," âš ï¸ Window is not in focus! QR codes won't be received. Click anywhere in the window to restore focus. ")):n("",!0),o(i("input",{type:"text",ref:"qrInput","onUpdate:modelValue":g[1]||(g[1]=e=>f.qrCode=e),onInput:g[2]||(g[2]=(...e)=>w.handleQrInput&&w.handleQrInput(...e)),style:{position:"absolute",opacity:"0"},autofocus:f.isReceiving},null,40,l),[[r,f.qrCode]]),f.isReceiving?(t(),s("div",p," ðŸ“± Ready to receive QR codes ")):n("",!0),f.lastScannedCode?(t(),s("div",v," âœ… Last scanned: "+d(f.lastScannedCode),1)):n("",!0)])}],["__scopeId","data-v-e15ceb09"]]);export{g as default};
