import{Q as l}from"./QSelect-D0qwdF6_.js";import{b as e,p as a,t as n,G as r,h as s,d as o,f as u,c as t,o as d,e as i,aS as c}from"./app-DTyzyps1.js";import{Q as v}from"./QSpace-BwAH5_uj.js";import{Q as p}from"./QTd-BUEdgfO2.js";import{Q as m}from"./QTable-ONISDY_Z.js";import{Q as y}from"./QMarkupTable-xjy79eNm.js";import{u as h}from"./i18n-BDgsCcB6.js";import{a as b,r as w,f as k,k as f,N as g,J as _,O as P,b as j,z as x,I as V,K as C,W as S,V as L,F as U,R as q,Q,y as T,_ as $,U as M}from"./vendor-BJyC5yAd.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./ui-DFn3cvMd.js";import"./QLinearProgress-Diz1Ffz5.js";import"./use-fullscreen-DbVybjDH.js";const N={class:"row q-gutter-sm q-mb-md items-end"},O={id:"plans-table-print"},W={class:"screen-only"},A={class:"subject-sub"},H={key:1},B={key:1},R={key:1},D={class:"text-h6 text-center q-mb-sm"},I={class:"print-only"},E={class:"print-header"},F={class:"meta"},z={class:"meta"},G={class:"meta"},J={class:"subject-sub"},K=["innerHTML"],X=["innerHTML"],Y=["innerHTML"],Z={class:"text-h6"},ll={class:"q-gutter-md"},el={class:"text-caption text-grey-7"},al={class:"text-subtitle2 q-mb-sm"},nl={style:{"max-width":"220px"}},rl={style:{"max-width":"220px"}},sl={style:{"max-width":"220px"}},ol={class:"q-mt-md text-subtitle2"},ul={class:"text-caption text-grey-7 q-mb-xs"},tl={style:{"max-width":"220px"}},dl={style:{"max-width":"220px"}},il={style:{"max-width":"220px"}},cl={__name:"WeeklyPlansTable",props:{plans:{type:Array,default:()=>[]},weekNumber:{type:Number,required:!0},semesterNumber:{type:Number,required:!0}},emits:["edit","copied"],setup(cl,{emit:vl}){const{t:pl,locale:ml}=h(),yl=b(()=>"ar"===ml.value?"right":"left"),hl=cl,bl=vl,wl=l=>l?pl(`weeklyPlans.fullDays.${l}`)||`Day ${l}`:"-",kl=l=>l?`${pl("weeklyPlans.teacher.filters.grade")} ${l}`:"-",fl=w({day:null,classroom:null,grade:null,subject:null}),gl=()=>{fl.day=fl.classroom=fl.grade=fl.subject=null},_l=k(!1),Pl=b(()=>[{name:"dayName",label:pl("weeklyPlans.teacher.filters.day"),field:"dayName",align:yl.value,sortable:!0},{name:"period",label:pl("weeklyPlans.period"),field:l=>{var e,a;return null!=(a=null==(e=l.schedule)?void 0:e.period_number)?a:"-"},align:"center",sortable:!0},{name:"periodOrder",label:pl("weeklyPlans.teacher.periodOrder"),field:l=>{var e,a;return null!=(a=null==(e=l.schedule)?void 0:e.period_order)?a:"-"},align:"center",sortable:!0},{name:"classroom",label:pl("weeklyPlans.teacher.filters.classroom"),field:l=>{var e,a,n,r;return null!=(r=null==(n=null==(a=null==(e=l.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.name)?r:"-"},align:yl.value,sortable:!0,style:"width: 1%;",headerStyle:"width: 1%;"},{name:"grade",label:pl("weeklyPlans.teacher.filters.grade"),field:l=>{var e;return kl(null==(e=l.schedule)?void 0:e.grade_id)},align:yl.value},{name:"subject",label:pl("weeklyPlans.teacher.filters.subject"),field:l=>{var e,a,n,r;return null!=(r=null==(n=null==(a=null==(e=l.schedule)?void 0:e.cst)?void 0:a.subject)?void 0:n.name)?r:"-"},align:yl.value,sortable:!0},{name:"cw",label:"CW",field:"cw",align:yl.value},{name:"hw",label:"HW",field:"hw",align:yl.value},{name:"notes",label:pl("weeklyPlans.teacher.notesLabel"),field:"notes",align:yl.value},{name:"status",label:pl("weeklyPlans.status"),field:"status",align:yl.value},{name:"actions",label:pl("weeklyPlans.previewAndPrint"),field:l=>l.id,align:"right"}]),jl=b(()=>El.value?Pl.value:Pl.value.filter(l=>"periodOrder"!==l.name)),xl=(l,e)=>{const a=new Set;return l.filter(l=>{const n=e(l);return null!=n&&!a.has(n)&&(a.add(n),!0)})},Vl=b(()=>xl(hl.plans.filter(l=>{var e;return null!=(null==(e=null==l?void 0:l.schedule)?void 0:e.day)}),l=>l.schedule.day).map(l=>({label:wl(l.schedule.day),value:l.schedule.day})).sort((l,e)=>l.value-e.value)),Cl=b(()=>xl(hl.plans.filter(l=>{var e,a;return null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.classroom}),l=>l.schedule.cst.classroom.id).map(l=>({label:l.schedule.cst.classroom.name,value:l.schedule.cst.classroom.id})).sort((l,e)=>l.label.localeCompare(e.label))),Sl=b(()=>xl(hl.plans.filter(l=>{var e;return null!=(null==(e=null==l?void 0:l.schedule)?void 0:e.grade_id)}),l=>l.schedule.grade_id).map(l=>({label:kl(l.schedule.grade_id),value:l.schedule.grade_id})).sort((l,e)=>{var a,n;return(null!=(a=l.value)?a:0)-(null!=(n=e.value)?n:0)})),Ll=b(()=>xl(hl.plans.filter(l=>{var e,a;return null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.subject}),l=>l.schedule.cst.subject.id).map(l=>({label:l.schedule.cst.subject.name,value:l.schedule.cst.subject.id})).sort((l,e)=>l.label.localeCompare(e.label))),Ul=b(()=>hl.plans.filter(l=>{var e,a,n,r,s,o,u,t;return!(fl.day&&(null==(e=null==l?void 0:l.schedule)?void 0:e.day)!==fl.day||fl.classroom&&(null==(r=null==(n=null==(a=null==l?void 0:l.schedule)?void 0:a.cst)?void 0:n.classroom)?void 0:r.id)!==fl.classroom||fl.grade&&(null==(s=null==l?void 0:l.schedule)?void 0:s.grade_id)!==fl.grade||fl.subject&&(null==(t=null==(u=null==(o=null==l?void 0:l.schedule)?void 0:o.cst)?void 0:u.subject)?void 0:t.id)!==fl.subject)})),ql=b(()=>{var l,e,a,n,r,s,o,u;const t=new Map;for(const d of Ul.value){const i=null!=(n=null==(a=null==(e=null==(l=null==d?void 0:d.schedule)?void 0:l.cst)?void 0:e.classroom)?void 0:a.id)?n:"unknown",c=null!=(u=null==(o=null==(s=null==(r=null==d?void 0:d.schedule)?void 0:r.cst)?void 0:s.classroom)?void 0:o.name)?u:"Unknown classroom";t.has(i)||t.set(i,{id:i,name:c,rows:[]}),t.get(i).rows.push(d)}for(const d of t.values())d.rows.sort((l,e)=>{var a,n,r,s;const o=((null==(a=null==l?void 0:l.schedule)?void 0:a.day)||0)-((null==(n=null==e?void 0:e.schedule)?void 0:n.day)||0);if(0!==o)return o;const u=((null==(r=null==l?void 0:l.schedule)?void 0:r.period_number)||0)-((null==(s=null==e?void 0:e.schedule)?void 0:s.period_number)||0);return 0!==u?u:((null==l?void 0:l.id)||0)-((null==e?void 0:e.id)||0)});return Array.from(t.values()).sort((l,e)=>String(l.name).localeCompare(String(e.name)))}),Ql=l=>({empty:pl("weeklyPlans.empty"),partial:pl("weeklyPlans.partial"),completed:pl("weeklyPlans.completed")}[l]||l||"-"),Tl=k(!1),$l=k(null),Ml=k(null),Nl=k([]);k(!1);const Ol=()=>{$l.value=fl.classroom||null,Ml.value=fl.subject||null,Nl.value=[],Rl.value=null,Tl.value=!0},Wl=b(()=>Cl.value.filter(l=>l.value!==$l.value)),Al=b(()=>!!$l.value&&!!Ml.value&&Nl.value.length>0),Hl=b(()=>hl.weekNumber),Bl=b(()=>hl.semesterNumber),Rl=k(null),Dl=k(!1),Il=k(!1),El=k(!1),Fl=k(""),zl=async()=>{if(Al.value)try{Dl.value=!0;const{data:l}=await $.post("/weekly-system/api/teacher/copy-plans-classrooms/preview",{from_classroom_id:$l.value,subject_id:Ml.value,to_classroom_ids:Nl.value,week_number:Hl.value,semester_number:Bl.value});Rl.value=l}catch(l){console.error("Preview failed",l)}finally{Dl.value=!1}},Gl=async()=>{var l,e;if(null==(e=null==(l=Rl.value)?void 0:l.operations)?void 0:e.length)try{Il.value=!0,await $.post("/weekly-system/api/teacher/copy-plans-classrooms/commit",{operations:Rl.value.operations}),Tl.value=!1,bl("copied")}catch(a){console.error("Commit failed",a)}finally{Il.value=!1}else Tl.value=!1},Jl=b(()=>{if(!$l.value)return[];return xl(hl.plans.filter(l=>{var e,a,n,r,s;return(null==(n=null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.id)===$l.value&&(null==(s=null==(r=null==l?void 0:l.schedule)?void 0:r.cst)?void 0:s.subject)}),l=>l.schedule.cst.subject.id).map(l=>({label:l.schedule.cst.subject.name,value:l.schedule.cst.subject.id})).sort((l,e)=>l.label.localeCompare(e.label))});f([$l,Ml],async([l,e])=>{Tl.value&&l&&e?await zl():Rl.value=null}),f(Nl,async l=>{Tl.value&&$l.value&&Ml.value&&await zl()});const Kl=l=>String(null!=l?l:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),Xl=l=>String(null!=l?l:"").replace(/&/g,"&amp;").replace(/"/g,"&quot;"),Yl=l=>{const e=String(null!=l?l:""),a=/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,n=/(https?:\/\/[^\s]+)/g,r=l=>{let e,a="",r=0;for(;null!==(e=n.exec(l));){a+=Kl(l.slice(r,e.index));const s=e[1];a+=`<a href="${Xl(s)}" target="_blank" rel="noopener noreferrer">${Kl(s)}</a>`,r=n.lastIndex}return a+=Kl(l.slice(r)),a};let s,o="",u=0;for(;null!==(s=a.exec(e));){o+=r(e.slice(u,s.index));const l=Kl(s[1]);o+=`<a href="${Xl(s[2])}" target="_blank" rel="noopener noreferrer">${l}</a>`,u=a.lastIndex}return o+=r(e.slice(u)),o||"-"},Zl=()=>{var l,e;const a=new URLSearchParams({week:String(null!=(l=Hl.value)?l:""),semester:String(null!=(e=Bl.value)?e:""),day:null!=fl.day?String(fl.day):"",classroom:null!=fl.classroom?String(fl.classroom):"",subject:null!=fl.subject?String(fl.subject):"",grade:null!=fl.grade?String(fl.grade):""});_l.value&&a.set("group","classroom"),window.open(`/weekly-plans-print.html?${a.toString()}`,"_blank","noopener,noreferrer")};return(h,b)=>{var w,k;return _(),g("div",null,[P("div",N,[j(l,{modelValue:fl.day,"onUpdate:modelValue":b[0]||(b[0]=l=>fl.day=l),options:Vl.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:x(pl)("weeklyPlans.teacher.filters.day"),style:{"min-width":"160px"}},null,8,["modelValue","options","label"]),j(l,{modelValue:fl.classroom,"onUpdate:modelValue":b[1]||(b[1]=l=>fl.classroom=l),options:Cl.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:x(pl)("weeklyPlans.teacher.filters.classroom"),style:{"min-width":"200px"}},null,8,["modelValue","options","label"]),j(l,{modelValue:fl.grade,"onUpdate:modelValue":b[2]||(b[2]=l=>fl.grade=l),options:Sl.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:x(pl)("weeklyPlans.teacher.filters.grade"),style:{"min-width":"160px"}},null,8,["modelValue","options","label"]),j(l,{modelValue:fl.subject,"onUpdate:modelValue":b[3]||(b[3]=l=>fl.subject=l),options:Ll.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:x(pl)("weeklyPlans.teacher.filters.subject"),style:{"min-width":"200px"}},null,8,["modelValue","options","label"]),j(e,{flat:"",dense:"",icon:"refresh",color:"primary",onClick:gl,label:x(pl)("weeklyPlans.teacher.filters.clear")},null,8,["label"]),j(v),j(e,{color:"primary",dense:"",unelevated:"",icon:"content_copy",label:x(pl)("weeklyPlans.copy"),onClick:Ol},null,8,["label"]),j(e,{color:_l.value?"primary":"grey-7",outline:!_l.value,dense:"",icon:"table_rows",label:x(pl)("weeklyPlans.groupByClassroom"),onClick:b[4]||(b[4]=l=>_l.value=!_l.value)},null,8,["color","outline","label"]),j(e,{color:"primary",dense:"",unelevated:"",icon:"print",label:x(pl)("weeklyPlans.print"),onClick:Zl},null,8,["label"]),j(a,{modelValue:El.value,"onUpdate:modelValue":b[5]||(b[5]=l=>El.value=l),label:x(pl)("weeklyPlans.periodOrderEdit"),color:"primary",class:"q-ml-md"},null,8,["modelValue","label"])]),P("div",O,[P("div",W,[_l.value?(_(),g("div",R,[(_(!0),g(U,null,q(ql.value,l=>(_(),g("div",{key:l.id,class:"q-mb-xl"},[P("div",D,L(x(pl)("weeklyPlans.teacher.filters.classroom"))+": "+L(l.name),1),j(y,{dense:"",flat:"",bordered:""},{default:C(()=>[P("thead",null,[P("tr",null,[P("th",null,L(x(pl)("weeklyPlans.teacher.filters.day")),1),P("th",null,L(x(pl)("weeklyPlans.period")),1),P("th",null,L(x(pl)("weeklyPlans.periodOrder")),1),P("th",null,L(x(pl)("weeklyPlans.weeklyLearningPlan")),1)])]),P("tbody",null,[(_(!0),g(U,null,q(l.rows,l=>{var e,a,n,r,s;return _(),g("tr",{key:l.id},[P("td",null,L(wl(null==(e=null==l?void 0:l.schedule)?void 0:e.day)),1),P("td",null,L(null!=(n=null==(a=null==l?void 0:l.schedule)?void 0:a.period_number)?n:"-"),1),P("td",null,L(null!=(s=null==(r=null==l?void 0:l.schedule)?void 0:r.period_order)?s:"-"),1),P("td",null,[P("div",null,[b[11]||(b[11]=P("strong",null,"CW:",-1)),S(" "+L((null==l?void 0:l.cw)||"-"),1)]),P("div",null,[P("strong",null,L(x(pl)("weeklyPlans.teacher.hwLabel")),1),S(" "+L((null==l?void 0:l.hw)||"-"),1)]),P("div",null,[P("strong",null,L(x(pl)("weeklyPlans.teacher.notesLabel")),1),S(" "+L((null==l?void 0:l.notes)||"-"),1)])])])}),128))])]),_:2},1024)]))),128))])):(_(),V(m,{key:0,flat:"",bordered:"",rows:Ul.value,columns:jl.value,"row-key":"id",pagination:{rowsPerPage:10}},{"body-cell-dayName":C(l=>[j(p,{props:l},{default:C(()=>{var e;return[S(L(wl(null==(e=l.row.schedule)?void 0:e.day)),1)]}),_:2},1032,["props"])]),"body-cell-classroom":C(l=>[j(p,{props:l},{default:C(()=>{var e,a,n,r,s,o,u,t;return[S(L((null==(n=null==(a=null==(e=l.row.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.name)||"-")+" ",1),P("div",A,L((null==(o=null==(s=null==(r=l.row.schedule)?void 0:r.cst)?void 0:s.subject)?void 0:o.name)||"-")+" ("+L(null!=(t=null==(u=l.row.schedule)?void 0:u.period_order)?t:"-")+") ",1)]}),_:2},1032,["props"])]),"body-cell-grade":C(l=>[j(p,{props:l},{default:C(()=>{var e;return[S(L(kl(null==(e=l.row.schedule)?void 0:e.grade_id)),1)]}),_:2},1032,["props"])]),"body-cell-subject":C(l=>[j(p,{props:l},{default:C(()=>{var e,a,n;return[S(L((null==(n=null==(a=null==(e=l.row.schedule)?void 0:e.cst)?void 0:a.subject)?void 0:n.name)||"-"),1)]}),_:2},1032,["props"])]),"body-cell-periodOrder":C(l=>[j(p,{props:l},{default:C(()=>{var e,a,n;return[(null==(e=l.row.schedule)?void 0:e.id)?(_(),g(U,{key:0},[El.value?(_(),V(s,{key:0,dense:"",outlined:"",type:"number",min:"1",style:{"max-width":"90px"},modelValue:l.row.schedule.period_order,"onUpdate:modelValue":e=>l.row.schedule.period_order=e,modelModifiers:{number:!0},onBlur:e=>(async l=>{var e,a;try{if(!(null==(e=null==l?void 0:l.schedule)?void 0:e.id)||!(null==(a=null==l?void 0:l.schedule)?void 0:a.period_order))return;await $.put(`/weekly-system/api/schedules/${l.schedule.id}/period-order`,{period_order:l.schedule.period_order})}catch(n){console.error("Failed to update period_order",n)}})(l.row)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(_(),g("span",H,L(null!=(n=null==(a=l.row.schedule)?void 0:a.period_order)?n:"-"),1))],64)):(_(),g("span",B,"-"))]}),_:2},1032,["props"])]),"body-cell-status":C(l=>[j(p,{props:l},{default:C(()=>{return[j(r,{dense:"",color:(e=l.row.status,{empty:"grey",partial:"amber",completed:"green"}[e]||"primary"),"text-color":"white"},{default:C(()=>[S(L(Ql(l.row.status)),1)]),_:2},1032,["color"])];var e}),_:2},1032,["props"])]),"body-cell-actions":C(l=>[j(p,{props:l,class:"text-right"},{default:C(()=>[j(e,{flat:"",dense:"",round:"",icon:"edit",color:"primary",onClick:e=>{return a=l.row,bl("edit",a);var a}},{default:C(()=>[j(n,null,{default:C(()=>b[10]||(b[10]=[S("Edit")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]))]),P("div",I,[P("div",E,[P("h1",null,L(x(pl)("weeklyPlans.teacher.myWeeklyPlans")),1),P("div",F,L(x(pl)("weeklyPlans.week"))+" "+L(Hl.value)+" • "+L(x(pl)("weeklyPlans.semester"))+" "+L(Bl.value),1),P("div",z,[S(L(x(pl)("weeklyPlans.teacher.tableView"))+": ",1),P("span",null,L(x(pl)("weeklyPlans.teacher.filters.day"))+": "+L(fl.day?wl(fl.day):x(pl)("common.all")||"All"),1),b[12]||(b[12]=S(" | ")),P("span",null,L(x(pl)("weeklyPlans.teacher.filters.classroom"))+": "+L(fl.classroom?(null==(w=Cl.value.find(l=>l.value===fl.classroom))?void 0:w.label)||fl.classroom:x(pl)("common.all")||"All"),1),b[13]||(b[13]=S(" | ")),P("span",null,L(x(pl)("weeklyPlans.teacher.filters.subject"))+": "+L(fl.subject?(null==(k=Ll.value.find(l=>l.value===fl.subject))?void 0:k.label)||fl.subject:x(pl)("common.all")||"All"),1),b[14]||(b[14]=S(" | ")),P("span",null,L(x(pl)("weeklyPlans.teacher.filters.grade"))+": "+L(fl.grade?kl(fl.grade):x(pl)("common.all")||"All"),1)]),P("div",G,L(x(pl)("weeklyPlans.teacher.generated"))+" "+L(Fl.value),1)]),j(y,{flat:"",bordered:"",dense:""},{default:C(()=>[P("thead",null,[P("tr",null,[P("th",null,L(x(pl)("weeklyPlans.teacher.filters.classroom")),1),P("th",null,L(x(pl)("weeklyPlans.teacher.filters.day")),1),P("th",null,L(x(pl)("weeklyPlans.period")),1),P("th",null,L(x(pl)("weeklyPlans.weeklyLearningPlan")),1)])]),P("tbody",null,[(_(!0),g(U,null,q(Ul.value,l=>{var e,a,n,r,s,o,u,t,d,i,c;return _(),g("tr",{key:l.id},[P("td",null,[S(L((null==(n=null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.name)||"-")+" ",1),P("div",J,L((null==(o=null==(s=null==(r=null==l?void 0:l.schedule)?void 0:r.cst)?void 0:s.subject)?void 0:o.name)||"-")+" ("+L(null!=(t=null==(u=null==l?void 0:l.schedule)?void 0:u.period_order)?t:"-")+")",1)]),P("td",null,L(wl(null==(d=null==l?void 0:l.schedule)?void 0:d.day)),1),P("td",null,L(null!=(c=null==(i=null==l?void 0:l.schedule)?void 0:i.period_number)?c:"-"),1),P("td",null,[P("div",null,[b[15]||(b[15]=P("strong",null,"CW:",-1)),b[16]||(b[16]=S()),P("span",{innerHTML:Yl((null==l?void 0:l.cw)||"-")},null,8,K)]),P("div",null,[P("strong",null,L(x(pl)("weeklyPlans.teacher.hwLabel")),1),b[17]||(b[17]=S()),P("span",{innerHTML:Yl((null==l?void 0:l.hw)||"-")},null,8,X)]),P("div",null,[P("strong",null,L(x(pl)("weeklyPlans.teacher.notesLabel")),1),b[18]||(b[18]=S()),P("span",{innerHTML:Yl((null==l?void 0:l.notes)||"-")},null,8,Y)])])])}),128))])]),_:1})])]),j(i,{modelValue:Tl.value,"onUpdate:modelValue":b[9]||(b[9]=l=>Tl.value=l)},{default:C(()=>[j(o,{style:{"min-width":"520px","max-width":"90vw"}},{default:C(()=>[j(u,{class:"row items-center q-pb-none"},{default:C(()=>[P("div",Z,L(x(pl)("weeklyPlans.copyPlansTitle")),1),j(v),T(j(e,{icon:"close",flat:"",round:"",dense:""},null,512),[[c]])]),_:1}),j(t),j(u,null,{default:C(()=>[P("div",ll,[j(l,{modelValue:$l.value,"onUpdate:modelValue":b[6]||(b[6]=l=>$l.value=l),options:Cl.value,"emit-value":"","map-options":"",outlined:"",label:x(pl)("weeklyPlans.teacher.fromClassroom"),disable:0===Cl.value.length},null,8,["modelValue","options","label","disable"]),j(l,{modelValue:Ml.value,"onUpdate:modelValue":b[7]||(b[7]=l=>Ml.value=l),options:Jl.value,"emit-value":"","map-options":"",outlined:"",label:x(pl)("weeklyPlans.teacher.filters.subject"),disable:!$l.value||0===Jl.value.length},null,8,["modelValue","options","label","disable"]),j(l,{modelValue:Nl.value,"onUpdate:modelValue":b[8]||(b[8]=l=>Nl.value=l),options:Wl.value,"use-chips":"",multiple:"","emit-value":"","map-options":"",outlined:"",label:x(pl)("weeklyPlans.teacher.toClassrooms"),disable:!$l.value||0===Wl.value.length},null,8,["modelValue","options","label","disable"]),P("div",el,L(x(pl)("weeklyPlans.week"))+" "+L(Hl.value)+" • "+L(x(pl)("weeklyPlans.semester"))+" "+L(Bl.value),1)])]),_:1}),j(t),Rl.value?(_(),V(u,{key:0},{default:C(()=>[P("div",al,L(x(pl)("weeklyPlans.sourceRecords")),1),j(y,{dense:"",flat:"",bordered:""},{default:C(()=>[P("thead",null,[P("tr",null,[P("th",null,L(x(pl)("weeklyPlans.teacher.filters.day")),1),P("th",null,L(x(pl)("weeklyPlans.teacher.periodOrder")),1),b[19]||(b[19]=P("th",null,"CW",-1)),P("th",null,L(x(pl)("weeklyPlans.teacher.hwLabel")),1),P("th",null,L(x(pl)("weeklyPlans.teacher.notesLabel")),1)])]),P("tbody",null,[(_(!0),g(U,null,q(Rl.value.source,l=>{var e;return _(),g("tr",{key:l.weekly_plan_id},[P("td",null,L(wl(l.day)),1),P("td",null,L(null!=(e=l.period_order)?e:"-"),1),P("td",nl,L(l.cw),1),P("td",rl,L(l.hw),1),P("td",sl,L(l.notes),1)])}),128))])]),_:1}),P("div",ol,L(x(pl)("weeklyPlans.targets")),1),(_(!0),g(U,null,q(Rl.value.targets,l=>(_(),g("div",{key:l.to_classroom_id,class:"q-mt-sm"},[P("div",ul,L(l("weeklyPlans.teacher.filters.classroom"))+" #"+L(l.to_classroom_id),1),j(y,{dense:"",flat:"",bordered:""},{default:C(()=>[P("thead",null,[P("tr",null,[P("th",null,L(l("weeklyPlans.teacher.srcDay")),1),P("th",null,L(l("weeklyPlans.teacher.srcOrder")),1),P("th",null,L(l("weeklyPlans.teacher.targetOrder")),1),P("th",null,L(l("weeklyPlans.teacher.ordersMatch")),1),P("th",null,L(l("weeklyPlans.teacher.willUpdate")),1),P("th",null,L(l("weeklyPlans.teacher.filters.classroom"))+" CW",1),P("th",null,L(l("weeklyPlans.teacher.filters.classroom"))+" HW",1),P("th",null,L(l("weeklyPlans.teacher.filters.classroom"))+" "+L(l("weeklyPlans.teacher.notesLabel")),1)])]),P("tbody",null,[(_(!0),g(U,null,q(l.matches,e=>{var a,n,r,s,o,u,t,d;return _(),g("tr",{key:e.source_weekly_plan_id},[P("td",null,L(wl(null!=(n=e.source_day)?n:null==(a=Rl.value.source.find(l=>l.weekly_plan_id===e.source_weekly_plan_id))?void 0:a.day)),1),P("td",null,L(null!=(s=e.source_period_order)?s:null==(r=Rl.value.source.find(l=>l.weekly_plan_id===e.source_weekly_plan_id))?void 0:r.period_order),1),P("td",null,L(null!=(o=e.target_period_order)?o:"-"),1),P("td",null,[P("span",{class:M(null!=e.source_period_order&&null!=e.target_period_order?e.source_period_order===e.target_period_order?"text-positive":"text-negative":"text-grey-7")},L(null!=e.source_period_order&&null!=e.target_period_order?e.source_period_order===e.target_period_order?l("weeklyPlans.yes"):l("weeklyPlans.no"):"-"),3)]),P("td",null,L(e.has_target_plan?l("weeklyPlans.yes"):`${l("weeklyPlans.no")} (${l("weeklyPlans.skipped")})`),1),P("td",tl,L(null!=(u=e.target_cw)?u:"-"),1),P("td",dl,L(null!=(t=e.target_hw)?t:"-"),1),P("td",il,L(null!=(d=e.target_notes)?d:"-"),1)])}),128))])]),_:2},1024)]))),128))]),_:1})):Q("",!0),j(t),j(d,{align:"right"},{default:C(()=>{var l,a;return[T(j(e,{flat:"",label:x(pl)("weeklyPlans.cancel")},null,8,["label"]),[[c]]),Rl.value?(_(),V(e,{key:1,color:"primary",loading:Il.value,disable:!(null==(a=null==(l=Rl.value)?void 0:l.operations)?void 0:a.length),label:x(pl)("weeklyPlans.save"),onClick:Gl},null,8,["loading","disable","label"])):(_(),V(e,{key:0,color:"primary",loading:Dl.value,disable:!Al.value,label:x(pl)("weeklyPlans.preview"),onClick:zl},null,8,["loading","disable","label"]))]}),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{cl as default};
