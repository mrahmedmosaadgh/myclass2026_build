import{Q as l}from"./QSelect-CnZtzPIC.js";import{Q as e,o as a,q as n,C as r,g as s,n as o,d as u,a as t,m as d,b as i,aD as c}from"./app-BXm70mdJ.js";import{Q as v}from"./QSpace-Bu8V-QDa.js";import{Q as m}from"./QTd-BIxMTYzb.js";import{Q as p}from"./QTable-rnEofRem.js";import{Q as y}from"./QMarkupTable-Dmg3C5Wm.js";import{a as h,r as b,f as w,k,L as f,I as g,M as _,b as P,y as j,H as x,J as V,V as C,U as L,F as S,Q as q,O as U,x as Q,Z as M,S as $}from"./vendor-DNM7Y6Xn.js";import{u as O}from"./i18n-CBOKL2HS.js";import"./rtl-Cr6c3OOr.js";import"./offline-BzIlwqNM.js";import"./ui-BP0GJNn5.js";import"./QLinearProgress-Cix0cchl.js";import"./use-fullscreen-FlxrEg_V.js";const T={class:"row q-gutter-sm q-mb-md items-end"},N={id:"plans-table-print"},H={class:"screen-only"},W={class:"subject-sub"},A={key:1},B={key:1},D={key:1},I={class:"text-h6 text-center q-mb-sm"},E={class:"print-only"},F={class:"print-header"},R={class:"meta"},J={class:"meta"},K={class:"meta"},Z={class:"subject-sub"},z=["innerHTML"],G=["innerHTML"],X=["innerHTML"],Y={class:"text-h6"},ll={class:"q-gutter-md"},el={class:"text-caption text-grey-7"},al={class:"text-subtitle2 q-mb-sm"},nl={style:{"max-width":"220px"}},rl={style:{"max-width":"220px"}},sl={style:{"max-width":"220px"}},ol={class:"q-mt-md text-subtitle2"},ul={class:"text-caption text-grey-7 q-mb-xs"},tl={style:{"max-width":"220px"}},dl={style:{"max-width":"220px"}},il={style:{"max-width":"220px"}},cl={__name:"WeeklyPlansTable",props:{plans:{type:Array,default:()=>[]},weekNumber:{type:Number,required:!0},semesterNumber:{type:Number,required:!0}},emits:["edit","copied"],setup(cl,{emit:vl}){const{t:ml,locale:pl}=O(),yl=h(()=>"ar"===pl.value?"right":"left"),hl=cl,bl=vl,wl=l=>l?ml(`weeklyPlans.fullDays.${l}`)||`Day ${l}`:"-",kl=l=>l?`${ml("weeklyPlans.teacher.filters.grade")} ${l}`:"-",fl=b({day:null,classroom:null,grade:null,subject:null}),gl=()=>{fl.day=fl.classroom=fl.grade=fl.subject=null},_l=w(!1),Pl=h(()=>[{name:"dayName",label:ml("weeklyPlans.teacher.filters.day"),field:"dayName",align:yl.value,sortable:!0},{name:"period",label:ml("weeklyPlans.period"),field:l=>{var e,a;return null!=(a=null==(e=l.schedule)?void 0:e.period_number)?a:"-"},align:"center",sortable:!0},{name:"periodOrder",label:ml("weeklyPlans.teacher.periodOrder"),field:l=>{var e,a;return null!=(a=null==(e=l.schedule)?void 0:e.period_order)?a:"-"},align:"center",sortable:!0},{name:"classroom",label:ml("weeklyPlans.teacher.filters.classroom"),field:l=>{var e,a,n,r;return null!=(r=null==(n=null==(a=null==(e=l.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.name)?r:"-"},align:yl.value,sortable:!0,style:"width: 1%;",headerStyle:"width: 1%;"},{name:"grade",label:ml("weeklyPlans.teacher.filters.grade"),field:l=>{var e;return kl(null==(e=l.schedule)?void 0:e.grade_id)},align:yl.value},{name:"subject",label:ml("weeklyPlans.teacher.filters.subject"),field:l=>{var e,a,n,r;return null!=(r=null==(n=null==(a=null==(e=l.schedule)?void 0:e.cst)?void 0:a.subject)?void 0:n.name)?r:"-"},align:yl.value,sortable:!0},{name:"cw",label:"CW",field:"cw",align:yl.value},{name:"hw",label:"HW",field:"hw",align:yl.value},{name:"notes",label:ml("weeklyPlans.teacher.notesLabel"),field:"notes",align:yl.value},{name:"status",label:ml("weeklyPlans.status"),field:"status",align:yl.value},{name:"actions",label:ml("weeklyPlans.previewAndPrint"),field:l=>l.id,align:"right"}]),jl=h(()=>Fl.value?Pl.value:Pl.value.filter(l=>"periodOrder"!==l.name)),xl=(l,e)=>{const a=new Set;return l.filter(l=>{const n=e(l);return null!=n&&!a.has(n)&&(a.add(n),!0)})},Vl=h(()=>xl(hl.plans.filter(l=>{var e;return null!=(null==(e=null==l?void 0:l.schedule)?void 0:e.day)}),l=>l.schedule.day).map(l=>({label:wl(l.schedule.day),value:l.schedule.day})).sort((l,e)=>l.value-e.value)),Cl=h(()=>xl(hl.plans.filter(l=>{var e,a;return null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.classroom}),l=>l.schedule.cst.classroom.id).map(l=>({label:l.schedule.cst.classroom.name,value:l.schedule.cst.classroom.id})).sort((l,e)=>l.label.localeCompare(e.label))),Ll=h(()=>xl(hl.plans.filter(l=>{var e;return null!=(null==(e=null==l?void 0:l.schedule)?void 0:e.grade_id)}),l=>l.schedule.grade_id).map(l=>({label:kl(l.schedule.grade_id),value:l.schedule.grade_id})).sort((l,e)=>{var a,n;return(null!=(a=l.value)?a:0)-(null!=(n=e.value)?n:0)})),Sl=h(()=>xl(hl.plans.filter(l=>{var e,a;return null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.subject}),l=>l.schedule.cst.subject.id).map(l=>({label:l.schedule.cst.subject.name,value:l.schedule.cst.subject.id})).sort((l,e)=>l.label.localeCompare(e.label))),ql=h(()=>hl.plans.filter(l=>{var e,a,n,r,s,o,u,t;return!(fl.day&&(null==(e=null==l?void 0:l.schedule)?void 0:e.day)!==fl.day||fl.classroom&&(null==(r=null==(n=null==(a=null==l?void 0:l.schedule)?void 0:a.cst)?void 0:n.classroom)?void 0:r.id)!==fl.classroom||fl.grade&&(null==(s=null==l?void 0:l.schedule)?void 0:s.grade_id)!==fl.grade||fl.subject&&(null==(t=null==(u=null==(o=null==l?void 0:l.schedule)?void 0:o.cst)?void 0:u.subject)?void 0:t.id)!==fl.subject)})),Ul=h(()=>{var l,e,a,n,r,s,o,u;const t=new Map;for(const d of ql.value){const i=null!=(n=null==(a=null==(e=null==(l=null==d?void 0:d.schedule)?void 0:l.cst)?void 0:e.classroom)?void 0:a.id)?n:"unknown",c=null!=(u=null==(o=null==(s=null==(r=null==d?void 0:d.schedule)?void 0:r.cst)?void 0:s.classroom)?void 0:o.name)?u:"Unknown classroom";t.has(i)||t.set(i,{id:i,name:c,rows:[]}),t.get(i).rows.push(d)}for(const d of t.values())d.rows.sort((l,e)=>{var a,n,r,s;const o=((null==(a=null==l?void 0:l.schedule)?void 0:a.day)||0)-((null==(n=null==e?void 0:e.schedule)?void 0:n.day)||0);if(0!==o)return o;const u=((null==(r=null==l?void 0:l.schedule)?void 0:r.period_number)||0)-((null==(s=null==e?void 0:e.schedule)?void 0:s.period_number)||0);return 0!==u?u:((null==l?void 0:l.id)||0)-((null==e?void 0:e.id)||0)});return Array.from(t.values()).sort((l,e)=>String(l.name).localeCompare(String(e.name)))}),Ql=l=>({empty:ml("weeklyPlans.empty"),partial:ml("weeklyPlans.partial"),completed:ml("weeklyPlans.completed")}[l]||l||"-"),Ml=w(!1),$l=w(null),Ol=w(null),Tl=w([]);w(!1);const Nl=()=>{$l.value=fl.classroom||null,Ol.value=fl.subject||null,Tl.value=[],Dl.value=null,Ml.value=!0},Hl=h(()=>Cl.value.filter(l=>l.value!==$l.value)),Wl=h(()=>!!$l.value&&!!Ol.value&&Tl.value.length>0),Al=h(()=>hl.weekNumber),Bl=h(()=>hl.semesterNumber),Dl=w(null),Il=w(!1),El=w(!1),Fl=w(!1),Rl=w(""),Jl=async()=>{if(Wl.value)try{Il.value=!0;const{data:l}=await M.post("/weekly-system/api/teacher/copy-plans-classrooms/preview",{from_classroom_id:$l.value,subject_id:Ol.value,to_classroom_ids:Tl.value,week_number:Al.value,semester_number:Bl.value});Dl.value=l}catch(l){console.error("Preview failed",l)}finally{Il.value=!1}},Kl=async()=>{var l,e;if(null==(e=null==(l=Dl.value)?void 0:l.operations)?void 0:e.length)try{El.value=!0,await M.post("/weekly-system/api/teacher/copy-plans-classrooms/commit",{operations:Dl.value.operations}),Ml.value=!1,bl("copied")}catch(a){console.error("Commit failed",a)}finally{El.value=!1}else Ml.value=!1},Zl=h(()=>{if(!$l.value)return[];return xl(hl.plans.filter(l=>{var e,a,n,r,s;return(null==(n=null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.id)===$l.value&&(null==(s=null==(r=null==l?void 0:l.schedule)?void 0:r.cst)?void 0:s.subject)}),l=>l.schedule.cst.subject.id).map(l=>({label:l.schedule.cst.subject.name,value:l.schedule.cst.subject.id})).sort((l,e)=>l.label.localeCompare(e.label))});k([$l,Ol],async([l,e])=>{Ml.value&&l&&e?await Jl():Dl.value=null}),k(Tl,async l=>{Ml.value&&$l.value&&Ol.value&&await Jl()});const zl=l=>String(null!=l?l:"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),Gl=l=>String(null!=l?l:"").replace(/&/g,"&amp;").replace(/"/g,"&quot;"),Xl=l=>{const e=String(null!=l?l:""),a=/\[([^\]]+)\]\((https?:\/\/[^\s)]+)\)/g,n=/(https?:\/\/[^\s]+)/g,r=l=>{let e,a="",r=0;for(;null!==(e=n.exec(l));){a+=zl(l.slice(r,e.index));const s=e[1];a+=`<a href="${Gl(s)}" target="_blank" rel="noopener noreferrer">${zl(s)}</a>`,r=n.lastIndex}return a+=zl(l.slice(r)),a};let s,o="",u=0;for(;null!==(s=a.exec(e));){o+=r(e.slice(u,s.index));const l=zl(s[1]);o+=`<a href="${Gl(s[2])}" target="_blank" rel="noopener noreferrer">${l}</a>`,u=a.lastIndex}return o+=r(e.slice(u)),o||"-"},Yl=()=>{var l,e;const a=new URLSearchParams({week:String(null!=(l=Al.value)?l:""),semester:String(null!=(e=Bl.value)?e:""),day:null!=fl.day?String(fl.day):"",classroom:null!=fl.classroom?String(fl.classroom):"",subject:null!=fl.subject?String(fl.subject):"",grade:null!=fl.grade?String(fl.grade):""});_l.value&&a.set("group","classroom"),window.open(`/weekly-plans-print.html?${a.toString()}`,"_blank","noopener,noreferrer")};return(h,b)=>{var w,k;return g(),f("div",null,[_("div",T,[P(l,{modelValue:fl.day,"onUpdate:modelValue":b[0]||(b[0]=l=>fl.day=l),options:Vl.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:j(ml)("weeklyPlans.teacher.filters.day"),style:{"min-width":"160px"}},null,8,["modelValue","options","label"]),P(l,{modelValue:fl.classroom,"onUpdate:modelValue":b[1]||(b[1]=l=>fl.classroom=l),options:Cl.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:j(ml)("weeklyPlans.teacher.filters.classroom"),style:{"min-width":"200px"}},null,8,["modelValue","options","label"]),P(l,{modelValue:fl.grade,"onUpdate:modelValue":b[2]||(b[2]=l=>fl.grade=l),options:Ll.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:j(ml)("weeklyPlans.teacher.filters.grade"),style:{"min-width":"160px"}},null,8,["modelValue","options","label"]),P(l,{modelValue:fl.subject,"onUpdate:modelValue":b[3]||(b[3]=l=>fl.subject=l),options:Sl.value,dense:"",outlined:"",clearable:"","emit-value":"","map-options":"",label:j(ml)("weeklyPlans.teacher.filters.subject"),style:{"min-width":"200px"}},null,8,["modelValue","options","label"]),P(e,{flat:"",dense:"",icon:"refresh",color:"primary",onClick:gl,label:j(ml)("weeklyPlans.teacher.filters.clear")},null,8,["label"]),P(v),P(e,{color:"primary",dense:"",unelevated:"",icon:"content_copy",label:j(ml)("weeklyPlans.copy"),onClick:Nl},null,8,["label"]),P(e,{color:_l.value?"primary":"grey-7",outline:!_l.value,dense:"",icon:"table_rows",label:j(ml)("weeklyPlans.groupByClassroom"),onClick:b[4]||(b[4]=l=>_l.value=!_l.value)},null,8,["color","outline","label"]),P(e,{color:"primary",dense:"",unelevated:"",icon:"print",label:j(ml)("weeklyPlans.print"),onClick:Yl},null,8,["label"]),P(a,{modelValue:Fl.value,"onUpdate:modelValue":b[5]||(b[5]=l=>Fl.value=l),label:j(ml)("weeklyPlans.periodOrderEdit"),color:"primary",class:"q-ml-md"},null,8,["modelValue","label"])]),_("div",N,[_("div",H,[_l.value?(g(),f("div",D,[(g(!0),f(S,null,q(Ul.value,l=>(g(),f("div",{key:l.id,class:"q-mb-xl"},[_("div",I,L(j(ml)("weeklyPlans.teacher.filters.classroom"))+": "+L(l.name),1),P(y,{dense:"",flat:"",bordered:""},{default:V(()=>[_("thead",null,[_("tr",null,[_("th",null,L(j(ml)("weeklyPlans.teacher.filters.day")),1),_("th",null,L(j(ml)("weeklyPlans.period")),1),_("th",null,L(j(ml)("weeklyPlans.periodOrder")),1),_("th",null,L(j(ml)("weeklyPlans.weeklyLearningPlan")),1)])]),_("tbody",null,[(g(!0),f(S,null,q(l.rows,l=>{var e,a,n,r,s;return g(),f("tr",{key:l.id},[_("td",null,L(wl(null==(e=null==l?void 0:l.schedule)?void 0:e.day)),1),_("td",null,L(null!=(n=null==(a=null==l?void 0:l.schedule)?void 0:a.period_number)?n:"-"),1),_("td",null,L(null!=(s=null==(r=null==l?void 0:l.schedule)?void 0:r.period_order)?s:"-"),1),_("td",null,[_("div",null,[b[11]||(b[11]=_("strong",null,"CW:",-1)),C(" "+L((null==l?void 0:l.cw)||"-"),1)]),_("div",null,[_("strong",null,L(j(ml)("weeklyPlans.teacher.hwLabel")),1),C(" "+L((null==l?void 0:l.hw)||"-"),1)]),_("div",null,[_("strong",null,L(j(ml)("weeklyPlans.teacher.notesLabel")),1),C(" "+L((null==l?void 0:l.notes)||"-"),1)])])])}),128))])]),_:2},1024)]))),128))])):(g(),x(p,{key:0,flat:"",bordered:"",rows:ql.value,columns:jl.value,"row-key":"id",pagination:{rowsPerPage:10}},{"body-cell-dayName":V(l=>[P(m,{props:l},{default:V(()=>{var e;return[C(L(wl(null==(e=l.row.schedule)?void 0:e.day)),1)]}),_:2},1032,["props"])]),"body-cell-classroom":V(l=>[P(m,{props:l},{default:V(()=>{var e,a,n,r,s,o,u,t;return[C(L((null==(n=null==(a=null==(e=l.row.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.name)||"-")+" ",1),_("div",W,L((null==(o=null==(s=null==(r=l.row.schedule)?void 0:r.cst)?void 0:s.subject)?void 0:o.name)||"-")+" ("+L(null!=(t=null==(u=l.row.schedule)?void 0:u.period_order)?t:"-")+") ",1)]}),_:2},1032,["props"])]),"body-cell-grade":V(l=>[P(m,{props:l},{default:V(()=>{var e;return[C(L(kl(null==(e=l.row.schedule)?void 0:e.grade_id)),1)]}),_:2},1032,["props"])]),"body-cell-subject":V(l=>[P(m,{props:l},{default:V(()=>{var e,a,n;return[C(L((null==(n=null==(a=null==(e=l.row.schedule)?void 0:e.cst)?void 0:a.subject)?void 0:n.name)||"-"),1)]}),_:2},1032,["props"])]),"body-cell-periodOrder":V(l=>[P(m,{props:l},{default:V(()=>{var e,a,n;return[(null==(e=l.row.schedule)?void 0:e.id)?(g(),f(S,{key:0},[Fl.value?(g(),x(s,{key:0,dense:"",outlined:"",type:"number",min:"1",style:{"max-width":"90px"},modelValue:l.row.schedule.period_order,"onUpdate:modelValue":e=>l.row.schedule.period_order=e,modelModifiers:{number:!0},onBlur:e=>(async l=>{var e,a;try{if(!(null==(e=null==l?void 0:l.schedule)?void 0:e.id)||!(null==(a=null==l?void 0:l.schedule)?void 0:a.period_order))return;await M.put(`/weekly-system/api/schedules/${l.schedule.id}/period-order`,{period_order:l.schedule.period_order})}catch(n){console.error("Failed to update period_order",n)}})(l.row)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):(g(),f("span",A,L(null!=(n=null==(a=l.row.schedule)?void 0:a.period_order)?n:"-"),1))],64)):(g(),f("span",B,"-"))]}),_:2},1032,["props"])]),"body-cell-status":V(l=>[P(m,{props:l},{default:V(()=>{return[P(r,{dense:"",color:(e=l.row.status,{empty:"grey",partial:"amber",completed:"green"}[e]||"primary"),"text-color":"white"},{default:V(()=>[C(L(Ql(l.row.status)),1)]),_:2},1032,["color"])];var e}),_:2},1032,["props"])]),"body-cell-actions":V(l=>[P(m,{props:l,class:"text-right"},{default:V(()=>[P(e,{flat:"",dense:"",round:"",icon:"edit",color:"primary",onClick:e=>{return a=l.row,bl("edit",a);var a}},{default:V(()=>[P(n,null,{default:V(()=>b[10]||(b[10]=[C("Edit")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]))]),_("div",E,[_("div",F,[_("h1",null,L(j(ml)("weeklyPlans.teacher.myWeeklyPlans")),1),_("div",R,L(j(ml)("weeklyPlans.week"))+" "+L(Al.value)+" • "+L(j(ml)("weeklyPlans.semester"))+" "+L(Bl.value),1),_("div",J,[C(L(j(ml)("weeklyPlans.teacher.tableView"))+": ",1),_("span",null,L(j(ml)("weeklyPlans.teacher.filters.day"))+": "+L(fl.day?wl(fl.day):j(ml)("common.all")||"All"),1),b[12]||(b[12]=C(" | ")),_("span",null,L(j(ml)("weeklyPlans.teacher.filters.classroom"))+": "+L(fl.classroom?(null==(w=Cl.value.find(l=>l.value===fl.classroom))?void 0:w.label)||fl.classroom:j(ml)("common.all")||"All"),1),b[13]||(b[13]=C(" | ")),_("span",null,L(j(ml)("weeklyPlans.teacher.filters.subject"))+": "+L(fl.subject?(null==(k=Sl.value.find(l=>l.value===fl.subject))?void 0:k.label)||fl.subject:j(ml)("common.all")||"All"),1),b[14]||(b[14]=C(" | ")),_("span",null,L(j(ml)("weeklyPlans.teacher.filters.grade"))+": "+L(fl.grade?kl(fl.grade):j(ml)("common.all")||"All"),1)]),_("div",K,L(j(ml)("weeklyPlans.teacher.generated"))+" "+L(Rl.value),1)]),P(y,{flat:"",bordered:"",dense:""},{default:V(()=>[_("thead",null,[_("tr",null,[_("th",null,L(j(ml)("weeklyPlans.teacher.filters.classroom")),1),_("th",null,L(j(ml)("weeklyPlans.teacher.filters.day")),1),_("th",null,L(j(ml)("weeklyPlans.period")),1),_("th",null,L(j(ml)("weeklyPlans.weeklyLearningPlan")),1)])]),_("tbody",null,[(g(!0),f(S,null,q(ql.value,l=>{var e,a,n,r,s,o,u,t,d,i,c;return g(),f("tr",{key:l.id},[_("td",null,[C(L((null==(n=null==(a=null==(e=null==l?void 0:l.schedule)?void 0:e.cst)?void 0:a.classroom)?void 0:n.name)||"-")+" ",1),_("div",Z,L((null==(o=null==(s=null==(r=null==l?void 0:l.schedule)?void 0:r.cst)?void 0:s.subject)?void 0:o.name)||"-")+" ("+L(null!=(t=null==(u=null==l?void 0:l.schedule)?void 0:u.period_order)?t:"-")+")",1)]),_("td",null,L(wl(null==(d=null==l?void 0:l.schedule)?void 0:d.day)),1),_("td",null,L(null!=(c=null==(i=null==l?void 0:l.schedule)?void 0:i.period_number)?c:"-"),1),_("td",null,[_("div",null,[b[15]||(b[15]=_("strong",null,"CW:",-1)),b[16]||(b[16]=C()),_("span",{innerHTML:Xl((null==l?void 0:l.cw)||"-")},null,8,z)]),_("div",null,[_("strong",null,L(j(ml)("weeklyPlans.teacher.hwLabel")),1),b[17]||(b[17]=C()),_("span",{innerHTML:Xl((null==l?void 0:l.hw)||"-")},null,8,G)]),_("div",null,[_("strong",null,L(j(ml)("weeklyPlans.teacher.notesLabel")),1),b[18]||(b[18]=C()),_("span",{innerHTML:Xl((null==l?void 0:l.notes)||"-")},null,8,X)])])])}),128))])]),_:1})])]),P(i,{modelValue:Ml.value,"onUpdate:modelValue":b[9]||(b[9]=l=>Ml.value=l)},{default:V(()=>[P(o,{style:{"min-width":"520px","max-width":"90vw"}},{default:V(()=>[P(u,{class:"row items-center q-pb-none"},{default:V(()=>[_("div",Y,L(j(ml)("weeklyPlans.copyPlansTitle")),1),P(v),Q(P(e,{icon:"close",flat:"",round:"",dense:""},null,512),[[c]])]),_:1}),P(t),P(u,null,{default:V(()=>[_("div",ll,[P(l,{modelValue:$l.value,"onUpdate:modelValue":b[6]||(b[6]=l=>$l.value=l),options:Cl.value,"emit-value":"","map-options":"",outlined:"",label:j(ml)("weeklyPlans.teacher.fromClassroom"),disable:0===Cl.value.length},null,8,["modelValue","options","label","disable"]),P(l,{modelValue:Ol.value,"onUpdate:modelValue":b[7]||(b[7]=l=>Ol.value=l),options:Zl.value,"emit-value":"","map-options":"",outlined:"",label:j(ml)("weeklyPlans.teacher.filters.subject"),disable:!$l.value||0===Zl.value.length},null,8,["modelValue","options","label","disable"]),P(l,{modelValue:Tl.value,"onUpdate:modelValue":b[8]||(b[8]=l=>Tl.value=l),options:Hl.value,"use-chips":"",multiple:"","emit-value":"","map-options":"",outlined:"",label:j(ml)("weeklyPlans.teacher.toClassrooms"),disable:!$l.value||0===Hl.value.length},null,8,["modelValue","options","label","disable"]),_("div",el,L(j(ml)("weeklyPlans.week"))+" "+L(Al.value)+" • "+L(j(ml)("weeklyPlans.semester"))+" "+L(Bl.value),1)])]),_:1}),P(t),Dl.value?(g(),x(u,{key:0},{default:V(()=>[_("div",al,L(j(ml)("weeklyPlans.sourceRecords")),1),P(y,{dense:"",flat:"",bordered:""},{default:V(()=>[_("thead",null,[_("tr",null,[_("th",null,L(j(ml)("weeklyPlans.teacher.filters.day")),1),_("th",null,L(j(ml)("weeklyPlans.teacher.periodOrder")),1),b[19]||(b[19]=_("th",null,"CW",-1)),_("th",null,L(j(ml)("weeklyPlans.teacher.hwLabel")),1),_("th",null,L(j(ml)("weeklyPlans.teacher.notesLabel")),1)])]),_("tbody",null,[(g(!0),f(S,null,q(Dl.value.source,l=>{var e;return g(),f("tr",{key:l.weekly_plan_id},[_("td",null,L(wl(l.day)),1),_("td",null,L(null!=(e=l.period_order)?e:"-"),1),_("td",nl,L(l.cw),1),_("td",rl,L(l.hw),1),_("td",sl,L(l.notes),1)])}),128))])]),_:1}),_("div",ol,L(j(ml)("weeklyPlans.targets")),1),(g(!0),f(S,null,q(Dl.value.targets,l=>(g(),f("div",{key:l.to_classroom_id,class:"q-mt-sm"},[_("div",ul,L(l("weeklyPlans.teacher.filters.classroom"))+" #"+L(l.to_classroom_id),1),P(y,{dense:"",flat:"",bordered:""},{default:V(()=>[_("thead",null,[_("tr",null,[_("th",null,L(l("weeklyPlans.teacher.srcDay")),1),_("th",null,L(l("weeklyPlans.teacher.srcOrder")),1),_("th",null,L(l("weeklyPlans.teacher.targetOrder")),1),_("th",null,L(l("weeklyPlans.teacher.ordersMatch")),1),_("th",null,L(l("weeklyPlans.teacher.willUpdate")),1),_("th",null,L(l("weeklyPlans.teacher.filters.classroom"))+" CW",1),_("th",null,L(l("weeklyPlans.teacher.filters.classroom"))+" HW",1),_("th",null,L(l("weeklyPlans.teacher.filters.classroom"))+" "+L(l("weeklyPlans.teacher.notesLabel")),1)])]),_("tbody",null,[(g(!0),f(S,null,q(l.matches,e=>{var a,n,r,s,o,u,t,d;return g(),f("tr",{key:e.source_weekly_plan_id},[_("td",null,L(wl(null!=(n=e.source_day)?n:null==(a=Dl.value.source.find(l=>l.weekly_plan_id===e.source_weekly_plan_id))?void 0:a.day)),1),_("td",null,L(null!=(s=e.source_period_order)?s:null==(r=Dl.value.source.find(l=>l.weekly_plan_id===e.source_weekly_plan_id))?void 0:r.period_order),1),_("td",null,L(null!=(o=e.target_period_order)?o:"-"),1),_("td",null,[_("span",{class:$(null!=e.source_period_order&&null!=e.target_period_order?e.source_period_order===e.target_period_order?"text-positive":"text-negative":"text-grey-7")},L(null!=e.source_period_order&&null!=e.target_period_order?e.source_period_order===e.target_period_order?l("weeklyPlans.yes"):l("weeklyPlans.no"):"-"),3)]),_("td",null,L(e.has_target_plan?l("weeklyPlans.yes"):`${l("weeklyPlans.no")} (${l("weeklyPlans.skipped")})`),1),_("td",tl,L(null!=(u=e.target_cw)?u:"-"),1),_("td",dl,L(null!=(t=e.target_hw)?t:"-"),1),_("td",il,L(null!=(d=e.target_notes)?d:"-"),1)])}),128))])]),_:2},1024)]))),128))]),_:1})):U("",!0),P(t),P(d,{align:"right"},{default:V(()=>{var l,a;return[Q(P(e,{flat:"",label:j(ml)("weeklyPlans.cancel")},null,8,["label"]),[[c]]),Dl.value?(g(),x(e,{key:1,color:"primary",loading:El.value,disable:!(null==(a=null==(l=Dl.value)?void 0:l.operations)?void 0:a.length),label:j(ml)("weeklyPlans.save"),onClick:Kl},null,8,["loading","disable","label"])):(g(),x(e,{key:0,color:"primary",loading:Il.value,disable:!Wl.value,label:j(ml)("weeklyPlans.preview"),onClick:Jl},null,8,["loading","disable","label"]))]}),_:1})]),_:1})]),_:1},8,["modelValue"])])}}};export{cl as default};
