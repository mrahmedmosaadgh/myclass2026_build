import{u as e,Q as a,a as l,b as s}from"./app-DOc39CFu.js";import{Q as o}from"./QTab-Dldfuhzv.js";import{Q as t}from"./QTabs-CQbEg8iR.js";import{Q as u}from"./QTabPanel-C5l4w7rK.js";import{Q as n}from"./QTabPanels-D4WV1jNy.js";import{O as m,f as i,k as r,I as d,J as p,K as c,N as v,b as y,M as f,R as b,F as j,_ as g,$ as Q}from"./vendor-DuKqz2x4.js";import{u as V,A as M}from"./AdminLayout-CCgn0nWg.js";import C from"./MenuList-D4mCejGS.js";import _ from"./MenuForm-Dr_xasoH.js";import h from"./MenuDeleteDialog-DKcmvJxJ.js";import k from"./BulkImportDialog-C8-3NHv5.js";import"./offline-BzIlwqNM.js";import"./i18n-DE5KxGn8.js";import"./ui-BITzTqrO.js";import"./rtl-Cr6c3OOr.js";import"./use-panel-Ddka6S_L.js";import"./use-render-cache-CmTcazfP.js";import"./QBadge-Dz6oAuer.js";import"./QSpace-DuS_4lXE.js";import"./QSelect-Dkiz84LX.js";import"./QForm-CqUo2wlA.js";import"./QStepperNavigation-Mv9Q7tio.js";import"./QStepper-BS9Llc3-.js";import"./copy-to-clipboard-CCj9pgC1.js";const U={class:"q-pa-md"},w={class:"row q-mb-md items-center"},F={class:"col-auto"},S={__name:"MenuManagement",props:{menus:Array,modules:Array},setup(S){const x=e();m();const A=S,I=i(A.modules[0]||"academics"),T=i(!1),D=i(!1),q=i(!1),B=i(!1),L=i(null),N=i(null),P=e=>A.menus.filter(a=>a.module===e),R=e=>e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");r(D,e=>{e&&(L.value=null,T.value=!0,D.value=!1)});const $=e=>{L.value=e,T.value=!0},J=e=>{N.value=e,q.value=!0},K=async e=>{var a,l;try{L.value?(await g.put(`/api/admin/menus/${L.value.id}`,e),x.notify({type:"positive",message:"Menu updated successfully"})):(await g.post("/api/admin/menus",e),x.notify({type:"positive",message:"Menu created successfully"})),G(),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to save menu"})}},O=async()=>{var e,a;try{await g.delete(`/api/admin/menus/${N.value.id}`),x.notify({type:"positive",message:"Menu deleted successfully"}),q.value=!1,Q.reload({only:["menus"]})}catch(l){x.notify({type:"negative",message:(null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"Failed to delete menu"})}},E=async e=>{var a,l;try{await g.post("/api/admin/menus/reorder",{items:e}),x.notify({type:"positive",message:"Menu order updated successfully"}),Q.reload({only:["menus"]})}catch(s){x.notify({type:"negative",message:(null==(l=null==(a=s.response)?void 0:a.data)?void 0:l.message)||"Failed to reorder menus"})}},W=V(),z=async()=>{await W.invalidateCache(),Q.reload({only:["menus"]})},G=()=>{T.value=!1,L.value=null};return(e,m)=>(p(),d(M,null,{default:c(()=>[v("div",U,[v("div",w,[m[8]||(m[8]=v("div",{class:"col"},[v("div",{class:"text-h4"},"Menu Management"),v("div",{class:"text-subtitle2 text-grey-7"},"Manage navigation menus for your application")],-1)),v("div",F,[y(a,{color:"primary",icon:"add",label:"Create Menu",onClick:m[0]||(m[0]=e=>D.value=!0)}),y(a,{color:"secondary",icon:"upload",label:"Bulk Import",class:"q-ml-sm",onClick:m[1]||(m[1]=e=>B.value=!0)})])]),y(t,{modelValue:I.value,"onUpdate:modelValue":m[2]||(m[2]=e=>I.value=e),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"left"},{default:c(()=>[(p(!0),f(j,null,b(S.modules,e=>(p(),d(o,{key:e,name:e,label:R(e)},null,8,["name","label"]))),128))]),_:1},8,["modelValue"]),y(l),y(n,{modelValue:I.value,"onUpdate:modelValue":m[3]||(m[3]=e=>I.value=e),animated:""},{default:c(()=>[(p(!0),f(j,null,b(S.modules,e=>(p(),d(u,{key:e,name:e},{default:c(()=>[y(C,{menus:P(e),module:e,onEdit:$,onDelete:J,onReorder:E},null,8,["menus","module"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),y(s,{modelValue:T.value,"onUpdate:modelValue":m[4]||(m[4]=e=>T.value=e),persistent:""},{default:c(()=>[y(_,{menu:L.value,modules:S.modules,onSave:K,onCancel:G},null,8,["menu","modules"])]),_:1},8,["modelValue"]),y(h,{modelValue:q.value,"onUpdate:modelValue":m[5]||(m[5]=e=>q.value=e),menu:N.value,onConfirm:O,onCancel:m[6]||(m[6]=e=>q.value=!1)},null,8,["modelValue","menu"]),y(k,{modelValue:B.value,"onUpdate:modelValue":m[7]||(m[7]=e=>B.value=e),onImported:z},null,8,["modelValue"])])]),_:1}))}};export{S as default};
