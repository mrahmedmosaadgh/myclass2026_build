import{u as e,f as t,h as l,m as s,Q as o,g as a,br as i,b as n,d as u}from"./app-CWAnT6CT.js";import{Q as r}from"./QSelect-5P1Qxg14.js";import{Q as c}from"./QForm-BHNk-Zcq.js";import{f as d,a7 as m,N as p,J as b,b as v,K as q,R as _,V as y,a0 as f,O as h,z as w,W as g,I as V,F as x,Q as j}from"./vendor-BWKGNkNB.js";import{s as k}from"./i18n-B0T1C7j3.js";import"./offline-BzIlwqNM.js";import"./ui-B7TfxbV_.js";import"./rtl-Cr6c3OOr.js";const Q={class:"q-pa-md"},C={class:"text-h5"},S={key:0,class:"row q-gutter-md q-mb-md"},U={class:"q-mb-md"},O={key:1,class:"q-mb-md"},A={key:1,class:"text-caption text-positive"},M={key:2,class:"q-mb-md"},F={key:3,class:"q-mb-md"},P={class:"row q-gutter-md q-mb-md"},T={class:"row q-gutter-sm"},E={__name:"QuQuestionForm",props:{subjects:Array,question:Object,selectedSubjectId:[Number,String]},emits:["success"],setup(E,{emit:I}){var z,B,D,$,L,N,R,J,W,H;const K=e(),G=E,X=I,Y=d([]),Z=[{value:"mcq",label:"Multiple Choice (MCQ)"},{value:"true_false",label:"True/False"},{value:"short",label:"Short Answer"},{value:"long",label:"Long Answer (Essay)"}],ee=["easy","medium","hard"],te=[{value:"remember",label:"Remember - Recall facts and basic concepts"},{value:"understand",label:"Understand - Explain ideas or concepts"},{value:"apply",label:"Apply - Use information in new situations"},{value:"analyze",label:"Analyze - Draw connections among ideas"},{value:"evaluate",label:"Evaluate - Justify a decision or course of action"},{value:"create",label:"Create - Produce new or original work"}],le=m({subject_id:(null==(z=G.question)?void 0:z.subject_id)||G.selectedSubjectId||null,topic_id:(null==(B=G.question)?void 0:B.topic_id)||null,question_text:(null==(D=G.question)?void 0:D.question_text)||"",question_type:(null==($=G.question)?void 0:$.question_type)||"mcq",options:(null==(L=G.question)?void 0:L.options)||{A:"",B:"",C:"",D:""},correct_answer:(null==(N=G.question)?void 0:N.correct_answer)||[],difficulty:(null==(R=G.question)?void 0:R.difficulty)||"medium",bloom_level:(null==(J=G.question)?void 0:J.bloom_level)||null,marks:(null==(W=G.question)?void 0:W.marks)||1}),se=e=>{if(e){const t=G.subjects.find(t=>t.id===e);t&&t.curricula&&(Y.value=t.curricula.flatMap(e=>e.curriculum_topics||[]))}else Y.value=[],le.topic_id=null};(null==(H=G.question)?void 0:H.subject_id)?se(G.question.subject_id):G.selectedSubjectId&&se(G.selectedSubjectId);const oe=e=>{"mcq"===e?(le.options={A:"",B:"",C:"",D:""},le.correct_answer=[]):"true_false"===e?(le.options={true:"True",false:"False"},le.correct_answer=["true"]):(le.options={},le.correct_answer=["N/A"])},ae=()=>{"mcq"!==le.question_type||0!==le.correct_answer.length?G.question?le.put(k("qu-questions.update",G.question.id),{onSuccess:()=>{K.notify({type:"positive",message:"Question updated successfully!",icon:"check_circle",position:"top"}),X("success")},onError:e=>{K.notify({type:"negative",message:"Failed to update question. Please check the form.",caption:Object.values(e)[0],position:"top"})}}):le.post(k("qu-questions.store"),{onSuccess:()=>{K.notify({type:"positive",message:"Question created successfully!",icon:"check_circle",position:"top"}),X("success")},onError:e=>{K.notify({type:"negative",message:"Failed to create question. Please check the form.",caption:Object.values(e)[0],position:"top"})}}):K.notify({type:"warning",message:"Please select at least one correct answer for MCQ",position:"top"})};return(e,d)=>(b(),p("div",Q,[v(u,null,{default:q(()=>[v(t,null,{default:q(()=>[_("div",C,y(E.question?"Edit":"Create")+" Question",1)]),_:1}),v(t,null,{default:q(()=>[v(c,{onSubmit:f(ae,["prevent"])},{default:q(()=>[E.selectedSubjectId?h("",!0):(b(),p("div",S,[v(r,{modelValue:w(le).subject_id,"onUpdate:modelValue":[d[0]||(d[0]=e=>w(le).subject_id=e),se],options:E.subjects,"option-value":"id","option-label":"name",label:"Subject *","emit-value":"","map-options":"",style:{flex:"1"},rules:[e=>!!e||"Subject is required"]},null,8,["modelValue","options","rules"])])),_("div",U,[v(r,{modelValue:w(le).topic_id,"onUpdate:modelValue":d[1]||(d[1]=e=>w(le).topic_id=e),options:Y.value,"option-value":"id","option-label":"name",label:"Topic (Optional)",clearable:"","emit-value":"","map-options":"",disable:!w(le).subject_id},null,8,["modelValue","options","disable"])]),v(r,{modelValue:w(le).question_type,"onUpdate:modelValue":[d[2]||(d[2]=e=>w(le).question_type=e),oe],options:Z,"option-value":"value","option-label":"label",label:"Question Type *","emit-value":"","map-options":"",class:"q-mb-md",rules:[e=>!!e||"Please select a question type"]},{hint:q(()=>d[9]||(d[9]=[g(" Choose how students will answer this question ")])),_:1},8,["modelValue","rules"]),v(l,{modelValue:w(le).question_text,"onUpdate:modelValue":d[3]||(d[3]=e=>w(le).question_text=e),type:"textarea",label:"Question Text *",rows:"4",outlined:"",class:"q-mb-md",counter:"",maxlength:"1000",rules:[e=>!!e||"Question text is required",e=>e.length>=10||"Question must be at least 10 characters",e=>e.length<=1e3||"Question must not exceed 1000 characters"]},{hint:q(()=>d[10]||(d[10]=[g(" Write a clear and concise question (10-1000 characters) ")])),_:1},8,["modelValue","rules"]),"mcq"===w(le).question_type?(b(),p("div",O,[d[12]||(d[12]=_("div",{class:"text-subtitle2 q-mb-sm"},"Multiple Choice Options *",-1)),(b(!0),p(x,null,j(w(le).options,(e,t)=>(b(),p("div",{key:t,class:"row q-gutter-sm q-mb-sm items-center"},[v(l,{modelValue:w(le).options[t],"onUpdate:modelValue":e=>w(le).options[t]=e,label:`Option ${t}`,outlined:"",style:{flex:"1"},rules:[e=>!!e||`Option ${t} cannot be empty`,e=>e.length>=1||`Option ${t} must have at least 1 character`]},null,8,["modelValue","onUpdate:modelValue","label","rules"]),v(s,{"model-value":w(le).correct_answer.includes(t),"onUpdate:modelValue":e=>(e=>{const t=le.correct_answer.indexOf(e);t>-1?le.correct_answer.splice(t,1):le.correct_answer.push(e)})(t),label:"Correct",color:"positive"},null,8,["model-value","onUpdate:modelValue"])]))),128)),0===w(le).correct_answer.length?(b(),V(a,{key:0,class:"bg-warning text-white q-mt-sm"},{avatar:q(()=>[v(o,{name:"warning"})]),default:q(()=>[d[11]||(d[11]=g(" Please select at least one correct answer "))]),_:1})):(b(),p("div",A," âœ“ "+y(w(le).correct_answer.length)+" correct answer(s) selected ",1))])):h("",!0),"true_false"===w(le).question_type?(b(),p("div",M,[d[13]||(d[13]=_("div",{class:"text-subtitle2 q-mb-sm"},"Correct Answer",-1)),v(i,{modelValue:w(le).correct_answer[0],"onUpdate:modelValue":d[4]||(d[4]=e=>w(le).correct_answer[0]=e),options:[{label:"True",value:"true"},{label:"False",value:"false"}],type:"radio"},null,8,["modelValue"])])):h("",!0),"short"===w(le).question_type||"long"===w(le).question_type?(b(),p("div",F,[v(a,{class:"bg-info text-white"},{avatar:q(()=>[v(o,{name:"info"})]),default:q(()=>[d[14]||(d[14]=g(" This question type requires manual grading. Students will provide text answers. "))]),_:1})])):h("",!0),_("div",P,[v(r,{modelValue:w(le).difficulty,"onUpdate:modelValue":d[5]||(d[5]=e=>w(le).difficulty=e),options:ee,label:"Difficulty Level *",style:{"min-width":"150px"},rules:[e=>!!e||"Please select difficulty level"]},{hint:q(()=>d[15]||(d[15]=[g(" How challenging is this question? ")])),_:1},8,["modelValue","rules"]),v(r,{modelValue:w(le).bloom_level,"onUpdate:modelValue":d[6]||(d[6]=e=>w(le).bloom_level=e),options:te,"option-value":"value","option-label":"label",label:"Bloom's Taxonomy Level",clearable:"","emit-value":"","map-options":"",style:{"min-width":"200px"}},{prepend:q(()=>{return[v(o,{name:w(le).bloom_level?(e=w(le).bloom_level,{remember:"psychology",understand:"lightbulb",apply:"build",analyze:"analytics",evaluate:"fact_check",create:"auto_awesome"}[e]||"help"):"help"},null,8,["name"])];var e}),hint:q(()=>d[16]||(d[16]=[g(" Cognitive skill level (optional) ")])),_:1},8,["modelValue"]),v(l,{modelValue:w(le).marks,"onUpdate:modelValue":d[7]||(d[7]=e=>w(le).marks=e),modelModifiers:{number:!0},type:"number",label:"Marks *",min:"1",max:"100",style:{"max-width":"120px"},rules:[e=>e>0||"Marks must be greater than 0",e=>e<=100||"Marks cannot exceed 100"]},{hint:q(()=>d[17]||(d[17]=[g(" Points (1-100) ")])),_:1},8,["modelValue","rules"])]),_("div",T,[v(n,{type:"submit",color:"primary",label:"Save Question",loading:w(le).processing},null,8,["loading"]),v(n,{flat:"",label:"Cancel",onClick:d[8]||(d[8]=t=>e.$inertia.visit(w(k)("qu-questions.index")))})])]),_:1})]),_:1})]),_:1})]))}};export{E as default};
